Return-Path: <mjpeg-users-bounces@lists.sourceforge.net>
X-Original-To: lists+mjpeg-users@lfdr.de
Delivered-To: lists+mjpeg-users@lfdr.de
Received: from lists.sourceforge.net (lists.sourceforge.net [216.105.38.7])
	by mail.lfdr.de (Postfix) with ESMTPS id 194A2B8BEC0
	for <lists+mjpeg-users@lfdr.de>; Sat, 20 Sep 2025 06:13:10 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.sourceforge.net; s=beta; h=Content-Transfer-Encoding:Content-Type:Cc:
	Reply-To:List-Subscribe:List-Help:List-Post:List-Archive:List-Unsubscribe:
	List-Id:Subject:To:In-Reply-To:References:Message-Id:MIME-Version:Date:From:
	Sender:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:
	Resent-To:Resent-Cc:Resent-Message-ID:List-Owner;
	bh=1dIDlCTzYF94/6z/bj4+Onjs1cE+jhO89Fz1zxtxxEA=; b=f5/aRNhkH2W43Wc/2GgGYY1aDZ
	MU1HK2TQ14CX012t3BGqfGc1BkAesgfCEmUZvsjgpAb7J9Akv9AyYrh1rsCOkW7l6mMR/pwuoOM0k
	n7H5HK1qvCPAymEhVLV5E3M510ZjMB1pUivMLYsqBa8KvNwWY/cWJWUkc0PsvFZaiHbI=;
Received: from [127.0.0.1] (helo=sfs-ml-2.v29.lw.sourceforge.com)
	by sfs-ml-2.v29.lw.sourceforge.com with esmtp (Exim 4.95)
	(envelope-from <mjpeg-users-bounces@lists.sourceforge.net>)
	id 1uzoy9-0006k3-GI;
	Sat, 20 Sep 2025 04:13:06 +0000
Received: from [172.30.29.66] (helo=mx.sourceforge.net)
 by sfs-ml-2.v29.lw.sourceforge.com with esmtps (TLS1.2) tls
 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (Exim 4.95)
 (envelope-from <jai.luthra@ideasonboard.com>) id 1uzYXZ-0006Ib-I2
 for mjpeg-users@lists.sourceforge.net;
 Fri, 19 Sep 2025 10:40:34 +0000
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
 d=sourceforge.net; s=x; h=Cc:To:In-Reply-To:References:Message-Id:
 Content-Transfer-Encoding:Content-Type:MIME-Version:Subject:Date:From:Sender:
 Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender
 :Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:
 List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=5h2csvsIynkHtI3mgoCR67siuBNIbWoxqCVSe2CJrts=; b=CIcEvQSxEMOMH/JWba3NEuIhAK
 8TG6Vr7D6tKn03bXfpSj36TLqWfN/ukgFf2I/KeQJJciu7zMVu3XIOUxwR6t4qhCcLmZVDnxe71Na
 EYM2cDyerNl1rSkXQgybwtrHfbqnqtfbSnPZJbkDAetrQPbeT59ccZ1A1tqBT5JDAe1M=;
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=sf.net; s=x
 ;
 h=Cc:To:In-Reply-To:References:Message-Id:Content-Transfer-Encoding:
 Content-Type:MIME-Version:Subject:Date:From:Sender:Reply-To:Content-ID:
 Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc
 :Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:List-Subscribe:
 List-Post:List-Owner:List-Archive;
 bh=5h2csvsIynkHtI3mgoCR67siuBNIbWoxqCVSe2CJrts=; b=gebI242QVPmKe21rKle9ELAuiA
 Ic/taMEugcQMrqULhqNfQcMEzXfzT+/4PN4Z94lDo8zgmyiyrdKQ9fYOWnxktm+L6PxUtWdxndmuW
 3htUnjgncbgQ8QUOVUbWUjr4RUF3p59MD95+oo/yPzOeE4E5VECK3sH1SxDcQVaQmDlA=;
Received: from perceval.ideasonboard.com ([213.167.242.64])
 by sfi-mx-2.v28.lw.sourceforge.com with esmtps
 (TLS1.2:ECDHE-RSA-AES256-GCM-SHA384:256) (Exim 4.95)
 id 1uzYXV-0006Vq-8j for mjpeg-users@lists.sourceforge.net;
 Fri, 19 Sep 2025 10:40:34 +0000
Received: from mail.ideasonboard.com (unknown
 [IPv6:2401:4900:1c30:4816:952:3054:81b6:1a3a])
 by perceval.ideasonboard.com (Postfix) with ESMTPSA id 29362842;
 Fri, 19 Sep 2025 11:56:12 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=ideasonboard.com;
 s=mail; t=1758275776;
 bh=PVcIVYgi1U5GQ0iqtJSIWmipD24USGtOXZChfIDQUag=;
 h=From:Date:Subject:References:In-Reply-To:To:Cc:From;
 b=PlUBeh2MEuzjx1/LZR1uL0+t043lpF3lfUOf5VA0LkUQG1A46f0qUjh3at+VSJVMb
 4k2SmXx9wIVQshJf+fgnRnDXKFrqp6x0sEjjb73DFYV6uG9iBnm8ygtqwz8pGPApXo
 TmsR2iVRZ/nR01JNkQia/OOc3wRBsw1u4jM+m88s=
From: Jai Luthra <jai.luthra@ideasonboard.com>
Date: Fri, 19 Sep 2025 15:25:58 +0530
MIME-Version: 1.0
Message-Id: <20250919-vdev-state-v2-6-b2c42426965c@ideasonboard.com>
References: <20250919-vdev-state-v2-0-b2c42426965c@ideasonboard.com>
In-Reply-To: <20250919-vdev-state-v2-0-b2c42426965c@ideasonboard.com>
To: Hans Verkuil <hverkuil@kernel.org>, 
 Mauro Carvalho Chehab <mchehab@kernel.org>, 
 Sakari Ailus <sakari.ailus@linux.intel.com>, 
 Laurent Pinchart <laurent.pinchart@ideasonboard.com>, 
 Tomi Valkeinen <tomi.valkeinen@ideasonboard.com>, 
 Jacopo Mondi <jacopo.mondi@ideasonboard.com>, linux-media@vger.kernel.org
X-Mailer: b4 0.14.2
X-Spam-Score: -0.2 (/)
X-Spam-Report: Spam detection software,
 running on the system "sfi-spamd-1.hosts.colo.sdot.me", 
 has NOT identified this incoming email as spam.  The original
 message has been attached to this so you can view it or label
 similar future email.  If you have any questions, see
 the administrator of that system for details.
 Content preview:  Replace the opaque (and unused) pointer with a pointer to
 the video device state in all V4L2 driver ioctl implementations. Most changes
 were automated using Coccinelle semantic patches for both drivers and
 framework helpers: 
 Content analysis details:   (-0.2 points, 5.0 required)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.1 DKIM_VALID_AU Message has a valid DKIM or DK signature from author's
 domain
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature,
 not necessarily valid
X-Headers-End: 1uzYXV-0006Vq-8j
X-Mailman-Approved-At: Sat, 20 Sep 2025 04:13:03 +0000
Subject: [Mjpeg-users] [PATCH v2 06/10] media: Replace void * with
 video_device_state * in all driver ioctl implementations
X-BeenThere: mjpeg-users@lists.sourceforge.net
X-Mailman-Version: 2.1.21
Precedence: list
List-Id: MJPEG-tools user list <mjpeg-users.lists.sourceforge.net>
List-Unsubscribe: <https://lists.sourceforge.net/lists/options/mjpeg-users>,
 <mailto:mjpeg-users-request@lists.sourceforge.net?subject=unsubscribe>
List-Archive: <http://sourceforge.net/mailarchive/forum.php?forum_name=mjpeg-users>
List-Post: <mailto:mjpeg-users@lists.sourceforge.net>
List-Help: <mailto:mjpeg-users-request@lists.sourceforge.net?subject=help>
List-Subscribe: <https://lists.sourceforge.net/lists/listinfo/mjpeg-users>,
 <mailto:mjpeg-users-request@lists.sourceforge.net?subject=subscribe>
Reply-To: MJPEG-tools user list <mjpeg-users@lists.sourceforge.net>
Cc: Maxime Ripard <mripard@kernel.org>, Plamen Atanasov <tigerment@mail.bg>,
 Heiko Stuebner <heiko@sntech.de>, Devarsh Thakkar <devarsht@ti.com>,
 Eddie James <eajames@linux.ibm.com>, Alim Akhtar <alim.akhtar@samsung.com>,
 Christian Gromm <christian.gromm@microchip.com>,
 Dmitry Osipenko <digetx@gmail.com>,
 Tommaso Merciai <tommaso.merciai.xr@bp.renesas.com>,
 linux-stm32@st-md-mailman.stormreply.com,
 Marek Szyprowski <m.szyprowski@samsung.com>,
 Nikita Yushchenko <nikita.yoush@cogentembedded.com>,
 Michael Grzeschik <m.grzeschik@pengutronix.de>, Robert Foss <rfoss@kernel.org>,
 Geert Uytterhoeven <geert+renesas@glider.be>,
 Samuel Holland <samuel@sholland.org>, Kevin Hilman <khilman@baylibre.com>,
 Jacob Chen <jacob-chen@iotwrt.com>,
 Yemike Abhilash Chandra <y-abhilashchandra@ti.com>,
 Bingbu Cao <bingbu.cao@intel.com>,
 Andrew Jeffery <andrew@codeconstruct.com.au>,
 Luca Ceresoli <luca.ceresoli@bootlin.com>, linux-sunxi@lists.linux.dev,
 Sascha Hauer <s.hauer@pengutronix.de>,
 =?utf-8?q?=C5=81ukasz_Stelmach?= <l.stelmach@samsung.com>,
 Shuah Khan <skhan@linuxfoundation.org>,
 Andrzej Pietrasiewicz <andrzejtp2010@gmail.com>,
 Thomas Gleixner <tglx@linutronix.de>, Nas Chung <nas.chung@chipsnmedia.com>,
 Andy Shevchenko <andy@kernel.org>, Andy Walls <awalls@md.metrocast.net>,
 Scott Branden <sbranden@broadcom.com>,
 Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Vladimir Zapolskiy <vladimir.zapolskiy@linaro.org>, linux-usb@vger.kernel.org,
 Michael Tretter <m.tretter@pengutronix.de>, linux-kernel@vger.kernel.org,
 Jack Zhu <jack.zhu@starfivetech.com>,
 Sowjanya Komatineni <skomatineni@nvidia.com>,
 Jai Luthra <jai.luthra@linux.dev>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 Shreeya Patel <shreeya.patel@collabora.com>,
 Changhuang Liang <changhuang.liang@starfivetech.com>,
 Ming Qian <ming.qian@nxp.com>, Andrew-CT Chen <andrew-ct.chen@mediatek.com>,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 Sylwester Nawrocki <s.nawrocki@samsung.com>, linux-aspeed@lists.ozlabs.org,
 Yunfei Dong <yunfei.dong@mediatek.com>,
 Jai Luthra <jai.luthra@ideasonboard.com>, Matt Ranostay <matt@ranostay.sg>,
 "Lad, Prabhakar" <prabhakar.csengg@gmail.com>,
 Thierry Reding <thierry.reding@gmail.com>,
 Ariel Otilibili <ariel.otilibili-anieli@eurecom.fr>, kernel@collabora.com,
 Ingo Molnar <mingo@kernel.org>, Matthew Majewski <mattwmajewski@gmail.com>,
 Magnus Damm <magnus.damm@gmail.com>, Jonathan Hunter <jonathanh@nvidia.com>,
 linux-rockchip@lists.infradead.org,
 Fabien Dessenne <fabien.dessenne@foss.st.com>,
 Ezequiel Garcia <ezequiel@vanguardiasur.com.ar>,
 Alain Volmat <alain.volmat@foss.st.com>,
 Daniel Scally <dan.scally+renesas@ideasonboard.com>,
 Jerome Brunet <jbrunet@baylibre.com>, Tianshu Qiu <tian.shu.qiu@intel.com>,
 Joseph Liu <kwliu@nuvoton.com>,
 Parthiban Veerasooran <parthiban.veerasooran@microchip.com>,
 Paul Kocialkowski <paulk@sys-base.io>,
 Martin Blumenstingl <martin.blumenstingl@googlemail.com>,
 linux-arm-msm@vger.kernel.org, Houlong Wei <houlong.wei@mediatek.com>,
 linux-input@vger.kernel.org, Fabrizio Castro <fabrizio.castro.jz@renesas.com>,
 Biju Das <biju.das.jz@bp.renesas.com>, linux-amlogic@lists.infradead.org,
 Michal Simek <michal.simek@amd.com>, linux-arm-kernel@lists.infradead.org,
 Neil Armstrong <neil.armstrong@linaro.org>,
 linux-rpi-kernel@lists.infradead.org, Zhou Peng <eagle.zhou@nxp.com>,
 Chen Ni <nichen@iscas.ac.cn>, Dave Stevenson <dave.stevenson@raspberrypi.com>,
 linux-renesas-soc@vger.kernel.org, Stefan Wahren <wahrenst@gmx.net>,
 Maxime Coquelin <mcoquelin.stm32@gmail.com>,
 Raspberry Pi Kernel Maintenance <kernel-list@raspberrypi.com>,
 linux-mediatek@lists.infradead.org,
 Nicolas Dufresne <nicolas.dufresne@collabora.com>,
 Marvin Lin <kflin@nuvoton.com>, Jacek Anaszewski <jacek.anaszewski@gmail.com>,
 imx@lists.linux.dev, Dafna Hirschfeld <dafna@fastmail.com>,
 "Everest K.C." <everestkc@everestkc.com.np>,
 Xavier Roumegue <xavier.roumegue@oss.nxp.com>, linux-tegra@vger.kernel.org,
 Bluecherry Maintainers <maintainers@bluecherrydvr.com>,
 Jernej Skrabec <jernej.skrabec@gmail.com>,
 Andrzej Hajda <andrzej.hajda@intel.com>, Fabio Estevam <festevam@gmail.com>,
 Jean-Christophe Trotin <jean-christophe.trotin@foss.st.com>,
 Andrey Utkin <andrey_utkin@fastmail.com>,
 Detlev Casanova <detlev.casanova@collabora.com>,
 Benjamin Gaignard <benjamin.gaignard@collabora.com>,
 Mike Isely <isely@pobox.com>, Jackson Lee <jackson.lee@chipsnmedia.com>,
 linux-staging@lists.linux.dev, Krzysztof Kozlowski <krzk@kernel.org>,
 linux-samsung-soc@vger.kernel.org, Chen-Yu Tsai <wens@csie.org>,
 Broadcom internal kernel review list <bcm-kernel-feedback-list@broadcom.com>,
 Joel Stanley <joel@jms.id.au>, Yang Yingliang <yangyingliang@huawei.com>,
 Bryan O'Donoghue <bryan.odonoghue@linaro.org>, Bin Liu <bin.liu@mediatek.com>,
 Vikash Garodia <vikash.garodia@oss.qualcomm.com>,
 Dikshita Agarwal <dikshita.agarwal@oss.qualcomm.com>,
 Ray Jui <rjui@broadcom.com>, Steve Longerbeam <slongerbeam@gmail.com>,
 Akash Kumar <quic_akakum@quicinc.com>, Mark Brown <broonie@kernel.org>,
 Eugen Hristev <eugen.hristev@linaro.org>,
 Martin Kepplinger <martink@posteo.de>, Yunseong Kim <ysk@kzalloc.com>,
 Dmitry Torokhov <dmitry.torokhov@gmail.com>,
 Claudiu Beznea <claudiu.beznea@tuxon.dev>, Tomasz Figa <tfiga@chromium.org>,
 Dan Scally <djrscally@gmail.com>, Sean Young <sean@mess.org>,
 Kieran Bingham <kieran.bingham+renesas@ideasonboard.com>,
 Ricardo Ribalda <ribalda@chromium.org>,
 Martin Tuma <martin.tuma@digiteqautomotive.com>,
 Shawn Guo <shawnguo@kernel.org>, Hans de Goede <hansg@kernel.org>,
 Ludwig Disterhof <ludwig@disterhof.eu>,
 Minghsiu Tsai <minghsiu.tsai@mediatek.com>, Nick Dyer <nick@shmanahar.org>,
 Daniel Almeida <daniel.almeida@collabora.com>,
 Alexandre Torgue <alexandre.torgue@foss.st.com>,
 Todor Tomov <todor.too@gmail.com>, Mirela Rabulea <mirela.rabulea@nxp.com>,
 Jiasheng Jiang <jiashengjiangcool@gmail.com>,
 Fabio Luongo <f.langufo.l@gmail.com>, Alexey Klimov <alexey.klimov@linaro.org>,
 Florian Fainelli <florian.fainelli@broadcom.com>,
 Hugues Fruchet <hugues.fruchet@foss.st.com>, openbmc@lists.ozlabs.org,
 Michael Krufky <mkrufky@linuxtv.org>, Corentin Labbe <clabbe@baylibre.com>,
 Ismael Luceno <ismael@iodev.co.uk>, Yong Zhi <yong.zhi@intel.com>,
 "Dr. David Alan Gilbert" <linux@treblig.org>, Ma Ke <make24@iscas.ac.cn>,
 Lad Prabhakar <prabhakar.mahadev-lad.rj@bp.renesas.com>,
 Abhinav Kumar <abhinav.kumar@linux.dev>,
 Eduardo Valentin <edubezval@gmail.com>, Rui Miguel Silva <rmfrfs@gmail.com>,
 =?utf-8?q?Uwe_Kleine-K=C3=B6nig?= <u.kleine-koenig@baylibre.com>,
 Yong Deng <yong.deng@magewell.com>, Matthias Brugger <matthias.bgg@gmail.com>,
 Tiffany Lin <tiffany.lin@mediatek.com>,
 AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>,
 Purism Kernel Team <kernel@puri.sm>,
 Nicolas Ferre <nicolas.ferre@microchip.com>, mjpeg-users@lists.sourceforge.net,
 Philipp Zabel <p.zabel@pengutronix.de>,
 =?utf-8?q?Niklas_S=C3=B6derlund?= <niklas.soderlund@ragnatech.se>,
 Keke Li <keke.li@amlogic.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: mjpeg-users-bounces@lists.sourceforge.net

UmVwbGFjZSB0aGUgb3BhcXVlIChhbmQgdW51c2VkKSBwb2ludGVyIHdpdGggYSBwb2ludGVyIHRv
IHRoZSB2aWRlbwpkZXZpY2Ugc3RhdGUgaW4gYWxsIFY0TDIgZHJpdmVyIGlvY3RsIGltcGxlbWVu
dGF0aW9ucy4KCk1vc3QgY2hhbmdlcyB3ZXJlIGF1dG9tYXRlZCB1c2luZyBDb2NjaW5lbGxlIHNl
bWFudGljIHBhdGNoZXMgZm9yIGJvdGgKZHJpdmVycyBhbmQgZnJhbWV3b3JrIGhlbHBlcnM6CgpA
b3BzQAppZGVudGlmaWVyIG9wczsKaWRlbnRpZmllciB2aWRpb2Nfb3A7CmlkZW50aWZpZXIgZm47
CkBACnN0cnVjdCB2NGwyX2lvY3RsX29wcyBvcHMgPSB7CgkuLi4sCgkudmlkaW9jX29wID0gZm4s
CgkuLi4sCn07CgovLyBSdWxlIDEgKGxpa2UgdmlkaW9jX2xvZ19zdGF0dXMpCkBkZXBlbmRzIG9u
IG9wc0AKaWRlbnRpZmllciBvcHMuZm47CmlkZW50aWZpZXIgZmlsZXA7CmlkZW50aWZpZXIgcHJp
djsKQEAKaW50IGZuKHN0cnVjdCBmaWxlICpmaWxlcCwKLSAgICAgIHZvaWQgKnByaXYpCisgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKewoJPC4uLgotCXByaXYKKwlzdGF0
ZQoJLi4uPgp9CgovLyBSdWxlIDIgKG1vc3QgaW9jdGxzKQpAZGVwZW5kcyBvbiBvcHNACmlkZW50
aWZpZXIgb3BzLmZuOwppZGVudGlmaWVyIGZpbGVwOwppZGVudGlmaWVyIHByaXY7CmlkZW50aWZp
ZXIgYXJnOwp0eXBlIFQ7CkBACmludCBmbihzdHJ1Y3QgZmlsZSAqZmlsZXAsCi0gICAgICB2b2lk
ICpwcml2LAorICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAgICAgICBU
IGFyZykKewoJPC4uLgotCXByaXYKKwlzdGF0ZQoJLi4uPgp9CgovLyBSdWxlIDMgKGxpa2Ugdmlk
aW9jX2dfcGl4ZWxhc3BlY3QpCkBkZXBlbmRzIG9uIG9wc0AKaWRlbnRpZmllciBvcHMuZm47Cmlk
ZW50aWZpZXIgZmlsZXA7CmlkZW50aWZpZXIgcHJpdjsKaWRlbnRpZmllciBidWZfdHlwZTsKaWRl
bnRpZmllciBhcmc7CnR5cGUgVDEsIFQyOwpAQAppbnQgZm4oc3RydWN0IGZpbGUgKmZpbGVwLAot
ICAgICAgdm9pZCAqcHJpdiwKKyAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogICAgICAgVDEgYnVmX3R5cGUsIFQyICphcmcpCnsKCTwuLi4KLQlwcml2CisJc3RhdGUKCS4u
Lj4KfQoKLy8gUnVsZSA0IChsaWtlIHZpZGlvY19kZWZhdWx0KQpAZGVwZW5kcyBvbiBvcHNACmlk
ZW50aWZpZXIgb3BzLmZuOwppZGVudGlmaWVyIGZpbGVwOwppZGVudGlmaWVyIHByaXY7CmlkZW50
aWZpZXIgdmFsaWRfcHJpbzsKaWRlbnRpZmllciBjbWQ7CmlkZW50aWZpZXIgYXJnOwpAQApsb25n
IGZuKHN0cnVjdCBmaWxlICpmaWxlcCwKLSAgICAgICAgdm9pZCAqcHJpdiwKKyAgICAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAgICAgICAgIGJvb2wgdmFsaWRfcHJpbywg
dW5zaWduZWQgaW50IGNtZCwgdm9pZCAqYXJnKQp7Cgk8Li4uCi0JcHJpdgorCXN0YXRlCgkuLi4+
Cn0KCkZ1bmN0aW9uIHNpZ25hdHVyZSB1cGRhdGVzIGluIGhlYWRlcnMgYW5kIGVkZ2UgY2FzZXMg
d2hlcmUgZHJpdmVycyBjYWxsCmlvY3RsIGltcGxlbWVudGF0aW9ucyBpbnRlcm5hbGx5IHdlcmUg
aGFuZGxlZCBtYW51YWxseS4KClNpZ25lZC1vZmYtYnk6IEphaSBMdXRocmEgPGphaS5sdXRocmFA
aWRlYXNvbmJvYXJkLmNvbT4KLS0KQ2M6IERtaXRyeSBUb3Jva2hvdiA8ZG1pdHJ5LnRvcm9raG92
QGdtYWlsLmNvbT4KQ2M6IE5pY2sgRHllciA8bmlja0BzaG1hbmFoYXIub3JnPgpDYzogSGFucyBW
ZXJrdWlsIDxodmVya3VpbEBrZXJuZWwub3JnPgpDYzogTWF1cm8gQ2FydmFsaG8gQ2hlaGFiIDxt
Y2hlaGFiQGtlcm5lbC5vcmc+CkNjOiBUb21hc3ogRmlnYSA8dGZpZ2FAY2hyb21pdW0ub3JnPgpD
YzogTWFyZWsgU3p5cHJvd3NraSA8bS5zenlwcm93c2tpQHNhbXN1bmcuY29tPgpDYzogTWF0dCBS
YW5vc3RheSA8bWF0dEByYW5vc3RheS5zZz4KQ2M6IEFuZHkgV2FsbHMgPGF3YWxsc0BtZC5tZXRy
b2Nhc3QubmV0PgpDYzogWW9uZyBaaGkgPHlvbmcuemhpQGludGVsLmNvbT4KQ2M6IFNha2FyaSBB
aWx1cyA8c2FrYXJpLmFpbHVzQGxpbnV4LmludGVsLmNvbT4KQ2M6IEJpbmdidSBDYW8gPGJpbmdi
dS5jYW9AaW50ZWwuY29tPgpDYzogRGFuIFNjYWxseSA8ZGpyc2NhbGx5QGdtYWlsLmNvbT4KQ2M6
IFRpYW5zaHUgUWl1IDx0aWFuLnNodS5xaXVAaW50ZWwuY29tPgpDYzogTWFydGluIFR1bWEgPG1h
cnRpbi50dW1hQGRpZ2l0ZXFhdXRvbW90aXZlLmNvbT4KQ2M6IEJsdWVjaGVycnkgTWFpbnRhaW5l
cnMgPG1haW50YWluZXJzQGJsdWVjaGVycnlkdnIuY29tPgpDYzogQW5kcmV5IFV0a2luIDxhbmRy
ZXlfdXRraW5AZmFzdG1haWwuY29tPgpDYzogSXNtYWVsIEx1Y2VubyA8aXNtYWVsQGlvZGV2LmNv
LnVrPgpDYzogRXplcXVpZWwgR2FyY2lhIDxlemVxdWllbEB2YW5ndWFyZGlhc3VyLmNvbS5hcj4K
Q2M6IENvcmVudGluIExhYmJlIDxjbGFiYmVAYmF5bGlicmUuY29tPgpDYzogTWljaGFlbCBUcmV0
dGVyIDxtLnRyZXR0ZXJAcGVuZ3V0cm9uaXguZGU+CkNjOiBQZW5ndXRyb25peCBLZXJuZWwgVGVh
bSA8a2VybmVsQHBlbmd1dHJvbml4LmRlPgpDYzogS2VrZSBMaSA8a2VrZS5saUBhbWxvZ2ljLmNv
bT4KQ2M6IE5laWwgQXJtc3Ryb25nIDxuZWlsLmFybXN0cm9uZ0BsaW5hcm8ub3JnPgpDYzogS2V2
aW4gSGlsbWFuIDxraGlsbWFuQGJheWxpYnJlLmNvbT4KQ2M6IEplcm9tZSBCcnVuZXQgPGpicnVu
ZXRAYmF5bGlicmUuY29tPgpDYzogTWFydGluIEJsdW1lbnN0aW5nbCA8bWFydGluLmJsdW1lbnN0
aW5nbEBnb29nbGVtYWlsLmNvbT4KQ2M6IE1pbmcgUWlhbiA8bWluZy5xaWFuQG54cC5jb20+CkNj
OiBaaG91IFBlbmcgPGVhZ2xlLnpob3VAbnhwLmNvbT4KQ2M6IEVkZGllIEphbWVzIDxlYWphbWVz
QGxpbnV4LmlibS5jb20+CkNjOiBKb2VsIFN0YW5sZXkgPGpvZWxAam1zLmlkLmF1PgpDYzogQW5k
cmV3IEplZmZlcnkgPGFuZHJld0Bjb2RlY29uc3RydWN0LmNvbS5hdT4KQ2M6IEV1Z2VuIEhyaXN0
ZXYgPGV1Z2VuLmhyaXN0ZXZAbGluYXJvLm9yZz4KQ2M6IE5pY29sYXMgRmVycmUgPG5pY29sYXMu
ZmVycmVAbWljcm9jaGlwLmNvbT4KQ2M6IEFsZXhhbmRyZSBCZWxsb25pIDxhbGV4YW5kcmUuYmVs
bG9uaUBib290bGluLmNvbT4KQ2M6IENsYXVkaXUgQmV6bmVhIDxjbGF1ZGl1LmJlem5lYUB0dXhv
bi5kZXY+CkNjOiBSYXNwYmVycnkgUGkgS2VybmVsIE1haW50ZW5hbmNlIDxrZXJuZWwtbGlzdEBy
YXNwYmVycnlwaS5jb20+CkNjOiBGbG9yaWFuIEZhaW5lbGxpIDxmbG9yaWFuLmZhaW5lbGxpQGJy
b2FkY29tLmNvbT4KQ2M6IEJyb2FkY29tIGludGVybmFsIGtlcm5lbCByZXZpZXcgbGlzdCA8YmNt
LWtlcm5lbC1mZWVkYmFjay1saXN0QGJyb2FkY29tLmNvbT4KQ2M6IFJheSBKdWkgPHJqdWlAYnJv
YWRjb20uY29tPgpDYzogU2NvdHQgQnJhbmRlbiA8c2JyYW5kZW5AYnJvYWRjb20uY29tPgpDYzog
UGhpbGlwcCBaYWJlbCA8cC56YWJlbEBwZW5ndXRyb25peC5kZT4KQ2M6IE5hcyBDaHVuZyA8bmFz
LmNodW5nQGNoaXBzbm1lZGlhLmNvbT4KQ2M6IEphY2tzb24gTGVlIDxqYWNrc29uLmxlZUBjaGlw
c25tZWRpYS5jb20+CkNjOiBEZXZhcnNoIFRoYWtrYXIgPGRldmFyc2h0QHRpLmNvbT4KQ2M6IEJp
biBMaXUgPGJpbi5saXVAbWVkaWF0ZWsuY29tPgpDYzogTWF0dGhpYXMgQnJ1Z2dlciA8bWF0dGhp
YXMuYmdnQGdtYWlsLmNvbT4KQ2M6IEFuZ2Vsb0dpb2FjY2hpbm8gRGVsIFJlZ25vIDxhbmdlbG9n
aW9hY2NoaW5vLmRlbHJlZ25vQGNvbGxhYm9yYS5jb20+CkNjOiBNaW5naHNpdSBUc2FpIDxtaW5n
aHNpdS50c2FpQG1lZGlhdGVrLmNvbT4KQ2M6IEhvdWxvbmcgV2VpIDxob3Vsb25nLndlaUBtZWRp
YXRlay5jb20+CkNjOiBBbmRyZXctQ1QgQ2hlbiA8YW5kcmV3LWN0LmNoZW5AbWVkaWF0ZWsuY29t
PgpDYzogVGlmZmFueSBMaW4gPHRpZmZhbnkubGluQG1lZGlhdGVrLmNvbT4KQ2M6IFl1bmZlaSBE
b25nIDx5dW5mZWkuZG9uZ0BtZWRpYXRlay5jb20+CkNjOiBKb3NlcGggTGl1IDxrd2xpdUBudXZv
dG9uLmNvbT4KQ2M6IE1hcnZpbiBMaW4gPGtmbGluQG51dm90b24uY29tPgpDYzogRG1pdHJ5IE9z
aXBlbmtvIDxkaWdldHhAZ21haWwuY29tPgpDYzogVGhpZXJyeSBSZWRpbmcgPHRoaWVycnkucmVk
aW5nQGdtYWlsLmNvbT4KQ2M6IEpvbmF0aGFuIEh1bnRlciA8am9uYXRoYW5oQG52aWRpYS5jb20+
CkNjOiBYYXZpZXIgUm91bWVndWUgPHhhdmllci5yb3VtZWd1ZUBvc3MubnhwLmNvbT4KQ2M6IE1p
cmVsYSBSYWJ1bGVhIDxtaXJlbGEucmFidWxlYUBueHAuY29tPgpDYzogU2hhd24gR3VvIDxzaGF3
bmd1b0BrZXJuZWwub3JnPgpDYzogU2FzY2hhIEhhdWVyIDxzLmhhdWVyQHBlbmd1dHJvbml4LmRl
PgpDYzogRmFiaW8gRXN0ZXZhbSA8ZmVzdGV2YW1AZ21haWwuY29tPgpDYzogUnVpIE1pZ3VlbCBT
aWx2YSA8cm1mcmZzQGdtYWlsLmNvbT4KQ2M6IExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGlu
Y2hhcnRAaWRlYXNvbmJvYXJkLmNvbT4KQ2M6IE1hcnRpbiBLZXBwbGluZ2VyIDxtYXJ0aW5rQHBv
c3Rlby5kZT4KQ2M6IFB1cmlzbSBLZXJuZWwgVGVhbSA8a2VybmVsQHB1cmkuc20+CkNjOiBSb2Jl
cnQgRm9zcyA8cmZvc3NAa2VybmVsLm9yZz4KQ2M6IFRvZG9yIFRvbW92IDx0b2Rvci50b29AZ21h
aWwuY29tPgpDYzogIkJyeWFuIE8nRG9ub2dodWUiIDxicnlhbi5vZG9ub2dodWVAbGluYXJvLm9y
Zz4KQ2M6IFZsYWRpbWlyIFphcG9sc2tpeSA8dmxhZGltaXIuemFwb2xza2l5QGxpbmFyby5vcmc+
CkNjOiBWaWthc2ggR2Fyb2RpYSA8dmlrYXNoLmdhcm9kaWFAb3NzLnF1YWxjb21tLmNvbT4KQ2M6
IERpa3NoaXRhIEFnYXJ3YWwgPGRpa3NoaXRhLmFnYXJ3YWxAb3NzLnF1YWxjb21tLmNvbT4KQ2M6
IEFiaGluYXYgS3VtYXIgPGFiaGluYXYua3VtYXJAbGludXguZGV2PgpDYzogSmFjb3BvIE1vbmRp
IDxqYWNvcG8ubW9uZGlAaWRlYXNvbmJvYXJkLmNvbT4KQ2M6IFRvbWkgVmFsa2VpbmVuIDx0b21p
LnZhbGtlaW5lbkBpZGVhc29uYm9hcmQuY29tPgpDYzogIk5pa2xhcyBTw7ZkZXJsdW5kIiA8bmlr
bGFzLnNvZGVybHVuZEByYWduYXRlY2guc2U+CkNjOiBHZWVydCBVeXR0ZXJob2V2ZW4gPGdlZXJ0
K3JlbmVzYXNAZ2xpZGVyLmJlPgpDYzogTWFnbnVzIERhbW0gPG1hZ251cy5kYW1tQGdtYWlsLmNv
bT4KQ2M6IEZhYnJpemlvIENhc3RybyA8ZmFicml6aW8uY2FzdHJvLmp6QHJlbmVzYXMuY29tPgpD
YzogS2llcmFuIEJpbmdoYW0gPGtpZXJhbi5iaW5naGFtK3JlbmVzYXNAaWRlYXNvbmJvYXJkLmNv
bT4KQ2M6IE5pa2l0YSBZdXNoY2hlbmtvIDxuaWtpdGEueW91c2hAY29nZW50ZW1iZWRkZWQuY29t
PgpDYzogSmFjb2IgQ2hlbiA8amFjb2ItY2hlbkBpb3R3cnQuY29tPgpDYzogSGVpa28gU3R1ZWJu
ZXIgPGhlaWtvQHNudGVjaC5kZT4KQ2M6IERhZm5hIEhpcnNjaGZlbGQgPGRhZm5hQGZhc3RtYWls
LmNvbT4KQ2M6IERldGxldiBDYXNhbm92YSA8ZGV0bGV2LmNhc2Fub3ZhQGNvbGxhYm9yYS5jb20+
CkNjOiBLcnp5c3p0b2YgS296bG93c2tpIDxrcnprQGtlcm5lbC5vcmc+CkNjOiBBbGltIEFraHRh
ciA8YWxpbS5ha2h0YXJAc2Ftc3VuZy5jb20+CkNjOiBTeWx3ZXN0ZXIgTmF3cm9ja2kgPHMubmF3
cm9ja2lAc2Ftc3VuZy5jb20+CkNjOiAixYF1a2FzeiBTdGVsbWFjaCIgPGwuc3RlbG1hY2hAc2Ft
c3VuZy5jb20+CkNjOiBBbmRyemVqIFBpZXRyYXNpZXdpY3ogPGFuZHJ6ZWp0cDIwMTBAZ21haWwu
Y29tPgpDYzogSmFjZWsgQW5hc3pld3NraSA8amFjZWsuYW5hc3pld3NraUBnbWFpbC5jb20+CkNj
OiBBbmRyemVqIEhhamRhIDxhbmRyemVqLmhhamRhQGludGVsLmNvbT4KQ2M6IEZhYmllbiBEZXNz
ZW5uZSA8ZmFiaWVuLmRlc3Nlbm5lQGZvc3Muc3QuY29tPgpDYzogSHVndWVzIEZydWNoZXQgPGh1
Z3Vlcy5mcnVjaGV0QGZvc3Muc3QuY29tPgpDYzogSmVhbi1DaHJpc3RvcGhlIFRyb3RpbiA8amVh
bi1jaHJpc3RvcGhlLnRyb3RpbkBmb3NzLnN0LmNvbT4KQ2M6IE1heGltZSBDb3F1ZWxpbiA8bWNv
cXVlbGluLnN0bTMyQGdtYWlsLmNvbT4KQ2M6IEFsZXhhbmRyZSBUb3JndWUgPGFsZXhhbmRyZS50
b3JndWVAZm9zcy5zdC5jb20+CkNjOiBBbGFpbiBWb2xtYXQgPGFsYWluLnZvbG1hdEBmb3NzLnN0
LmNvbT4KQ2M6IE1heGltZSBSaXBhcmQgPG1yaXBhcmRAa2VybmVsLm9yZz4KQ2M6IENoZW4tWXUg
VHNhaSA8d2Vuc0Bjc2llLm9yZz4KQ2M6IEplcm5laiBTa3JhYmVjIDxqZXJuZWouc2tyYWJlY0Bn
bWFpbC5jb20+CkNjOiBTYW11ZWwgSG9sbGFuZCA8c2FtdWVsQHNob2xsYW5kLm9yZz4KQ2M6IFlv
bmcgRGVuZyA8eW9uZy5kZW5nQG1hZ2V3ZWxsLmNvbT4KQ2M6IFBhdWwgS29jaWFsa293c2tpIDxw
YXVsa0BzeXMtYmFzZS5pbz4KQ2M6IFNocmVleWEgUGF0ZWwgPHNocmVleWEucGF0ZWxAY29sbGFi
b3JhLmNvbT4KQ2M6ICJMYWQsIFByYWJoYWthciIgPHByYWJoYWthci5jc2VuZ2dAZ21haWwuY29t
PgpDYzogWWVtaWtlIEFiaGlsYXNoIENoYW5kcmEgPHktYWJoaWxhc2hjaGFuZHJhQHRpLmNvbT4K
Q2M6IEphaSBMdXRocmEgPGphaS5sdXRocmFAbGludXguZGV2PgpDYzogTmljb2xhcyBEdWZyZXNu
ZSA8bmljb2xhcy5kdWZyZXNuZUBjb2xsYWJvcmEuY29tPgpDYzogQmVuamFtaW4gR2FpZ25hcmQg
PGJlbmphbWluLmdhaWduYXJkQGNvbGxhYm9yYS5jb20+CkNjOiBNaWNoYWwgU2ltZWsgPG1pY2hh
bC5zaW1la0BhbWQuY29tPgpDYzogQWxleGV5IEtsaW1vdiA8YWxleGV5LmtsaW1vdkBsaW5hcm8u
b3JnPgpDYzogRWR1YXJkbyBWYWxlbnRpbiA8ZWR1YmV6dmFsQGdtYWlsLmNvbT4KQ2M6IFNodWFo
IEtoYW4gPHNraGFuQGxpbnV4Zm91bmRhdGlvbi5vcmc+CkNjOiBEYW5pZWwgQWxtZWlkYSA8ZGFu
aWVsLmFsbWVpZGFAY29sbGFib3JhLmNvbT4KQ2M6IE1pY2hhZWwgS3J1Zmt5IDxta3J1Zmt5QGxp
bnV4dHYub3JnPgpDYzogTWlrZSBJc2VseSA8aXNlbHlAcG9ib3guY29tPgpDYzogSGFucyBkZSBH
b2VkZSA8aGFuc2dAa2VybmVsLm9yZz4KQ2M6IEFuZHkgU2hldmNoZW5rbyA8YW5keUBrZXJuZWwu
b3JnPgpDYzogR3JlZyBLcm9haC1IYXJ0bWFuIDxncmVna2hAbGludXhmb3VuZGF0aW9uLm9yZz4K
Q2M6IFN0ZXZlIExvbmdlcmJlYW0gPHNsb25nZXJiZWFtQGdtYWlsLmNvbT4KQ2M6IEphY2sgWmh1
IDxqYWNrLnpodUBzdGFyZml2ZXRlY2guY29tPgpDYzogQ2hhbmdodWFuZyBMaWFuZyA8Y2hhbmdo
dWFuZy5saWFuZ0BzdGFyZml2ZXRlY2guY29tPgpDYzogU293amFueWEgS29tYXRpbmVuaSA8c2tv
bWF0aW5lbmlAbnZpZGlhLmNvbT4KQ2M6IEx1Y2EgQ2VyZXNvbGkgPGx1Y2EuY2VyZXNvbGlAYm9v
dGxpbi5jb20+CkNjOiBQYXJ0aGliYW4gVmVlcmFzb29yYW4gPHBhcnRoaWJhbi52ZWVyYXNvb3Jh
bkBtaWNyb2NoaXAuY29tPgpDYzogQ2hyaXN0aWFuIEdyb21tIDxjaHJpc3RpYW4uZ3JvbW1AbWlj
cm9jaGlwLmNvbT4KQ2M6ICJVd2UgS2xlaW5lLUvDtm5pZyIgPHUua2xlaW5lLWtvZW5pZ0BiYXls
aWJyZS5jb20+CkNjOiBJbmdvIE1vbG5hciA8bWluZ29Aa2VybmVsLm9yZz4KQ2M6IFRob21hcyBH
bGVpeG5lciA8dGdseEBsaW51dHJvbml4LmRlPgpDYzogUGxhbWVuIEF0YW5hc292IDx0aWdlcm1l
bnRAbWFpbC5iZz4KQ2M6IFNlYW4gWW91bmcgPHNlYW5AbWVzcy5vcmc+CkNjOiBBcmllbCBPdGls
aWJpbGkgPGFyaWVsLm90aWxpYmlsaS1hbmllbGlAZXVyZWNvbS5mcj4KQ2M6ICJEci4gRGF2aWQg
QWxhbiBHaWxiZXJ0IiA8bGludXhAdHJlYmxpZy5vcmc+CkNjOiBKaWFzaGVuZyBKaWFuZyA8amlh
c2hlbmdqaWFuZ2Nvb2xAZ21haWwuY29tPgpDYzogTGFkIFByYWJoYWthciA8cHJhYmhha2FyLm1h
aGFkZXYtbGFkLnJqQGJwLnJlbmVzYXMuY29tPgpDYzogVG9tbWFzbyBNZXJjaWFpIDx0b21tYXNv
Lm1lcmNpYWkueHJAYnAucmVuZXNhcy5jb20+CkNjOiBCaWp1IERhcyA8YmlqdS5kYXMuanpAYnAu
cmVuZXNhcy5jb20+CkNjOiBEYW5pZWwgU2NhbGx5IDxkYW4uc2NhbGx5K3JlbmVzYXNAaWRlYXNv
bmJvYXJkLmNvbT4KQ2M6IE1hdHRoZXcgTWFqZXdza2kgPG1hdHR3bWFqZXdza2lAZ21haWwuY29t
PgpDYzogWXVuc2VvbmcgS2ltIDx5c2tAa3phbGxvYy5jb20+CkNjOiBDaGVuIE5pIDxuaWNoZW5A
aXNjYXMuYWMuY24+CkNjOiBSaWNhcmRvIFJpYmFsZGEgPHJpYmFsZGFAY2hyb21pdW0ub3JnPgpD
YzogRmFiaW8gTHVvbmdvIDxmLmxhbmd1Zm8ubEBnbWFpbC5jb20+CkNjOiBNYXJrIEJyb3duIDxi
cm9vbmllQGtlcm5lbC5vcmc+CkNjOiBZYW5nIFlpbmdsaWFuZyA8eWFuZ3lpbmdsaWFuZ0BodWF3
ZWkuY29tPgpDYzogTHVkd2lnIERpc3RlcmhvZiA8bHVkd2lnQGRpc3RlcmhvZi5ldT4KQ2M6IE1h
IEtlIDxtYWtlMjRAaXNjYXMuYWMuY24+CkNjOiAiRXZlcmVzdCBLLkMuIiA8ZXZlcmVzdGtjQGV2
ZXJlc3RrYy5jb20ubnA+CkNjOiBTdGVmYW4gV2FocmVuIDx3YWhyZW5zdEBnbXgubmV0PgpDYzog
RGF2ZSBTdGV2ZW5zb24gPGRhdmUuc3RldmVuc29uQHJhc3BiZXJyeXBpLmNvbT4KQ2M6IE1pY2hh
ZWwgR3J6ZXNjaGlrIDxtLmdyemVzY2hpa0BwZW5ndXRyb25peC5kZT4KQ2M6IEFrYXNoIEt1bWFy
IDxxdWljX2FrYWt1bUBxdWljaW5jLmNvbT4KQ2M6IGxpbnV4LWlucHV0QHZnZXIua2VybmVsLm9y
ZwpDYzogbGludXgta2VybmVsQHZnZXIua2VybmVsLm9yZwpDYzogbGludXgtbWVkaWFAdmdlci5r
ZXJuZWwub3JnCkNjOiBtanBlZy11c2Vyc0BsaXN0cy5zb3VyY2Vmb3JnZS5uZXQKQ2M6IGxpbnV4
LWFtbG9naWNAbGlzdHMuaW5mcmFkZWFkLm9yZwpDYzogbGludXgtYXJtLWtlcm5lbEBsaXN0cy5p
bmZyYWRlYWQub3JnCkNjOiBvcGVuYm1jQGxpc3RzLm96bGFicy5vcmcKQ2M6IGxpbnV4LWFzcGVl
ZEBsaXN0cy5vemxhYnMub3JnCkNjOiBsaW51eC1ycGkta2VybmVsQGxpc3RzLmluZnJhZGVhZC5v
cmcKQ2M6IGxpbnV4LW1lZGlhdGVrQGxpc3RzLmluZnJhZGVhZC5vcmcKQ2M6IGxpbnV4LXRlZ3Jh
QHZnZXIua2VybmVsLm9yZwpDYzogaW14QGxpc3RzLmxpbnV4LmRldgpDYzogbGludXgtYXJtLW1z
bUB2Z2VyLmtlcm5lbC5vcmcKQ2M6IGxpbnV4LXJlbmVzYXMtc29jQHZnZXIua2VybmVsLm9yZwpD
YzogbGludXgtcm9ja2NoaXBAbGlzdHMuaW5mcmFkZWFkLm9yZwpDYzogbGludXgtc2Ftc3VuZy1z
b2NAdmdlci5rZXJuZWwub3JnCkNjOiBsaW51eC1zdG0zMkBzdC1tZC1tYWlsbWFuLnN0b3JtcmVw
bHkuY29tCkNjOiBsaW51eC1zdW54aUBsaXN0cy5saW51eC5kZXYKQ2M6IGtlcm5lbEBjb2xsYWJv
cmEuY29tCkNjOiBsaW51eC1zdGFnaW5nQGxpc3RzLmxpbnV4LmRldgpDYzogbGludXgtdXNiQHZn
ZXIua2VybmVsLm9yZwotLS0KIGRyaXZlcnMvaW5wdXQvcm1pNC9ybWlfZjU0LmMgICAgICAgICAg
ICAgICAgICAgICAgIHwgIDIyICstCiBkcml2ZXJzL2lucHV0L3RvdWNoc2NyZWVuL2F0bWVsX214
dF90cy5jICAgICAgICAgICB8ICAyMyArLQogZHJpdmVycy9pbnB1dC90b3VjaHNjcmVlbi9zdXI0
MC5jICAgICAgICAgICAgICAgICAgfCAgMzUgKystCiAuLi4vZXh0cm9uLWRhLWhkLTRrLXBsdXMv
ZXh0cm9uLWRhLWhkLTRrLXBsdXMuYyAgICB8ICAzNCArKy0KIGRyaXZlcnMvbWVkaWEvY29tbW9u
L3NhYTcxNDYvc2FhNzE0Nl92aWRlby5jICAgICAgIHwgIDM3ICsrKy0KIGRyaXZlcnMvbWVkaWEv
Y29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdjRsMi5jICAgIHwgIDMwICsrLQogZHJpdmVycy9t
ZWRpYS9kdmItZnJvbnRlbmRzL3J0bDI4MzJfc2RyLmMgICAgICAgICAgfCAgMzggKystLQogZHJp
dmVycy9tZWRpYS9pMmMvdmlkZW8taTJjLmMgICAgICAgICAgICAgICAgICAgICAgfCAgMzkgKyst
LQogZHJpdmVycy9tZWRpYS9wY2kvYnQ4eHgvYnR0di1kcml2ZXIuYyAgICAgICAgICAgICAgfCAg
ODQgKysrKystLS0KIGRyaXZlcnMvbWVkaWEvcGNpL2J0OHh4L2J0dHYtdmJpLmMgICAgICAgICAg
ICAgICAgIHwgIDExICstCiBkcml2ZXJzL21lZGlhL3BjaS9idDh4eC9idHR2cC5oICAgICAgICAg
ICAgICAgICAgICB8ICAgOSArLQogZHJpdmVycy9tZWRpYS9wY2kvY29iYWx0L2NvYmFsdC12NGwy
LmMgICAgICAgICAgICAgfCAgOTggKysrKystLS0tCiBkcml2ZXJzL21lZGlhL3BjaS9jeDE4L2N4
MTgtZHJpdmVyLmMgICAgICAgICAgICAgICB8ICAgOSArLQogZHJpdmVycy9tZWRpYS9wY2kvY3gx
OC9jeDE4LWlvY3RsLmMgICAgICAgICAgICAgICAgfCAxMTQgKysrKysrLS0tLQogZHJpdmVycy9t
ZWRpYS9wY2kvY3gxOC9jeDE4LWlvY3RsLmggICAgICAgICAgICAgICAgfCAgIDkgKy0KIGRyaXZl
cnMvbWVkaWEvcGNpL2N4MjM4ODUvY3gyMzg4NS00MTcuYyAgICAgICAgICAgIHwgIDUzICsrKy0t
CiBkcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUtaW9jdGwuYyAgICAgICAgICB8ICAg
OCArLQogZHJpdmVycy9tZWRpYS9wY2kvY3gyMzg4NS9jeDIzODg1LWlvY3RsLmggICAgICAgICAg
fCAgIDkgKy0KIGRyaXZlcnMvbWVkaWEvcGNpL2N4MjM4ODUvY3gyMzg4NS12YmkuYyAgICAgICAg
ICAgIHwgICA1ICstCiBkcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUtdmlkZW8uYyAg
ICAgICAgICB8ICA4MiArKysrLS0tCiBkcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUu
aCAgICAgICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9tZWRpYS9wY2kvY3gyNTgyMS9jeDI1
ODIxLXZpZGVvLmMgICAgICAgICAgfCAgNTcgKysrLS0KIGRyaXZlcnMvbWVkaWEvcGNpL2N4ODgv
Y3g4OC1ibGFja2JpcmQuYyAgICAgICAgICAgIHwgIDQ3ICsrLS0KIGRyaXZlcnMvbWVkaWEvcGNp
L2N4ODgvY3g4OC12YmkuYyAgICAgICAgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL21lZGlh
L3BjaS9jeDg4L2N4ODgtdmlkZW8uYyAgICAgICAgICAgICAgICB8ICA1NiArKystLQogZHJpdmVy
cy9tZWRpYS9wY2kvY3g4OC9jeDg4LmggICAgICAgICAgICAgICAgICAgICAgfCAgIDIgKy0KIGRy
aXZlcnMvbWVkaWEvcGNpL2R0MzE1NS9kdDMxNTUuYyAgICAgICAgICAgICAgICAgIHwgIDI1ICsr
LQogZHJpdmVycy9tZWRpYS9wY2kvaW50ZWwvaXB1My9pcHUzLWNpbzIuYyAgICAgICAgICAgfCAg
MjkgKystCiBkcml2ZXJzL21lZGlhL3BjaS9pbnRlbC9pcHU2L2lwdTYtaXN5cy12aWRlby5jICAg
ICB8ICA0MSArKy0tCiBkcml2ZXJzL21lZGlhL3BjaS9pdnR2L2l2dHYtZHJpdmVyLmMgICAgICAg
ICAgICAgICB8ICAgOCArLQogZHJpdmVycy9tZWRpYS9wY2kvaXZ0di9pdnR2LWlvY3RsLmMgICAg
ICAgICAgICAgICAgfCAyMjUgKysrKysrKysrKysrKy0tLS0tLQogZHJpdmVycy9tZWRpYS9wY2kv
aXZ0di9pdnR2LWlvY3RsLmggICAgICAgICAgICAgICAgfCAgIDYgKy0KIGRyaXZlcnMvbWVkaWEv
cGNpL21nYjQvbWdiNF92aW4uYyAgICAgICAgICAgICAgICAgIHwgIDU1ICsrKy0tCiBkcml2ZXJz
L21lZGlhL3BjaS9tZ2I0L21nYjRfdm91dC5jICAgICAgICAgICAgICAgICB8ICA0OSArKystLQog
ZHJpdmVycy9tZWRpYS9wY2kvc2FhNzEzNC9zYWE3MTM0LWVtcHJlc3MuYyAgICAgICAgfCAgMTIg
Ky0KIGRyaXZlcnMvbWVkaWEvcGNpL3NhYTcxMzQvc2FhNzEzNC12aWRlby5jICAgICAgICAgIHwg
IDk2ICsrKysrLS0tLQogZHJpdmVycy9tZWRpYS9wY2kvc2FhNzEzNC9zYWE3MTM0LmggICAgICAg
ICAgICAgICAgfCAgMzggKystLQogZHJpdmVycy9tZWRpYS9wY2kvc2FhNzE0Ni9oZXhpdW1fZ2Vt
aW5pLmMgICAgICAgICAgfCAgMTAgKy0KIGRyaXZlcnMvbWVkaWEvcGNpL3NhYTcxNDYvaGV4aXVt
X29yaW9uLmMgICAgICAgICAgIHwgIDEwICstCiBkcml2ZXJzL21lZGlhL3BjaS9zYWE3MTQ2L214
Yi5jICAgICAgICAgICAgICAgICAgICB8ICA0NiArKy0tCiBkcml2ZXJzL21lZGlhL3BjaS9zYWE3
MTY0L3NhYTcxNjQtZW5jb2Rlci5jICAgICAgICB8ICAzOSArKy0tCiBkcml2ZXJzL21lZGlhL3Bj
aS9zYWE3MTY0L3NhYTcxNjQtdmJpLmMgICAgICAgICAgICB8ICAyNyArKy0KIGRyaXZlcnMvbWVk
aWEvcGNpL3NhYTcxNjQvc2FhNzE2NC5oICAgICAgICAgICAgICAgIHwgICA5ICstCiBkcml2ZXJz
L21lZGlhL3BjaS9zb2xvNngxMC9zb2xvNngxMC12NGwyLWVuYy5jICAgICB8ICA0NiArKy0tCiBk
cml2ZXJzL21lZGlhL3BjaS9zb2xvNngxMC9zb2xvNngxMC12NGwyLmMgICAgICAgICB8ICAzMiAr
Ky0KIGRyaXZlcnMvbWVkaWEvcGNpL3R0cGNpL2J1ZGdldC1hdi5jICAgICAgICAgICAgICAgIHwg
IDEwICstCiBkcml2ZXJzL21lZGlhL3BjaS90dzU4NjQvdHc1ODY0LXZpZGVvLmMgICAgICAgICAg
ICB8ICA0OSArKystLQogZHJpdmVycy9tZWRpYS9wY2kvdHc2OC90dzY4LXZpZGVvLmMgICAgICAg
ICAgICAgICAgfCAgNDMgKystLQogZHJpdmVycy9tZWRpYS9wY2kvdHc2ODZ4L3R3Njg2eC12aWRl
by5jICAgICAgICAgICAgfCAgNTMgKysrLS0KIGRyaXZlcnMvbWVkaWEvcGNpL3pvcmFuL3pvcmFu
X2RyaXZlci5jICAgICAgICAgICAgIHwgIDQ0ICsrLS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
YWxsZWdyby1kdnQvYWxsZWdyby1jb3JlLmMgIHwgIDQ5ICsrKy0tCiAuLi4vbWVkaWEvcGxhdGZv
cm0vYW1sb2dpYy9jMy9pc3AvYzMtaXNwLWNhcHR1cmUuYyB8ICAxOCArLQogLi4uL21lZGlhL3Bs
YXRmb3JtL2FtbG9naWMvYzMvaXNwL2MzLWlzcC1wYXJhbXMuYyAgfCAgIDkgKy0KIC4uLi9tZWRp
YS9wbGF0Zm9ybS9hbWxvZ2ljL2MzL2lzcC9jMy1pc3Atc3RhdHMuYyAgIHwgICA5ICstCiBkcml2
ZXJzL21lZGlhL3BsYXRmb3JtL2FtbG9naWMvbWVzb24tZ2UyZC9nZTJkLmMgICB8ICAzNiArKyst
CiBkcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtcGhpb24vdmRlYy5jICAgICAgICAgICAgICB8ICAz
MCArKy0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1waGlvbi92ZW5jLmMgICAgICAgICAgICAg
IHwgIDQ5ICsrKy0tCiBkcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FzcGVlZC9hc3BlZWQtdmlkZW8u
YyAgICAgICB8ICA1MCArKystLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hdG1lbC9hdG1lbC1p
c2kuYyAgICAgICAgICAgfCAgMzYgKystLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9icm9hZGNv
bS9iY20yODM1LXVuaWNhbS5jICAgfCAgMzMgKystCiAuLi4vbWVkaWEvcGxhdGZvcm0vY2hpcHMt
bWVkaWEvY29kYS9jb2RhLWNvbW1vbi5jICB8ICA2OSArKystLS0KIC4uLi9wbGF0Zm9ybS9jaGlw
cy1tZWRpYS93YXZlNS93YXZlNS1oZWxwZXIuYyAgICAgIHwgICAyICstCiAuLi4vcGxhdGZvcm0v
Y2hpcHMtbWVkaWEvd2F2ZTUvd2F2ZTUtaGVscGVyLmggICAgICB8ICAgMyArLQogLi4uL3BsYXRm
b3JtL2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LXZwdS1kZWMuYyAgICAgfCAgNTQgKysrLS0KIC4u
Li9wbGF0Zm9ybS9jaGlwcy1tZWRpYS93YXZlNS93YXZlNS12cHUtZW5jLmMgICAgIHwgIDYyICsr
KystLQogLi4uL21lZGlhL3BsYXRmb3JtL2ltYWdpbmF0aW9uL2U1MDEwLWpwZWctZW5jLmMgICAg
fCAgMzQgKystCiBkcml2ZXJzL21lZGlhL3BsYXRmb3JtL2ludGVsL3B4YV9jYW1lcmEuYyAgICAg
ICAgICB8ICAzNCArKy0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbTJtLWRlaW50ZXJsYWNlLmMg
ICAgICAgICAgIHwgIDM0ICstLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9tYXJ2ZWxsL21jYW0t
Y29yZS5jICAgICAgICAgfCAgNTIgKysrLS0KIC4uLi9tZWRpYS9wbGF0Zm9ybS9tZWRpYXRlay9q
cGVnL210a19qcGVnX2NvcmUuYyAgIHwgIDQ0ICsrLS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
bWVkaWF0ZWsvbWRwL210a19tZHBfbTJtLmMgIHwgIDM0ICstLQogLi4uL21lZGlhL3BsYXRmb3Jt
L21lZGlhdGVrL21kcDMvbXRrLW1kcDMtbTJtLmMgICAgfCAgMjUgKystCiAuLi4vbWVkaWF0ZWsv
dmNvZGVjL2RlY29kZXIvbXRrX3Zjb2RlY19kZWMuYyAgICAgICB8ICA1MiArKystLQogLi4uL21l
ZGlhdGVrL3Zjb2RlYy9lbmNvZGVyL210a192Y29kZWNfZW5jLmMgICAgICAgfCAgNTAgKysrLS0K
IC4uLi9tZWRpYS9wbGF0Zm9ybS9taWNyb2NoaXAvbWljcm9jaGlwLWlzYy1iYXNlLmMgIHwgIDMz
ICsrLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9udXZvdG9uL25wY20tdmlkZW8uYyAgICAgICAg
fCAgNDMgKystLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9udmlkaWEvdGVncmEtdmRlL3Y0bDIu
YyAgICAgfCAgMzggKystLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvZHcxMDAvZHcxMDAu
YyAgICAgICAgICAgfCAgMzUgKy0tCiBkcml2ZXJzL21lZGlhL3BsYXRmb3JtL254cC9pbXgtanBl
Zy9teGMtanBlZy5jICAgICB8ICA1MiArKystLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAv
aW14LXB4cC5jICAgICAgICAgICAgICAgfCAgMzQgKy0tCiBkcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L254cC9pbXg3LW1lZGlhLWNzaS5jICAgICAgICB8ICAyMSArLQogZHJpdmVycy9tZWRpYS9wbGF0
Zm9ybS9ueHAvaW14OC1pc2kvaW14OC1pc2ktbTJtLmMgfCAgMTUgKy0KIC4uLi9tZWRpYS9wbGF0
Zm9ybS9ueHAvaW14OC1pc2kvaW14OC1pc2ktdmlkZW8uYyAgIHwgIDE4ICstCiBkcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL254cC9teDJfZW1tYXBycC5jICAgICAgICAgICB8ICAzMSArKy0KIGRyaXZl
cnMvbWVkaWEvcGxhdGZvcm0vcWNvbS9jYW1zcy9jYW1zcy12aWRlby5jICAgIHwgIDI3ICsrLQog
ZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9xY29tL2lyaXMvaXJpc192aWRjLmMgICAgICAgfCAgNDgg
KysrLS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcWNvbS92ZW51cy92ZGVjLmMgICAgICAgICAg
IHwgIDI5ICsrLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9xY29tL3ZlbnVzL3ZlbmMuYyAgICAg
ICAgICAgfCAgMzggKystLQogLi4uL21lZGlhL3BsYXRmb3JtL3Jhc3BiZXJyeXBpL3Bpc3BfYmUv
cGlzcF9iZS5jICAgfCAgNDIgKystLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yYXNwYmVycnlw
aS9ycDEtY2ZlL2NmZS5jICAgfCAgNDAgKystLQogLi4uL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMv
cmNhci12aW4vcmNhci12NGwyLmMgICAgfCAgMjEgKy0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
cmVuZXNhcy9yY2FyX2RyaWYuYyAgICAgICAgIHwgIDMwICsrLQogZHJpdmVycy9tZWRpYS9wbGF0
Zm9ybS9yZW5lc2FzL3JjYXJfZmRwMS5jICAgICAgICAgfCAgMTggKy0KIGRyaXZlcnMvbWVkaWEv
cGxhdGZvcm0vcmVuZXNhcy9yY2FyX2pwdS5jICAgICAgICAgIHwgIDIxICstCiBkcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL3JlbmVzYXMvcmVuZXNhcy1jZXUuYyAgICAgICB8ICAzNiArKy0tCiAuLi4v
bWVkaWEvcGxhdGZvcm0vcmVuZXNhcy9yemcybC1jcnUvcnpnMmwtdmlkZW8uYyB8ICAxOCArLQog
ZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3NoX3ZvdS5jICAgICAgICAgICAgfCAgNDEg
KystLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3ZzcDEvdnNwMV9oaXN0by5jICAg
fCAgIDkgKy0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy92c3AxL3ZzcDFfdmlkZW8u
YyAgIHwgIDE4ICstCiBkcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3JnYS9yZ2EuYyAg
ICAgICAgICB8ICAyNCArKy0KIC4uLi9wbGF0Zm9ybS9yb2NrY2hpcC9ya2lzcDEvcmtpc3AxLWNh
cHR1cmUuYyAgICAgIHwgIDE4ICstCiAuLi4vbWVkaWEvcGxhdGZvcm0vcm9ja2NoaXAvcmtpc3Ax
L3JraXNwMS1wYXJhbXMuYyB8ICAxNSArLQogLi4uL21lZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3Jr
aXNwMS9ya2lzcDEtc3RhdHMuYyAgfCAgIDkgKy0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcm9j
a2NoaXAvcmt2ZGVjL3JrdmRlYy5jICAgIHwgIDM0ICstLQogLi4uL21lZGlhL3BsYXRmb3JtL3Nh
bXN1bmcvZXh5bm9zLWdzYy9nc2MtbTJtLmMgICAgfCAgNDQgKystLQogLi4uL3BsYXRmb3JtL3Nh
bXN1bmcvZXh5bm9zNC1pcy9maW1jLWNhcHR1cmUuYyAgICAgfCAgNDUgKystLQogLi4uL3BsYXRm
b3JtL3NhbXN1bmcvZXh5bm9zNC1pcy9maW1jLWlzcC12aWRlby5jICAgfCAgMzIgKy0tCiAuLi4v
bWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9leHlub3M0LWlzL2ZpbWMtbGl0ZS5jICB8ICAzNiArKy0t
CiAuLi4vbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9leHlub3M0LWlzL2ZpbWMtbTJtLmMgICB8ICAy
MSArLQogLi4uL3BsYXRmb3JtL3NhbXN1bmcvczNjLWNhbWlmL2NhbWlmLWNhcHR1cmUuYyAgICAg
fCAgNTQgKysrLS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9zNXAtZzJkL2cyZC5j
ICAgICAgIHwgIDI2ICsrLQogLi4uL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcvczVwLWpwZWcvanBl
Zy1jb3JlLmMgICAgfCAgMzQgKy0tCiAuLi4vbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9zNXAtbWZj
L3M1cF9tZmNfZGVjLmMgICB8ICA0OCArKystLQogLi4uL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcv
czVwLW1mYy9zNXBfbWZjX2VuYy5jICAgfCAgNTEgKysrLS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZv
cm0vc3Qvc3RpL2JkaXNwL2JkaXNwLXY0bDIuYyAgIHwgIDI2ICsrLQogZHJpdmVycy9tZWRpYS9w
bGF0Zm9ybS9zdC9zdGkvZGVsdGEvZGVsdGEtdjRsMi5jICAgfCAgNDQgKystLQogZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS9zdC9zdGkvaHZhL2h2YS12NGwyLmMgICAgICAgfCAgNDYgKystLQogZHJp
dmVycy9tZWRpYS9wbGF0Zm9ybS9zdC9zdG0zMi9kbWEyZC9kbWEyZC5jICAgICAgfCAgMTggKy0K
IGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RtMzIvc3RtMzItZGNtaS5jICAgICAgIHwgIDQy
ICsrLS0KIC4uLi9zdC9zdG0zMi9zdG0zMi1kY21pcHAvZGNtaXBwLWJ5dGVjYXAuYyAgICAgICAg
IHwgIDIwICstCiAuLi4vbWVkaWEvcGxhdGZvcm0vc3VueGkvc3VuNGktY3NpL3N1bjRpX3Y0bDIu
YyAgICB8ICAyNSArKy0KIC4uLi9wbGF0Zm9ybS9zdW54aS9zdW42aS1jc2kvc3VuNmlfY3NpX2Nh
cHR1cmUuYyAgIHwgIDI0ICsrLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdW54aS9zdW44aS1k
aS9zdW44aS1kaS5jICAgfCAgMzEgKystCiAuLi4vcGxhdGZvcm0vc3VueGkvc3VuOGktcm90YXRl
L3N1bjhpX3JvdGF0ZS5jICAgICB8ICAzNCArLS0KIC4uLi9tZWRpYS9wbGF0Zm9ybS9zeW5vcHN5
cy9oZG1pcngvc25wc19oZG1pcnguYyAgIHwgIDQ3ICsrLS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZv
cm0vdGkvYW00Mzd4L2FtNDM3eC12cGZlLmMgICAgIHwgIDUyICsrKy0tCiBkcml2ZXJzL21lZGlh
L3BsYXRmb3JtL3RpL2NhbC9jYWwtdmlkZW8uYyAgICAgICAgICB8ICA1NCArKystLQogZHJpdmVy
cy9tZWRpYS9wbGF0Zm9ybS90aS9kYXZpbmNpL3ZwaWZfY2FwdHVyZS5jICAgfCAgOTQgKysrKy0t
LS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vdGkvZGF2aW5jaS92cGlmX2Rpc3BsYXkuYyAgIHwg
IDU4ICsrKy0tCiAuLi4vbWVkaWEvcGxhdGZvcm0vdGkvajcyMWUtY3NpMnJ4L2o3MjFlLWNzaTJy
eC5jICB8ICAyMCArLQogZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9vbWFwL29tYXBfdm91dC5j
ICAgICAgICAgfCAgNDkgKysrLS0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vdGkvb21hcDNpc3Av
aXNwdmlkZW8uYyAgICAgIHwgIDUzICsrKy0tCiBkcml2ZXJzL21lZGlhL3BsYXRmb3JtL3RpL3Zw
ZS92cGUuYyAgICAgICAgICAgICAgICB8ICAyNSArKy0KIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
dmVyaXNpbGljb24vaGFudHJvX3Y0bDIuYyAgIHwgIDQ3ICsrLS0KIGRyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vdmlhL3ZpYS1jYW1lcmEuYyAgICAgICAgICAgIHwgIDQyICsrLS0KIGRyaXZlcnMvbWVk
aWEvcGxhdGZvcm0veGlsaW54L3hpbGlueC1kbWEuYyAgICAgICAgIHwgIDE1ICstCiBkcml2ZXJz
L21lZGlhL3JhZGlvL2RzYnIxMDAuYyAgICAgICAgICAgICAgICAgICAgICB8ICAxNSArLQogZHJp
dmVycy9tZWRpYS9yYWRpby9yYWRpby1jYWRldC5jICAgICAgICAgICAgICAgICAgfCAgMTggKy0K
IGRyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8taXNhLmMgICAgICAgICAgICAgICAgICAgIHwgIDE4
ICstCiBkcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLWtlZW5lLmMgICAgICAgICAgICAgICAgICB8
ICAxNSArLQogZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1tYTkwMS5jICAgICAgICAgICAgICAg
ICAgfCAgMTUgKy0KIGRyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tbWlyb3BjbTIwLmMgICAgICAg
ICAgICAgIHwgIDE1ICstCiBkcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLW1yODAwLmMgICAgICAg
ICAgICAgICAgICB8ICAxOCArLQogZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1yYXJlbW9uby5j
ICAgICAgICAgICAgICAgfCAgMTkgKy0KIGRyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tc2YxNmZt
aS5jICAgICAgICAgICAgICAgIHwgIDE1ICstCiBkcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLXNp
NDc2eC5jICAgICAgICAgICAgICAgICB8ICAyOCArKy0KIGRyaXZlcnMvbWVkaWEvcmFkaW8vcmFk
aW8tdGVhNTc2NC5jICAgICAgICAgICAgICAgIHwgIDE1ICstCiBkcml2ZXJzL21lZGlhL3JhZGlv
L3JhZGlvLXRlYTU3NzcuYyAgICAgICAgICAgICAgICB8ICAyMSArLQogZHJpdmVycy9tZWRpYS9y
YWRpby9yYWRpby10aW1iLmMgICAgICAgICAgICAgICAgICAgfCAgMjYgKystCiBkcml2ZXJzL21l
ZGlhL3JhZGlvL3NpNDcweC9yYWRpby1zaTQ3MHgtY29tbW9uLmMgICB8ICAyNSArKy0KIGRyaXZl
cnMvbWVkaWEvcmFkaW8vc2k0NzEzL3JhZGlvLXBsYXRmb3JtLXNpNDcxMy5jIHwgIDE4ICstCiBk
cml2ZXJzL21lZGlhL3JhZGlvL3NpNDcxMy9yYWRpby11c2Itc2k0NzEzLmMgICAgICB8ICAxNSAr
LQogZHJpdmVycy9tZWRpYS9yYWRpby90ZWE1NzV4LmMgICAgICAgICAgICAgICAgICAgICAgfCAg
MjEgKy0KIGRyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpY29kZWMvdmljb2RlYy1jb3JlLmMg
IHwgIDU0ICsrKy0tCiBkcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aW0ybS5jICAgICAgICAg
ICAgICAgICB8ICA1NiArKystLQogZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdmltYy92aW1j
LWNhcHR1cmUuYyAgICAgfCAgMjAgKy0KIGRyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3Zpc2wv
dmlzbC12aWRlby5jICAgICAgIHwgIDM0ICstLQogZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMv
dml2aWQvdml2aWQtY29yZS5jICAgICAgfCAyMDMgKysrKysrKysrKy0tLS0tLS0tCiBkcml2ZXJz
L21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1tZXRhLWNhcC5jICB8ICAgNiArLQogZHJp
dmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtbWV0YS1jYXAuaCAgfCAgIDYgKy0K
IGRyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLW1ldGEtb3V0LmMgIHwgICA2
ICstCiBkcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1tZXRhLW91dC5oICB8
ICAgOSArLQogZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtcmFkaW8tcngu
YyAgfCAgMTYgKy0KIGRyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXJhZGlv
LXJ4LmggIHwgIDE2ICstCiBkcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1y
YWRpby10eC5jICB8ICAgNiArLQogZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2
aWQtcmFkaW8tdHguaCAgfCAgIDYgKy0KIGRyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3Zpdmlk
L3ZpdmlkLXNkci1jYXAuYyAgIHwgIDMwICsrLQogZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMv
dml2aWQvdml2aWQtc2RyLWNhcC5oICAgfCAgMzAgKystCiBkcml2ZXJzL21lZGlhL3Rlc3QtZHJp
dmVycy92aXZpZC92aXZpZC10b3VjaC1jYXAuYyB8ICAyMiArLQogZHJpdmVycy9tZWRpYS90ZXN0
LWRyaXZlcnMvdml2aWQvdml2aWQtdG91Y2gtY2FwLmggfCAgMjIgKy0KIGRyaXZlcnMvbWVkaWEv
dGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZiaS1jYXAuYyAgIHwgIDI2ICsrLQogZHJpdmVycy9t
ZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmJpLWNhcC5oICAgfCAgMjIgKy0KIGRyaXZl
cnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZiaS1vdXQuYyAgIHwgIDIyICstCiBk
cml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12Ymktb3V0LmggICB8ICAxOCAr
LQogZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlkLWNhcC5jICAgfCAx
MTQgKysrKysrLS0tLQogZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlk
LWNhcC5oICAgfCAxMTcgKysrKysrKy0tLQogLi4uL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92
aXZpZC12aWQtY29tbW9uLmMgICAgfCAgMjQgKystCiAuLi4vbWVkaWEvdGVzdC1kcml2ZXJzL3Zp
dmlkL3ZpdmlkLXZpZC1jb21tb24uaCAgICB8ICAzNCArLS0KIGRyaXZlcnMvbWVkaWEvdGVzdC1k
cml2ZXJzL3ZpdmlkL3ZpdmlkLXZpZC1vdXQuYyAgIHwgMTIyICsrKysrKy0tLS0tCiBkcml2ZXJz
L21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12aWQtb3V0LmggICB8ICA5NSArKysrKy0t
LQogZHJpdmVycy9tZWRpYS91c2IvYWlyc3B5L2FpcnNweS5jICAgICAgICAgICAgICAgICAgfCAg
MzcgKystLQogZHJpdmVycy9tZWRpYS91c2IvYXUwODI4L2F1MDgyOC12aWRlby5jICAgICAgICAg
ICAgfCAgNzQgKysrKy0tLQogZHJpdmVycy9tZWRpYS91c2IvY3gyMzF4eC9jeDIzMXh4LTQxNy5j
ICAgICAgICAgICAgfCAgMjggKystCiBkcml2ZXJzL21lZGlhL3VzYi9jeDIzMXh4L2N4MjMxeHgt
dmlkZW8uYyAgICAgICAgICB8ICA3OSArKysrLS0tCiBkcml2ZXJzL21lZGlhL3VzYi9jeDIzMXh4
L2N4MjMxeHguaCAgICAgICAgICAgICAgICB8ICAzOSArKy0tCiBkcml2ZXJzL21lZGlhL3VzYi9k
dmItdXNiL2N4dXNiLWFuYWxvZy5jICAgICAgICAgICB8ICA0OCArKystLQogZHJpdmVycy9tZWRp
YS91c2IvZW0yOHh4L2VtMjh4eC12aWRlby5jICAgICAgICAgICAgfCAgODcgKysrKystLS0KIGRy
aXZlcnMvbWVkaWEvdXNiL2dvNzAwNy9nbzcwMDctdjRsMi5jICAgICAgICAgICAgIHwgIDc1ICsr
KystLS0KIGRyaXZlcnMvbWVkaWEvdXNiL2dzcGNhL2dzcGNhLmMgICAgICAgICAgICAgICAgICAg
IHwgIDUxICsrKy0tCiBkcml2ZXJzL21lZGlhL3VzYi9oYWNrcmYvaGFja3JmLmMgICAgICAgICAg
ICAgICAgICB8ICAzOSArKy0tCiBkcml2ZXJzL21lZGlhL3VzYi9oZHB2ci9oZHB2ci12aWRlby5j
ICAgICAgICAgICAgICB8ICA2MCArKysrLS0KIGRyaXZlcnMvbWVkaWEvdXNiL21zaTI1MDAvbXNp
MjUwMC5jICAgICAgICAgICAgICAgIHwgIDMxICsrLQogZHJpdmVycy9tZWRpYS91c2IvcHZydXNi
Mi9wdnJ1c2IyLXY0bDIuYyAgICAgICAgICAgfCAgOTggKysrKysrLS0tCiBkcml2ZXJzL21lZGlh
L3VzYi9wd2MvcHdjLXY0bC5jICAgICAgICAgICAgICAgICAgICB8ICA0NCArKy0tCiBkcml2ZXJz
L21lZGlhL3VzYi9zMjI1NS9zMjI1NWRydi5jICAgICAgICAgICAgICAgICB8ICA1NSArKystLQog
ZHJpdmVycy9tZWRpYS91c2Ivc3RrMTE2MC9zdGsxMTYwLXY0bC5jICAgICAgICAgICAgfCAgNDAg
KystLQogZHJpdmVycy9tZWRpYS91c2IvdXNidHYvdXNidHYtdmlkZW8uYyAgICAgICAgICAgICAg
fCAgMjQgKystCiBkcml2ZXJzL21lZGlhL3VzYi91dmMvdXZjX21ldGFkYXRhLmMgICAgICAgICAg
ICAgICB8ICAxNyArLQogZHJpdmVycy9tZWRpYS91c2IvdXZjL3V2Y192NGwyLmMgICAgICAgICAg
ICAgICAgICAgfCAgNTkgKysrLS0KIGRyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0bDItY3RybHMt
YXBpLmMgICAgICAgICAgIHwgICAyICstCiBkcml2ZXJzL21lZGlhL3Y0bDItY29yZS92NGwyLWRl
di5jICAgICAgICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9tZWRpYS92NGwyLWNvcmUvdjRs
Mi1tZW0ybWVtLmMgICAgICAgICAgICAgfCAgNTYgKysrLS0KIGRyaXZlcnMvc3RhZ2luZy9tZWRp
YS9hdG9taXNwL3BjaS9hdG9taXNwX2lvY3RsLmMgIHwgIDcyICsrKystLS0KIGRyaXZlcnMvc3Rh
Z2luZy9tZWRpYS9hdjcxMTAvYXY3MTEwX3Y0bC5jICAgICAgICAgIHwgIDYwICsrKystLQogLi4u
L21lZGlhL2RlcHJlY2F0ZWQvYXRtZWwvYXRtZWwtaXNjLWJhc2UuYyAgICAgICAgfCAgMzMgKyst
CiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvaW14L2lteC1tZWRpYS1jYXB0dXJlLmMgICAgICB8ICA1
MyArKystLQogZHJpdmVycy9zdGFnaW5nL21lZGlhL2lteC9pbXgtbWVkaWEtY3NjLXNjYWxlci5j
ICAgfCAgMjMgKy0KIGRyaXZlcnMvc3RhZ2luZy9tZWRpYS9pcHUzL2lwdTMtdjRsMi5jICAgICAg
ICAgICAgIHwgIDI5ICsrLQogZHJpdmVycy9zdGFnaW5nL21lZGlhL2lwdTcvaXB1Ny1pc3lzLXZp
ZGVvLmMgICAgICAgfCAgMzAgKystCiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvbWVzb24vdmRlYy92
ZGVjLmMgICAgICAgICAgICB8ICAyNiArKy0KIGRyaXZlcnMvc3RhZ2luZy9tZWRpYS9zdGFyZml2
ZS9jYW1zcy9zdGYtdmlkZW8uYyAgIHwgIDE4ICstCiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvc3Vu
eGkvY2VkcnVzL2NlZHJ1c192aWRlby5jICB8ICAyOSArKy0KIC4uLi9tZWRpYS9zdW54aS9zdW42
aS1pc3Avc3VuNmlfaXNwX2NhcHR1cmUuYyAgICAgIHwgIDI0ICsrLQogLi4uL21lZGlhL3N1bnhp
L3N1bjZpLWlzcC9zdW42aV9pc3BfcGFyYW1zLmMgICAgICAgfCAgIDkgKy0KIGRyaXZlcnMvc3Rh
Z2luZy9tZWRpYS90ZWdyYS12aWRlby92aS5jICAgICAgICAgICAgIHwgIDY4ICsrKystLQogZHJp
dmVycy9zdGFnaW5nL21vc3QvdmlkZW8vdmlkZW8uYyAgICAgICAgICAgICAgICAgfCAgMzkgKyst
LQogLi4uL3ZjMDRfc2VydmljZXMvYmNtMjgzNS1jYW1lcmEvYmNtMjgzNS1jYW1lcmEuYyAgfCAg
NTggKysrLS0KIGRyaXZlcnMvdXNiL2dhZGdldC9mdW5jdGlvbi91dmNfdjRsMi5jICAgICAgICAg
ICAgIHwgIDUwICsrKy0tCiBpbmNsdWRlL21lZGlhL3Y0bDItY3RybHMuaCAgICAgICAgICAgICAg
ICAgICAgICAgICB8ICAgNSArLQogaW5jbHVkZS9tZWRpYS92NGwyLWRldi5oICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgIDIgKy0KIGluY2x1ZGUvbWVkaWEvdjRsMi1pb2N0bC5oICAgICAg
ICAgICAgICAgICAgICAgICAgIHwgMjM4ICsrKysrKysrKysrLS0tLS0tLS0tLQogaW5jbHVkZS9t
ZWRpYS92NGwyLW1lbTJtZW0uaCAgICAgICAgICAgICAgICAgICAgICAgfCAgNDggKysrLS0KIGlu
Y2x1ZGUvbWVkaWEvdmlkZW9idWYyLXY0bDIuaCAgICAgICAgICAgICAgICAgICAgIHwgIDMzICst
LQogMjIzIGZpbGVzIGNoYW5nZWQsIDUzOTIgaW5zZXJ0aW9ucygrKSwgMjk1NSBkZWxldGlvbnMo
LSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lucHV0L3JtaTQvcm1pX2Y1NC5jIGIvZHJpdmVycy9p
bnB1dC9ybWk0L3JtaV9mNTQuYwppbmRleCBhYzQwNDFhNjlmY2QzYWNmNzY2YWM4MTg5ZWEwZWNj
Y2I5YjdhYzkzLi5iNjZiODBkNzY4MzNiZmU1NmYwNGY3MGNlOTA4MzA3NjkyNjMyZjQ4IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2lucHV0L3JtaTQvcm1pX2Y1NC5jCisrKyBiL2RyaXZlcnMvaW5wdXQv
cm1pNC9ybWlfZjU0LmMKQEAgLTM4Myw3ICszODMsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZi
Ml9xdWV1ZSBybWlfZjU0X3F1ZXVlID0gewogCS50aW1lc3RhbXBfZmxhZ3MgPSBWNEwyX0JVRl9G
TEFHX1RJTUVTVEFNUF9NT05PVE9OSUMsCiB9OwogCi1zdGF0aWMgaW50IHJtaV9mNTRfdmlkaW9j
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBybWlf
ZjU0X3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3RydWN0IGY1NF9kYXRhICpmNTQgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
Mzk2LDcgKzM5Nyw4IEBAIHN0YXRpYyBpbnQgcm1pX2Y1NF92aWRpb2NfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcm1p
X2Y1NF92aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgcm1pX2Y1NF92aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3RydWN0
IHY0bDJfaW5wdXQgKmkpCiB7CiAJc3RydWN0IGY1NF9kYXRhICpmNTQgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtNDQyLDEyICs0NDQsMTUgQEAgc3RhdGljIGludCBybWlfZjU0X3NldF9pbnB1
dChzdHJ1Y3QgZjU0X2RhdGEgKmY1NCwgdW5zaWduZWQgaW50IGkpCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgcm1pX2Y1NF92aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IHJtaV9mNTRfdmlkaW9jX3NfaW5w
dXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCQkgIHVuc2lnbmVkIGludCBpKQogewogCXJldHVybiBybWlfZjU0X3NldF9pbnB1
dCh2aWRlb19kcnZkYXRhKGZpbGUpLCBpKTsKIH0KIAotc3RhdGljIGludCBybWlfZjU0X3ZpZGlv
Y19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBybWlf
ZjU0X3ZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0
IGY1NF9kYXRhICpmNTQgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNDU3LDcgKzQ2Miw4IEBA
IHN0YXRpYyBpbnQgcm1pX2Y1NF92aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBybWlfZjU0X3ZpZGlvY19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJtaV9mNTRfdmlkaW9j
X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBm
NTRfZGF0YSAqZjU0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQ2Nyw3ICs0NzMsOCBAQCBz
dGF0aWMgaW50IHJtaV9mNTRfdmlkaW9jX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBybWlfZjU0X3ZpZGlvY19lbnVtX2ZtdChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcm1pX2Y1NF92aWRpb2Nf
ZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZm10KQogewogCXN0cnVj
dCBmNTRfZGF0YSAqZjU0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQ4Myw3ICs0OTAsOCBA
QCBzdGF0aWMgaW50IHJtaV9mNTRfdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJtaV9mNTRfdmlkaW9jX2df
cGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHJtaV9mNTRfdmlk
aW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJaWYgKGEt
PnR5cGUgIT0gVjRMMl9CVUZfVFlQRV9WSURFT19DQVBUVVJFKQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9pbnB1dC90b3VjaHNjcmVlbi9hdG1lbF9teHRfdHMuYyBiL2RyaXZlcnMvaW5wdXQvdG91Y2hz
Y3JlZW4vYXRtZWxfbXh0X3RzLmMKaW5kZXggMzIyZDVhM2Q0MGEwOTMzZjFlMWMyOTBlOTA2MjU4
YTg3NGJjZjRiMi4uMjU1ZTJlNzcxM2UzMzcxYjU2NzM2ZGVkMjJiNjZkN2RmOWNmOGY0OSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9pbnB1dC90b3VjaHNjcmVlbi9hdG1lbF9teHRfdHMuYworKysgYi9k
cml2ZXJzL2lucHV0L3RvdWNoc2NyZWVuL2F0bWVsX214dF90cy5jCkBAIC0yNTQ3LDcgKzI1NDcs
OCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZiMl9xdWV1ZSBteHRfcXVldWUgPSB7CiAJLm1pbl9x
dWV1ZWRfYnVmZmVycyA9IDEsCiB9OwogCi1zdGF0aWMgaW50IG14dF92aWRpb2NfcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG14dF92aWRpb2NfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1
Y3QgbXh0X2RhdGEgKmRhdGEgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjU1OSw3ICsyNTYw
LDggQEAgc3RhdGljIGludCBteHRfdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG14dF92aWRpb2NfZW51bV9p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXh0X3ZpZGlv
Y19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkKIHsKIAlpZiAoaS0+
aW5kZXggPj0gTVhUX1Y0TF9JTlBVVF9NQVgpCkBAIC0yNjA0LDEyICsyNjA2LDE2IEBAIHN0YXRp
YyBpbnQgbXh0X3NldF9pbnB1dChzdHJ1Y3QgbXh0X2RhdGEgKmRhdGEsIHVuc2lnbmVkIGludCBp
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG14dF92aWRpb2Nfc19pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IG14dF92
aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgdW5zaWduZWQgaW50IGkpCiB7CiAJcmV0dXJu
IG14dF9zZXRfaW5wdXQodmlkZW9fZHJ2ZGF0YShmaWxlKSwgaSk7CiB9CiAKLXN0YXRpYyBpbnQg
bXh0X3ZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25l
ZCBpbnQgKmkpCitzdGF0aWMgaW50IG14dF92aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAg
dW5zaWduZWQgaW50ICppKQogewogCXN0cnVjdCBteHRfZGF0YSAqZGF0YSA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTI2MTgsNyArMjYyNCw4IEBAIHN0YXRpYyBpbnQgbXh0X3ZpZGlvY19n
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXh0X3ZpZGlvY19mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgbXh0X3Zp
ZGlvY19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG14dF9kYXRhICpk
YXRhID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMjYyOCw3ICsyNjM1LDggQEAgc3RhdGlj
IGludCBteHRfdmlkaW9jX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG14dF92aWRpb2Nf
ZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG14dF92
aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmZtdCkKIHsK
IAlpZiAoZm10LT50eXBlICE9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRSkKQEAgLTI2NTAs
NyArMjY1OCw4IEBAIHN0YXRpYyBpbnQgbXh0X3ZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBteHRfdmlkaW9j
X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG14dF92aWRp
b2NfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlp
ZiAoYS0+dHlwZSAhPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkUpCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2lucHV0L3RvdWNoc2NyZWVuL3N1cjQwLmMgYi9kcml2ZXJzL2lucHV0L3RvdWNoc2Ny
ZWVuL3N1cjQwLmMKaW5kZXggN2IzYjEwY2JmY2ZjNDRlYWJkNTZhNGEzOTU1MWM0NGVlZDczMGRl
OC4uNmJjNTFhZDJjZDBhNDcwMjlhYWRlNTI0NTYwMDNmM2JlOTBlYzkzMiAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9pbnB1dC90b3VjaHNjcmVlbi9zdXI0MC5jCisrKyBiL2RyaXZlcnMvaW5wdXQvdG91
Y2hzY3JlZW4vc3VyNDAuYwpAQCAtOTM1LDcgKzkzNSw4IEBAIHN0YXRpYyB2b2lkIHN1cjQwX3N0
b3Bfc3RyZWFtaW5nKHN0cnVjdCB2YjJfcXVldWUgKnZxKQogfQogCiAvKiBWNEwgaW9jdGwgKi8K
LXN0YXRpYyBpbnQgc3VyNDBfdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCBzdXI0MF92aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHN1cjQwX3N0YXRlICpzdXI0MCA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05NDYsNyArOTQ3LDggQEAgc3RhdGljIGludCBzdXI0MF92
aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgc3VyNDBfdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHN1cjQwX3ZpZGlvY19lbnVtX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCSAgIHN0cnVjdCB2NGwyX2lucHV0ICppKQogewogCWlmIChpLT5pbmRleCAhPSAwKQpAQCAt
OTU4LDE4ICs5NjAsMjMgQEAgc3RhdGljIGludCBzdXI0MF92aWRpb2NfZW51bV9pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBz
dXI0MF92aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWdu
ZWQgaW50IGkpCitzdGF0aWMgaW50IHN1cjQwX3ZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXVuc2lnbmVk
IGludCBpKQogewogCXJldHVybiAoaSA9PSAwKSA/IDAgOiAtRUlOVkFMOwogfQogCi1zdGF0aWMg
aW50IHN1cjQwX3ZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1
bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHN1cjQwX3ZpZGlvY19nX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXVu
c2lnbmVkIGludCAqaSkKIHsKIAkqaSA9IDA7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
c3VyNDBfdmlkaW9jX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHN1cjQwX3ZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzd2l0Y2ggKGYtPmZtdC5waXgucGl4ZWxmb3JtYXQpIHsKQEAgLTk4NSw3ICs5OTIs
OCBAQCBzdGF0aWMgaW50IHN1cjQwX3ZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN1cjQwX3ZpZGlvY19zX2Zt
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VyNDBfdmlkaW9j
X3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBz
dXI0MF9zdGF0ZSAqc3VyNDAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTAwNCw3ICsxMDEy
LDggQEAgc3RhdGljIGludCBzdXI0MF92aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc3VyNDBfdmlkaW9jX2dfZm10
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzdXI0MF92aWRpb2Nf
Z19mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHN1
cjQwX3N0YXRlICpzdXI0MCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDM4LDcgKzEwNDcs
OCBAQCBzdGF0aWMgaW50IHN1cjQwX3NfY3RybChzdHJ1Y3QgdjRsMl9jdHJsICpjdHJsKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN1cjQwX2lvY3RsX3Bhcm0oc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHN1cjQwX2lvY3RsX3Bhcm0oc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAg
c3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcCkKIHsKIAlpZiAocC0+dHlwZSAhPSBWNEwyX0JVRl9U
WVBFX1ZJREVPX0NBUFRVUkUpCkBAIC0xMDUxLDcgKzEwNjEsOCBAQCBzdGF0aWMgaW50IHN1cjQw
X2lvY3RsX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgc3VyNDBfdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAorc3RhdGljIGludCBzdXI0MF92aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1
Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT5pbmRleCA+PSBBUlJBWV9TSVpFKHN1cjQw
X3BpeF9mb3JtYXQpKQpAQCAtMTA2Miw3ICsxMDczLDggQEAgc3RhdGljIGludCBzdXI0MF92aWRp
b2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgc3VyNDBfdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VyNDBfdmlkaW9jX2VudW1fZnJhbWVzaXpl
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJCXN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmKQogewogCXN0cnVjdCBzdXI0MF9z
dGF0ZSAqc3VyNDAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTA3Nyw3ICsxMDg5LDggQEAg
c3RhdGljIGludCBzdXI0MF92aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN1cjQwX3ZpZGlvY19l
bnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBzdXI0MF92aWRpb2NfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgICAgc3Ry
dWN0IHY0bDJfZnJtaXZhbGVudW0gKmYpCiB7CiAJc3RydWN0IHN1cjQwX3N0YXRlICpzdXI0MCA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2NlYy91c2Iv
ZXh0cm9uLWRhLWhkLTRrLXBsdXMvZXh0cm9uLWRhLWhkLTRrLXBsdXMuYyBiL2RyaXZlcnMvbWVk
aWEvY2VjL3VzYi9leHRyb24tZGEtaGQtNGstcGx1cy9leHRyb24tZGEtaGQtNGstcGx1cy5jCmlu
ZGV4IGUyZWZmMTc5NTJhYjIzN2I3OTlmOTg5MjE1OTI1NDE0NjMxOWY0YzcuLmViZWZkNWU1Yzc0
N2FhOTY0NmQ3YTQ1NDE0YTY2MWQwNzZjZjFlNGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEv
Y2VjL3VzYi9leHRyb24tZGEtaGQtNGstcGx1cy9leHRyb24tZGEtaGQtNGstcGx1cy5jCisrKyBi
L2RyaXZlcnMvbWVkaWEvY2VjL3VzYi9leHRyb24tZGEtaGQtNGstcGx1cy9leHRyb24tZGEtaGQt
NGstcGx1cy5jCkBAIC0xMTk1LDcgKzExOTUsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGNlY19h
ZGFwX29wcyBleHRyb25fY2VjX2FkYXBfb3BzID0gewogCS5yZWNlaXZlZCA9IGV4dHJvbl9yZWNl
aXZlZCwKIH07CiAKLXN0YXRpYyBpbnQgZXh0cm9uX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBleHRyb25fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVj
dCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgZXh0cm9uX3BvcnQgKnBvcnQgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTIwNiw3ICsxMjA3LDkgQEAgc3RhdGljIGludCBleHRy
b25fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgZXh0cm9uX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHN0cnVjdCB2NGwyX2lucHV0ICppbnApCitzdGF0aWMgaW50IGV4dHJvbl9lbnVtX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmlucCkKIHsKIAlzdHJ1Y3QgZXh0
cm9uX3BvcnQgKnBvcnQgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMjE5LDE4ICsxMjIy
LDIyIEBAIHN0YXRpYyBpbnQgZXh0cm9uX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX2lucHV0ICppCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgZXh0cm9uX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGludCAqaSkKK3N0YXRpYyBpbnQgZXh0cm9uX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7
CiAJKmkgPSAwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGV4dHJvbl9zX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKK3N0YXRpYyBpbnQg
ZXh0cm9uX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlyZXR1cm4gaSA/IC1FSU5WQUwg
OiAwOwogfQogCi1zdGF0aWMgaW50IGV4dHJvbl9lbnVtX291dHB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfb3V0cHV0ICpvdXQpCitzdGF0aWMgaW50IGV4dHJv
bl9lbnVtX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgc3RydWN0IHY0bDJfb3V0cHV0ICpvdXQpCiB7
CiAJc3RydWN0IGV4dHJvbl9wb3J0ICpwb3J0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAt
MTI0MSwxOCArMTI0OCwyMSBAQCBzdGF0aWMgaW50IGV4dHJvbl9lbnVtX291dHB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfb3V0cHV0CiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgZXh0cm9uX2dfb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCB1bnNpZ25lZCBpbnQgKm8pCitzdGF0aWMgaW50IGV4dHJvbl9nX291dHB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCB1bnNp
Z25lZCBpbnQgKm8pCiB7CiAJKm8gPSAwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGV4
dHJvbl9zX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50
IG8pCitzdGF0aWMgaW50IGV4dHJvbl9zX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCB1bnNpZ25lZCBpbnQgbykKIHsKIAly
ZXR1cm4gbyA/IC1FSU5WQUwgOiAwOwogfQogCi1zdGF0aWMgaW50IGV4dHJvbl9nX2VkaWQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGV4dHJvbl9nX2VkaWQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgc3RydWN0IHY0bDJfZWRpZCAqZWRpZCkKIHsKIAlzdHJ1Y3QgZXh0cm9uX3BvcnQgKnBvcnQg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTI4MCw3ICsxMjkwLDggQEAgc3RhdGljIGludCBl
eHRyb25fZ19lZGlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IGV4dHJvbl9zX2VkaWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHN0cnVjdCB2NGwyX2VkaWQgKmVkaWQpCitzdGF0aWMgaW50IGV4dHJvbl9zX2VkaWQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHN0
cnVjdCB2NGwyX2VkaWQgKmVkaWQpCiB7CiAJc3RydWN0IGV4dHJvbl9wb3J0ICpwb3J0ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTMwNSwxMiArMTMxNiwxMyBAQCBzdGF0aWMgaW50IGV4
dHJvbl9zX2VkaWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Vk
aWQgKmVkaWQpCiAJcmV0dXJuIGV4dHJvbl93cml0ZV9lZGlkKHBvcnQsIGVkaWQtPmVkaWQsIGVk
aWQtPmJsb2Nrcyk7CiB9CiAKLXN0YXRpYyBpbnQgZXh0cm9uX2xvZ19zdGF0dXMoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYpCitzdGF0aWMgaW50IGV4dHJvbl9sb2dfc3RhdHVzKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkK
IHsKIAlzdHJ1Y3QgZXh0cm9uX3BvcnQgKnBvcnQgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCiAJ
ZXh0cm9uX2FkYXBfc3RhdHVzKHBvcnQtPmFkYXAsIE5VTEwpOwotCXJldHVybiB2NGwyX2N0cmxf
bG9nX3N0YXR1cyhmaWxlLCBwcml2KTsKKwlyZXR1cm4gdjRsMl9jdHJsX2xvZ19zdGF0dXMoZmls
ZSwgc3RhdGUpOwogfQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfaW9jdGxfb3BzIGV4dHJv
bl9pb2N0bF9vcHMgPSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2NvbW1vbi9zYWE3MTQ2
L3NhYTcxNDZfdmlkZW8uYyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3NhYTcxNDYvc2FhNzE0Nl92
aWRlby5jCmluZGV4IDczM2UxODAwMWQwZDQxOGQzMmM1MTdiODBkZWU1NzEzMGIzNzliMDcuLjc2
OGJlMGM2YmZkZWVlNzA5MzlmYmU4NzJhODVlOTlmYWZlNGNkMjUgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvbWVkaWEvY29tbW9uL3NhYTcxNDYvc2FhNzE0Nl92aWRlby5jCisrKyBiL2RyaXZlcnMvbWVk
aWEvY29tbW9uL3NhYTcxNDYvc2FhNzE0Nl92aWRlby5jCkBAIC0yNTEsNyArMjUxLDkgQEAgc3Rh
dGljIHZvaWQgdmlkZW9fZW5kKHN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2KQogCXNhYTcxNDZfcmVz
X2ZyZWUoZGV2LCByZXNvdXJjZSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQor
c3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCB2NGwyX2NhcGFiaWxp
dHkgKmNhcCkKIHsKIAlzdHJ1Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKQEAgLTI2NCw3ICsyNjYsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKgogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgdmlk
aW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikK
IHsKIAlpZiAoZi0+aW5kZXggPj0gQVJSQVlfU0laRShmb3JtYXRzKSkKIAkJcmV0dXJuIC1FSU5W
QUw7CkBAIC0zMjMsNyArMzI3LDggQEAgaW50IHNhYTcxNDZfc19jdHJsKHN0cnVjdCB2NGwyX2N0
cmwgKmN0cmwpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfcGFybShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHZpZGlvY19nX3Bhcm0oc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCXN0
cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzM3LDcgKzM0Miw5IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgc2FhNzE0Nl9kZXYg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHNhYTcxNDZfdnYgKnZ2ID0gZGV2
LT52dl9kYXRhOwpAQCAtMzQ2LDcgKzM1Myw5IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlk
aW9jX2dfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3Qgc2FhNzE0
Nl92diAqdnYgPSBkZXYtPnZ2X2RhdGE7CkBAIC0zNTUsNyArMzY0LDkgQEAgc3RhdGljIGludCB2
aWRpb2NfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2Zvcm1hdAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAJc3RydWN0IHNhYTcxNDZfdnYgKnZ2ID0gZGV2LT52dl9kYXRhOwpAQCAtMzY0LDcg
KzM3NSw3IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hCiAJaW50IG1heHcsIG1heGg7CiAJaW50
IGNhbGNfYnBsOwogCi0JREVCX0VFKCJWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkU6IGRldjol
cCwgZmg6JXBcbiIsIGRldiwgZmgpOworCURFQl9FRSgiVjRMMl9CVUZfVFlQRV9WSURFT19DQVBU
VVJFOiBkZXY6JXAsIGZoOiVwXG4iLCBkZXYsIHN0YXRlKTsKIAogCWZtdCA9IHNhYTcxNDZfZm9y
bWF0X2J5X2ZvdXJjYyhkZXYsIGYtPmZtdC5waXgucGl4ZWxmb3JtYXQpOwogCWlmIChOVUxMID09
IGZtdCkKQEAgLTQxNyw3ICs0MjgsOSBAQCBzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYQogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2Nf
c19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHNh
YTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBzYWE3MTQ2X3Z2
ICp2diA9IGRldi0+dnZfZGF0YTsKQEAgLTQyOCw3ICs0NDEsNyBAQCBzdGF0aWMgaW50IHZpZGlv
Y19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
Zm9ybWF0CiAJCURFQl9FRSgic3RyZWFtaW5nIGNhcHR1cmUgaXMgYWN0aXZlXG4iKTsKIAkJcmV0
dXJuIC1FQlVTWTsKIAl9Ci0JZXJyID0gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBmaCwg
Zik7CisJZXJyID0gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7CiAJaWYg
KDAgIT0gZXJyKQogCQlyZXR1cm4gZXJyOwogCXN3aXRjaCAoZi0+Zm10LnBpeC5maWVsZCkgewpA
QCAtNDQ1LDcgKzQ1OCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB2
NGwyX3N0ZF9pZCAqbm9ybSkKK3N0YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3RkX2lkICpu
b3JtKQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
IAlzdHJ1Y3Qgc2FhNzE0Nl92diAqdnYgPSBkZXYtPnZ2X2RhdGE7CkBAIC00NTQsNyArNDY4LDgg
QEAgc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB2
NGwyX3N0ZF9pZCAqbm9ybSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19z
dGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB2NGwyX3N0ZF9pZCBpZCkKK3N0YXRpYyBp
bnQgdmlkaW9jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3RkX2lkIGlkKQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3Qgc2FhNzE0Nl92diAqdnYgPSBkZXYt
PnZ2X2RhdGE7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlk
ZW9idWYyLXY0bDIuYyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjIt
djRsMi5jCmluZGV4IGQ5MTEwMjFjMWJiMDUyNzc3N2QyZGExOGJlZjhmMDU2MmUzMmI0NjAuLjAx
ZjBlZTRmODFkMWM0NzhlM2FkODBmMzBjOTdjZWNjYjllNTQyZDggMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdjRsMi5jCisrKyBiL2RyaXZlcnMv
bWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdjRsMi5jCkBAIC05OTYsNyArOTk2LDgg
QEAgRVhQT1JUX1NZTUJPTF9HUEwodmIyX3BvbGwpOwogCiAvKiB2YjIgaW9jdGwgaGVscGVycyAq
LwogCi1pbnQgdmIyX2lvY3RsX3JlbW92ZV9idWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAoraW50IHZiMl9pb2N0bF9yZW1vdmVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0cnVjdCB2NGwyX3JlbW92
ZV9idWZmZXJzICpkKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZk
YXRhKGZpbGUpOwpAQCAtMTAxNCw3ICsxMDE1LDggQEAgaW50IHZiMl9pb2N0bF9yZW1vdmVfYnVm
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHZi
Ml9pb2N0bF9yZW1vdmVfYnVmcyk7CiAKLWludCB2YjJfaW9jdGxfcmVxYnVmcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2YjJfaW9jdGxfcmVxYnVmcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0
cnVjdCB2NGwyX3JlcXVlc3RidWZmZXJzICpwKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZk
ZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMTAzNyw3ICsxMDM5LDggQEAgaW50IHZiMl9p
b2N0bF9yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogRVhQT1JUX1NZ
TUJPTF9HUEwodmIyX2lvY3RsX3JlcWJ1ZnMpOwogCi1pbnQgdmIyX2lvY3RsX2NyZWF0ZV9idWZz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHZiMl9pb2N0bF9jcmVhdGVfYnVm
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgIHN0cnVjdCB2NGwyX2NyZWF0ZV9idWZmZXJzICpwKQogewogCXN0cnVjdCB2aWRl
b19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMTA2NCw3ICsxMDY3LDgg
QEAgaW50IHZiMl9pb2N0bF9jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHZiMl9pb2N0bF9jcmVhdGVfYnVmcyk7CiAKLWludCB2
YjJfaW9jdGxfcHJlcGFyZV9idWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQg
dmIyX2lvY3RsX3ByZXBhcmVfYnVmKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgc3RydWN0IHY0bDJfYnVmZmVyICpwKQogewog
CXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMTA3
NSw3ICsxMDc5LDggQEAgaW50IHZiMl9pb2N0bF9wcmVwYXJlX2J1ZihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHZiMl9pb2N0bF9wcmVwYXJlX2J1
Zik7CiAKLWludCB2YjJfaW9jdGxfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHN0cnVjdCB2NGwyX2J1ZmZlciAqcCkKK2ludCB2YjJfaW9jdGxfcXVlcnlidWYoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAg
c3RydWN0IHY0bDJfYnVmZmVyICpwKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2
aWRlb19kZXZkYXRhKGZpbGUpOwogCkBAIC0xMDg0LDcgKzEwODksOCBAQCBpbnQgdmIyX2lvY3Rs
X3F1ZXJ5YnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9idWZm
ZXIgKnApCiB9CiBFWFBPUlRfU1lNQk9MX0dQTCh2YjJfaW9jdGxfcXVlcnlidWYpOwogCi1pbnQg
dmIyX2lvY3RsX3FidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwy
X2J1ZmZlciAqcCkKK2ludCB2YjJfaW9jdGxfcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgIHN0cnVjdCB2NGwyX2J1ZmZlciAqcCkK
IHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIApA
QCAtMTA5NCw3ICsxMTAwLDggQEAgaW50IHZiMl9pb2N0bF9xYnVmKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9idWZmZXIgKnApCiB9CiBFWFBPUlRfU1lNQk9MX0dQ
TCh2YjJfaW9jdGxfcWJ1Zik7CiAKLWludCB2YjJfaW9jdGxfZHFidWYoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2J1ZmZlciAqcCkKK2ludCB2YjJfaW9jdGxfZHFi
dWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkgICAgc3RydWN0IHY0bDJfYnVmZmVyICpwKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZk
ZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCkBAIC0xMTA0LDcgKzExMTEsOCBAQCBpbnQgdmIy
X2lvY3RsX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9i
dWZmZXIgKnApCiB9CiBFWFBPUlRfU1lNQk9MX0dQTCh2YjJfaW9jdGxfZHFidWYpOwogCi1pbnQg
dmIyX2lvY3RsX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBlbnVtIHY0
bDJfYnVmX3R5cGUgaSkKK2ludCB2YjJfaW9jdGxfc3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUs
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgZW51bSB2NGwyX2J1
Zl90eXBlIGkpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEo
ZmlsZSk7CiAKQEAgLTExMTQsNyArMTEyMiw4IEBAIGludCB2YjJfaW9jdGxfc3RyZWFtb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGVudW0gdjRsMl9idWZfdHlwZSBpKQogfQogRVhQ
T1JUX1NZTUJPTF9HUEwodmIyX2lvY3RsX3N0cmVhbW9uKTsKIAotaW50IHZiMl9pb2N0bF9zdHJl
YW1vZmYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGVudW0gdjRsMl9idWZfdHlwZSBp
KQoraW50IHZiMl9pb2N0bF9zdHJlYW1vZmYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJZW51bSB2NGwyX2J1Zl90eXBlIGkpCiB7CiAJc3Ry
dWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKQEAgLTExMjQs
NyArMTEzMyw4IEBAIGludCB2YjJfaW9jdGxfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBlbnVtIHY0bDJfYnVmX3R5cGUgaSkKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHZi
Ml9pb2N0bF9zdHJlYW1vZmYpOwogCi1pbnQgdmIyX2lvY3RsX2V4cGJ1ZihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZXhwb3J0YnVmZmVyICpwKQoraW50IHZiMl9p
b2N0bF9leHBidWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkgICAgIHN0cnVjdCB2NGwyX2V4cG9ydGJ1ZmZlciAqcCkKIHsKIAlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9tZWRpYS9kdmItZnJvbnRlbmRzL3J0bDI4MzJfc2RyLmMgYi9kcml2ZXJzL21lZGlh
L2R2Yi1mcm9udGVuZHMvcnRsMjgzMl9zZHIuYwppbmRleCAwMzU3NjI0OTY4ZjFiNTQyNzcyZDhj
Yzc1MTIxMWMwYmYyOGUxOWFiLi45ODY2MzdjNGJlYzdkYTBkYzhhMTNkZWQ4ODI5ZTExYjBmOGE0
NDE1IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL2R2Yi1mcm9udGVuZHMvcnRsMjgzMl9zZHIu
YworKysgYi9kcml2ZXJzL21lZGlhL2R2Yi1mcm9udGVuZHMvcnRsMjgzMl9zZHIuYwpAQCAtNDE4
LDggKzQxOCw4IEBAIHN0YXRpYyB2b2lkIHJ0bDI4MzJfc2RyX2NsZWFudXBfcXVldWVkX2J1ZnMo
c3RydWN0IHJ0bDI4MzJfc2RyX2RldiAqZGV2KQogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRl
di0+cXVldWVkX2J1ZnNfbG9jaywgZmxhZ3MpOwogfQogCi1zdGF0aWMgaW50IHJ0bDI4MzJfc2Ry
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKLQkJc3RydWN0IHY0bDJfY2Fw
YWJpbGl0eSAqY2FwKQorc3RhdGljIGludCBydGwyODMyX3Nkcl9xdWVyeWNhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0
bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBydGwyODMyX3Nkcl9kZXYgKmRldiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldiA9IGRldi0+
cGRldjsKQEAgLTk0OSw4ICs5NDksOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZiMl9vcHMgcnRs
MjgzMl9zZHJfdmIyX29wcyA9IHsKIAkuc3RvcF9zdHJlYW1pbmcgICAgICAgICA9IHJ0bDI4MzJf
c2RyX3N0b3Bfc3RyZWFtaW5nLAogfTsKIAotc3RhdGljIGludCBydGwyODMyX3Nkcl9nX3R1bmVy
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl90dW5lciAqdikK
K3N0YXRpYyBpbnQgcnRsMjgzMl9zZHJfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJfdHVuZXIg
KnYpCiB7CiAJc3RydWN0IHJ0bDI4MzJfc2RyX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKIAlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gZGV2LT5wZGV2OwpAQCAtOTgxLDgg
Kzk4MSw4IEBAIHN0YXRpYyBpbnQgcnRsMjgzMl9zZHJfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHJ0bDI4MzJfc2Ry
X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCWNvbnN0IHN0cnVjdCB2
NGwyX3R1bmVyICp2KQorc3RhdGljIGludCBydGwyODMyX3Nkcl9zX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBjb25z
dCBzdHJ1Y3QgdjRsMl90dW5lciAqdikKIHsKIAlzdHJ1Y3QgcnRsMjgzMl9zZHJfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYgPSBk
ZXYtPnBkZXY7CkBAIC0xMDAzLDcgKzEwMDMsOCBAQCBzdGF0aWMgaW50IHJ0bDI4MzJfc2RyX3Nf
dHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAot
c3RhdGljIGludCBydGwyODMyX3Nkcl9lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJ0bDI4MzJfc2RyX2VudW1fZnJlcV9iYW5kcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCXN0cnVjdCB2NGwyX2ZyZXF1ZW5jeV9iYW5kICpiYW5kKQogewogCXN0cnVjdCBydGwy
ODMyX3Nkcl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDM0LDggKzEwMzUs
OCBAQCBzdGF0aWMgaW50IHJ0bDI4MzJfc2RyX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHJ0bDI4MzJf
c2RyX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlzdHJ1Y3Qg
djRsMl9mcmVxdWVuY3kgKmYpCitzdGF0aWMgaW50IHJ0bDI4MzJfc2RyX2dfZnJlcXVlbmN5KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHJ0bDI4MzJfc2RyX2RldiAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2
ID0gZGV2LT5wZGV2OwpAQCAtMTA2MSw3ICsxMDYyLDggQEAgc3RhdGljIGludCBydGwyODMyX3Nk
cl9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0
OwogfQogCi1zdGF0aWMgaW50IHJ0bDI4MzJfc2RyX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBydGwyODMyX3Nkcl9zX2ZyZXF1ZW5jeShzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBydGwyODMyX3Nk
cl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTA1LDggKzExMDcsOCBAQCBz
dGF0aWMgaW50IHJ0bDI4MzJfc2RyX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgcnRsMjgzMl9zZHJfZW51bV9m
bXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJf
Zm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgcnRsMjgzMl9zZHJfZW51bV9mbXRfc2RyX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHJ0bDI4MzJfc2RyX2RldiAqZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gZGV2
LT5wZGV2OwpAQCAtMTEyMSw4ICsxMTIzLDggQEAgc3RhdGljIGludCBydGwyODMyX3Nkcl9lbnVt
X2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHJ0bDI4MzJfc2RyX2dfZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgcnRs
MjgzMl9zZHJfZ19mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHJ0bDI4MzJfc2RyX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1
Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gZGV2LT5wZGV2OwpAQCAtMTEzNSw4ICsxMTM3LDgg
QEAgc3RhdGljIGludCBydGwyODMyX3Nkcl9nX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJ0bDI4MzJfc2RyX3Nf
Zm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgcnRsMjgzMl9zZHJfc19mbXRfc2RyX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHJ0bDI4MzJfc2RyX2RldiAqZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gZGV2
LT5wZGV2OwpAQCAtMTE2Niw4ICsxMTY4LDggQEAgc3RhdGljIGludCBydGwyODMyX3Nkcl9zX2Zt
dF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHJ0bDI4MzJfc2RyX3RyeV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBydGwy
ODMyX3Nkcl90cnlfZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHJ0bDI4MzJfc2RyX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlz
dHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2ID0gZGV2LT5wZGV2OwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9tZWRpYS9pMmMvdmlkZW8taTJjLmMgYi9kcml2ZXJzL21lZGlhL2kyYy92aWRlby1pMmMu
YwppbmRleCAwZGQ5OTFkNzBkNTM4MDUwNzMxYzAxMDY1MzNkNmYwNjE4ODUzYjFmLi45NmMxYjll
N2RiNzE5NjAyY2FkYTY1MzI1N2Q3N2VlNmUxMDNkMzE5IDEwMDY0NAotLS0gYS9kcml2ZXJzL21l
ZGlhL2kyYy92aWRlby1pMmMuYworKysgYi9kcml2ZXJzL21lZGlhL2kyYy92aWRlby1pMmMuYwpA
QCAtNTU4LDcgKzU1OCw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29wcyB2aWRlb19pMmNf
dmlkZW9fcW9wcyA9IHsKIAkuc3RvcF9zdHJlYW1pbmcJCT0gc3RvcF9zdHJlYW1pbmcsCiB9Owog
Ci1zdGF0aWMgaW50IHZpZGVvX2kyY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAg
KnByaXYsCitzdGF0aWMgaW50IHZpZGVvX2kyY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2
NGwyX2NhcGFiaWxpdHkgKnZjYXApCiB7CiAJc3RydWN0IHZpZGVvX2kyY19kYXRhICpkYXRhID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTU3MywxOSArNTc0LDI0IEBAIHN0YXRpYyBpbnQgdmlk
ZW9faTJjX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRlb19pMmNfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHVuc2lnbmVkIGludCAqaW5wKQorc3RhdGljIGludCB2aWRlb19pMmNfZ19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkgICAgIHVuc2lnbmVkIGludCAqaW5wKQogewogCSppbnAgPSAwOwogCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkZW9faTJjX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgaW5wKQorc3RhdGljIGludCB2aWRlb19pMmNfc19p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgICAgIHVuc2lnbmVkIGludCBpbnApCiB7CiAJcmV0dXJuIChpbnAgPiAw
KSA/IC1FSU5WQUwgOiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGVvX2kyY19lbnVtX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkZW9faTJjX2VudW1faW5w
dXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9pbnB1dCAqdmluKQogewogCWlmICh2aW4tPmluZGV4ID4g
MCkKQEAgLTU5OCw3ICs2MDQsOCBAQCBzdGF0aWMgaW50IHZpZGVvX2kyY19lbnVtX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2
aWRlb19pMmNfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitz
dGF0aWMgaW50IHZpZGVvX2kyY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmbXQpCiB7CiAJc3RydWN0IHZpZGVvX2kyY19kYXRhICpkYXRhID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTYxMyw3ICs2MjAsOCBAQCBzdGF0aWMgaW50IHZpZGVvX2ky
Y19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRlb19pMmNfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkZW9faTJjX2VudW1fZnJhbWVzaXplcyhz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJY29u
c3Qgc3RydWN0IHZpZGVvX2kyY19kYXRhICpkYXRhID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAg
LTYzMyw3ICs2NDEsOCBAQCBzdGF0aWMgaW50IHZpZGVvX2kyY19lbnVtX2ZyYW1lc2l6ZXMoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZp
ZGVvX2kyY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB2aWRlb19pMmNfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgICBz
dHJ1Y3QgdjRsMl9mcm1pdmFsZW51bSAqZmUpCiB7CiAJY29uc3Qgc3RydWN0IHZpZGVvX2kyY19k
YXRhICpkYXRhID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTY1MSw3ICs2NjAsOCBAQCBzdGF0
aWMgaW50IHZpZGVvX2kyY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGVvX2kyY190cnlfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2aWRlb19p
MmNfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
Zm10KQogewogCWNvbnN0IHN0cnVjdCB2aWRlb19pMmNfZGF0YSAqZGF0YSA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC02NzAsNyArNjgwLDggQEAgc3RhdGljIGludCB2aWRlb19pMmNfdHJ5X2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRlb19pMmNfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCitzdGF0aWMgaW50IHZpZGVvX2kyY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAg
c3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHZpZGVvX2kyY19kYXRhICpkYXRh
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTY3OCwxMCArNjg5LDExIEBAIHN0YXRpYyBpbnQg
dmlkZW9faTJjX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCWlm
ICh2YjJfaXNfYnVzeSgmZGF0YS0+dmJfdmlkcSkpCiAJCXJldHVybiAtRUJVU1k7CiAKLQlyZXR1
cm4gdmlkZW9faTJjX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBmaCwgZm10KTsKKwlyZXR1cm4gdmlk
ZW9faTJjX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZm10KTsKIH0KIAotc3RhdGljIGlu
dCB2aWRlb19pMmNfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRlb19pMmNfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFy
bSAqcGFybSkKIHsKIAlzdHJ1Y3QgdmlkZW9faTJjX2RhdGEgKmRhdGEgPSB2aWRlb19kcnZkYXRh
KGZpbHApOwpAQCAtNjk2LDcgKzcwOCw4IEBAIHN0YXRpYyBpbnQgdmlkZW9faTJjX2dfcGFybShz
dHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB2aWRlb19pMmNfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRlb19pMmNfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFy
bSAqcGFybSkKIHsKIAlzdHJ1Y3QgdmlkZW9faTJjX2RhdGEgKmRhdGEgPSB2aWRlb19kcnZkYXRh
KGZpbHApOwpAQCAtNzA5LDcgKzcyMiw3IEBAIHN0YXRpYyBpbnQgdmlkZW9faTJjX3NfcGFybShz
dHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAl9CiAJZGF0YS0+ZnJhbWVfaW50ZXJ2YWwg
PSBkYXRhLT5jaGlwLT5mcmFtZV9pbnRlcnZhbHNbaV07CiAKLQlyZXR1cm4gdmlkZW9faTJjX2df
cGFybShmaWxwLCBwcml2LCBwYXJtKTsKKwlyZXR1cm4gdmlkZW9faTJjX2dfcGFybShmaWxwLCBz
dGF0ZSwgcGFybSk7CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdjRsMl9pb2N0bF9vcHMgdmlk
ZW9faTJjX2lvY3RsX29wcyA9IHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL2J0OHh4
L2J0dHYtZHJpdmVyLmMgYi9kcml2ZXJzL21lZGlhL3BjaS9idDh4eC9idHR2LWRyaXZlci5jCmlu
ZGV4IDE3ZTQ1MjllNTM3YWI2NTRiZDY4MTRkY2VkYTAwNWFkNjUyYzg1MzMuLmU5YjhlN2E1M2Zk
YmY2OTI2MmY1NzRiNTJmZGFmZTc5YmY5ZWM4ZjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEv
cGNpL2J0OHh4L2J0dHYtZHJpdmVyLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvYnQ4eHgvYnR0
di1kcml2ZXIuYwpAQCAtMTU5Nyw3ICsxNTk3LDggQEAgc3RhdGljIHZvaWQgcmFkaW9fZW5hYmxl
KHN0cnVjdCBidHR2ICpidHYpCiAJfQogfQogCi1zdGF0aWMgaW50IGJ0dHZfc19zdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIGlkKQorc3RhdGljIGludCBidHR2
X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgaWQpCiB7CiAJc3RydWN0IGJ0dHYgKmJ0diA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CiAJdW5zaWduZWQgaW50IGk7CkBAIC0xNjEyLDcgKzE2MTMsOCBAQCBz
dGF0aWMgaW50IGJ0dHZfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJf
c3RkX2lkIGlkKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGJ0dHZfZ19zdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICppZCkKK3N0YXRpYyBpbnQgYnR0
dl9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCSAgICAgIHY0bDJfc3RkX2lkICppZCkKIHsKIAlzdHJ1Y3QgYnR0diAqYnR2ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTYyMCw3ICsxNjIyLDggQEAgc3RhdGljIGludCBidHR2
X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqaWQpCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYnR0dl9xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKmlkKQorc3RhdGljIGludCBidHR2X3F1ZXJ5c3Rk
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CSB2NGwyX3N0ZF9pZCAqaWQpCiB7CiAJc3RydWN0IGJ0dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAKQEAgLTE2MzEsNyArMTYzNCw4IEBAIHN0YXRpYyBpbnQgYnR0dl9xdWVyeXN0ZChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKmlkKQogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IGJ0dHZfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgYnR0dl9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwy
X2lucHV0ICppKQogewogCXN0cnVjdCBidHR2ICpidHYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtMTY2NCw3ICsxNjY4LDggQEAgc3RhdGljIGludCBidHR2X2VudW1faW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYnR0dl9n
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitz
dGF0aWMgaW50IGJ0dHZfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQl1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IGJ0dHYg
KmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTE2NzMsNyArMTY3OCw4IEBAIHN0YXRp
YyBpbnQgYnR0dl9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25l
ZCBpbnQgKmkpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYnR0dl9zX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKK3N0YXRpYyBpbnQgYnR0
dl9zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCXVuc2lnbmVkIGludCBpKQogewogCXN0cnVjdCBidHR2ICpidHYgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwogCkBAIC0xNjg0LDcgKzE2OTAsOCBAQCBzdGF0aWMgaW50IGJ0dHZfc19p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYnR0dl9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAorc3RhdGljIGludCBidHR2X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJY29uc3Qgc3RydWN0IHY0
bDJfdHVuZXIgKnQpCiB7CiAJc3RydWN0IGJ0dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC0xNzAyLDcgKzE3MDksOCBAQCBzdGF0aWMgaW50IGJ0dHZfc190dW5lcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBidHR2X2df
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBidHR2
X2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3Ry
dWN0IGJ0dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNzM4LDcgKzE3NDYsOCBA
QCBzdGF0aWMgdm9pZCBidHR2X3NldF9mcmVxdWVuY3koc3RydWN0IGJ0dHYgKmJ0diwgY29uc3Qg
c3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogCX0KIH0KIAotc3RhdGljIGludCBidHR2X3NfZnJl
cXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBidHR2X3Nf
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCQljb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJ
c3RydWN0IGJ0dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNzUwLDcgKzE3NTks
OCBAQCBzdGF0aWMgaW50IGJ0dHZfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYnR0dl9sb2dfc3RhdHVzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2KQorc3RhdGljIGludCBidHR2X2xvZ19zdGF0dXMoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkK
IHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAlz
dHJ1Y3QgYnR0diAqYnR2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE3NjEsNyArMTc3MSw4
IEBAIHN0YXRpYyBpbnQgYnR0dl9sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2KQogfQogCiAjaWZkZWYgQ09ORklHX1ZJREVPX0FEVl9ERUJVRwotc3RhdGljIGludCBidHR2
X2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGJ0
dHZfZ19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKIHsK
IAlzdHJ1Y3QgYnR0diAqYnR2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE3NzQsNyArMTc4
NSw4IEBAIHN0YXRpYyBpbnQgYnR0dl9nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGJ0dHZfc19yZWdpc3RlcihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgYnR0dl9zX3JlZ2lzdGVyKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJCWNvbnN0IHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVnKQogewogCXN0cnVjdCBi
dHR2ICpidHYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTk4MSw3ICsxOTkzLDggQEAgcGl4
X2Zvcm1hdF9zZXRfc2l6ZSAgICAgKHN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKiAgICAgICBmLAog
CX0KIH0KIAotc3RhdGljIGludCBidHR2X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGJ0dHZfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGJ0dHYgKmJ0diA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0yMDA3LDcgKzIwMjAsOCBAQCBzdGF0aWMgdm9pZCBidHR2X2dldF93aWR0
aF9tYXNrX3ZpZF9jYXAoY29uc3Qgc3RydWN0IGJ0dHZfZm9ybWF0ICpmbXQsCiAJfQogfQogCi1z
dGF0aWMgaW50IGJ0dHZfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCBidHR2X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAljb25zdCBzdHJ1Y3QgYnR0dl9mb3JtYXQgKmZtdDsKQEAgLTIwNjIs
NyArMjA3Niw4IEBAIHN0YXRpYyBpbnQgYnR0dl90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYnR0dl9zX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBidHR2
X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlpbnQgcmV0dmFsOwpAQCAtMjA3Niw3ICsyMDkxLDcgQEAgc3RhdGljIGludCBidHR2X3NfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKDAgIT0gcmV0dmFs
KQogCQlyZXR1cm4gcmV0dmFsOwogCi0JcmV0dmFsID0gYnR0dl90cnlfZm10X3ZpZF9jYXAoZmls
ZSwgcHJpdiwgZik7CisJcmV0dmFsID0gYnR0dl90cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUs
IGYpOwogCWlmICgwICE9IHJldHZhbCkKIAkJcmV0dXJuIHJldHZhbDsKIApAQCAtMjEwOSw3ICsy
MTI0LDggQEAgc3RhdGljIGludCBidHR2X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYnR0dl9xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IGJ0dHZfcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBidHR2ICpidHYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjE0MCw3ICsyMTU2LDggQEAgc3RhdGljIGludCBi
dHR2X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBidHR2X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgICpwcml2LAorc3RhdGljIGludCBidHR2X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBz
dHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWludCBpbmRleCA9IC0xLCBpOwpAQCAtMjE1OSw3
ICsyMTc2LDggQEAgc3RhdGljIGludCBidHR2X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGJ0dHZfZ19w
YXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBidHR2X2dfcGFy
bShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3RydWN0IGJ0
dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yMTczLDcgKzIxOTEsOCBAQCBzdGF0
aWMgaW50IGJ0dHZfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IGJ0dHZfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgYnR0dl9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfdHVuZXIg
KnQpCiB7CiAJc3RydWN0IGJ0dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yMTk1
LDggKzIyMTQsOSBAQCBzdGF0aWMgaW50IGJ0dHZfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBidHR2X2dfcGl4ZWxhc3Bl
Y3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkgICAgICBpbnQgdHlwZSwgc3Ry
dWN0IHY0bDJfZnJhY3QgKmYpCitzdGF0aWMgaW50IGJ0dHZfZ19waXhlbGFzcGVjdChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBp
bnQgdHlwZSwKKwkJCSAgICAgIHN0cnVjdCB2NGwyX2ZyYWN0ICpmKQogewogCXN0cnVjdCBidHR2
ICpidHYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0yMjA4LDcgKzIyMjgsOSBAQCBzdGF0
aWMgaW50IGJ0dHZfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBidHR2X2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKK3N0YXRpYyBp
bnQgYnR0dl9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNl
bCkKIHsKIAlzdHJ1Y3QgYnR0diAqYnR2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMjIz
Miw3ICsyMjU0LDkgQEAgc3RhdGljIGludCBidHR2X2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24KIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBidHR2X3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKK3N0YXRpYyBpbnQgYnR0dl9zX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsKIAlzdHJ1Y3QgYnR0
diAqYnR2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAljb25zdCBzdHJ1Y3QgdjRsMl9yZWN0ICpi
OwpAQCAtMjM5OCw3ICsyNDIyLDggQEAgc3RhdGljIGludCByYWRpb19yZWxlYXNlKHN0cnVjdCBm
aWxlICpmaWxlKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJhZGlvX2dfdHVuZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3R1bmVyICp0KQorc3RhdGlj
IGludCByYWRpb19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl90dW5lciAqdCkKIHsKIAlzdHJ1Y3QgYnR0
diAqYnR2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMjQxOSw3ICsyNDQ0LDggQEAgc3Rh
dGljIGludCByYWRpb19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1
Y3QgdjRsMl90dW5lciAqdCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByYWRpb19zX3R1
bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByYWRpb19zX3R1
bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCQljb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdCkKIHsKIAlzdHJ1Y3QgYnR0diAq
YnR2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTI0MzIsNyArMjQ1OCw4IEBAIHN0YXRpYyBp
bnQgcmFkaW9fc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCByYWRpb19zX2h3X2ZyZXFfc2VlayhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9fc19od19mcmVxX3NlZWsoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCWNv
bnN0IHN0cnVjdCB2NGwyX2h3X2ZyZXFfc2VlayAqYSkKIHsKIAlzdHJ1Y3QgYnR0diAqYnR2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTI0NDMsNyArMjQ3MCw4IEBAIHN0YXRpYyBpbnQgcmFk
aW9fc19od19mcmVxX3NlZWsoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IC1FTk9UVFk7CiB9CiAKLXN0YXRpYyBpbnQgcmFkaW9fZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByYWRpb19lbnVtX2ZyZXFfYmFuZHMo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCQkgc3RydWN0IHY0bDJfZnJlcXVlbmN5X2JhbmQgKmJhbmQpCiB7CiAJc3RydWN0IGJ0
dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlh
L3BjaS9idDh4eC9idHR2LXZiaS5jIGIvZHJpdmVycy9tZWRpYS9wY2kvYnQ4eHgvYnR0di12Ymku
YwppbmRleCAwY2E4OGEyNDAwZWVmYmJiNmM2MWUyOTJkNWZlMmNmZWY5NTFjNGQ3Li44NGJjZjVi
MjI1YTUxZDhhNDA1ZjhhNmZiMDg5NDdlN2EyNzBkOTIzIDEwMDY0NAotLS0gYS9kcml2ZXJzL21l
ZGlhL3BjaS9idDh4eC9idHR2LXZiaS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL2J0OHh4L2J0
dHYtdmJpLmMKQEAgLTI0MSw3ICsyNDEsOCBAQCBzdGF0aWMgaW50IHRyeV9mbXQoc3RydWN0IHY0
bDJfdmJpX2Zvcm1hdCAqZiwgY29uc3Qgc3RydWN0IGJ0dHZfdHZub3JtICp0dm5vcm0sCiAJcmV0
dXJuIDA7CiB9CiAKLWludCBidHR2X3RyeV9mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmcnQpCitpbnQgYnR0dl90cnlfZm10X3Zi
aV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZnJ0KQogewogCXN0cnVjdCBidHR2ICpidHYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwogCWNvbnN0IHN0cnVjdCBidHR2X3R2bm9ybSAqdHZub3JtOwpA
QCAtMjU3LDggKzI1OCw4IEBAIGludCBidHR2X3RyeV9mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmcnQpCiAJcmV0dXJuIHRyeV9m
bXQoJmZydC0+Zm10LnZiaSwgdHZub3JtLCBjcm9wX3N0YXJ0KTsKIH0KIAotCi1pbnQgYnR0dl9z
X2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmZydCkKK2ludCBidHR2X3NfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfZm9y
bWF0ICpmcnQpCiB7CiAJc3RydWN0IGJ0dHYgKmJ0diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJ
Y29uc3Qgc3RydWN0IGJ0dHZfdHZub3JtICp0dm5vcm07CkBAIC0zMDAsOCArMzAxLDggQEAgaW50
IGJ0dHZfc19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmcnQpCiAJcmV0dXJuIHJjOwogfQogCi0KLWludCBidHR2X2dfZm10X3Zi
aV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZnJ0KQoraW50IGJ0dHZfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZy
dCkKIHsKIAljb25zdCBzdHJ1Y3QgYnR0dl90dm5vcm0gKnR2bm9ybTsKIAlzdHJ1Y3QgYnR0diAq
YnR2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNp
L2J0OHh4L2J0dHZwLmggYi9kcml2ZXJzL21lZGlhL3BjaS9idDh4eC9idHR2cC5oCmluZGV4IGE1
MzRlNjNiOWEzN2JjNWZkYjI3Y2M1YjU1OGFlODg1YzcxODY3MTUuLjA4NDlmMmY0MzcyMGY0NTM3
MTc0YzQzMWI0MjQ2Y2RjMDJjZDIxZmYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGNpL2J0
OHh4L2J0dHZwLmgKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvYnQ4eHgvYnR0dnAuaApAQCAtMjI3
LDkgKzIyNywxMiBAQCBpbnQgYnR0dl9idWZmZXJfYWN0aXZhdGVfdmJpKHN0cnVjdCBidHR2ICpi
dHYsCiAKICNkZWZpbmUgVkJJX0RFRkxJTkVTIDE2CiAKLWludCBidHR2X3RyeV9mbXRfdmJpX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1p
bnQgYnR0dl9nX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKLWludCBidHR2X3NfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IGJ0dHZfdHJ5X2ZtdF92
YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IGJ0dHZfZ19mbXRfdmJpX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAg
ICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IGJ0dHZfc19mbXRfdmJpX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAg
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwogCiAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCiAvKiBidHR2LWdwaW8uYyAqLwpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvY29iYWx0L2NvYmFsdC12NGwyLmMgYi9kcml2
ZXJzL21lZGlhL3BjaS9jb2JhbHQvY29iYWx0LXY0bDIuYwppbmRleCA1MWZkOTU3NmM2YzJhNzc1
YWIzMTQ2YWYwNWM3ZTA1MWYxMTk4OTAyLi5lM2VmNmJmZjI4MTc1MzU4YTQ2ZDY1Y2M0YmFlODli
MWJlYzk3YWM0IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9jb2JhbHQvY29iYWx0LXY0
bDIuYworKysgYi9kcml2ZXJzL21lZGlhL3BjaS9jb2JhbHQvY29iYWx0LXY0bDIuYwpAQCAtNDQ3
LDcgKzQ0Nyw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2NvYmFsdGMoc3RydWN0IGNvYmFsdCAqY29i
YWx0LCB1bnNpZ25lZCBpbnQgY21kLCB2b2lkICphcmcpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgY29iYWx0X2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IGNvYmFsdF9nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJc3RydWN0IHY0bDJfZGJnX3JlZ2lz
dGVyICpyZWcpCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtNDU2LDcgKzQ1Nyw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2dfcmVnaXN0ZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGNvYmFsdF9jb2JhbHRjKGNvYmFs
dCwgVklESU9DX0RCR19HX1JFR0lTVEVSLCByZWcpOwogfQogCi1zdGF0aWMgaW50IGNvYmFsdF9z
X3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjb2Jh
bHRfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCWNvbnN0IHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVn
KQogewogCXN0cnVjdCBjb2JhbHRfc3RyZWFtICpzID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAg
LTQ2Nyw3ICs0NjksOCBAQCBzdGF0aWMgaW50IGNvYmFsdF9zX3JlZ2lzdGVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogfQogI2VuZGlmCiAKLXN0YXRpYyBpbnQgY29iYWx0X3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjb2JhbHRfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICp2Y2FwKQogewogCXN0cnVjdCBj
b2JhbHRfc3RyZWFtICpzID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTU2Miw3ICs1NjUsOCBA
QCBzdGF0aWMgdm9pZCBjb2JhbHRfdmlkZW9faW5wdXRfc3RhdHVzX3Nob3coc3RydWN0IGNvYmFs
dF9zdHJlYW0gKnMpCiAJY29iYWx0X2luZm8oInJ4JWQ6IFBhY2tlcjogJXhcbiIsIHJ4LCBpb3Jl
YWQzMigmcGFja2VyLT5jb250cm9sKSk7CiB9CiAKLXN0YXRpYyBpbnQgY29iYWx0X2xvZ19zdGF0
dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYpCitzdGF0aWMgaW50IGNvYmFsdF9sb2df
c3RhdHVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgY29iYWx0X3N0cmVhbSAqcyA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAJc3RydWN0IGNvYmFsdCAqY29iYWx0ID0gcy0+Y29iYWx0OwpAQCAtNTk2LDcgKzYw
MCw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY29iYWx0X2VudW1fZHZfdGlt
aW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY29iYWx0X2Vu
dW1fZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9lbnVtX2R2X3RpbWluZ3MgKnRp
bWluZ3MpCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtNjEzLDcgKzYxOCw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2VudW1fZHZfdGltaW5ncyhz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAkJCXBhZCwgZW51bV9kdl90aW1pbmdzLCB0
aW1pbmdzKTsKIH0KIAotc3RhdGljIGludCBjb2JhbHRfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjb2JhbHRfc19kdl90aW1pbmdzKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCBj
b2JhbHRfc3RyZWFtICpzID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTY0MSw3ICs2NDcsOCBA
QCBzdGF0aWMgaW50IGNvYmFsdF9zX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIGVycjsKIH0KIAotc3RhdGljIGludCBjb2JhbHRfZ19kdl90aW1pbmdz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjb2JhbHRfZ19kdl90
aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQog
ewogCXN0cnVjdCBjb2JhbHRfc3RyZWFtICpzID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTY1
NCw3ICs2NjEsOCBAQCBzdGF0aWMgaW50IGNvYmFsdF9nX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJCQlwYWQsIGdfZHZfdGltaW5ncywgMCwgdGltaW5ncyk7CiB9
CiAKLXN0YXRpYyBpbnQgY29iYWx0X3F1ZXJ5X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGNvYmFsdF9xdWVyeV9kdl90aW1pbmdzKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CSAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCBjb2JhbHRf
c3RyZWFtICpzID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTY2Nyw3ICs2NzUsOCBAQCBzdGF0
aWMgaW50IGNvYmFsdF9xdWVyeV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogCQkJcGFkLCBxdWVyeV9kdl90aW1pbmdzLCAwLCB0aW1pbmdzKTsKIH0KIAotc3RhdGlj
IGludCBjb2JhbHRfZHZfdGltaW5nc19jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IGNvYmFsdF9kdl90aW1pbmdzX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwy
X2R2X3RpbWluZ3NfY2FwICpjYXApCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtNjc3LDggKzY4Niw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2R2
X3RpbWluZ3NfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCQkJcGFkLCBkdl90
aW1pbmdzX2NhcCwgY2FwKTsKIH0KIAotc3RhdGljIGludCBjb2JhbHRfZW51bV9mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZm10ZGVzYyAq
ZikKK3N0YXRpYyBpbnQgY29iYWx0X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2Zt
dGRlc2MgKmYpCiB7CiAJc3dpdGNoIChmLT5pbmRleCkgewogCWNhc2UgMDoKQEAgLTY5Nyw4ICs3
MDYsOCBAQCBzdGF0aWMgaW50IGNvYmFsdF9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNvYmFsdF9nX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCitzdGF0aWMgaW50IGNvYmFsdF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKnBpeCA9ICZmLT5mbXQucGl4OwpAQCAtNzI2
LDggKzczNSw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY29iYWx0X3Ry
eV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBjb2JhbHRfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY29iYWx0X3N0cmVhbSAqcyA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdCAqcGl4ID0gJmYtPmZtdC5waXg7
CkBAIC03ODcsOCArNzk2LDggQEAgc3RhdGljIGludCBjb2JhbHRfdHJ5X2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGNvYmFsdF9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IGNvYmFsdF9zX2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKnBpeCA9ICZmLT5mbXQu
cGl4OwpAQCAtNzk2LDcgKzgwNSw3IEBAIHN0YXRpYyBpbnQgY29iYWx0X3NfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHZiMl9pc19idXN5KCZzLT5xKSkK
IAkJcmV0dXJuIC1FQlVTWTsKIAotCWlmIChjb2JhbHRfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHBy
aXYsIGYpKQorCWlmIChjb2JhbHRfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKSkKIAkJ
cmV0dXJuIC1FSU5WQUw7CiAKIAlzLT53aWR0aCA9IHBpeC0+d2lkdGg7CkBAIC04MjEsOCArODMw
LDggQEAgc3RhdGljIGludCBjb2JhbHRfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjb2JhbHRfdHJ5X2ZtdF92
aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCitzdGF0aWMgaW50IGNvYmFsdF90cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKnBpeCA9ICZmLT5mbXQucGl4
OwogCkBAIC04NjIsOCArODcxLDggQEAgc3RhdGljIGludCBjb2JhbHRfdHJ5X2ZtdF92aWRfb3V0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGNvYmFsdF9nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAot
CQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IGNvYmFsdF9nX2ZtdF92aWRfb3V0
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKnBpeCA9ICZmLT5m
bXQucGl4OwpAQCAtODgyLDggKzg5MSw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2dfZm10X3ZpZF9v
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgY29iYWx0X2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCi0JCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IGNvYmFsdF9lbnVtX2Zt
dF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN3aXRjaCAoZi0+aW5k
ZXgpIHsKIAljYXNlIDA6CkBAIC04OTksOCArOTA4LDggQEAgc3RhdGljIGludCBjb2JhbHRfZW51
bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBjb2JhbHRfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBjb2JhbHRf
c19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjb2JhbHRf
c3RyZWFtICpzID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0
ICpwaXggPSAmZi0+Zm10LnBpeDsKQEAgLTkwOSw3ICs5MTgsNyBAQCBzdGF0aWMgaW50IGNvYmFs
dF9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCX07CiAJdTMy
IGNvZGU7CiAKLQlpZiAoY29iYWx0X3RyeV9mbXRfdmlkX291dChmaWxlLCBwcml2LCBmKSkKKwlp
ZiAoY29iYWx0X3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZikpCiAJCXJldHVybiAtRUlO
VkFMOwogCiAJaWYgKHZiMl9pc19idXN5KCZzLT5xKSAmJiAocGl4LT5waXhlbGZvcm1hdCAhPSBz
LT5waXhmbXQgfHwKQEAgLTk0Miw3ICs5NTEsOCBAQCBzdGF0aWMgaW50IGNvYmFsdF9zX2ZtdF92
aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGNvYmFsdF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCBjb2JhbHRfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2lu
cHV0ICppbnApCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtOTYzLDcgKzk3Myw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X2VudW1faW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQl2aWRlbywgZ19pbnB1dF9zdGF0dXMsICZp
bnAtPnN0YXR1cyk7CiB9CiAKLXN0YXRpYyBpbnQgY29iYWx0X2dfaW5wdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKK3N0YXRpYyBpbnQgY29iYWx0X2df
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IGNvYmFsdF9zdHJlYW0gKnMgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC05NzEsNyArOTgyLDggQEAgc3RhdGljIGludCBjb2Jh
bHRfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICpp
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNvYmFsdF9zX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKK3N0YXRpYyBpbnQgY29iYWx0X3Nf
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlzdHJ1Y3QgY29iYWx0X3N0cmVhbSAqcyA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTk5MCw3ICsxMDAyLDggQEAgc3RhdGljIGludCBjb2Jh
bHRfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkp
CiAJCQlBRFY3NlhYX1BBRF9IRE1JX1BPUlRfQSwgMCwgMCk7CiB9CiAKLXN0YXRpYyBpbnQgY29i
YWx0X2VudW1fb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBjb2JhbHRfZW51bV9vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfb3V0cHV0ICpvdXQp
CiB7CiAJaWYgKG91dC0+aW5kZXgpCkBAIC0xMDAxLDE4ICsxMDE0LDIxIEBAIHN0YXRpYyBpbnQg
Y29iYWx0X2VudW1fb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IGNvYmFsdF9nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCBjb2JhbHRfZ19vdXRwdXQo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwgdW5zaWduZWQgaW50ICppKQogewogCSppID0gMDsKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBjb2JhbHRfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2ln
bmVkIGludCBpKQorc3RhdGljIGludCBjb2JhbHRfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5zaWduZWQgaW50IGkp
CiB7CiAJcmV0dXJuIGkgPyAtRUlOVkFMIDogMDsKIH0KIAotc3RhdGljIGludCBjb2JhbHRfZ19l
ZGlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9lZGlkICplZGlk
KQorc3RhdGljIGludCBjb2JhbHRfZ19lZGlkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9lZGlkICplZGlkKQogewog
CXN0cnVjdCBjb2JhbHRfc3RyZWFtICpzID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAl1MzIgcGFk
ID0gZWRpZC0+cGFkOwpAQCAtMTAyNiw3ICsxMDQyLDggQEAgc3RhdGljIGludCBjb2JhbHRfZ19l
ZGlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9lZGlkICplZGlk
KQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgY29iYWx0X3NfZWRpZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZWRpZCAqZWRpZCkKK3N0YXRpYyBpbnQg
Y29iYWx0X3NfZWRpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZWRpZCAqZWRpZCkKIHsKIAlzdHJ1Y3QgY29iYWx0
X3N0cmVhbSAqcyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJdTMyIHBhZCA9IGVkaWQtPnBhZDsK
QEAgLTEwNTAsNyArMTA2Nyw4IEBAIHN0YXRpYyBpbnQgY29iYWx0X3N1YnNjcmliZV9ldmVudChz
dHJ1Y3QgdjRsMl9maCAqZmgsCiAJcmV0dXJuIHY0bDJfY3RybF9zdWJzY3JpYmVfZXZlbnQoZmgs
IHN1Yik7CiB9CiAKLXN0YXRpYyBpbnQgY29iYWx0X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgY29iYWx0
X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlzdHJ1Y3QgY29iYWx0X3N0
cmVhbSAqcyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0bDJfZnJhY3QgZnBzOwpA
QCAtMTA2NSw4ICsxMDgzLDkgQEAgc3RhdGljIGludCBjb2JhbHRfZ19wYXJtKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICoKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBjb2JhbHRfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKLQkJCQlpbnQgdHlwZSwgc3RydWN0IHY0bDJfZnJhY3QgKmYpCitzdGF0aWMg
aW50IGNvYmFsdF9nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBpbnQgdHlwZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mcmFj
dCAqZikKIHsKIAlzdHJ1Y3QgY29iYWx0X3N0cmVhbSAqcyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CiAJc3RydWN0IHY0bDJfZHZfdGltaW5ncyB0aW1pbmdzOwpAQCAtMTA4NCw3ICsxMTAzLDggQEAg
c3RhdGljIGludCBjb2JhbHRfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gZXJyOwogfQogCi1zdGF0aWMgaW50IGNvYmFsdF9nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY29iYWx0X2dfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsKIAlzdHJ1
Y3QgY29iYWx0X3N0cmVhbSAqcyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL21lZGlhL3BjaS9jeDE4L2N4MTgtZHJpdmVyLmMgYi9kcml2ZXJzL21lZGlhL3BjaS9j
eDE4L2N4MTgtZHJpdmVyLmMKaW5kZXggYjYyZmQxMmM5M2MxYTM3ZWE2YzhkM2Q0ODg3MTAyOGQ4
MWIzMzQ4NS4uNDc1YzVhNWUyMDAwOTg3ZmMzZDU5MGViNTdkYTE0NzJkN2NjYmY0YiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvY3gxOC9jeDE4LWRyaXZlci5jCisrKyBiL2RyaXZlcnMv
bWVkaWEvcGNpL2N4MTgvY3gxOC1kcml2ZXIuYwpAQCAtMTEzNiwxMSArMTEzNiw4IEBAIGludCBj
eDE4X2luaXRfb25fZmlyc3Rfb3BlbihzdHJ1Y3QgY3gxOCAqY3gpCiAJaW50IHZpZGVvX2lucHV0
OwogCWludCBmd19yZXRyeV9jb3VudCA9IDM7CiAJc3RydWN0IHY0bDJfZnJlcXVlbmN5IHZmOwot
CXN0cnVjdCBjeDE4X29wZW5faWQgZmg7CiAJdjRsMl9zdGRfaWQgc3RkOwogCi0JZmguY3ggPSBj
eDsKLQogCWlmICh0ZXN0X2JpdChDWDE4X0ZfSV9GQUlMRUQsICZjeC0+aV9mbGFncykpCiAJCXJl
dHVybiAtRU5YSU87CiAKQEAgLTEyMjAsMTQgKzEyMTcsMTQgQEAgaW50IGN4MThfaW5pdF9vbl9m
aXJzdF9vcGVuKHN0cnVjdCBjeDE4ICpjeCkKIAogCXZpZGVvX2lucHV0ID0gY3gtPmFjdGl2ZV9p
bnB1dDsKIAljeC0+YWN0aXZlX2lucHV0Kys7CS8qIEZvcmNlIHVwZGF0ZSBvZiBpbnB1dCAqLwot
CWN4MThfc19pbnB1dChOVUxMLCAmZmgsIHZpZGVvX2lucHV0KTsKKwljeDE4X3NfaW5wdXQoTlVM
TCwgTlVMTCwgdmlkZW9faW5wdXQpOwogCiAJLyogTGV0IHRoZSBWSURJT0NfU19TVEQgaW9jdGwg
ZG8gYWxsIHRoZSB3b3JrLCBrZWVwcyB0aGUgY29kZQogCSAgIGluIG9uZSBwbGFjZS4gKi8KIAlj
eC0+c3RkKys7CQkvKiBGb3JjZSBmdWxsIHN0YW5kYXJkIGluaXRpYWxpemF0aW9uICovCiAJc3Rk
ID0gKGN4LT50dW5lcl9zdGQgPT0gVjRMMl9TVERfQUxMKSA/IFY0TDJfU1REX05UU0NfTSA6IGN4
LT50dW5lcl9zdGQ7Ci0JY3gxOF9zX3N0ZChOVUxMLCAmZmgsIHN0ZCk7Ci0JY3gxOF9zX2ZyZXF1
ZW5jeShOVUxMLCAmZmgsICZ2Zik7CisJY3gxOF9zX3N0ZChOVUxMLCBOVUxMLCBzdGQpOworCWN4
MThfc19mcmVxdWVuY3koTlVMTCwgTlVMTCwgJnZmKTsKIAlyZXR1cm4gMDsKIH0KIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvY3gxOC9jeDE4LWlvY3RsLmMgYi9kcml2ZXJzL21lZGlh
L3BjaS9jeDE4L2N4MTgtaW9jdGwuYwppbmRleCAwZjMwMTk3MzlkMDNkYWIxZWQ4YmE2M2Y3MTEz
NGE1YjY0ODA3YzdkLi5mY2Y5NDc3ZTE1OGNlY2JmZDQzODE1NmZjNDFhOThmNTEwNzdmM2Y2IDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9jeDE4L2N4MTgtaW9jdGwuYworKysgYi9kcml2
ZXJzL21lZGlhL3BjaS9jeDE4L2N4MTgtaW9jdGwuYwpAQCAtNDksNyArNDksOCBAQCBzdGF0aWMg
Y29uc3Qgc3RydWN0IHY0bDJfZm10ZGVzYyBjeDE4X2Zvcm1hdHNfbXBlZ1tdID0gewogCX0sCiB9
OwogCi1zdGF0aWMgaW50IGN4MThfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCitzdGF0aWMgaW50IGN4MThfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IGN4MThfb3Blbl9pZCAqaWQgPSBmaWxl
MmlkKGZpbGUpOwpAQCAtNzMsNyArNzQsOCBAQCBzdGF0aWMgaW50IGN4MThfZ19mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgY3gxOF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3Rh
dGljIGludCBjeDE4X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZt
dCkKIHsKIAlzdHJ1Y3QgY3gxOF9vcGVuX2lkICppZCA9IGZpbGUyaWQoZmlsZSk7CkBAIC0xMTgs
NyArMTIwLDggQEAgc3RhdGljIGludCBjeDE4X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY3gxOF9zX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3gxOF9zX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlz
dHJ1Y3QgY3gxOF9vcGVuX2lkICppZCA9IGZpbGUyaWQoZmlsZSk7CkBAIC0xMzAsNyArMTMzLDcg
QEAgc3RhdGljIGludCBjeDE4X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCWludCByZXQ7CiAJaW50IHcsIGg7CiAKLQlyZXQgPSBjeDE4X3RyeV9mbXRfdmlkX2Nh
cChmaWxlLCBmaCwgZm10KTsKKwlyZXQgPSBjeDE4X3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0
ZSwgZm10KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCXcgPSBmbXQtPmZtdC5waXgud2lk
dGg7CkBAIC0xNTEsNyArMTU0LDcgQEAgc3RhdGljIGludCBjeDE4X3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCWZvcm1hdC5mb3JtYXQuaGVpZ2h0ID0gY3gtPmN4
aGRsLmhlaWdodCA9IGg7CiAJZm9ybWF0LmZvcm1hdC5jb2RlID0gTUVESUFfQlVTX0ZNVF9GSVhF
RDsKIAl2NGwyX3N1YmRldl9jYWxsKGN4LT5zZF9hdiwgcGFkLCBzZXRfZm10LCBOVUxMLCAmZm9y
bWF0KTsKLQlyZXR1cm4gY3gxOF9nX2ZtdF92aWRfY2FwKGZpbGUsIGZoLCBmbXQpOworCXJldHVy
biBjeDE4X2dfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGZtdCk7CiB9CiAKIHUxNiBjeDE4X3Nl
cnZpY2UydmJpKGludCB0eXBlKQpAQCAtMjU4LDcgKzI2MSw4IEBAIHUxNiBjeDE4X2dldF9zZXJ2
aWNlX3NldChzdHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2Zvcm1hdCAqZm10KQogCXJldHVybiBzZXQ7
CiB9CiAKLXN0YXRpYyBpbnQgY3gxOF9nX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKK3N0YXRpYyBpbnQgY3gxOF9nX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IGN4MTggKmN4ID0gZmlsZTJpZChmaWxlKS0+
Y3g7CkBAIC0yNzcsNyArMjgxLDggQEAgc3RhdGljIGludCBjeDE4X2dfZm10X3ZiaV9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGN4
MThfZ19mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3Rh
dGljIGludCBjeDE4X2dfZm10X3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCBjeDE4ICpjeCA9IGZpbGUyaWQoZmlsZSktPmN4OwpA
QCAtMzAyLDEzICszMDcsMTUgQEAgc3RhdGljIGludCBjeDE4X2dfZm10X3NsaWNlZF92YmlfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBjeDE4X3RyeV9mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0
aWMgaW50IGN4MThfdHJ5X2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10
KQogewotCXJldHVybiBjeDE4X2dfZm10X3ZiaV9jYXAoZmlsZSwgZmgsIGZtdCk7CisJcmV0dXJu
IGN4MThfZ19mbXRfdmJpX2NhcChmaWxlLCBzdGF0ZSwgZm10KTsKIH0KIAotc3RhdGljIGludCBj
eDE4X3RyeV9mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAor
c3RhdGljIGludCBjeDE4X3RyeV9mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUp
LT5jeDsKQEAgLTMyNyw3ICszMzQsOCBAQCBzdGF0aWMgaW50IGN4MThfdHJ5X2ZtdF9zbGljZWRf
dmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgY3gxOF9zX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgY3gxOF9zX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9y
bWF0ICpmbXQpCiB7CiAJc3RydWN0IGN4MThfb3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwpA
QCAtMzU0LDEwICszNjIsMTEgQEAgc3RhdGljIGludCBjeDE4X3NfZm10X3ZiaV9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCWN4LT52Ymkuc2xpY2VkX2luLT5zZXJ2aWNlX3NldCA9
IDA7CiAJY3gtPnZiaS5pbi50eXBlID0gVjRMMl9CVUZfVFlQRV9WQklfQ0FQVFVSRTsKIAotCXJl
dHVybiBjeDE4X2dfZm10X3ZiaV9jYXAoZmlsZSwgZmgsIGZtdCk7CisJcmV0dXJuIGN4MThfZ19m
bXRfdmJpX2NhcChmaWxlLCBzdGF0ZSwgZm10KTsKIH0KIAotc3RhdGljIGludCBjeDE4X3NfZm10
X3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
Y3gxOF9zX2ZtdF9zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmZtdCkKIHsKIAlzdHJ1Y3QgY3gxOF9vcGVuX2lkICppZCA9IGZpbGUyaWQoZmlsZSk7CkBAIC0z
NjUsNyArMzc0LDcgQEAgc3RhdGljIGludCBjeDE4X3NfZm10X3NsaWNlZF92YmlfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlpbnQgcmV0OwogCXN0cnVjdCB2NGwyX3NsaWNlZF92
YmlfZm9ybWF0ICp2YmlmbXQgPSAmZm10LT5mbXQuc2xpY2VkOwogCi0JY3gxOF90cnlfZm10X3Ns
aWNlZF92YmlfY2FwKGZpbGUsIGZoLCBmbXQpOworCWN4MThfdHJ5X2ZtdF9zbGljZWRfdmJpX2Nh
cChmaWxlLCBzdGF0ZSwgZm10KTsKIAogCS8qCiAJICogQ2hhbmdpbmcgdGhlIEVuY29kZXIncyBS
YXcgVkJJIHBhcmFtZXRlcnMgd29uJ3QgaGF2ZSBhbnkgZWZmZWN0CkBAIC0zODksOCArMzk4LDgg
QEAgc3RhdGljIGludCBjeDE4X3NfZm10X3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIH0KIAogI2lmZGVmIENPTkZJR19WSURFT19BRFZfREVCVUcKLXN0YXRpYyBp
bnQgY3gxOF9nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKLQkJCQlzdHJ1
Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKK3N0YXRpYyBpbnQgY3gxOF9nX3JlZ2lzdGVyKHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAg
IHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVnKQogewogCXN0cnVjdCBjeDE4ICpjeCA9IGZp
bGUyaWQoZmlsZSktPmN4OwogCkBAIC00MDMsOCArNDEyLDggQEAgc3RhdGljIGludCBjeDE4X2df
cmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGN4MThfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCi0J
CQkJY29uc3Qgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCitzdGF0aWMgaW50IGN4MThf
c19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkgICBjb25zdCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKIHsKIAlz
dHJ1Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIApAQCAtNDE3LDcgKzQyNiw4IEBA
IHN0YXRpYyBpbnQgY3gxOF9zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IH0KICNlbmRpZgogCi1zdGF0aWMgaW50IGN4MThfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAorc3RhdGljIGludCBjeDE4X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Nh
cGFiaWxpdHkgKnZjYXApCiB7CiAJc3RydWN0IGN4MThfb3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZp
bGUpOwpAQCAtNDI5LDE0ICs0MzksMTYgQEAgc3RhdGljIGludCBjeDE4X3F1ZXJ5Y2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjeDE4
X2VudW1hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2F1ZGlv
ICp2aW4pCitzdGF0aWMgaW50IGN4MThfZW51bWF1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJfYXVkaW8gKnZp
bikKIHsKIAlzdHJ1Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIAogCXJldHVybiBj
eDE4X2dldF9hdWRpb19pbnB1dChjeCwgdmluLT5pbmRleCwgdmluKTsKIH0KIAotc3RhdGljIGlu
dCBjeDE4X2dfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9h
dWRpbyAqdmluKQorc3RhdGljIGludCBjeDE4X2dfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfYXVkaW8gKnZp
bikKIHsKIAlzdHJ1Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIApAQCAtNDQ0LDcg
KzQ1Niw4IEBAIHN0YXRpYyBpbnQgY3gxOF9nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwgc3RydWN0IHY0bDJfYXVkaW8gKnZpbikKIAlyZXR1cm4gY3gxOF9nZXRfYXVkaW9faW5w
dXQoY3gsIHZpbi0+aW5kZXgsIHZpbik7CiB9CiAKLXN0YXRpYyBpbnQgY3gxOF9zX2F1ZGlvKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW8gKnZvdXQp
CitzdGF0aWMgaW50IGN4MThfc19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQljb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyAqdm91dCkK
IHsKIAlzdHJ1Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIApAQCAtNDU1LDcgKzQ2
OCw5IEBAIHN0YXRpYyBpbnQgY3gxOF9zX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW8gKnZvCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgY3gxOF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0
bDJfaW5wdXQgKnZpbikKK3N0YXRpYyBpbnQgY3gxOF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1
Y3QgdjRsMl9pbnB1dCAqdmluKQogewogCXN0cnVjdCBjeDE4ICpjeCA9IGZpbGUyaWQoZmlsZSkt
PmN4OwogCkBAIC00NjMsOCArNDc4LDkgQEAgc3RhdGljIGludCBjeDE4X2VudW1faW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9pbnB1dCAqdmluKQogCXJldHVy
biBjeDE4X2dldF9pbnB1dChjeCwgdmluLT5pbmRleCwgdmluKTsKIH0KIAotc3RhdGljIGludCBj
eDE4X2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAotCQkJICAgICAg
aW50IHR5cGUsIHN0cnVjdCB2NGwyX2ZyYWN0ICpmKQorc3RhdGljIGludCBjeDE4X2dfcGl4ZWxh
c3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwgaW50IHR5cGUsCisJCQkgICAgICBzdHJ1Y3QgdjRsMl9mcmFjdCAqZikKIHsK
IAlzdHJ1Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIApAQCAtNDc2LDcgKzQ5Miw4
IEBAIHN0YXRpYyBpbnQgY3gxOF9nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjeDE4X2dfc2VsZWN0aW9uKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3gxOF9nX3NlbGVjdGlvbihzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCSAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsKIAlzdHJ1Y3QgY3gxOCAqY3gg
PSBmaWxlMmlkKGZpbGUpLT5jeDsKQEAgLTQ5Niw3ICs1MTMsOCBAQCBzdGF0aWMgaW50IGN4MThf
Z19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IGN4MThfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCitzdGF0aWMgaW50IGN4MThfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmZtdCkKIHsKIAlzdHJ1Y3QgY3gxOF9vcGVuX2lkICppZCA9IGZpbGUyaWQo
ZmlsZSk7CkBAIC01MTMsNyArNTMxLDggQEAgc3RhdGljIGludCBjeDE4X2VudW1fZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGN4MThfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGlu
dCAqaSkKK3N0YXRpYyBpbnQgY3gxOF9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXVuc2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1
Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIApAQCAtNTIxLDcgKzU0MCw4IEBAIHN0
YXRpYyBpbnQgY3gxOF9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWdu
ZWQgaW50ICppKQogCXJldHVybiAwOwogfQogCi1pbnQgY3gxOF9zX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGlucCkKK2ludCBjeDE4X3NfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgdW5z
aWduZWQgaW50IGlucCkKIHsKIAlzdHJ1Y3QgY3gxOF9vcGVuX2lkICppZCA9IGZpbGUyaWQoZmls
ZSk7CiAJc3RydWN0IGN4MTggKmN4ID0gaWQtPmN4OwpAQCAtNTU4LDcgKzU3OCw4IEBAIGludCBj
eDE4X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgaW5w
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGN4MThfZ19mcmVxdWVuY3koc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBjeDE4X2dfZnJlcXVlbmN5KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CXN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqdmYpCiB7CiAJc3RydWN0IGN4MTggKmN4ID0gZmlsZTJp
ZChmaWxlKS0+Y3g7CkBAIC01NzAsNyArNTkxLDggQEAgc3RhdGljIGludCBjeDE4X2dfZnJlcXVl
bmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotaW50IGN4
MThfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBjb25zdCBzdHJ1Y3Qg
djRsMl9mcmVxdWVuY3kgKnZmKQoraW50IGN4MThfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgIGNvbnN0IHN0cnVj
dCB2NGwyX2ZyZXF1ZW5jeSAqdmYpCiB7CiAJc3RydWN0IGN4MThfb3Blbl9pZCAqaWQgPSBmaWxl
MmlkKGZpbGUpOwogCXN0cnVjdCBjeDE4ICpjeCA9IGlkLT5jeDsKQEAgLTU4NSw3ICs2MDcsOCBA
QCBpbnQgY3gxOF9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0
IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqdgogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGN4
MThfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB2NGwyX3N0ZF9pZCAqc3RkKQor
c3RhdGljIGludCBjeDE4X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgKnN0ZCkKIHsKIAlzdHJ1Y3Qg
Y3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIApAQCAtNTkzLDcgKzYxNiw4IEBAIHN0YXRp
YyBpbnQgY3gxOF9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHY0bDJfc3RkX2lk
ICpzdGQpCiAJcmV0dXJuIDA7CiB9CiAKLWludCBjeDE4X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgdjRsMl9zdGRfaWQgc3RkKQoraW50IGN4MThfc19zdGQoc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCSAgICAgICB2NGwyX3N0
ZF9pZCBzdGQpCiB7CiAJc3RydWN0IGN4MThfb3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwog
CXN0cnVjdCBjeDE4ICpjeCA9IGlkLT5jeDsKQEAgLTY0Miw3ICs2NjYsOCBAQCBpbnQgY3gxOF9z
X3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHY0bDJfc3RkX2lkIHN0ZCkKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCBjeDE4X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCitzdGF0aWMgaW50IGN4MThfc190
dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQljb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCiB7CiAJc3RydWN0IGN4MThfb3Blbl9p
ZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwogCXN0cnVjdCBjeDE4ICpjeCA9IGlkLT5jeDsKQEAgLTY1
NCw3ICs2NzksOCBAQCBzdGF0aWMgaW50IGN4MThfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2dAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGN4MThfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX3R1bmVyICp2dCkKK3N0YXRpYyBpbnQgY3gxOF9nX3R1bmVyKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX3R1
bmVyICp2dCkKIHsKIAlzdHJ1Y3QgY3gxOCAqY3ggPSBmaWxlMmlkKGZpbGUpLT5jeDsKIApAQCAt
NjcwLDcgKzY5Niw4IEBAIHN0YXRpYyBpbnQgY3gxOF9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IGN4MThfZ19zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IGN4MThfZ19zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX3Ns
aWNlZF92YmlfY2FwICpjYXApCiB7CiAJc3RydWN0IGN4MTggKmN4ID0gZmlsZTJpZChmaWxlKS0+
Y3g7CkBAIC03OTEsNyArODE4LDggQEAgc3RhdGljIGludCBjeDE4X3Byb2Nlc3NfaWR4X2RhdGEo
c3RydWN0IGN4MThfc3RyZWFtICpzLCBzdHJ1Y3QgY3gxOF9tZGwgKm1kbCwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBjeDE4X2dfZW5jX2luZGV4KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgY3gxOF9nX2VuY19pbmRleChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9l
bmNfaWR4ICppZHgpCiB7CiAJc3RydWN0IGN4MTggKmN4ID0gZmlsZTJpZChmaWxlKS0+Y3g7CkBA
IC04MzgsNyArODY2LDggQEAgc3RhdGljIGludCBjeDE4X2dfZW5jX2luZGV4KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjeDE4X2VuY29k
ZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3gxOF9lbmNv
ZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9lbmNvZGVyX2NtZCAqZW5jKQogewogCXN0cnVj
dCBjeDE4X29wZW5faWQgKmlkID0gZmlsZTJpZChmaWxlKTsKQEAgLTg5Nyw3ICs5MjYsOCBAQCBz
dGF0aWMgaW50IGN4MThfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGN4MThfdHJ5X2VuY29kZXJfY21kKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3gxOF90cnlfZW5jb2Rlcl9jbWQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmVuYykKIHsKIAlzdHJ1Y3QgY3gxOCAqY3ggPSBm
aWxlMmlkKGZpbGUpLT5jeDsKQEAgLTkzMCw3ICs5NjAsOCBAQCBzdGF0aWMgaW50IGN4MThfdHJ5
X2VuY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBjeDE4X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
KQorc3RhdGljIGludCBjeDE4X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgY3gxOCAqY3ggPSBm
aWxlMmlkKGZpbGUpLT5jeDsKIAlzdHJ1Y3QgdjRsMl9pbnB1dCB2aWRpbjsKQEAgLTk3Myw3ICsx
MDA0LDggQEAgc3RhdGljIGludCBjeDE4X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgbG9uZyBjeDE4X2RlZmF1bHQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBib29sIHZhbGlkX3ByaW8sCitzdGF0aWMgbG9uZyBjeDE4
X2RlZmF1bHQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJIGJvb2wgdmFsaWRfcHJpbywKIAkJCSB1bnNpZ25lZCBpbnQgY21kLCB2b2lkICph
cmcpCiB7CiAJc3RydWN0IGN4MTggKmN4ID0gZmlsZTJpZChmaWxlKS0+Y3g7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL21lZGlhL3BjaS9jeDE4L2N4MTgtaW9jdGwuaCBiL2RyaXZlcnMvbWVkaWEvcGNp
L2N4MTgvY3gxOC1pb2N0bC5oCmluZGV4IDk3Y2Q5Zjk5ZTIyZDk2NzZkNDI3YTdlOWUxMmZiNTcy
YTkxYjJhODIuLjYyYzEyMzgwMjFkNDI0MTlhMGQwZWY3YjUyMGQzZTAyMGIzYjFmNmUgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGNpL2N4MTgvY3gxOC1pb2N0bC5oCisrKyBiL2RyaXZlcnMv
bWVkaWEvcGNpL2N4MTgvY3gxOC1pb2N0bC5oCkBAIC0xMiw2ICsxMiw5IEBAIHUxNiBjeDE4X3Nl
cnZpY2UydmJpKGludCB0eXBlKTsKIHZvaWQgY3gxOF9leHBhbmRfc2VydmljZV9zZXQoc3RydWN0
IHY0bDJfc2xpY2VkX3ZiaV9mb3JtYXQgKmZtdCwgaW50IGlzX3BhbCk7CiB1MTYgY3gxOF9nZXRf
c2VydmljZV9zZXQoc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9mb3JtYXQgKmZtdCk7CiB2b2lkIGN4
MThfc2V0X2Z1bmNzKHN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYpOwotaW50IGN4MThfc19zdGQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB2NGwyX3N0ZF9pZCBzdGQpOwotaW50IGN4MThf
c19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBjb25zdCBzdHJ1Y3QgdjRs
Ml9mcmVxdWVuY3kgKnZmKTsKLWludCBjeDE4X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCB1bnNpZ25lZCBpbnQgaW5wKTsKK2ludCBjeDE4X3Nfc3RkKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkgICAgICAgdjRsMl9zdGRf
aWQgc3RkKTsKK2ludCBjeDE4X3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVx
dWVuY3kgKnZmKTsKK2ludCBjeDE4X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgdW5zaWduZWQgaW50IGlucCk7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUtNDE3LmMgYi9kcml2ZXJzL21l
ZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUtNDE3LmMKaW5kZXggMjE5OTM3YTE1M2IzYWVkMjA2MDkx
NTc5ZmZmYmQwNzg0MGNhMGMzYS4uN2QwODBlOTdiZjQ2MGMyYzg5YzgzMzkzNmQ2ZDZkZTViNjQ1
NDQxNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvY3gyMzg4NS9jeDIzODg1LTQxNy5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL2N4MjM4ODUvY3gyMzg4NS00MTcuYwpAQCAtMTIxNiw3
ICsxMjE2LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIGN4MjM4ODVfcW9wcyA9IHsK
IAogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tICovCiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqaWQpCitzdGF0aWMgaW50IHZpZGlvY19n
X3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQl2NGwyX3N0ZF9pZCAqaWQpCiB7CiAJc3RydWN0IGN4MjM4ODVfZGV2ICpkZXYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMjI0LDcgKzEyMjUsOCBAQCBzdGF0aWMgaW50IHZpZGlv
Y19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKmlkKQog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgaWQpCitzdGF0aWMgaW50IHZpZGlvY19zX3N0ZChz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQl2
NGwyX3N0ZF9pZCBpZCkKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAJdW5zaWduZWQgaW50IGk7CkBAIC0xMjQyLDI1ICsxMjQ0LDI4IEBAIHN0YXRp
YyBpbnQgdmlkaW9jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0
ZF9pZCBpZCkKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCXN0cnVjdCB2NGwyX2lucHV0ICppKQor
c3RhdGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2lucHV0ICppKQog
ewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlkcHJp
bnRrKDEsICIlcygpXG4iLCBfX2Z1bmNfXyk7CiAJcmV0dXJuIGN4MjM4ODVfZW51bV9pbnB1dChk
ZXYsIGkpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CSAgdW5zaWduZWQgaW50ICppKQogewotCXJldHVybiBjeDIzODg1X2dldF9pbnB1dChmaWxlLCBw
cml2LCBpKTsKKwlyZXR1cm4gY3gyMzg4NV9nZXRfaW5wdXQoZmlsZSwgc3RhdGUsIGkpOwogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCB1bnNpZ25lZCBpbnQgaSkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBp
bnQgaSkKIHsKLQlyZXR1cm4gY3gyMzg4NV9zZXRfaW5wdXQoZmlsZSwgcHJpdiwgaSk7CisJcmV0
dXJuIGN4MjM4ODVfc2V0X2lucHV0KGZpbGUsIHN0YXRlLCBpKTsKIH0KIAotc3RhdGljIGludCB2
aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
dmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBj
eDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEyNzcsNyArMTI4Miw4
IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlj
b25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdCkKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMjkxLDcgKzEyOTcsOCBAQCBzdGF0aWMgaW50IHZp
ZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0
IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTEzMDYsMTMgKzEzMTMsMTQgQEAgc3RhdGljIGludCB2aWRpb2Nf
Z19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAotCWNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKK3N0YXRpYyBpbnQgdmlk
aW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKIHsK
LQlyZXR1cm4gY3gyMzg4NV9zZXRfZnJlcXVlbmN5KGZpbGUsIHByaXYsIGYpOworCXJldHVybiBj
eDIzODg1X3NldF9mcmVxdWVuY3koZmlsZSwgc3RhdGUsIGYpOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50
IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsK
IAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzMx
LDcgKzEzMzksOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1f
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB2
aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZikK
IHsKIAlpZiAoZi0+aW5kZXggIT0gMCkKQEAgLTEzNDIsNyArMTM1MSw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4MjM4ODVfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTM2MCw3ICsxMzcwLDggQEAgc3RhdGljIGludCB2
aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEzNzYsNyArMTM4Nyw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEzOTIsNyArMTQwNCw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYpCitzdGF0aWMgaW50IHZpZGlvY19sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1
Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJY2hhciBuYW1lWzMy
ICsgMl07CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUtaW9j
dGwuYyBiL2RyaXZlcnMvbWVkaWEvcGNpL2N4MjM4ODUvY3gyMzg4NS1pb2N0bC5jCmluZGV4IGE4
Y2NhZDA3Y2Y1MDMwMzg5NWExNGUyOTc1MWIzOWE4YzM2NWZhMTcuLmUxNTRiNjc3N2ZkZGVlZmJh
YzA0MWE0ZTA0YzE2NDU3NGQ2NTA3OWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGNpL2N4
MjM4ODUvY3gyMzg4NS1pb2N0bC5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL2N4MjM4ODUvY3gy
Mzg4NS1pb2N0bC5jCkBAIC0xMSw4ICsxMSw4IEBACiAjaW5jbHVkZSAiY3gyMzg4NS1pb2N0bC5o
IgogCiAjaWZkZWYgQ09ORklHX1ZJREVPX0FEVl9ERUJVRwotaW50IGN4MjM4ODVfZ19jaGlwX2lu
Zm8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAotCQkJIHN0cnVjdCB2NGwyX2RiZ19jaGlw
X2luZm8gKmNoaXApCitpbnQgY3gyMzg4NV9nX2NoaXBfaW5mbyhzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl9kYmdfY2hp
cF9pbmZvICpjaGlwKQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIApAQCAtNDcsNyArNDcsNyBAQCBzdGF0aWMgaW50IGN4MjM0MTdfZ19yZWdpc3Rl
cihzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IGN4MjM4ODVf
Z19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitpbnQgY3gyMzg4NV9nX3Jl
Z2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJICAgICAgIHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVnKQogewogCXN0cnVjdCBj
eDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc5LDcgKzc5LDcgQEAg
c3RhdGljIGludCBjeDIzNDE3X3NfcmVnaXN0ZXIoc3RydWN0IGN4MjM4ODVfZGV2ICpkZXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLWludCBjeDIzODg1X3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAoraW50IGN4MjM4ODVfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCSAgICAgICBjb25zdCBzdHJ1Y3QgdjRs
Ml9kYmdfcmVnaXN0ZXIgKnJlZykKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4
MjM4ODUtaW9jdGwuaCBiL2RyaXZlcnMvbWVkaWEvcGNpL2N4MjM4ODUvY3gyMzg4NS1pb2N0bC5o
CmluZGV4IDE0YmZlOWU0ZWMyNjRmMzhmMTk4NjRlYTM0MjI5YzljOGE0ZTdlZDAuLjg5YzdiZmUw
ZWMxNmQ5ZmRiMDU2ZjgxNWFkZDA5YzI0Y2M0MWU4NDYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVk
aWEvcGNpL2N4MjM4ODUvY3gyMzg4NS1pb2N0bC5oCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL2N4
MjM4ODUvY3gyMzg4NS1pb2N0bC5oCkBAIC0xMCwxNSArMTAsMTQgQEAKICNpZm5kZWYgX0NYMjM4
ODVfSU9DVExfSF8KICNkZWZpbmUgX0NYMjM4ODVfSU9DVExfSF8KIAotaW50IGN4MjM4ODVfZ19j
aGlwX2luZm8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAotCQkJIHN0cnVjdCB2NGwyX2Ri
Z19jaGlwX2luZm8gKmNoaXApOworaW50IGN4MjM4ODVfZ19jaGlwX2luZm8oc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJf
ZGJnX2NoaXBfaW5mbyAqY2hpcCk7CiAKICNpZmRlZiBDT05GSUdfVklERU9fQURWX0RFQlVHCi1p
bnQgY3gyMzg4NV9nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK2ludCBj
eDIzODg1X2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkgICAgICAgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpOwog
Ci0KLWludCBjeDIzODg1X3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAor
aW50IGN4MjM4ODVfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCSAgICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0
ZXIgKnJlZyk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvY3gyMzg4
NS9jeDIzODg1LXZiaS5jIGIvZHJpdmVycy9tZWRpYS9wY2kvY3gyMzg4NS9jeDIzODg1LXZiaS5j
CmluZGV4IDQwODE3Y2M1MmZjMWVlMjU2YmU4NjMxOTYzOGQwZDI2MTE2ZTUxYzAuLjA0OWFhMGQ0
MzU5Y2Y3ODlkZGYzOTU1MzQ3ZDMwYTYzNmRhMWM3ZTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVk
aWEvcGNpL2N4MjM4ODUvY3gyMzg4NS12YmkuYworKysgYi9kcml2ZXJzL21lZGlhL3BjaS9jeDIz
ODg1L2N4MjM4ODUtdmJpLmMKQEAgLTMyLDkgKzMyLDggQEAgTU9EVUxFX1BBUk1fREVTQyh2Ymlf
ZGVidWcsICJlbmFibGUgZGVidWcgbWVzc2FnZXMgW3ZiaV0iKTsKICNkZWZpbmUgVkJJX05UU0Nf
TElORV9DT1VOVCAxMgogI2RlZmluZSBWQklfUEFMX0xJTkVfQ09VTlQgMTgKIAotCi1pbnQgY3gy
Mzg4NV92YmlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKK2ludCBjeDIzODg1X3ZiaV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApk
aWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvY3gyMzg4NS9jeDIzODg1LXZpZGVvLmMgYi9k
cml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUtdmlkZW8uYwppbmRleCAxNGQyMTlmZDFk
OGEwYTVmOTY0YjZjMTgyYzE2N2I2M2YzZjQ1YTUxLi45ZDllMTc1MDliMjZlM2I5YzBkMmM2ZDkx
NjIwYzM2NjdlZDI4OWMwIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4
MjM4ODUtdmlkZW8uYworKysgYi9kcml2ZXJzL21lZGlhL3BjaS9jeDIzODg1L2N4MjM4ODUtdmlk
ZW8uYwpAQCAtNTI3LDggKzUyNyw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBjeDIz
ODg1X3ZpZGVvX3FvcHMgPSB7CiAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KIC8qIFZJREVPIElPQ1RMUyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLwogCi1z
dGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAotCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTU0NSw4ICs1NDUsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCi0Jc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGlu
dCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGN4
MjM4ODVfZm10ICpmbXQ7CkBAIC01OTMsOCArNTkzLDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAotCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX3Nf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9k
ZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0bDJfc3ViZGV2X2Zvcm1h
dCBmb3JtYXQgPSB7CkBAIC02MDMsNyArNjAzLDcgQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlpbnQgZXJyOwogCiAJZHBy
aW50aygyLCAiJXMoKVxuIiwgX19mdW5jX18pOwotCWVyciA9IHZpZGlvY190cnlfZm10X3ZpZF9j
YXAoZmlsZSwgcHJpdiwgZik7CisJZXJyID0gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBz
dGF0ZSwgZik7CiAKIAlpZiAoMCAhPSBlcnIpCiAJCXJldHVybiBlcnI7CkBAIC02MjYsOCArNjI2
LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAotCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkg
KmNhcCkKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2NhcGFiaWxp
dHkgKmNhcCkKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKQEAgLTY1NCw4ICs2NTQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAot
CXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmICh1bmxpa2VseShmLT5pbmRl
eCA+PSBBUlJBWV9TSVpFKGZvcm1hdHMpKSkKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC02NjUsOCAr
NjY1LDkgQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2df
cGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJaW50IHR5cGUs
IHN0cnVjdCB2NGwyX2ZyYWN0ICpmKQorc3RhdGljIGludCB2aWRpb2NfZ19waXhlbGFzcGVjdChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwg
aW50IHR5cGUsCisJCQkJc3RydWN0IHY0bDJfZnJhY3QgKmYpCiB7CiAJc3RydWN0IGN4MjM4ODVf
ZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWJvb2wgaXNfNTBoeiA9IGRldi0+dHZu
b3JtICYgVjRMMl9TVERfNjI1XzUwOwpAQCAtNjgwLDcgKzY4MSw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAg
ICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC03MDIsNyArNzA0LDggQEAgc3RhdGljIGludCB2
aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgdjRsMl9zdGRfaWQgKmlkKQorc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRf
aWQgKmlkKQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKIAlkcHJpbnRrKDEsICIlcygpXG4iLCBfX2Z1bmNfXyk7CkBAIC03MTEsNyArNzE0LDggQEAg
c3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0
bDJfc3RkX2lkICppZCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19zdGQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIHR2bm9ybXMpCitzdGF0
aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQl2NGwyX3N0ZF9pZCB0dm5vcm1zKQogewogCXN0cnVjdCBjeDIz
ODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlkcHJpbnRrKDEsICIlcygpXG4i
LCBfX2Z1bmNfXyk7CkBAIC03NjgsNyArNzcyLDggQEAgaW50IGN4MjM4ODVfZW51bV9pbnB1dChz
dHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiwgc3RydWN0IHY0bDJfaW5wdXQgKmkpCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3Qg
djRsMl9pbnB1dCAqaSkKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC03ODUsOSArNzkwLDEwIEBAIGludCBjeDIzODg1X2dldF9pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWdu
ZWQgaW50ICppKQogewotCXJldHVybiBjeDIzODg1X2dldF9pbnB1dChmaWxlLCBwcml2LCBpKTsK
KwlyZXR1cm4gY3gyMzg4NV9nZXRfaW5wdXQoZmlsZSwgc3RhdGUsIGkpOwogfQogCiBpbnQgY3gy
Mzg4NV9zZXRfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGlu
dCBpKQpAQCAtODEyLDEyICs4MTgsMTQgQEAgaW50IGN4MjM4ODVfc2V0X2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
dW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50
IGkpCiB7Ci0JcmV0dXJuIGN4MjM4ODVfc2V0X2lucHV0KGZpbGUsIHByaXYsIGkpOworCXJldHVy
biBjeDIzODg1X3NldF9pbnB1dChmaWxlLCBzdGF0ZSwgaSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYpCitzdGF0aWMgaW50
IHZpZGlvY19sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRldiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTg0OCwxNCArODU2LDE1IEBAIHN0YXRpYyBpbnQgY3gy
Mzg4NV9xdWVyeV9hdWRpbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2F1ZGlucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9hdWRpbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRs
Ml9hdWRpbyAqaSkKIHsKLQlyZXR1cm4gY3gyMzg4NV9xdWVyeV9hdWRpbnB1dChmaWxlLCBwcml2
LCBpKTsKKwlyZXR1cm4gY3gyMzg4NV9xdWVyeV9hdWRpbnB1dChmaWxlLCBzdGF0ZSwgaSk7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfYXVkaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCi0Jc3RydWN0IHY0bDJfYXVkaW8gKmkpCitzdGF0aWMgaW50IHZpZGlvY19nX2F1ZGlu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwgc3RydWN0IHY0bDJfYXVkaW8gKmkpCiB7CiAJc3RydWN0IGN4MjM4ODVfZGV2ICpk
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC04NjYsMTEgKzg3NSwxMSBAQCBzdGF0aWMg
aW50IHZpZGlvY19nX2F1ZGlucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCQlp
LT5pbmRleCA9IGRldi0+YXVkaW5wdXQ7CiAJZHByaW50aygxLCAiJXMoaW5wdXQ9JWQpXG4iLCBf
X2Z1bmNfXywgaS0+aW5kZXgpOwogCi0JcmV0dXJuIGN4MjM4ODVfcXVlcnlfYXVkaW5wdXQoZmls
ZSwgcHJpdiwgaSk7CisJcmV0dXJuIGN4MjM4ODVfcXVlcnlfYXVkaW5wdXQoZmlsZSwgc3RhdGUs
IGkpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2F1ZGlucHV0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAotCWNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlvICppKQorc3RhdGljIGludCB2
aWRpb2Nfc19hdWRpbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsIGNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlvICppKQogewogCXN0
cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtODkxLDcg
KzkwMCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfYXVkaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVy
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQlzdHJ1Y3QgdjRsMl90dW5lciAqdCkKIHsKIAlzdHJ1Y3QgY3gyMzg4NV9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05MTYsNyArOTI2LDggQEAgc3RhdGljIGludCB2
aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwy
X3R1bmVyICp0KQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKQEAgLTk0MCw3ICs5NTEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpm
KQogewogCXN0cnVjdCBjeDIzODg1X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAg
LTEwOTAsMTAgKzExMDIsMTAgQEAgaW50IGN4MjM4ODVfc2V0X2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQljb25zdCBzdHJ1
Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCitzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LCBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7Ci0JcmV0dXJuIGN4MjM4ODVfc2V0
X2ZyZXF1ZW5jeShmaWxlLCBwcml2LCBmKTsKKwlyZXR1cm4gY3gyMzg4NV9zZXRfZnJlcXVlbmN5
KGZpbGUsIHN0YXRlLCBmKTsKIH0KIAogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcGNpL2N4MjM4ODUvY3gyMzg4NS5oIGIvZHJpdmVycy9tZWRpYS9wY2kvY3gyMzg4NS9jeDIz
ODg1LmgKaW5kZXggOGJhMWYzMDYyMzhjYjNjMTM2YzFmYmFlOGQyOWI1ODFhZWI1NjZlNS4uOWEw
ZDUwYWM4MzY5NTNiMzQ2MGQzOWQwZGJhMzMyNmUwYmE5ZGZhYiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9tZWRpYS9wY2kvY3gyMzg4NS9jeDIzODg1LmgKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvY3gy
Mzg4NS9jeDIzODg1LmgKQEAgLTU4NSw4ICs1ODUsOCBAQCBpbnQgY3gyMzg4NV9zZXRfdHZub3Jt
KHN0cnVjdCBjeDIzODg1X2RldiAqZGV2LCB2NGwyX3N0ZF9pZCBub3JtKTsKIAogLyogLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8K
IC8qIGN4MjM4ODUtdmJpLmMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICovCi1leHRlcm4gaW50IGN4MjM4ODVfdmJpX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKLQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IGN4MjM4ODVfdmJpX2Zt
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwogZXh0ZXJuIHZvaWQgY3gyMzg4NV92YmlfdGlt
ZW91dCh1bnNpZ25lZCBsb25nIGRhdGEpOwogZXh0ZXJuIGNvbnN0IHN0cnVjdCB2YjJfb3BzIGN4
MjM4ODVfdmJpX3FvcHM7CiBleHRlcm4gaW50IGN4MjM4ODVfdmJpX2lycShzdHJ1Y3QgY3gyMzg4
NV9kZXYgKmRldiwgdTMyIHN0YXR1cyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9j
eDI1ODIxL2N4MjU4MjEtdmlkZW8uYyBiL2RyaXZlcnMvbWVkaWEvcGNpL2N4MjU4MjEvY3gyNTgy
MS12aWRlby5jCmluZGV4IDg0YWExMjA5ZTcxNzFlY2M1NDFhNzY0ZmVhMDY0ZTAzMWNlMmJiNmUu
Ljc4MzZlNDQwOTAxMjJmMmM2NzVhMzA5OGRmZWQyYzk1NGQ1YzljMTEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvbWVkaWEvcGNpL2N4MjU4MjEvY3gyNTgyMS12aWRlby5jCisrKyBiL2RyaXZlcnMvbWVk
aWEvcGNpL2N4MjU4MjEvY3gyNTgyMS12aWRlby5jCkBAIC0zMDEsNyArMzAxLDggQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCB2YjJfb3BzIGN4MjU4MjFfdmlkZW9fcW9wcyA9IHsKIAogLyogVklERU8g
SU9DVExTICovCiAKLXN0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2NfZW51bV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2Nf
ZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsK
IAlpZiAodW5saWtlbHkoZi0+aW5kZXggPj0gQVJSQVlfU0laRShmb3JtYXRzKSkpCkBAIC0zMTIs
NyArMzEzLDggQEAgc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGN4MjU4MjFfdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IGN4MjU4MjFfdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4MjU4MjFfY2hhbm5lbCAqY2hhbiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zMjgsNyArMzMwLDggQEAgc3RhdGljIGludCBjeDI1ODIx
X3ZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IGN4MjU4MjFfdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2Nf
dHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgY3gyNTgyMV9jaGFubmVsICpjaGFuID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTM2
Niw3ICszNjksOCBAQCBzdGF0aWMgaW50IGN4MjU4MjFfdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCBjeDI1ODIxX2NoYW5uZWwgKmNoYW4gPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtMzc0LDcgKzM3OCw3IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaW50IHBpeF9mb3JtYXQgPSBQSVhFTF9GUk1U
XzQyMjsKIAlpbnQgZXJyOwogCi0JZXJyID0gY3gyNTgyMV92aWRpb2NfdHJ5X2ZtdF92aWRfY2Fw
KGZpbGUsIHByaXYsIGYpOworCWVyciA9IGN4MjU4MjFfdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChm
aWxlLCBzdGF0ZSwgZik7CiAKIAlpZiAoMCAhPSBlcnIpCiAJCXJldHVybiBlcnI7CkBAIC00MDIs
NyArNDA2LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfbG9n
X3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdikKK3N0YXRpYyBpbnQgdmlkaW9j
X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlKQogewogCXN0cnVjdCBjeDI1ODIxX2NoYW5uZWwgKmNoYW4gPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBjeDI1ODIxX2RldiAqZGV2ID0gY2hhbi0+ZGV2OwpA
QCAtNDE2LDcgKzQyMSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2xvZ19zdGF0dXMoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYpCiB9CiAKIAotc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY19x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY3gyNTgy
MV92aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2Fw
KQogewogCXN0cnVjdCBjeDI1ODIxX2NoYW5uZWwgKmNoYW4gPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtNDMxLDcgKzQzNyw5IEBAIHN0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2NfcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgY3gyNTgyMV92aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0
bDJfc3RkX2lkICp0dm5vcm1zKQorc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY19nX3N0ZChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CQl2NGwyX3N0ZF9pZCAqdHZub3JtcykKIHsKIAlzdHJ1Y3QgY3gyNTgyMV9jaGFubmVsICpjaGFu
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtNDM5LDcgKzQ0Nyw4IEBAIHN0YXRpYyBpbnQg
Y3gyNTgyMV92aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJf
c3RkX2lkICp0dm5vCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2Nf
c19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGN4MjU4MjFf
dmlkaW9jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCXY0bDJfc3RkX2lkIHR2bm9ybXMpCiB7CiAJc3RydWN0IGN4MjU4
MjFfY2hhbm5lbCAqY2hhbiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00NTcsNyArNDY2LDgg
QEAgc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY19lbnVt
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjeDI1ODIx
X3ZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkK
IHsKIAlpZiAoaS0+aW5kZXgpCkBAIC00NjksMTMgKzQ3OSwxNyBAQCBzdGF0aWMgaW50IGN4MjU4
MjFfdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCBjeDI1ODIx
X3ZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJKmkgPSAwOwog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGN4MjU4MjFfdmlkaW9jX3NfaW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBjeDI1
ODIxX3ZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlyZXR1cm4g
aSA/IC1FSU5WQUwgOiAwOwogfQpAQCAtNTA1LDcgKzUxOSw4IEBAIHN0YXRpYyBpbnQgY3gyNTgy
MV9zX2N0cmwoc3RydWN0IHY0bDJfY3RybCAqY3RybCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBjeDI1ODIxX3ZpZGlvY19lbnVtX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2NfZW51bV9vdXRwdXQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICAgICBzdHJ1Y3QgdjRsMl9vdXRwdXQgKm8pCiB7CiAJaWYgKG8tPmluZGV4KQpAQCAtNTE3LDE4
ICs1MzIsMjMgQEAgc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY19lbnVtX291dHB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjeDI1
ODIxX3ZpZGlvY19nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWdu
ZWQgaW50ICpvKQorc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY19nX291dHB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkg
ICB1bnNpZ25lZCBpbnQgKm8pCiB7CiAJKm8gPSAwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGN4MjU4MjFfdmlkaW9jX3Nfb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCB1bnNpZ25lZCBpbnQgbykKK3N0YXRpYyBpbnQgY3gyNTgyMV92aWRpb2Nfc19vdXRwdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkJICAgdW5zaWduZWQgaW50IG8pCiB7CiAJcmV0dXJuIG8gPyAtRUlOVkFMIDogMDsKIH0K
IAotc3RhdGljIGludCBjeDI1ODIxX3ZpZGlvY190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGN4MjU4MjFfdmlkaW9jX3RyeV9mbXRfdmlk
X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4MjU4
MjFfY2hhbm5lbCAqY2hhbiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01NDcsMTMgKzU2Nywx
NCBAQCBzdGF0aWMgaW50IGN4MjU4MjFfdmlkaW9jX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
c19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
dmlkaW9jX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0
cnVjdCBjeDI1ODIxX2NoYW5uZWwgKmNoYW4gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWludCBl
cnI7CiAKLQllcnIgPSBjeDI1ODIxX3ZpZGlvY190cnlfZm10X3ZpZF9vdXQoZmlsZSwgcHJpdiwg
Zik7CisJZXJyID0gY3gyNTgyMV92aWRpb2NfdHJ5X2ZtdF92aWRfb3V0KGZpbGUsIHN0YXRlLCBm
KTsKIAogCWlmICgwICE9IGVycikKIAkJcmV0dXJuIGVycjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
bWVkaWEvcGNpL2N4ODgvY3g4OC1ibGFja2JpcmQuYyBiL2RyaXZlcnMvbWVkaWEvcGNpL2N4ODgv
Y3g4OC1ibGFja2JpcmQuYwppbmRleCAxM2I4Y2M0NjgzNWIyY2I1YTg0NDA1Y2RiN2ZhMjFkMzU2
NzVmNTUyLi4xNDlmMTlmNmNlZjI3ZmU5MzQ4M2NhNWVkZTg1NzU3ZTkwYjk3M2VjIDEwMDY0NAot
LS0gYS9kcml2ZXJzL21lZGlhL3BjaS9jeDg4L2N4ODgtYmxhY2tiaXJkLmMKKysrIGIvZHJpdmVy
cy9tZWRpYS9wY2kvY3g4OC9jeDg4LWJsYWNrYmlyZC5jCkBAIC03ODcsNyArNzg3LDggQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIGJsYWNrYmlyZF9xb3BzID0gewogCiAvKiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0gKi8KIAotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2
NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgY3g4ODAyX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTc5Nyw3ICs3OTgsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVy
eWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIGN4ODhfcXVlcnlj
YXAoZmlsZSwgY29yZSwgY2FwKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19l
bnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJ
aWYgKGYtPmluZGV4ICE9IDApCkBAIC04MDcsNyArODA5LDggQEAgc3RhdGljIGludCB2aWRpb2Nf
ZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY3g4ODAyX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTgyMyw3ICs4MjYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY3g4ODAyX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTg2Myw3ICs4NjcsOCBAQCBzdGF0aWMgaW50IHZpZGlvY190cnlf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY3g4ODAyX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTg3NCw3ICs4NzksNyBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCWlmIChjb3JlLT52NGxkZXYgJiYg
KHZiMl9pc19idXN5KCZjb3JlLT52NGxkZXYtPnZiMl92aWRxKSB8fAogCQkJICAgICB2YjJfaXNf
YnVzeSgmY29yZS0+djRsZGV2LT52YjJfdmJpcSkpKQogCQlyZXR1cm4gLUVCVVNZOwotCXZpZGlv
Y190cnlfZm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwgZik7CisJdmlkaW9jX3RyeV9mbXRfdmlkX2Nh
cChmaWxlLCBzdGF0ZSwgZik7CiAJY29yZS0+d2lkdGggPSBmLT5mbXQucGl4LndpZHRoOwogCWNv
cmUtPmhlaWdodCA9IGYtPmZtdC5waXguaGVpZ2h0OwogCWNvcmUtPmZpZWxkID0gZi0+Zm10LnBp
eC5maWVsZDsKQEAgLTg4NSw3ICs4OTAsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBjb25zdCBzdHJ1
Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGN4ODgwMl9kZXYgKmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC05MDgsNyArOTE0LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19m
cmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYpCitzdGF0aWMgaW50IHZpZGlvY19sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgY3g4ODAy
X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgY3g4OF9jb3JlICpjb3Jl
ID0gZGV2LT5jb3JlOwpAQCAtOTIwLDcgKzkyNyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2xvZ19z
dGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJf
aW5wdXQgKmkpCiB7CiAJc3RydWN0IGN4ODgwMl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC05MjksNyArOTM3LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gY3g4OF9lbnVtX2lucHV0KGNvcmUs
IGkpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICAgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGN4ODgwMl9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05NDYsNyArOTU1LDggQEAgc3RhdGljIGludCB2
aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKK3N0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1
bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IGN4ODgwMl9kZXYgKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAJc3RydWN0IGN4ODhfY29yZSAqY29yZSA9IGRldi0+Y29yZTsKQEAgLTk1NSw3
ICs5NjUsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGlu
dCBpKQorc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCBpKQogewogCXN0
cnVjdCBjeDg4MDJfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBjeDg4
X2NvcmUgKmNvcmUgPSBkZXYtPmNvcmU7CkBAIC05NzAsNyArOTgxLDggQEAgc3RhdGljIGludCB2
aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50
IGkpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
c3RydWN0IHY0bDJfdHVuZXIgKnQpCiB7CiAJc3RydWN0IGN4ODgwMl9kZXYgKmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC05OTMsNyArMTAwNSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2df
dHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIg
KnQpCiB7CiAJc3RydWN0IGN4ODgwMl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xMDA4LDcgKzEwMjEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19n
X3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKnR2bm9ybSkK
K3N0YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3RkX2lkICp0dm5vcm0pCiB7CiAJc3RydWN0
IGN4ODgwMl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGN4ODhfY29y
ZSAqY29yZSA9IGRldi0+Y29yZTsKQEAgLTEwMTcsNyArMTAzMSw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqdHZu
b3JtKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgaWQpCitzdGF0aWMgaW50IHZpZGlvY19z
X3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQl2NGwyX3N0ZF9pZCBpZCkKIHsKIAlzdHJ1Y3QgY3g4ODAyX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgY3g4OF9jb3JlICpjb3JlID0gZGV2LT5jb3JlOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvY3g4OC9jeDg4LXZiaS5jIGIvZHJpdmVycy9tZWRp
YS9wY2kvY3g4OC9jeDg4LXZiaS5jCmluZGV4IGUzZTM3OWU2ZjYyMDdiNmViZjA4MzI3MjYzZDcw
ODdmNTEyMmQyMzYuLjRkNzAyYWNkZmE3NWE4YTk1NTU0ZDBiN2Y5N2QxMWJkN2E5ZDI1YzMgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGNpL2N4ODgvY3g4OC12YmkuYworKysgYi9kcml2ZXJz
L21lZGlhL3BjaS9jeDg4L2N4ODgtdmJpLmMKQEAgLTIwLDcgKzIwLDcgQEAgTU9EVUxFX1BBUk1f
REVTQyh2YmlfZGVidWcsICJlbmFibGUgZGVidWcgbWVzc2FnZXMgW3ZiaV0iKTsKIAogLyogLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tICovCiAKLWludCBjeDg4MDBfdmJpX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK2ludCBjeDg4MDBfdmJpX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgY3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbWVkaWEvcGNpL2N4ODgvY3g4OC12aWRlby5jIGIvZHJpdmVycy9tZWRpYS9wY2kv
Y3g4OC9jeDg4LXZpZGVvLmMKaW5kZXggMGM4NzMyNzY4OWQzZjY2OTI0MWJmYzExY2EwN2Y3MjEw
ZjYwM2EzNi4uODI4OGUyYWE4ZDYxZjU4MjY4NDk4NTZmZDYyZDA2NzBmNmU5NjUwOSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvY3g4OC9jeDg4LXZpZGVvLmMKKysrIGIvZHJpdmVycy9t
ZWRpYS9wY2kvY3g4OC9jeDg4LXZpZGVvLmMKQEAgLTcwMSw3ICs3MDEsOCBAQCBzdGF0aWMgaW50
IGN4ODgwMF9zX2F1ZF9jdHJsKHN0cnVjdCB2NGwyX2N0cmwgKmN0cmwpCiAvKiAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0g
Ki8KIC8qIFZJREVPIElPQ1RMUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAqLwogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4ODgwMF9kZXYg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC03MTksNyArNzIwLDggQEAgc3RhdGljIGlu
dCB2aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4ODgwMF9kZXYg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC03NjUsMTIgKzc2NywxMyBAQCBzdGF0aWMg
aW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY3g4ODAwX2RldiAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgY3g4OF9jb3JlICpjb3JlID0gZGV2LT5j
b3JlOwotCWludCBlcnIgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHByaXYsIGYpOwor
CWludCBlcnIgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAogCWlm
IChlcnIgIT0gMCkKIAkJcmV0dXJuIGVycjsKQEAgLTgwMCw3ICs4MDMsOCBAQCBpbnQgY3g4OF9x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IGN4ODhfY29yZSAqY29yZSwKIH0KIEVY
UE9SVF9TWU1CT0woY3g4OF9xdWVyeWNhcCk7CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGN4
ODgwMF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04MTAsNyArODE0LDggQEAg
c3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2
LAogCXJldHVybiBjeDg4X3F1ZXJ5Y2FwKGZpbGUsIGNvcmUsIGNhcCk7CiB9CiAKLXN0YXRpYyBp
bnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2
LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmKQogewogCWlmICh1bmxpa2VseShmLT5pbmRleCA+PSBBUlJBWV9TSVpF
KGZvcm1hdHMpKSkKQEAgLTgyMSw3ICs4MjYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHY0bDJfc3RkX2lkICp0dm5vcm0pCitzdGF0aWMgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQl2NGwyX3N0ZF9p
ZCAqdHZub3JtKQogewogCXN0cnVjdCBjeDg4MDBfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwogCXN0cnVjdCBjeDg4X2NvcmUgKmNvcmUgPSBkZXYtPmNvcmU7CkBAIC04MzAsNyArODM2
LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHY0bDJfc3RkX2lkICp0dm5vcm0pCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCB0dm5v
cm1zKQorc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRfaWQgdHZub3JtcykKIHsKIAlz
dHJ1Y3QgY3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgY3g4
OF9jb3JlICpjb3JlID0gZGV2LT5jb3JlOwpAQCAtODY5LDcgKzg3Niw4IEBAIGludCBjeDg4X2Vu
dW1faW5wdXQoc3RydWN0IGN4ODhfY29yZSAgKmNvcmUsIHN0cnVjdCB2NGwyX2lucHV0ICppKQog
fQogRVhQT1JUX1NZTUJPTChjeDg4X2VudW1faW5wdXQpOwogCi1zdGF0aWMgaW50IHZpZGlvY19l
bnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRp
b2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2lucHV0ICppKQogewogCXN0
cnVjdCBjeDg4MDBfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODc4LDcgKzg4
Niw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIGN4ODhfZW51bV9pbnB1dChjb3JlLCBpKTsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWdu
ZWQgaW50ICppKQorc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCAqaSkK
IHsKIAlzdHJ1Y3QgY3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1
Y3QgY3g4OF9jb3JlICpjb3JlID0gZGV2LT5jb3JlOwpAQCAtODg3LDcgKzg5Niw4IEBAIHN0YXRp
YyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2ln
bmVkIGludCAqaSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50
IHZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50IGkpCiB7CiAJc3RydWN0IGN4ODgwMF9kZXYg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGN4ODhfY29yZSAqY29yZSA9IGRl
di0+Y29yZTsKQEAgLTkwMiw3ICs5MTIsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl90dW5l
ciAqdCkKIHsKIAlzdHJ1Y3QgY3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTkyNSw3ICs5MzYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19z
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nf
c190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBj
eDg4MDBfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTQwLDcgKzk1Miw4IEBA
IHN0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKIHsKIAlzdHJ1Y3QgY3g4ODAw
X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk4MSw3ICs5OTQsOCBAQCBpbnQg
Y3g4OF9zZXRfZnJlcShzdHJ1Y3QgY3g4OF9jb3JlICAqY29yZSwKIH0KIEVYUE9SVF9TWU1CT0wo
Y3g4OF9zZXRfZnJlcSk7CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKIHsKIAlzdHJ1Y3Qg
Y3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk5MSw3ICsxMDA1LDgg
QEAgc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiB9CiAKICNpZmRlZiBDT05GSUdfVklERU9fQURWX0RFQlVHCi1zdGF0aWMgaW50IHZp
ZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
dmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIg
KnJlZykKIHsKIAlzdHJ1Y3QgY3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTEwMDMsNyArMTAxOCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlk
aW9jX3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0
ZXIgKnJlZykKIHsKIAlzdHJ1Y3QgY3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKQEAgLTEwMTgsNyArMTAzNCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfcmVnaXN0ZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogLyogUkFESU8gRVNQRUNJRklDIElPQ1RMUyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KIC8qIC0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCiAKLXN0YXRpYyBp
bnQgcmFkaW9fZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgcmFkaW9fZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3QgdjRsMl90dW5lciAqdCkKIHsKIAlzdHJ1Y3Qg
Y3g4ODAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEwMzMsNyArMTA1MCw4
IEBAIHN0YXRpYyBpbnQgcmFkaW9fZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByYWRpb19zX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByYWRpb19zX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIGNvbnN0
IHN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBjeDg4MDBfZGV2ICpkZXYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvY3g4OC9jeDg4
LmggYi9kcml2ZXJzL21lZGlhL3BjaS9jeDg4L2N4ODguaAppbmRleCAyZmYzMjI2YTUyZWM0ZGUz
YjVmNGI5Zjg1Y2NhOWI4YWM0ODlhMDFmLi44MGQwNjY1MDYzYzk1YTA2NTVkNjU0YTdmNWRjMDVm
MmZhM2Y1MzFmIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9jeDg4L2N4ODguaAorKysg
Yi9kcml2ZXJzL21lZGlhL3BjaS9jeDg4L2N4ODguaApAQCAtNjU2LDcgKzY1Niw3IEBAIGludCBj
eDg4X3N0b3BfYXVkaW9fZG1hKHN0cnVjdCBjeDg4X2NvcmUgKmNvcmUpOwogLyogY3g4OC12Ymku
YyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KIAog
LyogQ2FuIGJlIHVzZWQgYXMgZ192YmlfZm10LCB0cnlfdmJpX2ZtdCBhbmQgc192YmlfZm10ICov
Ci1pbnQgY3g4ODAwX3ZiaV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQg
Y3g4ODAwX3ZiaV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwogCiB2b2lkIGN4ODgwMF9z
dG9wX3ZiaV9kbWEoc3RydWN0IGN4ODgwMF9kZXYgKmRldik7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L21lZGlhL3BjaS9kdDMxNTUvZHQzMTU1LmMgYi9kcml2ZXJzL21lZGlhL3BjaS9kdDMxNTUvZHQz
MTU1LmMKaW5kZXggN2JkZGNiYmE0Y2YxYmEyOTk4YWZiZmUxZTk2MWFkODlhMzAzZjFjMi4uZGU3
OTQ0MDA2NDM4Y2ZjNTBiMTQ4OWQ2ZGU3YTgzNGM4NGE1YjdiZiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9tZWRpYS9wY2kvZHQzMTU1L2R0MzE1NS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL2R0MzE1
NS9kdDMxNTUuYwpAQCAtMjg1LDcgKzI4NSw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdjRsMl9m
aWxlX29wZXJhdGlvbnMgZHQzMTU1X2ZvcHMgPSB7CiAJLnBvbGwgPSB2YjJfZm9wX3BvbGwKIH07
CiAKLXN0YXRpYyBpbnQgZHQzMTU1X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpw
LAorc3RhdGljIGludCBkdDMxNTVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbHAsCisJCQkgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2NhcGFi
aWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBEVDMxNTVfTkFNRSwgc2l6ZW9m
KGNhcC0+ZHJpdmVyKSk7CkBAIC0yOTQsNyArMjk1LDggQEAgc3RhdGljIGludCBkdDMxNTVfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnAsCiB9CiAKIHN0YXRpYyBpbnQgZHQzMTU1
X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsCi0JCQkJICAgdm9pZCAqcCwgc3Ry
dWN0IHY0bDJfZm10ZGVzYyAqZikKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT5pbmRleCkK
IAkJcmV0dXJuIC1FSU5WQUw7CkBAIC0zMDIsNyArMzA0LDkgQEAgc3RhdGljIGludCBkdDMxNTVf
ZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBkdDMxNTVfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnAsIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgZHQzMTU1X2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxwLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGR0MzE1NV9wcml2
ICpwZCA9IHZpZGVvX2RydmRhdGEoZmlscCk7CiAKQEAgLTMxNiw3ICszMjAsOCBAQCBzdGF0aWMg
aW50IGR0MzE1NV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcCwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGR0MzE1NV9nX3N0
ZChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcCwgdjRsMl9zdGRfaWQgKm5vcm0pCitzdGF0aWMg
aW50IGR0MzE1NV9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQl2NGwyX3N0ZF9pZCAqbm9ybSkKIHsKIAlzdHJ1Y3QgZHQzMTU1X3By
aXYgKnBkID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKIApAQCAtMzI0LDcgKzMyOSw4IEBAIHN0YXRp
YyBpbnQgZHQzMTU1X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwLCB2NGwyX3N0ZF9p
ZCAqbm9ybSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkdDMxNTVfc19zdGQoc3RydWN0
IGZpbGUgKmZpbHAsIHZvaWQgKnAsIHY0bDJfc3RkX2lkIG5vcm0pCitzdGF0aWMgaW50IGR0MzE1
NV9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQl2NGwyX3N0ZF9pZCBub3JtKQogewogCXN0cnVjdCBkdDMxNTVfcHJpdiAqcGQgPSB2
aWRlb19kcnZkYXRhKGZpbHApOwogCkBAIC0zNDUsNyArMzUxLDggQEAgc3RhdGljIGludCBkdDMx
NTVfc19zdGQoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnAsIHY0bDJfc3RkX2lkIG5vcm0pCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZHQzMTU1X2VudW1faW5wdXQoc3RydWN0IGZpbGUg
KmZpbHAsIHZvaWQgKnAsCitzdGF0aWMgaW50IGR0MzE1NV9lbnVtX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxwLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
ICAgc3RydWN0IHY0bDJfaW5wdXQgKmlucHV0KQogewogCWlmIChpbnB1dC0+aW5kZXggPiAzKQpA
QCAtMzYxLDcgKzM2OCw4IEBAIHN0YXRpYyBpbnQgZHQzMTU1X2VudW1faW5wdXQoc3RydWN0IGZp
bGUgKmZpbHAsIHZvaWQgKnAsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZHQzMTU1X2df
aW5wdXQoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnAsIHVuc2lnbmVkIGludCAqaSkKK3N0YXRp
YyBpbnQgZHQzMTU1X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IGR0MzE1
NV9wcml2ICpwZCA9IHZpZGVvX2RydmRhdGEoZmlscCk7CiAKQEAgLTM2OSw3ICszNzcsOCBAQCBz
dGF0aWMgaW50IGR0MzE1NV9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwLCB1bnNp
Z25lZCBpbnQgKmkpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZHQzMTU1X3NfaW5wdXQo
c3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnAsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBk
dDMxNTVfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCBpKQogewogCXN0cnVjdCBkdDMxNTVfcHJpdiAq
cGQgPSB2aWRlb19kcnZkYXRhKGZpbHApOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Bj
aS9pbnRlbC9pcHUzL2lwdTMtY2lvMi5jIGIvZHJpdmVycy9tZWRpYS9wY2kvaW50ZWwvaXB1My9p
cHUzLWNpbzIuYwppbmRleCBhODdmMTA1YmViNWUyNjdmZDQ1MGI4YTM2ZWY5YjBlMGVjYWZjNTk4
Li4wY2YzZjBmZmM5Mzc1ZGQ5MzMwNWQxZWNmZWFlYTdjM2M2NTQwN2M2IDEwMDY0NAotLS0gYS9k
cml2ZXJzL21lZGlhL3BjaS9pbnRlbC9pcHUzL2lwdTMtY2lvMi5jCisrKyBiL2RyaXZlcnMvbWVk
aWEvcGNpL2ludGVsL2lwdTMvaXB1My1jaW8yLmMKQEAgLTEwNjIsNyArMTA2Miw4IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBjaW8yX3ZiMl9vcHMgPSB7CiAKIC8qKioqKioqKioqKioq
KioqIFY0TDIgaW50ZXJmYWNlICoqKioqKioqKioqKioqKiovCiAKLXN0YXRpYyBpbnQgY2lvMl92
NGwyX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY2lv
Ml92NGwyX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgQ0lPMl9OQU1FLCBzaXplb2YoY2FwLT5kcml2
ZXIpKTsKQEAgLTEwNzEsNyArMTA3Miw4IEBAIHN0YXRpYyBpbnQgY2lvMl92NGwyX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBjaW8yX3Y0bDJfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGlj
IGludCBjaW8yX3Y0bDJfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwyX2ZtdGRl
c2MgKmYpCiB7CiAJaWYgKGYtPmluZGV4ID49IEFSUkFZX1NJWkUoZm9ybWF0cykpCkBAIC0xMDgz
LDcgKzEwODUsOSBAQCBzdGF0aWMgaW50IGNpbzJfdjRsMl9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCiB9CiAKIC8qIFRoZSBmb3JtYXQgaXMgdmFsaWRhdGVkIGluIGNpbzJf
dmlkZW9fbGlua192YWxpZGF0ZSgpICovCi1zdGF0aWMgaW50IGNpbzJfdjRsMl9nX2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBp
bnQgY2lvMl92NGwyX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IGNpbzJfcXVldWUgKnEgPSBmaWxlX3RvX2NpbzJfcXVldWUoZmlsZSk7CiAKQEAgLTEw
OTIsNyArMTA5Niw5IEBAIHN0YXRpYyBpbnQgY2lvMl92NGwyX2dfZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGNpbzJfdjRsMl90cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBjaW8yX3Y0bDJfdHJ5X2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAljb25zdCBzdHJ1Y3QgaXB1M19j
aW8yX2ZtdCAqZm10OwogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBsYW5lICptcGl4ID0gJmYt
PmZtdC5waXhfbXA7CkBAIC0xMTIzLDE4ICsxMTI5LDIxIEBAIHN0YXRpYyBpbnQgY2lvMl92NGwy
X3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY2lvMl92NGwyX3NfZm10KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBj
aW8yX3Y0bDJfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3QgY2lvMl9xdWV1ZSAqcSA9IGZpbGVfdG9fY2lvMl9xdWV1ZShmaWxlKTsKIAotCWNpbzJfdjRs
Ml90cnlfZm10KGZpbGUsIGZoLCBmKTsKKwljaW8yX3Y0bDJfdHJ5X2ZtdChmaWxlLCBzdGF0ZSwg
Zik7CiAJcS0+Zm9ybWF0ID0gZi0+Zm10LnBpeF9tcDsKIAogCXJldHVybiAwOwogfQogCiBzdGF0
aWMgaW50Ci1jaW8yX3ZpZGVvX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wdXQpCitjaW8yX3ZpZGVvX2VudW1faW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBz
dHJ1Y3QgdjRsMl9pbnB1dCAqaW5wdXQpCiB7CiAJaWYgKGlucHV0LT5pbmRleCA+IDApCiAJCXJl
dHVybiAtRUlOVkFMOwpAQCAtMTE0Niw3ICsxMTU1LDggQEAgY2lvMl92aWRlb19lbnVtX2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfaW5wdXQgKmlucHV0KQog
fQogCiBzdGF0aWMgaW50Ci1jaW8yX3ZpZGVvX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCB1bnNpZ25lZCBpbnQgKmlucHV0KQorY2lvMl92aWRlb19nX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgdW5zaWdu
ZWQgaW50ICppbnB1dCkKIHsKIAkqaW5wdXQgPSAwOwogCkBAIC0xMTU0LDcgKzExNjQsOCBAQCBj
aW8yX3ZpZGVvX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBp
bnQgKmlucHV0KQogfQogCiBzdGF0aWMgaW50Ci1jaW8yX3ZpZGVvX3NfaW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgaW5wdXQpCitjaW8yX3ZpZGVvX3NfaW5w
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkgICB1bnNpZ25lZCBpbnQgaW5wdXQpCiB7CiAJcmV0dXJuIGlucHV0ID09IDAgPyAwIDogLUVJ
TlZBTDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL2ludGVsL2lwdTYvaXB1Ni1p
c3lzLXZpZGVvLmMgYi9kcml2ZXJzL21lZGlhL3BjaS9pbnRlbC9pcHU2L2lwdTYtaXN5cy12aWRl
by5jCmluZGV4IGYzZjNiYzA2MTVlNWRjNjk4YmU1YzQ3OWRmZWQ4ZWYyZWI0OWNiZmIuLjIxYTYx
YmQ3OTI3NGQxNzJjOTI4OWJjMTQ0ZjJhOTJiMTlkMjU2ZjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
bWVkaWEvcGNpL2ludGVsL2lwdTYvaXB1Ni1pc3lzLXZpZGVvLmMKKysrIGIvZHJpdmVycy9tZWRp
YS9wY2kvaW50ZWwvaXB1Ni9pcHU2LWlzeXMtdmlkZW8uYwpAQCAtMTM5LDcgKzEzOSw4IEBAIGlw
dTZfaXN5c19nZXRfaXN5c19mb3JtYXQodTMyIHBpeGVsZm9ybWF0LCB1MzIgdHlwZSkKIAlyZXR1
cm4gZGVmYXVsdF9wZm10OwogfQogCi1zdGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2NfcXVlcnlj
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcHU2X2lzeXNfdmlk
aW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXAp
CiB7CiAJc3RydWN0IGlwdTZfaXN5c192aWRlbyAqYXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtMTUwLDcgKzE1MSw4IEBAIHN0YXRpYyBpbnQgaXB1Nl9pc3lzX3ZpZGlvY19xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
aXB1Nl9pc3lzX3ZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitz
dGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVj
dCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJdW5zaWduZWQgaW50IGksIG51bV9mb3VuZDsKQEAgLTE3
OSw3ICsxODEsOCBAQCBzdGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2NfZW51bV9mbXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50
IGlwdTZfaXN5c192aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgaXB1Nl9pc3lzX3ZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkJICAgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKIHsKIAl1bnNpZ25lZCBp
bnQgaTsKQEAgLTIwNSw3ICsyMDgsOCBAQCBzdGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2NfZW51
bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gLUVJTlZB
TDsKIH0KIAotc3RhdGljIGludCBpcHU2X2lzeXNfdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcHU2X2lzeXNfdmlkaW9jX2dfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBpcHU2X2lzeXNfdmlkZW8gKmF2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTIxNSw3ICsy
MTksOCBAQCBzdGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXB1Nl9p
c3lzX3ZpZGlvY19nX2ZtdF9tZXRhX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitz
dGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2NfZ19mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGlwdTZfaXN5c192aWRlbyAqYXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjcxLDcgKzI3Niw4IEBAIHN0YXRpYyB2b2lkIF9faXB1
Nl9pc3lzX3ZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGlwdTZfaXN5c192aWRlbyAqYXYs
CiAJZi0+Zm10LnBpeC54ZmVyX2Z1bmMgPSBWNEwyX1hGRVJfRlVOQ19ERUZBVUxUOwogfQogCi1z
dGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaXB1Nl9pc3lzX3ZpZGlvY190cnlfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaXB1
Nl9pc3lzX3ZpZGVvICphdiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yOTUsNyArMzAxLDgg
QEAgc3RhdGljIGludCBfX2lwdTZfaXN5c192aWRpb2NfdHJ5X2ZtdF9tZXRhX2NhcChzdHJ1Y3Qg
aXB1Nl9pc3lzX3ZpZGVvICphdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpcHU2X2lz
eXNfdmlkaW9jX3RyeV9mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAor
c3RhdGljIGludCBpcHU2X2lzeXNfdmlkaW9jX3RyeV9mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
CSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBpcHU2X2lzeXNfdmlkZW8g
KmF2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTMwNSwxOCArMzEyLDIwIEBAIHN0YXRpYyBp
bnQgaXB1Nl9pc3lzX3ZpZGlvY190cnlfZm10X21ldGFfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpcHU2X2lzeXNfdmlkaW9jX3Nf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcHU2
X2lzeXNfdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQogewogCXN0cnVjdCBpcHU2X2lzeXNfdmlkZW8gKmF2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKIAotCWlwdTZfaXN5c192aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIGZoLCBmKTsK
KwlpcHU2X2lzeXNfdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7CiAJYXYt
PnBpeF9mbXQgPSBmLT5mbXQucGl4OwogCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXB1
Nl9pc3lzX3ZpZGlvY19zX2ZtdF9tZXRhX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IGlwdTZfaXN5c192aWRpb2Nfc19mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkg
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGlwdTZfaXN5c192aWRlbyAqYXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzI0LDEzICszMzMsMTQgQEAgc3RhdGljIGludCBp
cHU2X2lzeXNfdmlkaW9jX3NfZm10X21ldGFfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKIAlpZiAodmIyX2lzX2J1c3koJmF2LT5hcS52YnEpKQogCQlyZXR1cm4gLUVCVVNZOwogCi0J
aXB1Nl9pc3lzX3ZpZGlvY190cnlfZm10X21ldGFfY2FwKGZpbGUsIGZoLCBmKTsKKwlpcHU2X2lz
eXNfdmlkaW9jX3RyeV9mbXRfbWV0YV9jYXAoZmlsZSwgc3RhdGUsIGYpOwogCWF2LT5tZXRhX2Zt
dCA9IGYtPmZtdC5tZXRhOwogCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXB1Nl9pc3lz
X3ZpZGlvY19yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBpcHU2X2lzeXNfdmlkaW9jX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9yZXF1
ZXN0YnVmZmVycyAqcCkKIHsKIAlzdHJ1Y3QgaXB1Nl9pc3lzX3ZpZGVvICphdiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC0zNDMsMTAgKzM1MywxMSBAQCBzdGF0aWMgaW50IGlwdTZfaXN5c192
aWRpb2NfcmVxYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlpZiAocmV0KQog
CQlyZXR1cm4gcmV0OwogCi0JcmV0dXJuIHZiMl9pb2N0bF9yZXFidWZzKGZpbGUsIHByaXYsIHAp
OworCXJldHVybiB2YjJfaW9jdGxfcmVxYnVmcyhmaWxlLCBzdGF0ZSwgcCk7CiB9CiAKLXN0YXRp
YyBpbnQgaXB1Nl9pc3lzX3ZpZGlvY19jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXB1Nl9pc3lzX3ZpZGlvY19jcmVhdGVfYnVmcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
CXN0cnVjdCB2NGwyX2NyZWF0ZV9idWZmZXJzICpwKQogewogCXN0cnVjdCBpcHU2X2lzeXNfdmlk
ZW8gKmF2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTM1OSw3ICszNzAsNyBAQCBzdGF0aWMg
aW50IGlwdTZfaXN5c192aWRpb2NfY3JlYXRlX2J1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAotCXJldHVybiB2YjJfaW9jdGxfY3Jl
YXRlX2J1ZnMoZmlsZSwgcHJpdiwgcCk7CisJcmV0dXJuIHZiMl9pb2N0bF9jcmVhdGVfYnVmcyhm
aWxlLCBzdGF0ZSwgcCk7CiB9CiAKIHN0YXRpYyBpbnQgbGlua192YWxpZGF0ZShzdHJ1Y3QgbWVk
aWFfbGluayAqbGluaykKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL2l2dHYvaXZ0di1k
cml2ZXIuYyBiL2RyaXZlcnMvbWVkaWEvcGNpL2l2dHYvaXZ0di1kcml2ZXIuYwppbmRleCA3MmE4
Zjc2YTQxZjQ1MDkxZmRkNGZlMDMzNWVjYjgyOGQ1NTVlYjljLi5hMjAxNmNiZGI4OTZkZjA2NjE1
OGEyZjg1ZGI4Yzg5NjRjYjk1MzI4IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9pdnR2
L2l2dHYtZHJpdmVyLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvaXZ0di9pdnR2LWRyaXZlci5j
CkBAIC0xMjQ5LDEzICsxMjQ5LDkgQEAgaW50IGl2dHZfaW5pdF9vbl9maXJzdF9vcGVuKHN0cnVj
dCBpdnR2ICppdHYpCiB7CiAJc3RydWN0IHY0bDJfZnJlcXVlbmN5IHZmOwogCS8qIE5lZWRlZCB0
byBjYWxsIGlvY3RscyBsYXRlciAqLwotCXN0cnVjdCBpdnR2X29wZW5faWQgZmg7CiAJaW50IGZ3
X3JldHJ5X2NvdW50ID0gMzsKIAlpbnQgdmlkZW9faW5wdXQ7CiAKLQlmaC5pdHYgPSBpdHY7Ci0J
ZmgudHlwZSA9IElWVFZfRU5DX1NUUkVBTV9UWVBFX01QRzsKLQogCWlmICh0ZXN0X2JpdChJVlRW
X0ZfSV9GQUlMRUQsICZpdHYtPmlfZmxhZ3MpKQogCQlyZXR1cm4gLUVOWElPOwogCkBAIC0xMjk3
LDEzICsxMjkzLDEzIEBAIGludCBpdnR2X2luaXRfb25fZmlyc3Rfb3BlbihzdHJ1Y3QgaXZ0diAq
aXR2KQogCiAJdmlkZW9faW5wdXQgPSBpdHYtPmFjdGl2ZV9pbnB1dDsKIAlpdHYtPmFjdGl2ZV9p
bnB1dCsrOwkvKiBGb3JjZSB1cGRhdGUgb2YgaW5wdXQgKi8KLQlpdnR2X3NfaW5wdXQoTlVMTCwg
JmZoLCB2aWRlb19pbnB1dCk7CisJaXZ0dl9zX2lucHV0KE5VTEwsIE5VTEwsIHZpZGVvX2lucHV0
KTsKIAogCS8qIExldCB0aGUgVklESU9DX1NfU1REIGlvY3RsIGRvIGFsbCB0aGUgd29yaywga2Vl
cHMgdGhlIGNvZGUKIAkgICBpbiBvbmUgcGxhY2UuICovCiAJaXR2LT5zdGQrKzsJCS8qIEZvcmNl
IGZ1bGwgc3RhbmRhcmQgaW5pdGlhbGl6YXRpb24gKi8KIAlpdHYtPnN0ZF9vdXQgPSBpdHYtPnN0
ZDsKLQlpdnR2X3NfZnJlcXVlbmN5KE5VTEwsICZmaCwgJnZmKTsKKwlpdnR2X3NfZnJlcXVlbmN5
KE5VTEwsIE5VTEwsICZ2Zik7CiAKIAlpZiAoaXR2LT5jYXJkLT52NGwyX2NhcGFiaWxpdGllcyAm
IFY0TDJfQ0FQX1ZJREVPX09VVFBVVCkgewogCQkvKiBUdXJuIG9uIHRoZSBUVi1vdXQ6IGl2dHZf
aW5pdF9tcGVnX2RlY29kZXIoKSBpbml0aWFsaXplcwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRp
YS9wY2kvaXZ0di9pdnR2LWlvY3RsLmMgYi9kcml2ZXJzL21lZGlhL3BjaS9pdnR2L2l2dHYtaW9j
dGwuYwppbmRleCA4NGM3M2JkMjJmMmRhZjQwNWJhNWVmOTg4OTRiOThkNDBlNWM3Y2YyLi5mNTI5
ZjBjOTYzNjg2YjczM2RmYWJmMWU0NGIxMzU5OTI1Y2RiMWVlIDEwMDY0NAotLS0gYS9kcml2ZXJz
L21lZGlhL3BjaS9pdnR2L2l2dHYtaW9jdGwuYworKysgYi9kcml2ZXJzL21lZGlhL3BjaS9pdnR2
L2l2dHYtaW9jdGwuYwpAQCAtMzA2LDcgKzMwNiw5IEBAIHN0YXRpYyBpbnQgaXZ0dl92aWRlb19j
b21tYW5kKHN0cnVjdCBpdnR2ICppdHYsIHN0cnVjdCBpdnR2X29wZW5faWQgKmlkLAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IGl2dHZfZ19mbXRfc2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQg
aXZ0dl9nX2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJfZm9y
bWF0ICpmbXQpCiB7CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQoZmlsZSktPml0djsKIAlz
dHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2Zvcm1hdCAqdmJpZm10ID0gJmZtdC0+Zm10LnNsaWNlZDsK
QEAgLTMyOCw3ICszMzAsOSBAQCBzdGF0aWMgaW50IGl2dHZfZ19mbXRfc2xpY2VkX3ZiaV9vdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbwogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IGl2dHZfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQorc3RhdGljIGludCBpdnR2X2dfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVj
dCBpdnR2X29wZW5faWQgKmlkID0gZmlsZTJpZChmaWxlKTsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0g
aWQtPml0djsKQEAgLTM1MSw3ICszNTUsOSBAQCBzdGF0aWMgaW50IGl2dHZfZ19mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZgogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IGl2dHZfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQorc3RhdGljIGludCBpdnR2
X2dfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQog
ewogCXN0cnVjdCBpdnR2ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAJc3RydWN0IHY0bDJf
dmJpX2Zvcm1hdCAqdmJpZm10ID0gJmZtdC0+Zm10LnZiaTsKQEAgLTM2OSw3ICszNzUsOSBAQCBz
dGF0aWMgaW50IGl2dHZfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZgogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGl2dHZf
Z19mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQgaXZ0dl9nX2ZtdF9zbGljZWRfdmJpX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHY0bDJf
c2xpY2VkX3ZiaV9mb3JtYXQgKnZiaWZtdCA9ICZmbXQtPmZtdC5zbGljZWQ7CiAJc3RydWN0IGl2
dHZfb3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwpAQCAtMzkyLDcgKzQwMCw5IEBAIHN0YXRp
YyBpbnQgaXZ0dl9nX2ZtdF9zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHN0cnVjdCB2NGwyX2ZvCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9nX2Zt
dF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmbXQpCitzdGF0aWMgaW50IGl2dHZfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IGl2dHZfb3Blbl9pZCAqaWQgPSBmaWxl
MmlkKGZpbGUpOwogCXN0cnVjdCBpdnR2ICppdHYgPSBpZC0+aXR2OwpAQCAtNDMyLDcgKzQ0Miw5
IEBAIHN0YXRpYyBpbnQgaXZ0dl9nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
aXZ0dl9nX2ZtdF92aWRfb3V0X292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQgaXZ0dl9nX2ZtdF92aWRfb3V0X292
ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3Ry
dWN0IGl2dHYgKml0diA9IGZpbGUyaWQoZmlsZSktPml0djsKIAlzdHJ1Y3QgaXZ0dl9zdHJlYW0g
KnMgPSAmaXR2LT5zdHJlYW1zW2ZpbGUyaWQoZmlsZSktPnR5cGVdOwpAQCAtNDU0LDEyICs0NjYs
MTYgQEAgc3RhdGljIGludCBpdnR2X2dfZm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2YKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBpdnR2X3RyeV9mbXRfc2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQgaXZ0dl90cnlfZm10X3NsaWNl
ZF92Ymlfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7
Ci0JcmV0dXJuIGl2dHZfZ19mbXRfc2xpY2VkX3ZiaV9vdXQoZmlsZSwgZmgsIGZtdCk7CisJcmV0
dXJuIGl2dHZfZ19mbXRfc2xpY2VkX3ZiaV9vdXQoZmlsZSwgc3RhdGUsIGZtdCk7CiB9CiAKLXN0
YXRpYyBpbnQgaXZ0dl90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQgaXZ0dl90cnlfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IGl2dHZfb3Blbl9p
ZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwogCXN0cnVjdCBpdnR2ICppdHYgPSBpZC0+aXR2OwpAQCAt
NDc2LDI1ICs0OTIsMjkgQEAgc3RhdGljIGludCBpdnR2X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdAogCX0KIAloID0gbWluKGgs
IGl0di0+aXNfNTBoeiA/IDU3NiA6IDQ4MCk7CiAJaCA9IG1heChoLCBtaW5faCk7Ci0JaXZ0dl9n
X2ZtdF92aWRfY2FwKGZpbGUsIGZoLCBmbXQpOworCWl2dHZfZ19mbXRfdmlkX2NhcChmaWxlLCBz
dGF0ZSwgZm10KTsKIAlmbXQtPmZtdC5waXgud2lkdGggPSB3OwogCWZtdC0+Zm10LnBpeC5oZWln
aHQgPSBoOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGl2dHZfdHJ5X2ZtdF92YmlfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCitz
dGF0aWMgaW50IGl2dHZfdHJ5X2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAq
Zm10KQogewotCXJldHVybiBpdnR2X2dfZm10X3ZiaV9jYXAoZmlsZSwgZmgsIGZtdCk7CisJcmV0
dXJuIGl2dHZfZ19mbXRfdmJpX2NhcChmaWxlLCBzdGF0ZSwgZm10KTsKIH0KIAotc3RhdGljIGlu
dCBpdnR2X3RyeV9mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQgaXZ0dl90cnlfZm10X3NsaWNl
ZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7
CiAJc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9mb3JtYXQgKnZiaWZtdCA9ICZmbXQtPmZtdC5zbGlj
ZWQ7CiAJc3RydWN0IGl2dHZfb3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwogCXN0cnVjdCBp
dnR2ICppdHYgPSBpZC0+aXR2OwogCiAJaWYgKGlkLT50eXBlID09IElWVFZfREVDX1NUUkVBTV9U
WVBFX1ZCSSkKLQkJcmV0dXJuIGl2dHZfZ19mbXRfc2xpY2VkX3ZiaV9jYXAoZmlsZSwgZmgsIGZt
dCk7CisJCXJldHVybiBpdnR2X2dfZm10X3NsaWNlZF92YmlfY2FwKGZpbGUsIHN0YXRlLCBmbXQp
OwogCiAJLyogc2V0IHNsaWNlZCBWQkkgY2FwdHVyZSBmb3JtYXQgKi8KIAl2YmlmbXQtPmlvX3Np
emUgPSBzaXplb2Yoc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9kYXRhKSAqIDM2OwpAQCAtNTA4LDEz
ICs1MjgsMTUgQEAgc3RhdGljIGludCBpdnR2X3RyeV9mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl8KIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBpdnR2X3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQorc3RhdGljIGludCBpdnR2X3RyeV9mbXRfdmlkX291
dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgaXZ0dl9vcGVuX2lk
ICppZCA9IGZpbGUyaWQoZmlsZSk7CiAJczMyIHcgPSBmbXQtPmZtdC5waXgud2lkdGg7CiAJczMy
IGggPSBmbXQtPmZtdC5waXguaGVpZ2h0OwogCWludCBmaWVsZCA9IGZtdC0+Zm10LnBpeC5maWVs
ZDsKLQlpbnQgcmV0ID0gaXZ0dl9nX2ZtdF92aWRfb3V0KGZpbGUsIGZoLCBmbXQpOworCWludCBy
ZXQgPSBpdnR2X2dfZm10X3ZpZF9vdXQoZmlsZSwgc3RhdGUsIGZtdCk7CiAKIAl3ID0gbWluKHcs
IDcyMCk7CiAJdyA9IG1heCh3LCAyKTsKQEAgLTU0Miw3ICs1NjQsOSBAQCBzdGF0aWMgaW50IGl2
dHZfdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0
bDJfZm9ybWF0CiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBpdnR2X3RyeV9mbXRfdmlk
X291dF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9y
bWF0ICpmbXQpCitzdGF0aWMgaW50IGl2dHZfdHJ5X2ZtdF92aWRfb3V0X292ZXJsYXkoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
CQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJp
ZChmaWxlKS0+aXR2OwogCXN0cnVjdCBpdnR2X3N0cmVhbSAqcyA9ICZpdHYtPnN0cmVhbXNbZmls
ZTJpZChmaWxlKS0+dHlwZV07CkBAIC01NTMsMjUgKzU3NywyOSBAQCBzdGF0aWMgaW50IGl2dHZf
dHJ5X2ZtdF92aWRfb3V0X292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMgogCQlyZXR1cm4gLUVJTlZBTDsKIAlpZiAoIWl0di0+b3NkX3ZpZGVvX3BiYXNlKQog
CQlyZXR1cm4gLUVJTlZBTDsKLQlpdnR2X2dfZm10X3ZpZF9vdXRfb3ZlcmxheShmaWxlLCBmaCwg
Zm10KTsKKwlpdnR2X2dfZm10X3ZpZF9vdXRfb3ZlcmxheShmaWxlLCBzdGF0ZSwgZm10KTsKIAlm
bXQtPmZtdC53aW4uY2hyb21ha2V5ID0gY2hyb21ha2V5OwogCWZtdC0+Zm10Lndpbi5nbG9iYWxf
YWxwaGEgPSBnbG9iYWxfYWxwaGE7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9z
X2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZm10KQorc3RhdGljIGludCBpdnR2X3NfZm10X3NsaWNlZF92Ymlfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKLQlyZXR1cm4gaXZ0dl9n
X2ZtdF9zbGljZWRfdmJpX291dChmaWxlLCBmaCwgZm10KTsKKwlyZXR1cm4gaXZ0dl9nX2ZtdF9z
bGljZWRfdmJpX291dChmaWxlLCBzdGF0ZSwgZm10KTsKIH0KIAotc3RhdGljIGludCBpdnR2X3Nf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmZtdCkKK3N0YXRpYyBpbnQgaXZ0dl9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgaXZ0dl9vcGVuX2lkICppZCA9IGZp
bGUyaWQoZmlsZSk7CiAJc3RydWN0IGl2dHYgKml0diA9IGlkLT5pdHY7CiAJc3RydWN0IHY0bDJf
c3ViZGV2X2Zvcm1hdCBmb3JtYXQgPSB7CiAJCS53aGljaCA9IFY0TDJfU1VCREVWX0ZPUk1BVF9B
Q1RJVkUsCiAJfTsKLQlpbnQgcmV0ID0gaXZ0dl90cnlfZm10X3ZpZF9jYXAoZmlsZSwgZmgsIGZt
dCk7CisJaW50IHJldCA9IGl2dHZfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmbXQpOwog
CWludCB3ID0gZm10LT5mbXQucGl4LndpZHRoOwogCWludCBoID0gZm10LT5mbXQucGl4LmhlaWdo
dDsKIApAQCAtNTkyLDEwICs2MjAsMTIgQEAgc3RhdGljIGludCBpdnR2X3NfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYKIAlmb3Jt
YXQuZm9ybWF0LmhlaWdodCA9IGg7CiAJZm9ybWF0LmZvcm1hdC5jb2RlID0gTUVESUFfQlVTX0ZN
VF9GSVhFRDsKIAl2NGwyX3N1YmRldl9jYWxsKGl0di0+c2RfdmlkZW8sIHBhZCwgc2V0X2ZtdCwg
TlVMTCwgJmZvcm1hdCk7Ci0JcmV0dXJuIGl2dHZfZ19mbXRfdmlkX2NhcChmaWxlLCBmaCwgZm10
KTsKKwlyZXR1cm4gaXZ0dl9nX2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmbXQpOwogfQogCi1z
dGF0aWMgaW50IGl2dHZfc19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQorc3RhdGljIGludCBpdnR2X3NfZm10X3ZiaV9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCBpdnR2
ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAKQEAgLTYwNCwxNSArNjM0LDE3IEBAIHN0YXRp
YyBpbnQgaXZ0dl9zX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmCiAJaXR2LT52Ymkuc2xpY2VkX2luLT5zZXJ2aWNlX3NldCA9IDA7
CiAJaXR2LT52YmkuaW4udHlwZSA9IFY0TDJfQlVGX1RZUEVfVkJJX0NBUFRVUkU7CiAJdjRsMl9z
dWJkZXZfY2FsbChpdHYtPnNkX3ZpZGVvLCB2YmksIHNfcmF3X2ZtdCwgJmZtdC0+Zm10LnZiaSk7
Ci0JcmV0dXJuIGl2dHZfZ19mbXRfdmJpX2NhcChmaWxlLCBmaCwgZm10KTsKKwlyZXR1cm4gaXZ0
dl9nX2ZtdF92YmlfY2FwKGZpbGUsIHN0YXRlLCBmbXQpOwogfQogCi1zdGF0aWMgaW50IGl2dHZf
c19mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQgaXZ0dl9zX2ZtdF9zbGljZWRfdmJpX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHY0bDJf
c2xpY2VkX3ZiaV9mb3JtYXQgKnZiaWZtdCA9ICZmbXQtPmZtdC5zbGljZWQ7CiAJc3RydWN0IGl2
dHZfb3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwogCXN0cnVjdCBpdnR2ICppdHYgPSBpZC0+
aXR2OwotCWludCByZXQgPSBpdnR2X3RyeV9mbXRfc2xpY2VkX3ZiaV9jYXAoZmlsZSwgZmgsIGZt
dCk7CisJaW50IHJldCA9IGl2dHZfdHJ5X2ZtdF9zbGljZWRfdmJpX2NhcChmaWxlLCBzdGF0ZSwg
Zm10KTsKIAogCWlmIChyZXQgfHwgaWQtPnR5cGUgPT0gSVZUVl9ERUNfU1RSRUFNX1RZUEVfVkJJ
KQogCQlyZXR1cm4gcmV0OwpAQCAtNjI2LDEyICs2NTgsMTQgQEAgc3RhdGljIGludCBpdnR2X3Nf
Zm10X3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0
bDJfZm8KIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpdnR2X3NfZm10X3ZpZF9vdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3N0YXRp
YyBpbnQgaXZ0dl9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmZtdCkKIHsKIAlzdHJ1Y3QgaXZ0dl9vcGVuX2lkICppZCA9IGZpbGUyaWQoZmlsZSk7CiAJ
c3RydWN0IGl2dHYgKml0diA9IGlkLT5pdHY7CiAJc3RydWN0IHl1dl9wbGF5YmFja19pbmZvICp5
aSA9ICZpdHYtPnl1dl9pbmZvOwotCWludCByZXQgPSBpdnR2X3RyeV9mbXRfdmlkX291dChmaWxl
LCBmaCwgZm10KTsKKwlpbnQgcmV0ID0gaXZ0dl90cnlfZm10X3ZpZF9vdXQoZmlsZSwgc3RhdGUs
IGZtdCk7CiAKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwpAQCAtNjcxLDEwICs3MDUsMTIgQEAg
c3RhdGljIGludCBpdnR2X3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpdnR2
X3NfZm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZm10KQorc3RhdGljIGludCBpdnR2X3NfZm10X3ZpZF9vdXRfb3Zlcmxh
eShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3Qg
aXZ0diAqaXR2ID0gZmlsZTJpZChmaWxlKS0+aXR2OwotCWludCByZXQgPSBpdnR2X3RyeV9mbXRf
dmlkX291dF9vdmVybGF5KGZpbGUsIGZoLCBmbXQpOworCWludCByZXQgPSBpdnR2X3RyeV9mbXRf
dmlkX291dF9vdmVybGF5KGZpbGUsIHN0YXRlLCBmbXQpOwogCiAJaWYgKHJldCA9PSAwKSB7CiAJ
CWl0di0+b3NkX2Nocm9tYV9rZXkgPSBmbXQtPmZtdC53aW4uY2hyb21ha2V5OwpAQCAtNzA4LDcg
Kzc0NCw5IEBAIHN0YXRpYyBpbnQgaXZ0dl9pdHZjKHN0cnVjdCBpdnR2ICppdHYsIGJvb2wgZ2V0
LCB1NjQgcmVnLCB1NjQgKnZhbCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpdnR2X2df
cmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9kYmdfcmVn
aXN0ZXIgKnJlZykKK3N0YXRpYyBpbnQgaXZ0dl9nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3Qg
djRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKIHsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJpZChm
aWxlKS0+aXR2OwogCkBAIC03MTYsNyArNzU0LDkgQEAgc3RhdGljIGludCBpdnR2X2dfcmVnaXN0
ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIK
IAlyZXR1cm4gaXZ0dl9pdHZjKGl0diwgdHJ1ZSwgcmVnLT5yZWcsICZyZWctPnZhbCk7CiB9CiAK
LXN0YXRpYyBpbnQgaXZ0dl9zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
Y29uc3Qgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCitzdGF0aWMgaW50IGl2dHZfc19y
ZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJICAgY29uc3Qgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7
CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQoZmlsZSktPml0djsKIAl1NjQgdmFsID0gcmVn
LT52YWw7CkBAIC03MjUsNyArNzY1LDggQEAgc3RhdGljIGludCBpdnR2X3NfcmVnaXN0ZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBjb25zdCBzdHJ1Y3QgdjRsMl9kYmdfcmUKIH0KICNl
bmRpZgogCi1zdGF0aWMgaW50IGl2dHZfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICp2Y2FwKQorc3RhdGljIGludCBpdnR2X3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICp2Y2FwKQogewogCXN0cnVjdCBpdnR2X29wZW5f
aWQgKmlkID0gZmlsZTJpZChmaWxlKTsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gaWQtPml0djsKQEAg
LTczNiwxNCArNzc3LDE2IEBAIHN0YXRpYyBpbnQgaXZ0dl9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKnZjCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgaXZ0dl9lbnVtYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9hdWRpbyAqdmluKQorc3RhdGljIGludCBpdnR2X2VudW1hdWRpbyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHN0
cnVjdCB2NGwyX2F1ZGlvICp2aW4pCiB7CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQoZmls
ZSktPml0djsKIAogCXJldHVybiBpdnR2X2dldF9hdWRpb19pbnB1dChpdHYsIHZpbi0+aW5kZXgs
IHZpbik7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwgc3RydWN0IHY0bDJfYXVkaW8gKnZpbikKK3N0YXRpYyBpbnQgaXZ0dl9nX2F1ZGlv
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CXN0cnVjdCB2NGwyX2F1ZGlvICp2aW4pCiB7CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQo
ZmlsZSktPml0djsKIApAQCAtNzUxLDcgKzc5NCw4IEBAIHN0YXRpYyBpbnQgaXZ0dl9nX2F1ZGlv
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfYXVkaW8gKnZpbikKIAly
ZXR1cm4gaXZ0dl9nZXRfYXVkaW9faW5wdXQoaXR2LCB2aW4tPmluZGV4LCB2aW4pOwogfQogCi1z
dGF0aWMgaW50IGl2dHZfc19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0
IHN0cnVjdCB2NGwyX2F1ZGlvICp2b3V0KQorc3RhdGljIGludCBpdnR2X3NfYXVkaW8oc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJY29uc3Qg
c3RydWN0IHY0bDJfYXVkaW8gKnZvdXQpCiB7CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQo
ZmlsZSktPml0djsKIApAQCAtNzY0LDcgKzgwOCw5IEBAIHN0YXRpYyBpbnQgaXZ0dl9zX2F1ZGlv
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW8gKnZv
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9lbnVtYXVkb3V0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfYXVkaW9vdXQgKnZpbikKK3N0YXRpYyBpbnQg
aXZ0dl9lbnVtYXVkb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9hdWRpb291dCAqdmluKQogewog
CXN0cnVjdCBpdnR2ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAKQEAgLTc3Miw3ICs4MTgs
OCBAQCBzdGF0aWMgaW50IGl2dHZfZW51bWF1ZG91dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHN0cnVjdCB2NGwyX2F1ZGlvb3V0ICp2aQogCXJldHVybiBpdnR2X2dldF9hdWRpb19vdXRw
dXQoaXR2LCB2aW4tPmluZGV4LCB2aW4pOwogfQogCi1zdGF0aWMgaW50IGl2dHZfZ19hdWRvdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9hdWRpb291dCAqdmluKQor
c3RhdGljIGludCBpdnR2X2dfYXVkb3V0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9hdWRpb291dCAqdmluKQogewog
CXN0cnVjdCBpdnR2ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAKQEAgLTc4MCw3ICs4Mjcs
OCBAQCBzdGF0aWMgaW50IGl2dHZfZ19hdWRvdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9hdWRpb291dCAqdmluKQogCXJldHVybiBpdnR2X2dldF9hdWRpb19vdXRw
dXQoaXR2LCB2aW4tPmluZGV4LCB2aW4pOwogfQogCi1zdGF0aWMgaW50IGl2dHZfc19hdWRvdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpb291dCAq
dm91dCkKK3N0YXRpYyBpbnQgaXZ0dl9zX2F1ZG91dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW9v
dXQgKnZvdXQpCiB7CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQoZmlsZSktPml0djsKIApA
QCAtNzg5LDcgKzgzNyw5IEBAIHN0YXRpYyBpbnQgaXZ0dl9zX2F1ZG91dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlvb3V0CiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgaXZ0dl9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfaW5wdXQgKnZpbikKK3N0YXRpYyBpbnQgaXZ0dl9lbnVtX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqdmluKQogewogCXN0cnVjdCBpdnR2ICppdHYgPSBm
aWxlMmlkKGZpbGUpLT5pdHY7CiAKQEAgLTc5NywxNSArODQ3LDE4IEBAIHN0YXRpYyBpbnQgaXZ0
dl9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfaW5w
dXQgKnZpbikKIAlyZXR1cm4gaXZ0dl9nZXRfaW5wdXQoaXR2LCB2aW4tPmluZGV4LCB2aW4pOwog
fQogCi1zdGF0aWMgaW50IGl2dHZfZW51bV9vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9vdXRwdXQgKnZvdXQpCitzdGF0aWMgaW50IGl2dHZfZW51bV9vdXRw
dXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkgICAgc3RydWN0IHY0bDJfb3V0cHV0ICp2b3V0KQogewogCXN0cnVjdCBpdnR2
ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAKIAlyZXR1cm4gaXZ0dl9nZXRfb3V0cHV0KGl0
diwgdm91dC0+aW5kZXgsIHZvdXQpOwogfQogCi1zdGF0aWMgaW50IGl2dHZfZ19waXhlbGFzcGVj
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCi0JCQkgICAgICBpbnQgdHlwZSwgc3RydWN0
IHY0bDJfZnJhY3QgKmYpCitzdGF0aWMgaW50IGl2dHZfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBpbnQg
dHlwZSwKKwkJCSAgICAgIHN0cnVjdCB2NGwyX2ZyYWN0ICpmKQogewogCXN0cnVjdCBpdnR2X29w
ZW5faWQgKmlkID0gZmlsZTJpZChmaWxlKTsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gaWQtPml0djsK
QEAgLTgyMiw3ICs4NzUsOCBAQCBzdGF0aWMgaW50IGl2dHZfZ19waXhlbGFzcGVjdChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9z
X3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGl2dHZf
c19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJ
c3RydWN0IGl2dHZfb3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwpAQCAtODY1LDcgKzkxOSw4
IEBAIHN0YXRpYyBpbnQgaXZ0dl9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGl2dHZfZ19zZWxlY3Rpb24o
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0IGl2dHZf
b3Blbl9pZCAqaWQgPSBmaWxlMmlkKGZpbGUpOwpAQCAtOTExLDcgKzk2Niw5IEBAIHN0YXRpYyBp
bnQgaXZ0dl9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJu
IC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZm10KQorc3RhdGljIGlu
dCBpdnR2X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmbXQp
CiB7CiAJc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZtdGRlc2MgaG0xMiA9IHsKIAkJLnR5cGUg
PSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkUsCkBAIC05MzgsNyArOTk1LDkgQEAgc3RhdGlj
IGludCBpdnR2X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9mbXRkZXMKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpdnR2X2VudW1f
Zm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbXRk
ZXNjICpmbXQpCitzdGF0aWMgaW50IGl2dHZfZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJIHN0cnVj
dCB2NGwyX2ZtdGRlc2MgKmZtdCkKIHsKIAlzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZm10ZGVz
YyBobTEyID0gewogCQkudHlwZSA9IFY0TDJfQlVGX1RZUEVfVklERU9fT1VUUFVULApAQCAtOTY1
LDcgKzEwMjQsOCBAQCBzdGF0aWMgaW50IGl2dHZfZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlcwogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGl2dHZfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2ln
bmVkIGludCAqaSkKK3N0YXRpYyBpbnQgaXZ0dl9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXVuc2lnbmVkIGludCAqaSkKIHsK
IAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJpZChmaWxlKS0+aXR2OwogCkBAIC05NzQsNyArMTAz
NCw4IEBAIHN0YXRpYyBpbnQgaXZ0dl9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgdW5zaWduZWQgaW50ICppKQogCXJldHVybiAwOwogfQogCi1pbnQgaXZ0dl9zX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGlucCkKK2ludCBpdnR2X3Nf
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkgdW5zaWduZWQgaW50IGlucCkKIHsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJpZChm
aWxlKS0+aXR2OwogCXY0bDJfc3RkX2lkIHN0ZDsKQEAgLTEwMTcsNyArMTA3OCw4IEBAIGludCBp
dnR2X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgaW5w
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGl2dHZfZ19vdXRwdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IGl2dHZfZ19vdXRw
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJIHVuc2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJpZChmaWxl
KS0+aXR2OwogCkBAIC0xMDI5LDcgKzEwOTEsOCBAQCBzdGF0aWMgaW50IGl2dHZfZ19vdXRwdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgKmkpCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9zX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHVuc2lnbmVkIGludCBvdXRwKQorc3RhdGljIGludCBpdnR2X3Nfb3V0cHV0KHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSB1bnNpZ25l
ZCBpbnQgb3V0cCkKIHsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJpZChmaWxlKS0+aXR2Owog
CkBAIC0xMDUxLDcgKzExMTQsOSBAQCBzdGF0aWMgaW50IGl2dHZfc19vdXRwdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgb3V0cCkKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBpdnR2X2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
c3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikKK3N0YXRpYyBpbnQgaXZ0dl9nX2ZyZXF1ZW5jeShz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKnZmKQogewogCXN0cnVjdCBpdnR2ICpp
dHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAJc3RydWN0IGl2dHZfc3RyZWFtICpzID0gJml0di0+
c3RyZWFtc1tmaWxlMmlkKGZpbGUpLT50eXBlXTsKQEAgLTEwNjUsNyArMTEzMCw4IEBAIHN0YXRp
YyBpbnQgaXZ0dl9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2ZyZXF1ZW5jeSAqCiAJcmV0dXJuIDA7CiB9CiAKLWludCBpdnR2X3NfZnJlcXVlbmN5
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5
ICp2ZikKK2ludCBpdnR2X3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVu
Y3kgKnZmKQogewogCXN0cnVjdCBpdnR2ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAJc3Ry
dWN0IGl2dHZfc3RyZWFtICpzID0gJml0di0+c3RyZWFtc1tmaWxlMmlkKGZpbGUpLT50eXBlXTsK
QEAgLTEwODIsNyArMTE0OCw4IEBAIGludCBpdnR2X3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2CiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IHY0bDJfc3RkX2lkICpzdGQpCitzdGF0aWMgaW50IGl2dHZfZ19zdGQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICB2NGwyX3N0ZF9p
ZCAqc3RkKQogewogCXN0cnVjdCBpdnR2ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAKQEAg
LTExNTUsNyArMTIyMiw4IEBAIHZvaWQgaXZ0dl9zX3N0ZF9kZWMoc3RydWN0IGl2dHYgKml0diwg
djRsMl9zdGRfaWQgc3RkKQogCX0KIH0KIAotc3RhdGljIGludCBpdnR2X3Nfc3RkKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgdjRsMl9zdGRfaWQgc3RkKQorc3RhdGljIGludCBpdnR2X3Nf
c3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJICAgICAgdjRsMl9zdGRfaWQgc3RkKQogewogCXN0cnVjdCBpdnR2ICppdHYgPSBmaWxlMmlk
KGZpbGUpLT5pdHY7CiAKQEAgLTExODMsNyArMTI1MSw4IEBAIHN0YXRpYyBpbnQgaXZ0dl9zX3N0
ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHY0bDJfc3RkX2lkIHN0ZCkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBpdnR2X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCitzdGF0aWMgaW50IGl2dHZfc190dW5l
cihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQljb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCiB7CiAJc3RydWN0IGl2dHZfb3Blbl9pZCAq
aWQgPSBmaWxlMmlkKGZpbGUpOwogCXN0cnVjdCBpdnR2ICppdHYgPSBpZC0+aXR2OwpAQCAtMTE5
Niw3ICsxMjY1LDggQEAgc3RhdGljIGludCBpdnR2X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBpdnR2X2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl90dW5lciAqdnQpCitzdGF0aWMgaW50IGl2dHZfZ190dW5lcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl90
dW5lciAqdnQpCiB7CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQoZmlsZSktPml0djsKIApA
QCAtMTIxMiw3ICsxMjgyLDkgQEAgc3RhdGljIGludCBpdnR2X2dfdHVuZXIoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgaXZ0dl9nX3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwgc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9jYXAgKmNhcCkKK3N0YXRpYyBpbnQgaXZ0dl9n
X3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9jYXAgKmNhcCkK
IHsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJpZChmaWxlKS0+aXR2OwogCWludCBzZXQgPSBp
dHYtPmlzXzUwaHogPyBWNEwyX1NMSUNFRF9WQklfNjI1IDogVjRMMl9TTElDRURfVkJJXzUyNTsK
QEAgLTEyNDcsNyArMTMxOSw5IEBAIHN0YXRpYyBpbnQgaXZ0dl9nX3NsaWNlZF92YmlfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc2xpY2VkCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9nX2VuY19pbmRleChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX2VuY19pZHggKmlkeCkKK3N0YXRpYyBpbnQgaXZ0dl9nX2VuY19p
bmRleChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9lbmNfaWR4ICppZHgpCiB7CiAJc3RydWN0IGl2
dHYgKml0diA9IGZpbGUyaWQoZmlsZSktPml0djsKIAlzdHJ1Y3QgdjRsMl9lbmNfaWR4X2VudHJ5
ICplID0gaWR4LT5lbnRyeTsKQEAgLTEyNzMsNyArMTM0Nyw5IEBAIHN0YXRpYyBpbnQgaXZ0dl9n
X2VuY19pbmRleChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2VuY19p
ZHggKmlkCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9lbmNvZGVyX2NtZChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2VuY29kZXJfY21kICplbmMpCitz
dGF0aWMgaW50IGl2dHZfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgc3RydWN0IHY0bDJfZW5jb2Rl
cl9jbWQgKmVuYykKIHsKIAlzdHJ1Y3QgaXZ0dl9vcGVuX2lkICppZCA9IGZpbGUyaWQoZmlsZSk7
CiAJc3RydWN0IGl2dHYgKml0diA9IGlkLT5pdHY7CkBAIC0xMzI1LDcgKzE0MDEsOSBAQCBzdGF0
aWMgaW50IGl2dHZfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9lbmNvZGVyX2NtZAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGl2dHZfdHJ5
X2VuY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZW5j
b2Rlcl9jbWQgKmVuYykKK3N0YXRpYyBpbnQgaXZ0dl90cnlfZW5jb2Rlcl9jbWQoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJc3Ry
dWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmVuYykKIHsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gZmlsZTJp
ZChmaWxlKS0+aXR2OwogCkBAIC0xMzU1LDcgKzE0MzMsOCBAQCBzdGF0aWMgaW50IGl2dHZfdHJ5
X2VuY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZW5j
b2RlcgogCX0KIH0KIAotc3RhdGljIGludCBpdnR2X2dfZmJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZyYW1lYnVmZmVyICpmYikKK3N0YXRpYyBpbnQgaXZ0dl9n
X2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkgICAgICAgc3RydWN0IHY0bDJfZnJhbWVidWZmZXIgKmZiKQogewogCXN0cnVjdCBpdnR2
ICppdHYgPSBmaWxlMmlkKGZpbGUpLT5pdHY7CiAJc3RydWN0IGl2dHZfc3RyZWFtICpzID0gJml0
di0+c3RyZWFtc1tmaWxlMmlkKGZpbGUpLT50eXBlXTsKQEAgLTE0NDIsNyArMTUyMSw4IEBAIHN0
YXRpYyBpbnQgaXZ0dl9nX2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9mcmFtZWJ1ZmZlciAqZmIpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9z
X2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBjb25zdCBzdHJ1Y3QgdjRsMl9mcmFt
ZWJ1ZmZlciAqZmIpCitzdGF0aWMgaW50IGl2dHZfc19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIGNvbnN0IHN0cnVjdCB2
NGwyX2ZyYW1lYnVmZmVyICpmYikKIHsKIAlzdHJ1Y3QgaXZ0dl9vcGVuX2lkICppZCA9IGZpbGUy
aWQoZmlsZSk7CiAJc3RydWN0IGl2dHYgKml0diA9IGlkLT5pdHY7CkBAIC0xNDYzLDcgKzE1NDMs
OCBAQCBzdGF0aWMgaW50IGl2dHZfc19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
Y29uc3Qgc3RydWN0IHY0bDJfZnJhbWVidWZmZQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGl2dHZfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBv
bikKK3N0YXRpYyBpbnQgaXZ0dl9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXVuc2lnbmVkIGludCBvbikKIHsKIAlzdHJ1Y3Qg
aXZ0dl9vcGVuX2lkICppZCA9IGZpbGUyaWQoZmlsZSk7CiAJc3RydWN0IGl2dHYgKml0diA9IGlk
LT5pdHY7CkBAIC0xNDkwLDcgKzE1NzEsOCBAQCBzdGF0aWMgaW50IGl2dHZfc3Vic2NyaWJlX2V2
ZW50KHN0cnVjdCB2NGwyX2ZoICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfZXZlbnRfc3VicwogCX0K
IH0KIAotc3RhdGljIGludCBpdnR2X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoKQorc3RhdGljIGludCBpdnR2X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgaXZ0diAqaXR2
ID0gZmlsZTJpZChmaWxlKS0+aXR2OwogCXUzMiBkYXRhW0NYMjM0MVhfTUJPWF9NQVhfREFUQV07
CkBAIC0xNTgyLDcgKzE2NjQsOSBAQCBzdGF0aWMgaW50IGl2dHZfbG9nX3N0YXR1cyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl9k
ZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2RlY29k
ZXJfY21kICpkZWMpCitzdGF0aWMgaW50IGl2dHZfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgc3Ry
dWN0IHY0bDJfZGVjb2Rlcl9jbWQgKmRlYykKIHsKIAlzdHJ1Y3QgaXZ0dl9vcGVuX2lkICppZCA9
IGZpbGUyaWQoZmlsZSk7CiAJc3RydWN0IGl2dHYgKml0diA9IGlkLT5pdHY7CkBAIC0xNTkxLDcg
KzE2NzUsOSBAQCBzdGF0aWMgaW50IGl2dHZfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9kZWNvZGVyX2NtZAogCXJldHVybiBpdnR2X3ZpZGVvX2Nv
bW1hbmQoaXR2LCBpZCwgZGVjLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyBpbnQgaXZ0dl90cnlfZGVj
b2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9kZWNvZGVy
X2NtZCAqZGVjKQorc3RhdGljIGludCBpdnR2X3RyeV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQlzdHJ1Y3Qg
djRsMl9kZWNvZGVyX2NtZCAqZGVjKQogewogCXN0cnVjdCBpdnR2X29wZW5faWQgKmlkID0gZmls
ZTJpZChmaWxlKTsKIAlzdHJ1Y3QgaXZ0diAqaXR2ID0gaWQtPml0djsKQEAgLTE2NDIsNyArMTcy
OCw4IEBAIHN0YXRpYyBpbnQgaXZ0dl9kZWNvZGVyX2lvY3RscyhzdHJ1Y3QgZmlsZSAqZmlscCwg
dW5zaWduZWQgaW50IGNtZCwgdm9pZCAqYXJnKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgbG9u
ZyBpdnR2X2RlZmF1bHQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBib29sIHZhbGlkX3By
aW8sCitzdGF0aWMgbG9uZyBpdnR2X2RlZmF1bHQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIGJvb2wgdmFsaWRfcHJpbywKIAkJCSB1bnNp
Z25lZCBpbnQgY21kLCB2b2lkICphcmcpCiB7CiAJc3RydWN0IGl2dHYgKml0diA9IGZpbGUyaWQo
ZmlsZSktPml0djsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL2l2dHYvaXZ0di1pb2N0
bC5oIGIvZHJpdmVycy9tZWRpYS9wY2kvaXZ0di9pdnR2LWlvY3RsLmgKaW5kZXggN2Y4YzZmNDNk
Mzk3ZjA1MGE4MTE2NDI5ZGI3YTlhN2FjY2MwMzM2Yi4uNTlhZGNhZTBjMmYzOTAyMGI3M2YxMTAw
YzBhNmFlNzA1MWI1MjhhOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvaXZ0di9pdnR2
LWlvY3RsLmgKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvaXZ0di9pdnR2LWlvY3RsLmgKQEAgLTE3
LDcgKzE3LDkgQEAgaW50IGl2dHZfc2V0X3NwZWVkKHN0cnVjdCBpdnR2ICppdHYsIGludCBzcGVl
ZCk7CiB2b2lkIGl2dHZfc2V0X2Z1bmNzKHN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYpOwogdm9p
ZCBpdnR2X3Nfc3RkX2VuYyhzdHJ1Y3QgaXZ0diAqaXR2LCB2NGwyX3N0ZF9pZCBzdGQpOwogdm9p
ZCBpdnR2X3Nfc3RkX2RlYyhzdHJ1Y3QgaXZ0diAqaXR2LCB2NGwyX3N0ZF9pZCBzdGQpOwotaW50
IGl2dHZfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBjb25zdCBzdHJ1
Y3QgdjRsMl9mcmVxdWVuY3kgKnZmKTsKLWludCBpdnR2X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgaW5wKTsKK2ludCBpdnR2X3NfZnJlcXVlbmN5KHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAg
ICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKnZmKTsKK2ludCBpdnR2X3NfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgdW5z
aWduZWQgaW50IGlucCk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kv
bWdiNC9tZ2I0X3Zpbi5jIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0X3Zpbi5jCmluZGV4
IDQyYzMyN2JjNTBlMTBhZjI0OTI4OGQyZGJkNzdlZmQzMTFhYmZkYmQuLjBkYmM0NjRlOTZkYmJk
ZDZhYTllYWYzZDRiZTFjMzFjMzk2NDczZWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGNp
L21nYjQvbWdiNF92aW4uYworKysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfdmluLmMK
QEAgLTM0Niw3ICszNDYsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZmlsZV9vcGVyYXRp
b25zIHZpZGVvX2ZvcHMgPSB7CiAJLnBvbGwgPSB2YjJfZm9wX3BvbGwsCiB9OwogCi1zdGF0aWMg
aW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgS0JVSUxEX01PRE5BTUUsIHNpemVvZihjYXAt
PmRyaXZlcikpOwpAQCAtMzU1LDcgKzM1Niw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQog
ewogCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0zNzIsNyArMzc0LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJfQogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1l
aW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRp
b2NfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mcm1p
dmFsZW51bSAqaXZhbCkKIHsKIAlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtMzk4LDcgKzQwMSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1f
ZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgbWdiNF9yZWdzICp2aWRlbyA9ICZ2aW5kZXYtPm1n
YmRldi0+dmlkZW87CkBAIC00MjksNyArNDMzLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2Nf
dHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbWdiNF92aW5fZGV2
ICp2aW5kZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBtZ2I0X3JlZ3MgKnZpZGVv
ID0gJnZpbmRldi0+bWdiZGV2LT52aWRlbzsKQEAgLTQ2MSw3ICs0NjYsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0
aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG1n
YjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgbWdiNF9y
ZWdzICp2aWRlbyA9ICZ2aW5kZXYtPm1nYmRldi0+dmlkZW87CkBAIC00NzAsNyArNDc2LDcgQEAg
c3RhdGljIGludCB2aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlpZiAodmIyX2lzX2J1c3koJnZpbmRldi0+cXVldWUpKQog
CQlyZXR1cm4gLUVCVVNZOwogCi0JdmlkaW9jX3RyeV9mbXQoZmlsZSwgcHJpdiwgZik7CisJdmlk
aW9jX3RyeV9mbXQoZmlsZSwgc3RhdGUsIGYpOwogCiAJY29uZmlnID0gbWdiNF9yZWFkX3JlZyh2
aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3MuY29uZmlnKTsKIAlpZiAoZi0+Zm10LnBpeC5waXhl
bGZvcm1hdCA9PSBWNEwyX1BJWF9GTVRfWVVZVikgewpAQCAtNDk5LDcgKzUwNSw4IEBAIHN0YXRp
YyBpbnQgdmlkaW9jX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1f
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19l
bnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmkpCiB7CiAJc3RydWN0
IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTUyMyw3ICs1
MzAsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1l
c2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2aWRpb2NfZW51
bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7
CiAJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAg
LTUzOSwxOCArNTQ3LDIxIEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBp
KQorc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCBpKQogewogCXJldHVy
biAoaSA9PSAwKSA/IDAgOiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMg
aW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50ICppKQogewogCSppID0gMDsKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX3N0
cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTU3Niw3ICs1ODcsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3Bh
cm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQog
ewogCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC01OTcsMTAgKzYwOSwxMSBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJCW1nYjRfd3JpdGVfcmVnKHZpZGVvLCB2aW5kZXYtPmNvbmZp
Zy0+cmVncy50aW1lciwgdGltZXIpOwogCX0KIAotCXJldHVybiB2aWRpb2NfZ19wYXJtKGZpbGUs
IHByaXYsIHBhcm0pOworCXJldHVybiB2aWRpb2NfZ19wYXJtKGZpbGUsIHN0YXRlLCBwYXJtKTsK
IH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAg
ICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCBtZ2I0X3Zpbl9k
ZXYgKnZpbmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02MjAsNyArNjMzLDggQEAgc3Rh
dGljIGludCB2aWRpb2Nfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19kdl90aW1pbmdzKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZHZfdGltaW5ncyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVj
dCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02MjksNyAr
NjQzLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfcXVlcnlfZHZf
dGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHZpZGlvY19x
dWVyeV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWlu
Z3MpCiB7CiAJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKQEAgLTYzNyw3ICs2NTIsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeV9kdl90aW1pbmdz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gZ2V0X3RpbWluZ3ModmluZGV2
LCB0aW1pbmdzKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9kdl90aW1pbmdzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZHZfdGltaW5n
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZW51bV9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0
cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02NTAs
NyArNjY2LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZHZf
dGltaW5nc19jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2aWRp
b2NfZHZfdGltaW5nc19jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzX2NhcCAqY2Fw
KQogewogCSpjYXAgPSB2aWRlb190aW1pbmdzX2NhcDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcGNpL21nYjQvbWdiNF92b3V0LmMgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfdm91
dC5jCmluZGV4IGMxNzljNDI1ZTE2N2NiM2EyYmJiMDkxOWRiYTM3NDlkZWRlZWIwNzAuLjNlNzFm
Mjg3MjQyMTc4MGVlMDVkNTY5MzA3N2E5MTIyMzFmOWY3ODEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
bWVkaWEvcGNpL21nYjQvbWdiNF92b3V0LmMKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9t
Z2I0X3ZvdXQuYwpAQCAtMjMyLDcgKzIzMiw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29w
cyBxdWV1ZV9vcHMgPSB7CiAJLnN0b3Bfc3RyZWFtaW5nID0gc3RvcF9zdHJlYW1pbmcsCiB9Owog
Ci1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBh
YmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgS0JVSUxEX01PRE5BTUUsIHNp
emVvZihjYXAtPmRyaXZlcikpOwpAQCAtMjQxLDcgKzI0Miw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9mbXRk
ZXNjICpmKQogewogCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZvdXRkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMjU4LDcgKzI2MCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCX0KIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
Z19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3Ry
dWN0IG1nYjRfcmVncyAqdmlkZW8gPSAmdm91dGRldi0+bWdiZGV2LT52aWRlbzsKQEAgLTI5MCw3
ICsyOTMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgbWdiNF9yZWdzICp2aWRlbyA9ICZ2b3V0ZGV2LT5tZ2JkZXYt
PnZpZGVvOwpAQCAtMzIyLDcgKzMyNiw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IG1nYjRfcmVncyAqdmlkZW8gPSAmdm91
dGRldi0+bWdiZGV2LT52aWRlbzsKQEAgLTMzMiw3ICszMzcsNyBAQCBzdGF0aWMgaW50IHZpZGlv
Y19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogCWlmICh2YjJfaXNfYnVzeSgmdm91dGRldi0+cXVldWUpKQogCQlyZXR1cm4gLUVCVVNZ
OwogCi0JcmV0ID0gdmlkaW9jX3RyeV9mbXQoZmlsZSwgcHJpdiwgZik7CisJcmV0ID0gdmlkaW9j
X3RyeV9mbXQoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4gcmV0Owog
CkBAIC0zNjMsMTggKzM2OCwyMSBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB2aWRpb2NfZ19vdXRwdXQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5z
aWduZWQgaW50ICppKQogewogCSppID0gMDsKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2
aWRpb2Nfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGlu
dCBpKQorc3RhdGljIGludCB2aWRpb2Nfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5zaWduZWQgaW50IGkpCiB7CiAJ
cmV0dXJuIGkgPyAtRUlOVkFMIDogMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9vdXRw
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19lbnVt
X291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfb3V0cHV0ICpvdXQpCiB7CiAJaWYg
KG91dC0+aW5kZXggIT0gMCkKQEAgLTM4Nyw3ICszOTUsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19l
bnVtX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJhbWVpbnRlcnZhbHMoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKml2YWwpCiB7CiAJc3RydWN0
IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNDE1LDcg
KzQyNCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9j
X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQogewogCXN0cnVjdCBt
Z2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQ0Myw3ICs0
NTMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBz
dHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQogewogCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2
b3V0ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQ2NiwxMCArNDc3LDExIEBAIHN0YXRp
YyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAkJbWdi
NF93cml0ZV9yZWcodmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy50aW1lciwgdGltZXIpOwog
CX0KIAotCXJldHVybiB2aWRpb2NfZ19wYXJtKGZpbGUsIHByaXYsIHBhcm0pOworCXJldHVybiB2
aWRpb2NfZ19wYXJtKGZpbGUsIHN0YXRlLCBwYXJtKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
Z19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlk
aW9jX2dfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdz
ICp0aW1pbmdzKQogewogCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTQ3OSw3ICs0OTEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2R2X3Rp
bWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IHZpZGlvY19zX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAor
c3RhdGljIGludCB2aWRpb2Nfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2
NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCiB7CiAJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRk
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNDg5LDcgKzUwMiw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2R2X3RpbWluZ3Moc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkgIHN0cnVjdCB2NGwyX2VudW1fZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlzdHJ1Y3QgbWdi
NF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01MDIsNyArNTE2
LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZHZfdGltaW5n
c19jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2aWRpb2NfZHZf
dGltaW5nc19jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzX2NhcCAqY2FwKQogewog
CSpjYXAgPSB2aWRlb190aW1pbmdzX2NhcDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNp
L3NhYTcxMzQvc2FhNzEzNC1lbXByZXNzLmMgYi9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTM0L3Nh
YTcxMzQtZW1wcmVzcy5jCmluZGV4IDhjNGY3MGU0MTc3ZDE4MzZhZDY4NWJlODUxZGY2M2IyMzQ2
NzRjNDAuLjAzZmJjZWQ3YWYzZTZkMDEyYzg0NDRlNDI0MWJkOTNjOGMwMmI0Y2UgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvbWVkaWEvcGNpL3NhYTcxMzQvc2FhNzEzNC1lbXByZXNzLmMKKysrIGIvZHJp
dmVycy9tZWRpYS9wY2kvc2FhNzEzNC9zYWE3MTM0LWVtcHJlc3MuYwpAQCAtODQsNyArODQsOCBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IHZiMl9vcHMgc2FhNzEzNF9lbXByZXNzX3FvcHMgPSB7CiAK
IC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLSAqLwogCi1zdGF0aWMgaW50IGVtcHJlc3NfZW51bV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IGVtcHJlc3NfZW51bV9m
bXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYgKGYt
PmluZGV4ICE9IDApCkBAIC05NCw3ICs5NSw4IEBAIHN0YXRpYyBpbnQgZW1wcmVzc19lbnVtX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBlbXByZXNzX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IGVtcHJlc3NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTExMyw3ICsxMTUsOCBAQCBzdGF0aWMgaW50IGVtcHJlc3NfZ19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBlbXByZXNzX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IGVtcHJlc3Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTEzMiw3ICsxMzUsOCBAQCBzdGF0aWMgaW50IGVtcHJlc3Nfc19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBlbXByZXNzX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgZW1wcmVzc190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL3NhYTcxMzQvc2FhNzEz
NC12aWRlby5jIGIvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzEzNC9zYWE3MTM0LXZpZGVvLmMKaW5k
ZXggNGE1MWI4NzNlNDdhZDY0YjQ5ZjdjNDY0ZjZlOTZkMzFiYTNlMzEzZS4uMDQ4NmI3YzE4ZDJj
Njc2ZWUyMjk3MmEwODMzNjVlNjI2Njc2OTA4OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9w
Y2kvc2FhNzEzNC9zYWE3MTM0LXZpZGVvLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzEz
NC9zYWE3MTM0LXZpZGVvLmMKQEAgLTEwMTEsOCArMTAxMSw5IEBAIHN0YXRpYyBfX3BvbGxfdCBy
YWRpb19wb2xsKHN0cnVjdCBmaWxlICpmaWxlLCBwb2xsX3RhYmxlICp3YWl0KQogCiAvKiAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0gKi8KIAotc3RhdGljIGludCBzYWE3MTM0X3RyeV9nZXRfc2V0X2ZtdF92YmlfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQorc3RhdGljIGludCBzYWE3MTM0X3RyeV9nZXRfc2V0X2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkJ
ICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3Qgc2FhNzEzNF90dm5vcm0gKm5vcm0gPSBkZXYt
PnR2bm9ybTsKQEAgLTEwMzEsOCArMTAzMiw5IEBAIHN0YXRpYyBpbnQgc2FhNzEzNF90cnlfZ2V0
X3NldF9mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBzYWE3MTM0X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCi0JCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBz
YWE3MTM0X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMDUx
LDggKzEwNTMsOSBAQCBzdGF0aWMgaW50IHNhYTcxMzRfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzYWE3MTM0
X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCQkJCXN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgc2FhNzEzNF90cnlfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTM0X2Rl
diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3Qgc2FhNzEzNF9mb3JtYXQgKmZt
dDsKQEAgLTExMDQsMTMgKzExMDcsMTQgQEAgc3RhdGljIGludCBzYWE3MTM0X3RyeV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBzYWE3MTM0X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCi0JCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgc2FhNzEzNF9zX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3
MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlpbnQgZXJyOwogCi0JZXJyID0g
c2FhNzEzNF90cnlfZm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwgZik7CisJZXJyID0gc2FhNzEzNF90
cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogCWlmICgwICE9IGVycikKIAkJcmV0dXJu
IGVycjsKIApAQCAtMTEyMSw3ICsxMTI1LDggQEAgc3RhdGljIGludCBzYWE3MTM0X3NfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLWlu
dCBzYWE3MTM0X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVj
dCB2NGwyX2lucHV0ICppKQoraW50IHNhYTcxMzRfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9pbnB1dCAqaSkKIHsKIAlzdHJ1Y3Qgc2FhNzEzNF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAJdW5zaWduZWQgaW50IG47CkBAIC0xMTU5LDcgKzExNjQsOCBAQCBpbnQgc2FhNzEz
NF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9p
bnB1dCAqaSkKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHNhYTcxMzRfZW51bV9pbnB1dCk7CiAKLWlu
dCBzYWE3MTM0X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGludCAqaSkKK2ludCBzYWE3MTM0X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgdW5zaWduZWQgaW50ICppKQogewogCXN0
cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTE2OCw3
ICsxMTc0LDggQEAgaW50IHNhYTcxMzRfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgdW5zaWduZWQgaW50ICppKQogfQogRVhQT1JUX1NZTUJPTF9HUEwoc2FhNzEzNF9nX2lu
cHV0KTsKIAotaW50IHNhYTcxMzRfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgdW5zaWduZWQgaW50IGkpCitpbnQgc2FhNzEzNF9zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIHVuc2lnbmVkIGludCBp
KQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApA
QCAtMTE4MSw3ICsxMTg4LDggQEAgaW50IHNhYTcxMzRfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCiB9CiBFWFBPUlRfU1lNQk9MX0dQTChzYWE3
MTM0X3NfaW5wdXQpOwogCi1pbnQgc2FhNzEzNF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK2ludCBzYWE3MTM0X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9j
YXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtMTIwMSw3ICsxMjA5LDggQEAgaW50IHNhYTcxMzRfcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiBFWFBPUlRfU1lNQk9MX0dQTChzYWE3MTM0
X3F1ZXJ5Y2FwKTsKIAotaW50IHNhYTcxMzRfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHY0bDJfc3RkX2lkIGlkKQoraW50IHNhYTcxMzRfc19zdGQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgIHY0bDJfc3RkX2lkIGlk
KQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAl1
bnNpZ25lZCBpbnQgaTsKQEAgLTEyNDUsNyArMTI1NCw4IEBAIGludCBzYWE3MTM0X3Nfc3RkKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBpZCkKIH0KIEVYUE9SVF9T
WU1CT0xfR1BMKHNhYTcxMzRfc19zdGQpOwogCi1pbnQgc2FhNzEzNF9nX3N0ZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKmlkKQoraW50IHNhYTcxMzRfZ19zdGQo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkg
IHY0bDJfc3RkX2lkICppZCkKIHsKIAlzdHJ1Y3Qgc2FhNzEzNF9kZXYgKmRldiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAKQEAgLTEyNzUsNyArMTI4NSw4IEBAIHN0YXRpYyB2NGwyX3N0ZF9pZCBz
YWE3MTM0X3JlYWRfc3RkKHN0cnVjdCBzYWE3MTM0X2RldiAqZGV2KQogCXJldHVybiByZXN1bHQ7
CiB9CiAKLWludCBzYWE3MTM0X3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCB2NGwyX3N0ZF9pZCAqc3RkKQoraW50IHNhYTcxMzRfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgIHY0bDJfc3RkX2lk
ICpzdGQpCiB7CiAJc3RydWN0IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwogCSpzdGQgJj0gc2FhNzEzNF9yZWFkX3N0ZChkZXYpOwpAQCAtMTI4Myw4ICsxMjk0LDkgQEAg
aW50IHNhYTcxMzRfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJf
c3RkX2lkICpzdGQpCiB9CiBFWFBPUlRfU1lNQk9MX0dQTChzYWE3MTM0X3F1ZXJ5c3RkKTsKIAot
c3RhdGljIGludCBzYWE3MTM0X2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCi0JCQkJIGludCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAqZikKK3N0YXRpYyBpbnQg
c2FhNzEzNF9nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgaW50IHR5cGUsCisJCQkJIHN0cnVjdCB2NGwyX2ZyYWN0
ICpmKQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
IApAQCAtMTMwMiw3ICsxMzE0LDkgQEAgc3RhdGljIGludCBzYWE3MTM0X2dfcGl4ZWxhc3BlY3Qo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgc2FhNzEzNF9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCitzdGF0aWMgaW50IHNhYTcxMzRfZ19zZWxlY3Rpb24o
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkgICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0
IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMzI1LDcgKzEz
MzksOSBAQCBzdGF0aWMgaW50IHNhYTcxMzRfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3NlbGVjdAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHNhYTcxMzRfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQorc3RhdGljIGludCBzYWE3MTM0X3Nfc2VsZWN0aW9u
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJICAgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQogewogCXN0cnVj
dCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9y
ZWN0ICpiID0gJmRldi0+Y3JvcF9ib3VuZHM7CkBAIC0xMzU4LDggKzEzNzQsOCBAQCBzdGF0aWMg
aW50IHNhYTcxMzRfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX3NlbGVjdAogCXJldHVybiAwOwogfQogCi1pbnQgc2FhNzEzNF9nX3R1bmVyKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCQlzdHJ1Y3QgdjRsMl90dW5lciAqdCkK
K2ludCBzYWE3MTM0X2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3RydWN0IHY0bDJfdHVuZXIgKnQpCiB7CiAJc3RydWN0
IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWludCBuOwpAQCAtMTM5
MSw4ICsxNDA3LDggQEAgaW50IHNhYTcxMzRfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHNhYTcxMzRfZ190dW5lcik7CiAKLWludCBz
YWE3MTM0X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJCWNvbnN0
IHN0cnVjdCB2NGwyX3R1bmVyICp0KQoraW50IHNhYTcxMzRfc190dW5lcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICBjb25zdCBzdHJ1
Y3QgdjRsMl90dW5lciAqdCkKIHsKIAlzdHJ1Y3Qgc2FhNzEzNF9kZXYgKmRldiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAJaW50IHJ4LCBtb2RlOwpAQCAtMTQxMiw4ICsxNDI4LDggQEAgaW50IHNh
YTcxMzRfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIEVYUE9SVF9T
WU1CT0xfR1BMKHNhYTcxMzRfc190dW5lcik7CiAKLWludCBzYWE3MTM0X2dfZnJlcXVlbmN5KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kg
KmYpCitpbnQgc2FhNzEzNF9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7
CiAJc3RydWN0IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0x
NDI2LDggKzE0NDIsOCBAQCBpbnQgc2FhNzEzNF9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHNhYTcxMzRfZ19mcmVxdWVuY3kp
OwogCi1pbnQgc2FhNzEzNF9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKLQkJCQkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQoraW50IHNhYTcxMzRfc19m
cmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBzYWE3
MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTQ0MSw4ICsxNDU3LDkg
QEAgaW50IHNhYTcxMzRfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiB9CiBFWFBPUlRfU1lNQk9MX0dQTChzYWE3MTM0X3NfZnJlcXVlbmN5KTsKIAotc3RhdGljIGlu
dCBzYWE3MTM0X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2
LAotCQkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQorc3RhdGljIGludCBzYWE3MTM0X2VudW1f
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlm
IChmLT5pbmRleCA+PSBGT1JNQVRTKQogCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTE0NTMsOCArMTQ3
MCw5IEBAIHN0YXRpYyBpbnQgc2FhNzEzNF9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICAqcHJpdiwKIH0KIAogI2lmZGVmIENPTkZJR19WSURFT19BRFZfREVCVUcKLXN0
YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIgKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAotCQkJICAgICAgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCitzdGF0aWMgaW50IHZp
ZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpy
ZWcpCiB7CiAJc3RydWN0IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwog
CkBAIC0xNDYzLDggKzE0ODEsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3JlZ2lzdGVyIChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2
aWRpb2Nfc19yZWdpc3RlciAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJY29u
c3Qgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCitzdGF0aWMgaW50IHZpZGlvY19zX3Jl
Z2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCSAgICAgY29uc3Qgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcp
CiB7CiAJc3RydWN0IHNhYTcxMzRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBA
IC0xNDczLDggKzE0OTIsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyIChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KICNlbmRpZgogCi1zdGF0aWMgaW50IHJhZGlvX2df
dHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJCXN0cnVjdCB2NGwyX3R1
bmVyICp0KQorc3RhdGljIGludCByYWRpb19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl90dW5lciAqdCkK
IHsKIAlzdHJ1Y3Qgc2FhNzEzNF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAg
LTE0OTIsOCArMTUxMSw5IEBAIHN0YXRpYyBpbnQgcmFkaW9fZ190dW5lcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAl9CiAJcmV0dXJuIDA7CiB9Ci1zdGF0aWMgaW50IHJhZGlvX3Nf
dHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJCWNvbnN0IHN0cnVjdCB2
NGwyX3R1bmVyICp0KQorCitzdGF0aWMgaW50IHJhZGlvX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIGNvbnN0IHN0cnVjdCB2
NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBzYWE3MTM0X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzEzNC9zYWE3MTM0
LmggYi9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTM0L3NhYTcxMzQuaAppbmRleCA5ZjI3ZTM3NzVj
MjczZTFiNDczOGYwMjIzOTlkNjI0YjE4ZjY5NWNjLi41Nzc1ZGYyMTk0ZDFkMzU5YjM0OTZlMjlm
MjNmNDIxNTQ0MjBhYjZlIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTM0L3Nh
YTcxMzQuaAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTM0L3NhYTcxMzQuaApAQCAtNzk1
LDIyICs3OTUsMjggQEAgdm9pZCBzYWE3MTM0X3ZiMl9idWZmZXJfcXVldWUoc3RydWN0IHZiMl9i
dWZmZXIgKnZiKTsKIGludCBzYWE3MTM0X3ZiMl9zdGFydF9zdHJlYW1pbmcoc3RydWN0IHZiMl9x
dWV1ZSAqdnEsIHVuc2lnbmVkIGludCBjb3VudCk7CiB2b2lkIHNhYTcxMzRfdmIyX3N0b3Bfc3Ry
ZWFtaW5nKHN0cnVjdCB2YjJfcXVldWUgKnZxKTsKIAotaW50IHNhYTcxMzRfc19zdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIGlkKTsKLWludCBzYWE3MTM0X2df
c3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqaWQpOwotaW50
IHNhYTcxMzRfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3Rk
X2lkICpzdGQpOwotaW50IHNhYTcxMzRfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgc3RydWN0IHY0bDJfaW5wdXQgKmkpOwotaW50IHNhYTcxMzRfZ19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKTsKLWludCBzYWE3MTM0
X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKTsK
LWludCBzYWE3MTM0X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKLQkJ
CQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKTsKLWludCBzYWE3MTM0X2dfdHVuZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJCXN0cnVjdCB2NGwyX3R1bmVyICp0KTsK
LWludCBzYWE3MTM0X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJ
CWNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0KTsKLWludCBzYWE3MTM0X2dfZnJlcXVlbmN5KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kg
KmYpOwotaW50IHNhYTcxMzRfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCi0JCQkJCWNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZik7CitpbnQgc2FhNzEzNF9z
X3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCSAgdjRsMl9zdGRfaWQgaWQpOworaW50IHNhYTcxMzRfZ19zdGQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgIHY0bDJfc3RkX2lkICpp
ZCk7CitpbnQgc2FhNzEzNF9xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgdjRsMl9zdGRfaWQgKnN0ZCk7CitpbnQgc2Fh
NzEzNF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJICAgICAgIHN0cnVjdCB2NGwyX2lucHV0ICppKTsKK2ludCBzYWE3MTM0
X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkgICAgdW5zaWduZWQgaW50ICppKTsKK2ludCBzYWE3MTM0X3NfaW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgdW5z
aWduZWQgaW50IGkpOworaW50IHNhYTcxMzRfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgIHN0cnVjdCB2NGwyX2NhcGFi
aWxpdHkgKmNhcCk7CitpbnQgc2FhNzEzNF9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIHN0cnVjdCB2NGwyX3R1bmVyICp0
KTsKK2ludCBzYWE3MTM0X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQpOwor
aW50IHNhYTcxMzRfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKTsKK2ludCBz
YWE3MTM0X3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCWNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZik7CiAKIGlu
dCBzYWE3MTM0X3ZpZGVvcG9ydF9pbml0KHN0cnVjdCBzYWE3MTM0X2RldiAqZGV2KTsKIHZvaWQg
c2FhNzEzNF9zZXRfdHZub3JtX2h3KHN0cnVjdCBzYWE3MTM0X2RldiAqZGV2KTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvbWVkaWEvcGNpL3NhYTcxNDYvaGV4aXVtX2dlbWluaS5jIGIvZHJpdmVycy9t
ZWRpYS9wY2kvc2FhNzE0Ni9oZXhpdW1fZ2VtaW5pLmMKaW5kZXggNDBiMzUwOThmM2VhZDFkNjMz
NzhkMDViZWIyY2NkZGYzOTc3YTJkYS4uY2RiZGZkZjYyNzM2MmIyMDI1MjhlNDBlZmJkMzgwMDhl
NDY0ZjRmOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzE0Ni9oZXhpdW1fZ2Vt
aW5pLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzE0Ni9oZXhpdW1fZ2VtaW5pLmMKQEAg
LTIwMSw3ICsyMDEsOSBAQCBzdGF0aWMgaW50IGhleGl1bV9zZXRfc3RhbmRhcmQoc3RydWN0IGhl
eGl1bSAqaGV4aXVtLCBzdHJ1Y3QgaGV4aXVtX2RhdGEgKnZkZWMpCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJICAgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkKIHsKIAlERUJfRUUoIlZJRElPQ19FTlVN
SU5QVVQgJWRcbiIsIGktPmluZGV4KTsKIApAQCAtMjE0LDcgKzIxNiw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRs
Ml9pbnB1dCAqaSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCAqaW5wdXQpCitzdGF0aWMg
aW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50ICppbnB1dCkKIHsKIAlzdHJ1Y3Qgc2Fh
NzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGhleGl1bSAqaGV4
aXVtID0gKHN0cnVjdCBoZXhpdW0gKikgZGV2LT5leHRfcHJpdjsKQEAgLTIyNSw3ICsyMjgsOCBA
QCBzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
dW5zaWduZWQgaW50ICppbnB1dCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
c19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpbnB1dCkK
K3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaW5wdXQpCiB7CiAJc3Ry
dWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBoZXhp
dW0gKmhleGl1bSA9IChzdHJ1Y3QgaGV4aXVtICopIGRldi0+ZXh0X3ByaXY7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTQ2L2hleGl1bV9vcmlvbi5jIGIvZHJpdmVycy9tZWRp
YS9wY2kvc2FhNzE0Ni9oZXhpdW1fb3Jpb24uYwppbmRleCBhMjA3NjcyOGM2MjEwZTlkNTQ0MmY1
MWZiYmMxM2E4NzM3MTk3M2U0Li4wMDc1ZjBkMmI5NjJiNDY5NjBmNjUwMjU2NDI1Y2E3NjIwYzNh
OGE2IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTQ2L2hleGl1bV9vcmlvbi5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL3NhYTcxNDYvaGV4aXVtX29yaW9uLmMKQEAgLTMxMiw3
ICszMTIsOSBAQCBzdGF0aWMgaW50IGhleGl1bV9zZXRfaW5wdXQoc3RydWN0IGhleGl1bSAqaGV4
aXVtLCBpbnQgaW5wdXQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1f
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkK
K3N0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgdjRsMl9p
bnB1dCAqaSkKIHsKIAlERUJfRUUoIlZJRElPQ19FTlVNSU5QVVQgJWRcbiIsIGktPmluZGV4KTsK
IApAQCAtMzI1LDcgKzMyNyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHVuc2lnbmVkIGludCAqaW5wdXQpCitzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5z
aWduZWQgaW50ICppbnB1dCkKIHsKIAlzdHJ1Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAJc3RydWN0IGhleGl1bSAqaGV4aXVtID0gKHN0cnVjdCBoZXhpdW0gKikg
ZGV2LT5leHRfcHJpdjsKQEAgLTMzNiw3ICszMzksOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50ICppbnB1dCkKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpbnB1dCkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5w
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJICB1bnNpZ25lZCBpbnQgaW5wdXQpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBoZXhpdW0gKmhleGl1bSA9IChzdHJ1Y3QgaGV4
aXVtICopIGRldi0+ZXh0X3ByaXY7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9zYWE3
MTQ2L214Yi5jIGIvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzE0Ni9teGIuYwppbmRleCBhMTRiODM5
MDk4Yjg0OTFiMmEyZmYzY2UwZDlkMjU2ODIzMDk2MDdlLi44YWQwNDhkZmEwMTM0ZjhjZjlhOWJh
ODAzNDVkMjhkNzQzMjAxYWQ0IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTQ2
L214Yi5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL3NhYTcxNDYvbXhiLmMKQEAgLTQ0Niw3ICs0
NDYsOSBAQCB2b2lkIG14Yl9pcnFfYmgoc3RydWN0IHNhYTcxNDZfZGV2KiBkZXYsIHUzMiogaXJx
X21hc2spCiB9CiAqLwogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfaW5wdXQgKmkpCitzdGF0aWMgaW50IHZpZGlv
Y19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmkpCiB7CiAJREVC
X0VFKCJWSURJT0NfRU5VTUlOUFVUICVkXG4iLCBpLT5pbmRleCk7CiAJaWYgKGktPmluZGV4ID49
IE1YQl9JTlBVVFMpCkBAIC00NTUsNyArNDU3LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2lucHV0ICppKQog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB2aWRpb2NfZ19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQkgIHVuc2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IG14YiAqbXhiID0gKHN0cnVjdCBteGIgKilkZXYtPmV4
dF9wcml2OwpAQCAtNDY1LDcgKzQ2OCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgKmkpCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCB1bnNpZ25lZCBpbnQgaW5wdXQpCitzdGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWdu
ZWQgaW50IGlucHV0KQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIAlzdHJ1Y3QgbXhiICpteGIgPSAoc3RydWN0IG14YiAqKWRldi0+ZXh0X3ByaXY7
CkBAIC01MzAsNyArNTM0LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpbnB1dCkKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0
cnVjdCB2NGwyX3R1bmVyICp0KQorc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHN0cnVjdCB2
NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIAlzdHJ1Y3QgbXhiICpteGIgPSAoc3RydWN0IG14YiAqKWRldi0+ZXh0X3ByaXY7
CkBAIC01NTIsNyArNTU3LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3R1bmVyICp0KQogCXJldHVybiBjYWxsX2Fs
bChkZXYsIHR1bmVyLCBnX3R1bmVyLCB0KTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc190dW5l
cihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0
KQorc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0
KQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlz
dHJ1Y3QgbXhiICpteGIgPSAoc3RydWN0IG14YiAqKWRldi0+ZXh0X3ByaXY7CkBAIC01NjcsMTQg
KzU3MywxOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKgogCXJldHVybiBjYWxsX2FsbChkZXYs
IHR1bmVyLCBzX3R1bmVyLCB0KTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfcXVlcnlzdGQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB2NGwyX3N0ZF9pZCAqbm9ybSkKK3N0YXRpYyBpbnQg
dmlkaW9jX3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICB2NGwyX3N0ZF9pZCAqbm9ybSkKIHsKIAlzdHJ1Y3Qg
c2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlyZXR1cm4gY2FsbF9h
bGwoZGV2LCB2aWRlbywgcXVlcnlzdGQsIG5vcm0pOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19n
X2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZyZXF1
ZW5jeSAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBz
dHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBteGIgKm14YiA9IChzdHJ1Y3QgbXhiICopZGV2
LT5leHRfcHJpdjsKQEAgLTU4Nyw3ICs1OTcsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1
ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeQog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKK3N0YXRp
YyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBjb25zdCBzdHJ1Y3QgdjRs
Ml9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwogCXN0cnVjdCBteGIgKm14YiA9IChzdHJ1Y3QgbXhiICopZGV2LT5leHRfcHJp
djsKQEAgLTYxMCw3ICs2MjIsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZQogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1hdWRp
byhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIHsKIAlpZiAoYS0+aW5kZXggPj0g
TVhCX0FVRElPUykKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC02MTgsNyArNjMyLDggQEAgc3RhdGlj
IGludCB2aWRpb2NfZW51bWF1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfYXVkaW8gKmEpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfYXVk
aW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKK3N0
YXRpYyBpbnQgdmlkaW9jX2dfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIHsKIAlzdHJ1
Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IG14YiAq
bXhiID0gKHN0cnVjdCBteGIgKilkZXYtPmV4dF9wcml2OwpAQCAtNjI4LDcgKzY0Myw4IEBAIHN0
YXRpYyBpbnQgdmlkaW9jX2dfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9hdWRpbyAqYSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19h
dWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlv
ICphKQorc3RhdGljIGludCB2aWRpb2Nfc19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIGNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlv
ICphKQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
IAlzdHJ1Y3QgbXhiICpteGIgPSAoc3RydWN0IG14YiAqKWRldi0+ZXh0X3ByaXY7CkBAIC02NDgs
NyArNjY0LDkgQEAgc3RhdGljIGludCB2aWRpb2Nfc19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlvICoKIH0KIAogI2lmZGVmIENPTkZJR19W
SURFT19BRFZfREVCVUcKLXN0YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKK3N0YXRpYyBp
bnQgdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0
ZXIgKnJlZykKIHsKIAlzdHJ1Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKQEAgLTY1OSw3ICs2NzcsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3JlZ2lzdGVyKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCitzdGF0aWMg
aW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgY29uc3Qgc3RydWN0IHY0bDJfZGJn
X3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9zYWE3MTY0L3NhYTcx
NjQtZW5jb2Rlci5jIGIvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzE2NC9zYWE3MTY0LWVuY29kZXIu
YwppbmRleCA2NmQ2NTBiNWY2OWFmMWVhYzkxMTdiOWM2NWFjN2MzOTg4M2Y2ZjIxLi4xYTE5M2E0
YzA1YTQ1ZjQyMWY1NjY2ZTQ3YTQ2ZmRlMGI3MDJmNDdiIDEwMDY0NAotLS0gYS9kcml2ZXJzL21l
ZGlhL3BjaS9zYWE3MTY0L3NhYTcxNjQtZW5jb2Rlci5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNp
L3NhYTcxNjQvc2FhNzE2NC1lbmNvZGVyLmMKQEAgLTIxNyw3ICsyMTcsOCBAQCBpbnQgc2FhNzE2
NF9zX3N0ZChzdHJ1Y3Qgc2FhNzE2NF9wb3J0ICpwb3J0LCB2NGwyX3N0ZF9pZCBpZCkKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHY0bDJfc3RkX2lkIGlkKQorc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9z
dGRfaWQgaWQpCiB7CiAJc3RydWN0IHNhYTcxNjRfZW5jb2Rlcl9maCAqZmggPSB0b19zYWE3MTY0
X2VuY29kZXJfZmgoZmlsZSk7CiAKQEAgLTIzMCwxNCArMjMxLDE2IEBAIGludCBzYWE3MTY0X2df
c3RkKHN0cnVjdCBzYWE3MTY0X3BvcnQgKnBvcnQsIHY0bDJfc3RkX2lkICppZCkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHY0bDJfc3RkX2lkICppZCkKK3N0YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3Rk
X2lkICppZCkKIHsKIAlzdHJ1Y3Qgc2FhNzE2NF9lbmNvZGVyX2ZoICpmaCA9IHRvX3NhYTcxNjRf
ZW5jb2Rlcl9maChmaWxlKTsKIAogCXJldHVybiBzYWE3MTY0X2dfc3RkKGZoLT5wb3J0LCBpZCk7
CiB9CiAKLWludCBzYWE3MTY0X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHN0cnVjdCB2NGwyX2lucHV0ICppKQoraW50IHNhYTcxNjRfZW51bV9pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBz
dHJ1Y3QgdjRsMl9pbnB1dCAqaSkKIHsKIAlzdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IGlucHV0
c1tdID0gewogCQkidHVuZXIiLCAiY29tcG9zaXRlIiwgInN2aWRlbyIsICJhdXgiLApAQCAtMjc1
LDcgKzI3OCw4IEBAIGludCBzYWE3MTY0X2dfaW5wdXQoc3RydWN0IHNhYTcxNjRfcG9ydCAqcG9y
dCwgdW5zaWduZWQgaW50ICppKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19n
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitz
dGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50ICppKQogewogCXN0cnVjdCBz
YWE3MTY0X2VuY29kZXJfZmggKmZoID0gdG9fc2FhNzE2NF9lbmNvZGVyX2ZoKGZpbGUpOwogCkBA
IC0yOTksMTQgKzMwMywxNiBAQCBpbnQgc2FhNzE2NF9zX2lucHV0KHN0cnVjdCBzYWE3MTY0X3Bv
cnQgKnBvcnQsIHVuc2lnbmVkIGludCBpKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQg
aSkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlzdHJ1
Y3Qgc2FhNzE2NF9lbmNvZGVyX2ZoICpmaCA9IHRvX3NhYTcxNjRfZW5jb2Rlcl9maChmaWxlKTsK
IAogCXJldHVybiBzYWE3MTY0X3NfaW5wdXQoZmgtPnBvcnQsIGkpOwogfQogCi1pbnQgc2FhNzE2
NF9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5l
ciAqdCkKK2ludCBzYWE3MTY0X2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3RydWN0IHY0bDJfdHVuZXIgKnQpCiB7CiAJ
c3RydWN0IHNhYTcxNjRfZW5jb2Rlcl9maCAqZmggPSB0b19zYWE3MTY0X2VuY29kZXJfZmgoZmls
ZSk7CiAJc3RydWN0IHNhYTcxNjRfcG9ydCAqcG9ydCA9IGZoLT5wb3J0OwpAQCAtMzI1LDcgKzMz
MSw4IEBAIGludCBzYWE3MTY0X2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX3R1bmVyICp0KQogCXJldHVybiAwOwogfQogCi1pbnQgc2FhNzE2NF9zX3R1
bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHNhYTcxNjRfc190dW5lcihz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJICAgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQpCiB7CiAJaWYgKDAgIT0gdC0+aW5k
ZXgpCkBAIC0zNDQsOCArMzUxLDggQEAgaW50IHNhYTcxNjRfZ19mcmVxdWVuY3koc3RydWN0IHNh
YTcxNjRfcG9ydCAqcG9ydCwgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKLQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCitzdGF0aWMgaW50IHZpZGlvY19n
X2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHNh
YTcxNjRfZW5jb2Rlcl9maCAqZmggPSB0b19zYWE3MTY0X2VuY29kZXJfZmgoZmlsZSk7CiAKQEAg
LTM5Nyw3ICs0MDQsOCBAQCBpbnQgc2FhNzE2NF9zX2ZyZXF1ZW5jeShzdHJ1Y3Qgc2FhNzE2NF9w
b3J0ICpwb3J0LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5j
eShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZnJl
cXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7
CiAJc3RydWN0IHNhYTcxNjRfZW5jb2Rlcl9maCAqZmggPSB0b19zYWE3MTY0X2VuY29kZXJfZmgo
ZmlsZSk7CkBAIC00ODAsOCArNDg4LDggQEAgc3RhdGljIGludCBzYWE3MTY0X3NfY3RybChzdHJ1
Y3QgdjRsMl9jdHJsICpjdHJsKQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKLQlzdHJ1Y3QgdjRsMl9j
YXBhYmlsaXR5ICpjYXApCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRs
Ml9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHNhYTcxNjRfZW5jb2Rlcl9maCAqZmggPSB0
b19zYWE3MTY0X2VuY29kZXJfZmgoZmlsZSk7CiAJc3RydWN0IHNhYTcxNjRfcG9ydCAqcG9ydCA9
IGZoLT5wb3J0OwpAQCAtNDk2LDggKzUwNCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnBy
aXYsCi0Jc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYgKGYtPmluZGV4ICE9
IDApCiAJCXJldHVybiAtRUlOVkFMOwpAQCAtNTA3LDcgKzUxNSw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTY0X2VuY29kZXJfZmgg
KmZoID0gdG9fc2FhNzE2NF9lbmNvZGVyX2ZoKGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wY2kvc2FhNzE2NC9zYWE3MTY0LXZiaS5jIGIvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzE2
NC9zYWE3MTY0LXZiaS5jCmluZGV4IDU3ZTQzNjJjMGQxOWQwZDNhNWYwYmUxZWU1OGNkMTQxZmRm
NjI0NjIuLjc0YzcxYTYxYWI0ZGIwNDVkYjQ0YTgyODMwNjMzMzc5OTJiZGYyMjYgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvbWVkaWEvcGNpL3NhYTcxNjQvc2FhNzE2NC12YmkuYworKysgYi9kcml2ZXJz
L21lZGlhL3BjaS9zYWE3MTY0L3NhYTcxNjQtdmJpLmMKQEAgLTE0Miw0NCArMTQyLDQ4IEBAIHN0
YXRpYyBpbnQgc2FhNzE2NF92YmlfaW5pdGlhbGl6ZShzdHJ1Y3Qgc2FhNzE2NF9wb3J0ICpwb3J0
KQogfQogCiAvKiAtLSBWNEwyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLSAqLwotc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIGlkKQorc3RhdGljIGludCB2aWRpb2Nf
c19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJdjRsMl9zdGRfaWQgaWQpCiB7CiAJc3RydWN0IHNhYTcxNjRfdmJpX2ZoICpmaCA9IHRv
X3NhYTcxNjRfdmJpX2ZoKGZpbGUpOwogCiAJcmV0dXJuIHNhYTcxNjRfc19zdGQoZmgtPnBvcnQt
PmVuY19wb3J0LCBpZCk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqaWQpCitzdGF0aWMgaW50IHZpZGlvY19n
X3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQl2NGwyX3N0ZF9pZCAqaWQpCiB7CiAJc3RydWN0IHNhYTcxNjRfdmJpX2ZoICpmaCA9IHRv
X3NhYTcxNjRfdmJpX2ZoKGZpbGUpOwogCiAJcmV0dXJuIHNhYTcxNjRfZ19zdGQoZmgtPnBvcnQt
PmVuY19wb3J0LCBpZCk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKK3N0YXRpYyBpbnQgdmlkaW9j
X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IHNhYTcxNjRfdmJpX2ZoICpm
aCA9IHRvX3NhYTcxNjRfdmJpX2ZoKGZpbGUpOwogCiAJcmV0dXJuIHNhYTcxNjRfZ19pbnB1dChm
aC0+cG9ydC0+ZW5jX3BvcnQsIGkpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKK3N0YXRpYyBpbnQg
dmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlzdHJ1Y3Qgc2FhNzE2NF92Ymlf
ZmggKmZoID0gdG9fc2FhNzE2NF92YmlfZmgoZmlsZSk7CiAKIAlyZXR1cm4gc2FhNzE2NF9zX2lu
cHV0KGZoLT5wb3J0LT5lbmNfcG9ydCwgaSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZnJl
cXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCXN0cnVjdCB2NGwyX2ZyZXF1
ZW5jeSAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwy
X2ZyZXF1ZW5jeSAqZikKIHsKIAlzdHJ1Y3Qgc2FhNzE2NF92YmlfZmggKmZoID0gdG9fc2FhNzE2
NF92YmlfZmgoZmlsZSk7CiAKIAlyZXR1cm4gc2FhNzE2NF9nX2ZyZXF1ZW5jeShmaC0+cG9ydC0+
ZW5jX3BvcnQsIGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQljb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYp
CitzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBjb25zdCBzdHJ1Y3QgdjRsMl9m
cmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHNhYTcxNjRfdmJpX2ZoICpmaCA9IHRvX3NhYTcxNjRf
dmJpX2ZoKGZpbGUpOwogCWludCByZXQgPSBzYWE3MTY0X3NfZnJlcXVlbmN5KGZoLT5wb3J0LT5l
bmNfcG9ydCwgZik7CkBAIC0xODksOCArMTkzLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mcmVx
dWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2
LAotCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3Qgc2FhNzE2NF92
YmlfZmggKmZoID0gdG9fc2FhNzE2NF92YmlfZmgoZmlsZSk7CiAJc3RydWN0IHNhYTcxNjRfcG9y
dCAqcG9ydCA9IGZoLT5wb3J0OwpAQCAtMzkwLDcgKzM5NCw4IEBAIHN0YXRpYyBpbnQgc2FhNzE2
NF92Ymlfc3RhcnRfc3RyZWFtaW5nKHN0cnVjdCBzYWE3MTY0X3BvcnQgKnBvcnQpCiAJcmV0dXJu
IHJldDsKIH0KIAotc3RhdGljIGludCBzYWE3MTY0X3ZiaV9mbXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHNhYTcxNjRfdmJpX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCS8qIG50c2MgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcGNpL3NhYTcxNjQvc2FhNzE2NC5oIGIvZHJpdmVycy9tZWRpYS9wY2kvc2FhNzE2NC9zYWE3
MTY0LmgKaW5kZXggOTRlOTg3ZTdiNWU1ZDRhZjhmM2NkYzdjMTQ4ZWIyYjMzYjEwNzZiOS4uNjEy
ODkwZmExOWMxNjgwYjUzMjdmNTRhOGU5NDNmZDE1ODk5ZjdjZiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9tZWRpYS9wY2kvc2FhNzE2NC9zYWE3MTY0LmgKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvc2Fh
NzE2NC9zYWE3MTY0LmgKQEAgLTU5MCwxMSArNTkwLDE0IEBAIGV4dGVybiBpbnQgc2FhNzE2NF9i
dWZmZXJfemVyb19vZmZzZXRzKHN0cnVjdCBzYWE3MTY0X3BvcnQgKnBvcnQsIGludCBpKTsKIC8q
IHNhYTcxNjQtZW5jb2Rlci5jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAqLwogaW50IHNhYTcxNjRfc19zdGQoc3RydWN0IHNhYTcxNjRfcG9ydCAqcG9ydCwgdjRs
Ml9zdGRfaWQgaWQpOwogaW50IHNhYTcxNjRfZ19zdGQoc3RydWN0IHNhYTcxNjRfcG9ydCAqcG9y
dCwgdjRsMl9zdGRfaWQgKmlkKTsKLWludCBzYWE3MTY0X2VudW1faW5wdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2lucHV0ICppKTsKK2ludCBzYWE3MTY0X2Vu
dW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmkpOwogaW50IHNhYTcxNjRfZ19pbnB1
dChzdHJ1Y3Qgc2FhNzE2NF9wb3J0ICpwb3J0LCB1bnNpZ25lZCBpbnQgKmkpOwogaW50IHNhYTcx
NjRfc19pbnB1dChzdHJ1Y3Qgc2FhNzE2NF9wb3J0ICpwb3J0LCB1bnNpZ25lZCBpbnQgaSk7Ci1p
bnQgc2FhNzE2NF9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3Qg
djRsMl90dW5lciAqdCk7Ci1pbnQgc2FhNzE2NF9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdCk7CitpbnQgc2FhNzE2NF9nX3R1
bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJICAgIHN0cnVjdCB2NGwyX3R1bmVyICp0KTsKK2ludCBzYWE3MTY0X3NfdHVuZXIoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgY29u
c3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQpOwogaW50IHNhYTcxNjRfZ19mcmVxdWVuY3koc3RydWN0
IHNhYTcxNjRfcG9ydCAqcG9ydCwgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKTsKIGludCBzYWE3
MTY0X3NfZnJlcXVlbmN5KHN0cnVjdCBzYWE3MTY0X3BvcnQgKnBvcnQsCiAJCQljb25zdCBzdHJ1
Y3QgdjRsMl9mcmVxdWVuY3kgKmYpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvc29s
bzZ4MTAvc29sbzZ4MTAtdjRsMi1lbmMuYyBiL2RyaXZlcnMvbWVkaWEvcGNpL3NvbG82eDEwL3Nv
bG82eDEwLXY0bDItZW5jLmMKaW5kZXggNWVlNTliMzg0NGNjM2RjNGFlNDJjMjU1YTBlYTNlNjI0
YzYwNWExZC4uYzg5MjFmMTM5ODg1ZWMyOGVjNmZjYjk2NzgxOWY1ZTYxNjg2OGUyZSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvc29sbzZ4MTAvc29sbzZ4MTAtdjRsMi1lbmMuYworKysg
Yi9kcml2ZXJzL21lZGlhL3BjaS9zb2xvNngxMC9zb2xvNngxMC12NGwyLWVuYy5jCkBAIC03NTgs
NyArNzU4LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIHNvbG9fZW5jX3ZpZGVvX3Fv
cHMgPSB7CiAJLnN0b3Bfc3RyZWFtaW5nID0gc29sb19lbmNfc3RvcF9zdHJlYW1pbmcsCiB9Owog
Ci1zdGF0aWMgaW50IHNvbG9fZW5jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAq
cHJpdiwKK3N0YXRpYyBpbnQgc29sb19lbmNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHNvbG9fZW5jX2RldiAqc29sb19lbmMg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzY5LDcgKzc3MCw4IEBAIHN0YXRpYyBpbnQgc29s
b19lbmNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHNvbG9fZW5jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHNvbG9fZW5jX2VudW1faW5wdXQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmlucHV0KQogewogCXN0cnVjdCBzb2xvX2VuY19kZXYg
KnNvbG9fZW5jID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc4OSw3ICs3OTEsOCBAQCBzdGF0
aWMgaW50IHNvbG9fZW5jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc29sb19lbmNfc2V0X2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzb2xvX2VuY19zZXRfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCSAgICAgIHVuc2lnbmVkIGludCBpbmRleCkKIHsKIAlpZiAoaW5kZXgpCkBAIC03OTgs
NyArODAxLDggQEAgc3RhdGljIGludCBzb2xvX2VuY19zZXRfaW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc29sb19lbmNfZ2V0
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzb2xvX2Vu
Y19nZXRfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHVuc2lnbmVkIGludCAqaW5kZXgpCiB7CiAJKmlu
ZGV4ID0gMDsKQEAgLTgwNiw3ICs4MTAsOCBAQCBzdGF0aWMgaW50IHNvbG9fZW5jX2dldF9pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBzb2xvX2VuY19lbnVtX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHNvbG9fZW5jX2VudW1fZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2Zt
dGRlc2MgKmYpCiB7CiAJc3RydWN0IHNvbG9fZW5jX2RldiAqc29sb19lbmMgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtODM5LDcgKzg0NCw4IEBAIHN0YXRpYyBpbmxpbmUgaW50IHNvbG9fdmFs
aWRfcGl4Zm10KHUzMiBwaXhmbXQsIGludCBkZXZfdHlwZSkKIAkJfHwgcGl4Zm10ID09IFY0TDJf
UElYX0ZNVF9NSlBFRyA/IDAgOiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IHNvbG9fZW5jX3Ry
eV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzb2xv
X2VuY190cnlfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHNvbG9fZW5jX2RldiAqc29sb19lbmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODc4
LDcgKzg4NCw4IEBAIHN0YXRpYyBpbnQgc29sb19lbmNfdHJ5X2ZtdF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc29sb19lbmNf
c2V0X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHNv
bG9fZW5jX3NldF9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3Qgc29sb19lbmNfZGV2ICpzb2xvX2VuYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04ODks
NyArODk2LDcgQEAgc3RhdGljIGludCBzb2xvX2VuY19zZXRfZm10X2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlpZiAodmIyX2lzX2J1c3koJnNvbG9fZW5jLT52aWRxKSkKIAkJ
cmV0dXJuIC1FQlVTWTsKIAotCXJldCA9IHNvbG9fZW5jX3RyeV9mbXRfY2FwKGZpbGUsIHByaXYs
IGYpOworCXJldCA9IHNvbG9fZW5jX3RyeV9mbXRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAo
cmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC05MTUsNyArOTIyLDggQEAgc3RhdGljIGludCBzb2xv
X2VuY19zZXRfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBzb2xvX2VuY19nZXRfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc29sb19lbmNfZ2V0X2ZtdF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzb2xvX2VuY19kZXYgKnNvbG9fZW5jID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTkzMiw3ICs5NDAsOCBAQCBzdGF0aWMgaW50IHNvbG9f
ZW5jX2dldF9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHNvbG9fZW5jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LCB2NGwyX3N0ZF9pZCAqaSkKK3N0YXRpYyBpbnQgc29sb19lbmNfZ19zdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB2NGwy
X3N0ZF9pZCAqaSkKIHsKIAlzdHJ1Y3Qgc29sb19lbmNfZGV2ICpzb2xvX2VuYyA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAJc3RydWN0IHNvbG9fZGV2ICpzb2xvX2RldiA9IHNvbG9fZW5jLT5zb2xv
X2RldjsKQEAgLTk0NCwxNCArOTUzLDE2IEBAIHN0YXRpYyBpbnQgc29sb19lbmNfZ19zdGQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICppKQogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHNvbG9fZW5jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCB2NGwyX3N0ZF9pZCBzdGQpCitzdGF0aWMgaW50IHNvbG9fZW5jX3Nfc3RkKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdjRsMl9z
dGRfaWQgc3RkKQogewogCXN0cnVjdCBzb2xvX2VuY19kZXYgKnNvbG9fZW5jID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIAogCXJldHVybiBzb2xvX3NldF92aWRlb190eXBlKHNvbG9fZW5jLT5zb2xv
X2Rldiwgc3RkICYgVjRMMl9TVERfNjI1XzUwKTsKIH0KIAotc3RhdGljIGludCBzb2xvX2VudW1f
ZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc29s
b19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQog
ewogCXN0cnVjdCBzb2xvX2VuY19kZXYgKnNvbG9fZW5jID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTk3OCw3ICs5ODksOCBAQCBzdGF0aWMgaW50IHNvbG9fZW51bV9mcmFtZXNpemVzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHNv
bG9fZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgc29sb19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0
bDJfZnJtaXZhbGVudW0gKmZpbnR2KQogewogCXN0cnVjdCBzb2xvX2VuY19kZXYgKnNvbG9fZW5j
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEwMDgsNyArMTAyMCw4IEBAIHN0YXRpYyBpbnQg
c29sb19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHNvbG9fZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBzb2xvX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkgICAgICAgc3Ry
dWN0IHY0bDJfc3RyZWFtcGFybSAqc3ApCiB7CiAJc3RydWN0IHNvbG9fZW5jX2RldiAqc29sb19l
bmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTAzNCw3ICsxMDQ3LDggQEAgc3RhdGljIGlu
bGluZSBpbnQgY2FsY19pbnRlcnZhbCh1OCBmcHMsIHUzMiBuLCB1MzIgZCkKIAlyZXR1cm4gbWlu
KDE1VSwgbiAvIGQgKyAobiAlIGQgPj0gKGZwcyA+PiAxKSkpOwogfQogCi1zdGF0aWMgaW50IHNv
bG9fc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzb2xv
X3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkgICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqc3ApCiB7CiAJ
c3RydWN0IHNvbG9fZW5jX2RldiAqc29sb19lbmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
MTA0Niw3ICsxMDYwLDcgQEAgc3RhdGljIGludCBzb2xvX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAogCXNvbG9fZW5jLT5pbnRlcnZhbCA9IGNhbGNfaW50ZXJ2YWwoZnBz
LCB0LT5udW1lcmF0b3IsIHQtPmRlbm9taW5hdG9yKTsKIAlzb2xvX3VwZGF0ZV9tb2RlKHNvbG9f
ZW5jKTsKLQlyZXR1cm4gc29sb19nX3Bhcm0oZmlsZSwgcHJpdiwgc3ApOworCXJldHVybiBzb2xv
X2dfcGFybShmaWxlLCBzdGF0ZSwgc3ApOwogfQogCiBzdGF0aWMgaW50IHNvbG9fc19jdHJsKHN0
cnVjdCB2NGwyX2N0cmwgKmN0cmwpCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9zb2xv
NngxMC9zb2xvNngxMC12NGwyLmMgYi9kcml2ZXJzL21lZGlhL3BjaS9zb2xvNngxMC9zb2xvNngx
MC12NGwyLmMKaW5kZXggMzU3MTViMjFkYmRmZmM4MGRlNjg5OTBiODg4MzY3MDA4MTZlN2NiNi4u
N2MwNDg5YzdiMGQ5ZjBjOTdlMzM4NmNjYzJkY2Q5NmRjZDNjYWQ3MSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9tZWRpYS9wY2kvc29sbzZ4MTAvc29sbzZ4MTAtdjRsMi5jCisrKyBiL2RyaXZlcnMvbWVk
aWEvcGNpL3NvbG82eDEwL3NvbG82eDEwLXY0bDIuYwpAQCAtMzY3LDcgKzM2Nyw4IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBzb2xvX3ZpZGVvX3FvcHMgPSB7CiAJLnN0b3Bfc3RyZWFt
aW5nID0gc29sb19zdG9wX3N0cmVhbWluZywKIH07CiAKLXN0YXRpYyBpbnQgc29sb19xdWVyeWNh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IHNvbG9fcXVlcnlj
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5k
cml2ZXIsIFNPTE82WDEwX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMzk5LDcgKzQw
MCw4IEBAIHN0YXRpYyBpbnQgc29sb19lbnVtX2V4dF9pbnB1dChzdHJ1Y3Qgc29sb19kZXYgKnNv
bG9fZGV2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHNvbG9fZW51bV9pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc29sb19lbnVtX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wdXQpCiB7CiAJc3RydWN0IHNvbG9fZGV2ICpz
b2xvX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00MjMsNyArNDI1LDggQEAgc3RhdGlj
IGludCBzb2xvX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc29sb19zZXRfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpbmRleCkKK3N0YXRpYyBpbnQgc29sb19zZXRfaW5w
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJICB1bnNpZ25lZCBpbnQgaW5kZXgpCiB7CiAJc3RydWN0IHNvbG9fZGV2ICpzb2xvX2RldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJaW50IHJldCA9IHNvbG9fdjRsMl9zZXRfY2goc29sb19k
ZXYsIGluZGV4KTsKQEAgLTQzNiw3ICs0MzksOCBAQCBzdGF0aWMgaW50IHNvbG9fc2V0X2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaW5kZXgpCiAJcmV0
dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBzb2xvX2dldF9pbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppbmRleCkKK3N0YXRpYyBpbnQgc29sb19nZXRf
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJICB1bnNpZ25lZCBpbnQgKmluZGV4KQogewogCXN0cnVjdCBzb2xvX2RldiAqc29sb19k
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC00NDUsNyArNDQ5LDggQEAgc3RhdGljIGlu
dCBzb2xvX2dldF9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQg
aW50ICppbmRleCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzb2xvX2VudW1fZm10X2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc29sb19lbnVtX2Zt
dF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT5p
bmRleCkKQEAgLTQ1NSw3ICs0NjAsOCBAQCBzdGF0aWMgaW50IHNvbG9fZW51bV9mbXRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHNvbG9fdHJ5X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHNvbG9fdHJ5X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCXN0cnVjdCBzb2xvX2RldiAqc29sb19kZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
NDc0LDcgKzQ4MCw4IEBAIHN0YXRpYyBpbnQgc29sb190cnlfZm10X2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzb2xvX3NldF9m
bXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzb2xvX3Nl
dF9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
c29sb19kZXYgKnNvbG9fZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQ4NCwxMCArNDkx
LDExIEBAIHN0YXRpYyBpbnQgc29sb19zZXRfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAogCS8qIEZvciByaWdodCBub3csIGlmIGl0IGRvZXNuJ3QgbWF0Y2ggb3VyIHJ1
bm5pbmcgY29uZmlnLAogCSAqIHRoZW4gZmFpbCAqLwotCXJldHVybiBzb2xvX3RyeV9mbXRfY2Fw
KGZpbGUsIHByaXYsIGYpOworCXJldHVybiBzb2xvX3RyeV9mbXRfY2FwKGZpbGUsIHN0YXRlLCBm
KTsKIH0KIAotc3RhdGljIGludCBzb2xvX2dldF9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAorc3RhdGljIGludCBzb2xvX2dldF9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgc29sb19kZXYgKnNvbG9fZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTUwNCw3ICs1MTIsOCBAQCBzdGF0aWMgaW50IHNvbG9fZ2V0X2Zt
dF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgc29sb19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9z
dGRfaWQgKmkpCitzdGF0aWMgaW50IHNvbG9fZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICB2NGwyX3N0ZF9pZCAqaSkKIHsK
IAlzdHJ1Y3Qgc29sb19kZXYgKnNvbG9fZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAt
NTM2LDcgKzU0NSw4IEBAIGludCBzb2xvX3NldF92aWRlb190eXBlKHN0cnVjdCBzb2xvX2RldiAq
c29sb19kZXYsIGJvb2wgaXNfNTBoeikKIAlyZXR1cm4gc29sb192NGwyX3NldF9jaChzb2xvX2Rl
diwgc29sb19kZXYtPmN1cl9kaXNwX2NoKTsKIH0KIAotc3RhdGljIGludCBzb2xvX3Nfc3RkKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBzdGQpCitzdGF0aWMgaW50
IHNvbG9fc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkgICAgICB2NGwyX3N0ZF9pZCBzdGQpCiB7CiAJc3RydWN0IHNvbG9fZGV2ICpz
b2xvX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcGNpL3R0cGNpL2J1ZGdldC1hdi5jIGIvZHJpdmVycy9tZWRpYS9wY2kvdHRwY2kvYnVkZ2V0
LWF2LmMKaW5kZXggNjlmNWU4MTBmOWI1NGRmNWUzZDY5YTVkMDZhNWNlZmMxMmNlZjZhOS4uNjM1
MDVmNDQ1YjY3ODMzMDE1YWE5YWFkODMxNGUyNTZkMzg2ZmYzMCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9tZWRpYS9wY2kvdHRwY2kvYnVkZ2V0LWF2LmMKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvdHRw
Y2kvYnVkZ2V0LWF2LmMKQEAgLTEzOTgsNyArMTM5OCw5IEBAIHN0YXRpYyBzdHJ1Y3QgdjRsMl9p
bnB1dCBrbmMxX2lucHV0c1tLTkMxX0lOUFVUU10gPSB7CiAJCVY0TDJfU1REX1BBTF9CRyB8IFY0
TDJfU1REX05UU0NfTSwgMCwgVjRMMl9JTl9DQVBfU1REIH0sCiB9OwogCi1zdGF0aWMgaW50IHZp
ZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
aW5wdXQgKmkpCitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3Ry
dWN0IHY0bDJfaW5wdXQgKmkpCiB7CiAJZHByaW50aygxLCAiVklESU9DX0VOVU1JTlBVVCAlZFxu
IiwgaS0+aW5kZXgpOwogCWlmIChpLT5pbmRleCA+PSBLTkMxX0lOUFVUUykKQEAgLTE0MDcsNyAr
MTQwOSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVk
IGludCAqaSkKK3N0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7
CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVj
dCBidWRnZXRfYXYgKmJ1ZGdldF9hdiA9IGRldi0+ZXh0X3ByaXY7CkBAIC0xNDE4LDcgKzE0MjEs
OCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgdW5zaWduZWQgaW50ICppKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19z
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGlucHV0KQor
c3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCBpbnB1dCkKIHsKIAlzdHJ1
Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGJ1ZGdl
dF9hdiAqYnVkZ2V0X2F2ID0gZGV2LT5leHRfcHJpdjsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcGNpL3R3NTg2NC90dzU4NjQtdmlkZW8uYyBiL2RyaXZlcnMvbWVkaWEvcGNpL3R3NTg2NC90
dzU4NjQtdmlkZW8uYwppbmRleCAwYTA4NzA4ZTUyYjA4MjgzMDc0ZGI2NjYxMTk2OTMxMjc2MjE4
MmE4Li40NmI1ZTc3M2FhMzM0M2QxZGY0YTRiN2U5ZjllZDhmZjNiYWE2MzcyIDEwMDY0NAotLS0g
YS9kcml2ZXJzL21lZGlhL3BjaS90dzU4NjQvdHc1ODY0LXZpZGVvLmMKKysrIGIvZHJpdmVycy9t
ZWRpYS9wY2kvdHc1ODY0L3R3NTg2NC12aWRlby5jCkBAIC01MjYsNyArNTI2LDggQEAgc3RhdGlj
IGludCB0dzU4NjRfc19jdHJsKHN0cnVjdCB2NGwyX2N0cmwgKmN0cmwpCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdHc1ODY0X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB0dzU4NjRfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdHc1ODY0X2lucHV0ICppbnB1dCA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01NTEsNyArNTUyLDggQEAgc3RhdGljIGludCB0dzU4NjRf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdHc1ODY0X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHR3NTg2NF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0
IHY0bDJfaW5wdXQgKmkpCiB7CiAJc3RydWN0IHR3NTg2NF9pbnB1dCAqaW5wdXQgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtNTgyLDIwICs1ODQsMjMgQEAgc3RhdGljIGludCB0dzU4NjRfZW51
bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB0dzU4NjRfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
dW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB0dzU4NjRfZ19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGlu
dCAqaSkKIHsKIAkqaSA9IDA7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdHc1ODY0X3Nf
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQorc3Rh
dGljIGludCB0dzU4NjRfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCBpKQogewogCWlmIChpKQogCQly
ZXR1cm4gLUVJTlZBTDsKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzU4NjRfcXVlcnlj
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHR3NTg2NF9xdWVy
eWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCB0
dzU4NjRfaW5wdXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTYwNiw3ICs2MTEs
OCBAQCBzdGF0aWMgaW50IHR3NTg2NF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzU4NjRfcXVlcnlzdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICpzdGQpCitzdGF0aWMgaW50IHR3
NTg2NF9xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLCB2NGwyX3N0ZF9pZCAqc3RkKQogewogCXN0cnVjdCB0dzU4NjRfaW5w
dXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAllbnVtIHR3NTg2NF92aWRfc3RkIHR3
X3N0ZDsKQEAgLTYyMCw3ICs2MjYsOCBAQCBzdGF0aWMgaW50IHR3NTg2NF9xdWVyeXN0ZChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKnN0ZCkKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB0dzU4NjRfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHY0bDJfc3RkX2lkICpzdGQpCitzdGF0aWMgaW50IHR3NTg2NF9nX3N0ZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQl2NGwyX3N0ZF9p
ZCAqc3RkKQogewogCXN0cnVjdCB0dzU4NjRfaW5wdXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKIApAQCAtNjI4LDcgKzYzNSw4IEBAIHN0YXRpYyBpbnQgdHc1ODY0X2dfc3RkKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqc3RkKQogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHR3NTg2NF9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgdjRsMl9zdGRfaWQgc3RkKQorc3RhdGljIGludCB0dzU4NjRfc19zdGQoc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRfaWQg
c3RkKQogewogCXN0cnVjdCB0dzU4NjRfaW5wdXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKIAlzdHJ1Y3QgdHc1ODY0X2RldiAqZGV2ID0gaW5wdXQtPnJvb3Q7CkBAIC02MzksNyArNjQ3
LDggQEAgc3RhdGljIGludCB0dzU4NjRfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHY0bDJfc3RkX2lkIHN0ZCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzU4NjRf
ZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdHc1ODY0X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVz
YyAqZikKIHsKIAlpZiAoZi0+aW5kZXgpCkBAIC03MjcsNyArNzM2LDggQEAgc3RhdGljIGludCB0
dzU4NjRfZnJhbWVpbnRlcnZhbF9nZXQoc3RydWN0IHR3NTg2NF9pbnB1dCAqaW5wdXQsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdHc1ODY0X2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdHc1ODY0X2VudW1fZnJhbWVzaXplcyhz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCB0dzU4
NjRfaW5wdXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc0NCw3ICs3NTQsOCBA
QCBzdGF0aWMgaW50IHR3NTg2NF9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdHc1ODY0X2VudW1fZnJhbWVp
bnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHR3NTg2
NF9lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2ZybWl2
YWxlbnVtICpmaW50dikKIHsKIAlzdHJ1Y3QgdHc1ODY0X2lucHV0ICppbnB1dCA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC03NTQsNyArNzY1LDcgQEAgc3RhdGljIGludCB0dzU4NjRfZW51bV9m
cmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAkJLnBpeGVsX2Zv
cm1hdCA9IGZpbnR2LT5waXhlbF9mb3JtYXQgfTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gdHc1ODY0
X2VudW1fZnJhbWVzaXplcyhmaWxlLCBwcml2LCAmZnNpemUpOworCXJldCA9IHR3NTg2NF9lbnVt
X2ZyYW1lc2l6ZXMoZmlsZSwgc3RhdGUsICZmc2l6ZSk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJl
dDsKIApAQCAtNzc2LDcgKzc4Nyw4IEBAIHN0YXRpYyBpbnQgdHc1ODY0X2VudW1fZnJhbWVpbnRl
cnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAot
c3RhdGljIGludCB0dzU4NjRfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCB0dzU4NjRfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnNw
KQogewogCXN0cnVjdCB0dzU4NjRfaW5wdXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTc5Niw3ICs4MDgsOCBAQCBzdGF0aWMgaW50IHR3NTg2NF9nX3Bhcm0oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCB0dzU4NjRf
c19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0dzU4NjRf
c19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnNwKQogewogCXN0cnVjdCB0dzU4
NjRfaW5wdXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTgyMSw3ICs4MzQsNyBA
QCBzdGF0aWMgaW50IHR3NTg2NF9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJaWYgKGlucHV0LT5mcmFtZV9pbnRlcnZhbCA8IDEpCiAJCWlucHV0LT5mcmFtZV9pbnRlcnZh
bCA9IDE7CiAJdHc1ODY0X2ZyYW1lX2ludGVydmFsX3NldChpbnB1dCk7Ci0JcmV0dXJuIHR3NTg2
NF9nX3Bhcm0oZmlsZSwgcHJpdiwgc3ApOworCXJldHVybiB0dzU4NjRfZ19wYXJtKGZpbGUsIHN0
YXRlLCBzcCk7CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdjRsMl9jdHJsX29wcyB0dzU4NjRf
Y3RybF9vcHMgPSB7CkBAIC04NDIsNyArODU1LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwy
X2ZpbGVfb3BlcmF0aW9ucyB2aWRlb19mb3BzID0gewogCiAjZGVmaW5lIElORElSX1NQQUNFX01B
UF9TSElGVCAweDEwMDAwMAogCi1zdGF0aWMgaW50IHR3NTg2NF9nX3JlZyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHR3NTg2NF9nX3JlZyhzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJc3RydWN0IHY0bDJf
ZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IHR3NTg2NF9pbnB1dCAqaW5wdXQgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtODY0LDcgKzg3OCw4IEBAIHN0YXRpYyBpbnQgdHc1ODY0X2df
cmVnKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB0dzU4NjRfc19yZWcoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGlu
dCB0dzU4NjRfc19yZWcoc3RydWN0IGZpbGUgKmZpbGUsCisJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCWNvbnN0IHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVnKQog
ewogCXN0cnVjdCB0dzU4NjRfaW5wdXQgKmlucHV0ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL3R3NjgvdHc2OC12aWRlby5jIGIvZHJpdmVycy9t
ZWRpYS9wY2kvdHc2OC90dzY4LXZpZGVvLmMKaW5kZXggNjIzMmJhYzE3MGQwMGY0MTMyMTExNTc1
YmM2MDBlNDE4OTdlOWM4Yy4uNGQwZTYyMDA2YzkzNDc5NDhiYzA5ZGU4N2E0ODllNzA2YTI0OWFl
YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvdHc2OC90dzY4LXZpZGVvLmMKKysrIGIv
ZHJpdmVycy9tZWRpYS9wY2kvdHc2OC90dzY4LXZpZGVvLmMKQEAgLTU2OSw3ICs1NjksOCBAQCBz
dGF0aWMgaW50IHR3Njhfc19jdHJsKHN0cnVjdCB2NGwyX2N0cmwgKmN0cmwpCiAgKiBOb3RlIHRo
YXQgdGhpcyByb3V0aW5lIHJldHVybnMgd2hhdCBpcyBzdG9yZWQgaW4gdGhlIGZoIHN0cnVjdHVy
ZSwgYW5kCiAgKiBkb2VzIG5vdCBpbnRlcnJvZ2F0ZSBhbnkgb2YgdGhlIGRldmljZSByZWdpc3Rl
cnMuCiAgKi8KLXN0YXRpYyBpbnQgdHc2OF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB0dzY4X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHR3NjhfZGV2ICpkZXYgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtNTg2LDcgKzU4Nyw4IEBAIHN0YXRpYyBpbnQgdHc2OF9nX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHR3NjhfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCB0dzY4X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdHc2OF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC02NDEsMTMgKzY0MywxNCBAQCBzdGF0aWMgaW50IHR3NjhfdHJ5X2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogICogc29tZSBudW1iZXIgb2YgYnVmZmVy
cyBvbiB0aGUgImFjdGl2ZSIgY2hhaW4gd2hpY2ggd2lsbCBiZSBmaWxsZWQgYmVmb3JlCiAgKiB0
aGUgY2hhbmdlIHRha2VzIHBsYWNlLgogICovCi1zdGF0aWMgaW50IHR3Njhfc19mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdHc2OF9zX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdHc2
OF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJaW50IGVycjsKIAotCWVyciA9IHR3
NjhfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHByaXYsIGYpOworCWVyciA9IHR3NjhfdHJ5X2ZtdF92
aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAoMCAhPSBlcnIpCiAJCXJldHVybiBlcnI7CiAK
QEAgLTY1OCw3ICs2NjEsOCBAQCBzdGF0aWMgaW50IHR3Njhfc19mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzY4
X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHR3
NjhfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkKIHsKIAlzdHJ1Y3Qg
dHc2OF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02OTEsNyArNjk1LDggQEAg
c3RhdGljIGludCB0dzY4X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdHc2OF9nX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHR3NjhfZ19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQl1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IHR3NjhfZGV2ICpkZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwogCkBAIC02OTksNyArNzA0LDggQEAgc3RhdGljIGludCB0dzY4X2dfaW5wdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB0dzY4X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCB0dzY4X3NfaW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdW5zaWduZWQg
aW50IGkpCiB7CiAJc3RydWN0IHR3NjhfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwog
CkBAIC03MTAsNyArNzE2LDggQEAgc3RhdGljIGludCB0dzY4X3NfaW5wdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IHR3NjhfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3Rh
dGljIGludCB0dzY4X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXAp
CiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgInR3NjgiLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsK
QEAgLTcxOSw3ICs3MjYsOCBAQCBzdGF0aWMgaW50IHR3NjhfcXVlcnljYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHR3Njhfc19z
dGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIGlkKQorc3RhdGlj
IGludCB0dzY4X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgaWQpCiB7CiAJc3RydWN0IHR3NjhfZGV2
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXVuc2lnbmVkIGludCBpOwpAQCAtNzQ3LDcg
Kzc1NSw4IEBAIHN0YXRpYyBpbnQgdHc2OF9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgdjRsMl9zdGRfaWQgaWQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdHc2OF9n
X3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKmlkKQorc3Rh
dGljIGludCB0dzY4X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgKmlkKQogewogCXN0cnVjdCB0dzY4
X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtNzU1LDcgKzc2NCw4IEBAIHN0
YXRpYyBpbnQgdHc2OF9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9z
dGRfaWQgKmlkKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHR3NjhfZW51bV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IHR3NjhfZW51
bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYgKGYt
PmluZGV4ID49IEZPUk1BVFMpCkBAIC04MTAsMTYgKzgyMCwxOCBAQCBzdGF0aWMgdm9pZCB0dzY4
X2R1bXBfcmVncyhzdHJ1Y3QgdHc2OF9kZXYgKmRldikKIAl9CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYpCitzdGF0aWMgaW50
IHZpZGlvY19sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgdHc2OF9kZXYgKmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CiAKIAl0dzY4X2R1bXBfcmVncyhkZXYpOwotCXJldHVybiB2NGwyX2N0
cmxfbG9nX3N0YXR1cyhmaWxlLCBwcml2KTsKKwlyZXR1cm4gdjRsMl9jdHJsX2xvZ19zdGF0dXMo
ZmlsZSwgc3RhdGUpOwogfQogCiAjaWZkZWYgQ09ORklHX1ZJREVPX0FEVl9ERUJVRwotc3RhdGlj
IGludCB2aWRpb2NfZ19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfZGJn
X3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IHR3NjhfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtODMxLDcgKzg0Myw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgdmlkaW9jX3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQljb25zdCBzdHJ1Y3QgdjRsMl9kYmdf
cmVnaXN0ZXIgKnJlZykKIHsKIAlzdHJ1Y3QgdHc2OF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS90dzY4NngvdHc2ODZ4LXZpZGVv
LmMgYi9kcml2ZXJzL21lZGlhL3BjaS90dzY4NngvdHc2ODZ4LXZpZGVvLmMKaW5kZXggNzg1ZGQ3
OTdkOTIxYjUxNWVhZDdiNTAwZWRkMDFhNGFjMDYxOGU2ZC4uYmVlMDdjZTBkZmQyMDdhZWRhNTA5
NGUwOTM5NGQyZjNkOTJhZTNjNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wY2kvdHc2ODZ4
L3R3Njg2eC12aWRlby5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL3R3Njg2eC90dzY4Nngtdmlk
ZW8uYwpAQCAtNjE4LDcgKzYxOCw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdjRsMl9jdHJsX29w
cyBjdHJsX29wcyA9IHsKIAkuc19jdHJsID0gdHc2ODZ4X3NfY3RybCwKIH07CiAKLXN0YXRpYyBp
bnQgdHc2ODZ4X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHR3Njg2eF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgdHc2ODZ4X3ZpZGVvX2NoYW5uZWwgKnZjID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKQEAgLTYzNCw3ICs2MzUsOCBAQCBzdGF0aWMgaW50IHR3Njg2eF9nX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHR3Njg2eF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHR3Njg2eF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdHc2ODZ4X3ZpZGVvX2NoYW5uZWwgKnZjID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTczMSw3ICs3MzMsOCBAQCBzdGF0aWMgaW50IHR3Njg2eF9zZXRf
Zm9ybWF0KHN0cnVjdCB0dzY4NnhfdmlkZW9fY2hhbm5lbCAqdmMsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdHc2ODZ4X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHR3Njg2eF9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdHc2ODZ4X3ZpZGVvX2NoYW5uZWwgKnZjID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTc0Myw3ICs3NDYsNyBAQCBzdGF0aWMgaW50IHR3Njg2eF9zX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCQlyZXR1cm4gLUVCVVNZ
OwogCiAJYXJlYSA9IHZjLT53aWR0aCAqIHZjLT5oZWlnaHQ7Ci0JZXJyID0gdHc2ODZ4X3RyeV9m
bXRfdmlkX2NhcChmaWxlLCBwcml2LCBmKTsKKwllcnIgPSB0dzY4NnhfdHJ5X2ZtdF92aWRfY2Fw
KGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwogCkBAIC03NTMsNyAr
NzU2LDggQEAgc3RhdGljIGludCB0dzY4Nnhfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAkJCQkgcmVhbGxvYyk7CiB9CiAKLXN0YXRpYyBpbnQgdHc2ODZ4X3F1
ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0dzY4Nnhf
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1
Y3QgdHc2ODZ4X3ZpZGVvX2NoYW5uZWwgKnZjID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc5
OCw3ICs4MDIsOCBAQCBzdGF0aWMgaW50IHR3Njg2eF9zZXRfc3RhbmRhcmQoc3RydWN0IHR3Njg2
eF92aWRlb19jaGFubmVsICp2YywgdjRsMl9zdGRfaWQgaWQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdHc2ODZ4X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwy
X3N0ZF9pZCBpZCkKK3N0YXRpYyBpbnQgdHc2ODZ4X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3RkX2lkIGlkKQogewog
CXN0cnVjdCB0dzY4NnhfdmlkZW9fY2hhbm5lbCAqdmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwog
CXN0cnVjdCB2NGwyX2Zvcm1hdCBmOwpAQCAtODE4LDggKzgyMyw4IEBAIHN0YXRpYyBpbnQgdHc2
ODZ4X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBpZCkK
IAkgKiBjYWxsaW5nIGdfZm10IGFuZCBzX2ZtdCB3aWxsIHNhbml0aXplIHRoZSBoZWlnaHQKIAkg
KiBhY2NvcmRpbmcgdG8gdGhlIHN0YW5kYXJkLgogCSAqLwotCXR3Njg2eF9nX2ZtdF92aWRfY2Fw
KGZpbGUsIHByaXYsICZmKTsKLQl0dzY4Nnhfc19mbXRfdmlkX2NhcChmaWxlLCBwcml2LCAmZik7
CisJdHc2ODZ4X2dfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsICZmKTsKKwl0dzY4Nnhfc19mbXRf
dmlkX2NhcChmaWxlLCBzdGF0ZSwgJmYpOwogCiAJLyoKIAkgKiBGcmFtZSBkZWNpbWF0aW9uIGRl
cGVuZHMgb24gdGhlIGNob3NlbiBzdGFuZGFyZCwKQEAgLTgyOSw3ICs4MzQsOCBAQCBzdGF0aWMg
aW50IHR3Njg2eF9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRf
aWQgaWQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdHc2ODZ4X3F1ZXJ5c3RkKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqc3RkKQorc3RhdGljIGludCB0
dzY4NnhfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwgdjRsMl9zdGRfaWQgKnN0ZCkKIHsKIAlzdHJ1Y3QgdHc2ODZ4X3Zp
ZGVvX2NoYW5uZWwgKnZjID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdHc2ODZ4X2Rl
diAqZGV2ID0gdmMtPmRldjsKQEAgLTg4Nyw3ICs4OTMsOCBAQCBzdGF0aWMgaW50IHR3Njg2eF9x
dWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKnN0ZCkK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzY4NnhfZ19zdGQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICppZCkKK3N0YXRpYyBpbnQgdHc2ODZ4X2dfc3Rk
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CXY0bDJfc3RkX2lkICppZCkKIHsKIAlzdHJ1Y3QgdHc2ODZ4X3ZpZGVvX2NoYW5uZWwgKnZjID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtODk1LDcgKzkwMiw4IEBAIHN0YXRpYyBpbnQgdHc2
ODZ4X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqaWQp
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdHc2ODZ4X2VudW1fZnJhbWVzaXplcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdHc2ODZ4X2VudW1fZnJhbWVz
aXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVj
dCB0dzY4NnhfdmlkZW9fY2hhbm5lbCAqdmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTEy
LDcgKzkyMCw4IEBAIHN0YXRpYyBpbnQgdHc2ODZ4X2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzY4Nnhf
ZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdHc2ODZ4X2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
ICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0
IHY0bDJfZnJtaXZhbGVudW0gKml2YWwpCiB7CiAJc3RydWN0IHR3Njg2eF92aWRlb19jaGFubmVs
ICp2YyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05MzEsNyArOTQwLDggQEAgc3RhdGljIGlu
dCB0dzY4NnhfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzY4NnhfZ19wYXJtKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0dzY4NnhfZ19wYXJtKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVj
dCB2NGwyX3N0cmVhbXBhcm0gKnNwKQogewogCXN0cnVjdCB0dzY4NnhfdmlkZW9fY2hhbm5lbCAq
dmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTQ3LDcgKzk1Nyw4IEBAIHN0YXRpYyBpbnQg
dHc2ODZ4X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB0dzY4Nnhfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCB0dzY4Nnhfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBh
cm0gKnNwKQogewogCXN0cnVjdCB0dzY4NnhfdmlkZW9fY2hhbm5lbCAqdmMgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtOTYyLDEwICs5NzMsMTEgQEAgc3RhdGljIGludCB0dzY4Nnhfc19wYXJt
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCWZwcyA9ICghbnVtZXJhdG9yIHx8ICFk
ZW5vbWluYXRvcikgPyAwIDogZGVub21pbmF0b3IgLyBudW1lcmF0b3I7CiAJaWYgKHZjLT5mcHMg
IT0gZnBzKQogCQl0dzY4Nnhfc2V0X2ZyYW1lcmF0ZSh2YywgZnBzKTsKLQlyZXR1cm4gdHc2ODZ4
X2dfcGFybShmaWxlLCBwcml2LCBzcCk7CisJcmV0dXJuIHR3Njg2eF9nX3Bhcm0oZmlsZSwgc3Rh
dGUsIHNwKTsKIH0KIAotc3RhdGljIGludCB0dzY4NnhfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdHc2ODZ4X2VudW1fZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlpZiAoZi0+aW5kZXgg
Pj0gQVJSQVlfU0laRShmb3JtYXRzKSkKQEAgLTk4Niw3ICs5OTgsOCBAQCBzdGF0aWMgdm9pZCB0
dzY4Nnhfc2V0X2lucHV0KHN0cnVjdCB0dzY4NnhfdmlkZW9fY2hhbm5lbCAqdmMsIHVuc2lnbmVk
IGludCBpKQogCXJlZ193cml0ZSh2Yy0+ZGV2LCBWRE1BX0NIQU5ORUxfQ09ORklHW3ZjLT5jaF0s
IHZhbCk7CiB9CiAKLXN0YXRpYyBpbnQgdHc2ODZ4X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCB0dzY4Nnhfc19pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkg
IHVuc2lnbmVkIGludCBpKQogewogCXN0cnVjdCB0dzY4NnhfdmlkZW9fY2hhbm5lbCAqdmMgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMDA0LDcgKzEwMTcsOCBAQCBzdGF0aWMgaW50IHR3
Njg2eF9zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQg
aSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0dzY4NnhfZ19pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB0dzY4Nnhf
Z19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkgIHVuc2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1Y3QgdHc2ODZ4X3ZpZGVvX2NoYW5u
ZWwgKnZjID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTAxMiw3ICsxMDI2LDggQEAgc3Rh
dGljIGludCB0dzY4NnhfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5z
aWduZWQgaW50ICppKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHR3Njg2eF9lbnVtX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0dzY4NnhfZW51
bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2lucHV0ICppKQogewogCXN0cnVjdCB0
dzY4NnhfdmlkZW9fY2hhbm5lbCAqdmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS9wY2kvem9yYW4vem9yYW5fZHJpdmVyLmMgYi9kcml2ZXJzL21lZGlh
L3BjaS96b3Jhbi96b3Jhbl9kcml2ZXIuYwppbmRleCA1YjRkNWRkMDZlZGJjMDc5NzdiYzc3OWRm
NmFlYWQ2MzdlZWFkODk4Li40ODhmNGI0ZTkyZTkwY2NhZjI3ZGEzNGNlZWI3YzJiMGQwYzkzODk0
IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS96b3Jhbi96b3Jhbl9kcml2ZXIuYworKysg
Yi9kcml2ZXJzL21lZGlhL3BjaS96b3Jhbi96b3Jhbl9kcml2ZXIuYwpAQCAtMjQ1LDcgKzI0NSw4
IEBAIHN0YXRpYyBpbnQgem9yYW5fc2V0X2lucHV0KHN0cnVjdCB6b3JhbiAqenIsIGludCBpbnB1
dCkKICAqICAgaW9jdGwgcm91dGluZQogICovCiAKLXN0YXRpYyBpbnQgem9yYW5fcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXAp
CitzdGF0aWMgaW50IHpvcmFuX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2Fw
KQogewogCXN0cnVjdCB6b3JhbiAqenIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0yNzgs
NyArMjc5LDggQEAgc3RhdGljIGludCB6b3Jhbl9lbnVtX2ZtdChzdHJ1Y3Qgem9yYW4gKnpyLCBz
dHJ1Y3QgdjRsMl9mbXRkZXNjICpmbXQsIGludCBmbGFnKQogCXJldHVybiAtRUlOVkFMOwogfQog
Ci1zdGF0aWMgaW50IHpvcmFuX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorc3RhdGljIGludCB6b3Jhbl9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1
Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB6b3JhbiAqenIgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMzA4LDEzICszMTAsMTQgQEAgc3RhdGljIGludCB6b3Jhbl9nX2ZtdF92aWRf
b3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB6b3Jhbl9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0
YXRpYyBpbnQgem9yYW5fZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3Qgem9yYW4gKnpyID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKIAogCWlmICh6ci0+bWFwX21vZGUgIT0gWk9SQU5fTUFQX01PREVfUkFXKQotCQlyZXR1cm4g
em9yYW5fZ19mbXRfdmlkX291dChmaWxlLCBmaCwgZm10KTsKKwkJcmV0dXJuIHpvcmFuX2dfZm10
X3ZpZF9vdXQoZmlsZSwgc3RhdGUsIGZtdCk7CiAJZm10LT5mbXQucGl4LndpZHRoID0genItPnY0
bF9zZXR0aW5ncy53aWR0aDsKIAlmbXQtPmZtdC5waXguaGVpZ2h0ID0genItPnY0bF9zZXR0aW5n
cy5oZWlnaHQ7CiAJZm10LT5mbXQucGl4LnNpemVpbWFnZSA9IHpyLT5idWZmZXJfc2l6ZTsKQEAg
LTM5MSw3ICszOTQsOCBAQCBzdGF0aWMgaW50IHpvcmFuX3RyeV9mbXRfdmlkX291dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIHJlczsKIH0KIAotc3RhdGljIGludCB6b3Jh
bl90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGlu
dCB6b3Jhbl90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkK
IHsKIAlzdHJ1Y3Qgem9yYW4gKnpyID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTM5OSw3ICs0
MDMsNyBAQCBzdGF0aWMgaW50IHpvcmFuX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiAJaW50IGk7CiAKIAlpZiAoZm10LT5mbXQucGl4LnBpeGVsZm9ybWF0ID09
IFY0TDJfUElYX0ZNVF9NSlBFRykKLQkJcmV0dXJuIHpvcmFuX3RyeV9mbXRfdmlkX291dChmaWxl
LCBmaCwgZm10KTsKKwkJcmV0dXJuIHpvcmFuX3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwg
Zm10KTsKIAogCWZvciAoaSA9IDA7IGkgPCBOVU1fRk9STUFUUzsgaSsrKQogCQlpZiAoem9yYW5f
Zm9ybWF0c1tpXS5mb3VyY2MgPT0gZm10LT5mbXQucGl4LnBpeGVsZm9ybWF0KQpAQCAtNTA3LDcg
KzUxMSw4IEBAIHN0YXRpYyBpbnQgem9yYW5fc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiAJcmV0dXJuIHJlczsKIH0KIAotc3RhdGljIGludCB6b3Jhbl9zX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgem9yYW5fc19m
bXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsK
IAlzdHJ1Y3Qgem9yYW4gKnpyID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTUxNSw3ICs1MjAs
NyBAQCBzdGF0aWMgaW50IHpvcmFuX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAogCWludCByZXMgPSAwOwogCiAJaWYgKGZtdC0+Zm10LnBpeC5waXhlbGZvcm1hdCA9
PSBWNEwyX1BJWF9GTVRfTUpQRUcpCi0JCXJldHVybiB6b3Jhbl9zX2ZtdF92aWRfb3V0KGZpbGUs
IGZoLCBmbXQpOworCQlyZXR1cm4gem9yYW5fc19mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZm10
KTsKIAogCWZvciAoaSA9IDA7IGkgPCBOVU1fRk9STUFUUzsgaSsrKQogCQlpZiAoZm10LT5mbXQu
cGl4LnBpeGVsZm9ybWF0ID09IHpvcmFuX2Zvcm1hdHNbaV0uZm91cmNjKQpAQCAtNTU1LDcgKzU2
MCw4IEBAIHN0YXRpYyBpbnQgem9yYW5fc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsCiAJcmV0dXJuIHJlczsKIH0KIAotc3RhdGljIGludCB6b3Jhbl9nX3N0ZChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHY0bDJfc3RkX2lkICpzdGQpCitzdGF0aWMgaW50IHpv
cmFuX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJICAgICAgIHY0bDJfc3RkX2lkICpzdGQpCiB7CiAJc3RydWN0IHpvcmFuICp6ciA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTU2Myw3ICs1NjksOCBAQCBzdGF0aWMgaW50IHpv
cmFuX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdjRsMl9zdGRfaWQgKnN0ZCkK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB6b3Jhbl9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHY0bDJfc3RkX2lkIHN0ZCkKK3N0YXRpYyBpbnQgem9yYW5fc19zdGQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAg
ICAgdjRsMl9zdGRfaWQgc3RkKQogewogCXN0cnVjdCB6b3JhbiAqenIgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwogCWludCByZXMgPSAwOwpAQCAtNTc4LDcgKzU4NSw4IEBAIHN0YXRpYyBpbnQgem9y
YW5fc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB2NGwyX3N0ZF9pZCBzdGQpCiAJ
cmV0dXJuIHJlczsKIH0KIAotc3RhdGljIGludCB6b3Jhbl9lbnVtX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgem9yYW5fZW51bV9pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
ICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wKQogewogCXN0cnVjdCB6b3JhbiAqenIgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtNTk1LDcgKzYwMyw4IEBAIHN0YXRpYyBpbnQgem9yYW5fZW51bV9p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgem9yYW5fZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVk
IGludCAqaW5wdXQpCitzdGF0aWMgaW50IHpvcmFuX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHVuc2lnbmVkIGludCAqaW5w
dXQpCiB7CiAJc3RydWN0IHpvcmFuICp6ciA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTYw
NCw3ICs2MTMsOCBAQCBzdGF0aWMgaW50IHpvcmFuX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgKmlucHV0KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHpvcmFuX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBp
bnQgaW5wdXQpCitzdGF0aWMgaW50IHpvcmFuX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHVuc2lnbmVkIGludCBpbnB1dCkK
IHsKIAlzdHJ1Y3Qgem9yYW4gKnpyID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlpbnQgcmVzOwpA
QCAtNjE3LDcgKzYyNyw5IEBAIHN0YXRpYyBpbnQgem9yYW5fc19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpbnB1dCkKIH0KIAogLyogY3JvcHBpbmcgKHN1
Yi1mcmFtZSBjYXB0dXJlKSAqLwotc3RhdGljIGludCB6b3Jhbl9nX3NlbGVjdGlvbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQorc3RhdGlj
IGludCB6b3Jhbl9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlv
biAqc2VsKQogewogCXN0cnVjdCB6b3JhbiAqenIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBA
IC02NTIsNyArNjY0LDkgQEAgc3RhdGljIGludCB6b3Jhbl9nX3NlbGVjdGlvbihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbgogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHpvcmFuX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCitzdGF0aWMgaW50IHpvcmFuX3Nfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0
IHpvcmFuICp6ciA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHpvcmFuX2pwZ19zZXR0
aW5ncyBzZXR0aW5nczsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYWxsZWdy
by1kdnQvYWxsZWdyby1jb3JlLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FsbGVncm8tZHZ0
L2FsbGVncm8tY29yZS5jCmluZGV4IDUxMGMzYzk2NjFkOTkwYzhhZTk3ZDRiNGQxNzQ2MzliNWFh
MGIxM2QuLmExNTc3M2MwYmZkNzM3YzkwMTExZTFjZWU2MzJmNjNjZGU1NTE5NTQgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYWxsZWdyby1kdnQvYWxsZWdyby1jb3JlLmMKKysr
IGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hbGxlZ3JvLWR2dC9hbGxlZ3JvLWNvcmUuYwpAQCAt
MzI0Nyw3ICszMjQ3LDggQEAgc3RhdGljIGludCBhbGxlZ3JvX3JlbGVhc2Uoc3RydWN0IGZpbGUg
KmZpbGUpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYWxsZWdyb19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGFsbGVncm9fcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5k
cml2ZXIsIEtCVUlMRF9NT0ROQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTMyNTYsNyAr
MzI1Nyw4IEBAIHN0YXRpYyBpbnQgYWxsZWdyb19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYWxsZWdyb19lbnVtX2ZtdF92
aWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBhbGxlZ3JvX2VudW1f
Zm10X3ZpZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN3aXRjaCAoZi0+dHlw
ZSkgewpAQCAtMzI3OSw3ICszMjgxLDggQEAgc3RhdGljIGludCBhbGxlZ3JvX2VudW1fZm10X3Zp
ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgYWxsZWdyb19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0
YXRpYyBpbnQgYWxsZWdyb19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCBhbGxlZ3JvX2NoYW5uZWwgKmNoYW5uZWwgPSBmaWxlX3RvX2NoYW5u
ZWwoZmlsZSk7CkBAIC0zMzAwLDcgKzMzMDMsOCBAQCBzdGF0aWMgaW50IGFsbGVncm9fZ19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgYWxsZWdyb190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAorc3RhdGljIGludCBhbGxlZ3JvX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJZi0+Zm10LnBpeC5maWVsZCA9IFY0TDJfRklFTERfTk9O
RTsKQEAgLTMzMjEsMTQgKzMzMjUsMTUgQEAgc3RhdGljIGludCBhbGxlZ3JvX3RyeV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgYWxsZWdyb19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgYWxsZWdyb19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQogewogCXN0cnVjdCBhbGxlZ3JvX2NoYW5uZWwgKmNoYW5uZWwgPSBmaWxlX3RvX2No
YW5uZWwoZmlsZSk7CiAJc3RydWN0IHZiMl9xdWV1ZSAqdnE7CiAJaW50IGVycjsKIAotCWVyciA9
IGFsbGVncm9fdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIGZoLCBmKTsKKwllcnIgPSBhbGxlZ3JvX3Ry
eV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsK
IApAQCAtMzM0NSw3ICszMzUwLDggQEAgc3RhdGljIGludCBhbGxlZ3JvX3NfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGFsbGVncm9fZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0
aWMgaW50IGFsbGVncm9fZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgYWxsZWdyb19jaGFubmVsICpjaGFubmVsID0gZmlsZV90b19jaGFubmVs
KGZpbGUpOwpAQCAtMzM2Nyw3ICszMzczLDggQEAgc3RhdGljIGludCBhbGxlZ3JvX2dfZm10X3Zp
ZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IGFsbGVncm9fdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKK3N0YXRpYyBpbnQgYWxsZWdyb190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCWYtPmZtdC5waXguZmllbGQgPSBWNEwyX0ZJRUxEX05PTkU7
CkBAIC0zMzkyLDEzICszMzk5LDE0IEBAIHN0YXRpYyBpbnQgYWxsZWdyb190cnlfZm10X3ZpZF9v
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGFsbGVncm9fc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitz
dGF0aWMgaW50IGFsbGVncm9fc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgYWxsZWdyb19jaGFubmVsICpjaGFubmVsID0gZmlsZV90b19jaGFu
bmVsKGZpbGUpOwogCWludCBlcnI7CiAKLQllcnIgPSBhbGxlZ3JvX3RyeV9mbXRfdmlkX291dChm
aWxlLCBmaCwgZik7CisJZXJyID0gYWxsZWdyb190cnlfZm10X3ZpZF9vdXQoZmlsZSwgc3RhdGUs
IGYpOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKQEAgLTM0MzMsMTcgKzM0NDEsMTggQEAg
c3RhdGljIGludCBhbGxlZ3JvX2NoYW5uZWxfY21kX3N0YXJ0KHN0cnVjdCBhbGxlZ3JvX2NoYW5u
ZWwgKmNoYW5uZWwpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYWxsZWdyb19lbmNvZGVy
X2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGFsbGVncm9fZW5j
b2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmNtZCkK
IHsKIAlzdHJ1Y3QgYWxsZWdyb19jaGFubmVsICpjaGFubmVsID0gZmlsZV90b19jaGFubmVsKGZp
bGUpOwogCWludCBlcnI7CiAKLQllcnIgPSB2NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rlcl9jbWQo
ZmlsZSwgZmgsIGNtZCk7CisJZXJyID0gdjRsMl9tMm1faW9jdGxfdHJ5X2VuY29kZXJfY21kKGZp
bGUsIHN0YXRlLCBjbWQpOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKLQllcnIgPSB2NGwy
X20ybV9pb2N0bF9lbmNvZGVyX2NtZChmaWxlLCBmaCwgY21kKTsKKwllcnIgPSB2NGwyX20ybV9p
b2N0bF9lbmNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgY21kKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4g
ZXJyOwogCkBAIC0zNDU2LDcgKzM0NjUsOCBAQCBzdGF0aWMgaW50IGFsbGVncm9fZW5jb2Rlcl9j
bWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiBlcnI7CiB9CiAKLXN0YXRp
YyBpbnQgYWxsZWdyb19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LAorc3RhdGljIGludCBhbGxlZ3JvX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3Qg
djRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3dpdGNoIChmc2l6ZS0+cGl4ZWxfZm9ybWF0
KSB7CkBAIC0zNDgyLDcgKzM0OTIsOCBAQCBzdGF0aWMgaW50IGFsbGVncm9fZW51bV9mcmFtZXNp
emVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBhbGxlZ3JvX2lvY3RsX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCBhbGxlZ3JvX2lvY3RsX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBlbnVtIHY0bDJf
YnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgYWxsZWdyb19jaGFubmVsICpjaGFubmVsID0gZmls
ZV90b19jaGFubmVsKGZpbGUpOwpAQCAtMzQ5Nyw3ICszNTA4LDggQEAgc3RhdGljIGludCBhbGxl
Z3JvX2lvY3RsX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biB2NGwyX20ybV9zdHJlYW1vbihmaWxlLCBjaGFubmVsLT5maC5tMm1fY3R4LCB0eXBlKTsKIH0K
IAotc3RhdGljIGludCBhbGxlZ3JvX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IGFsbGVncm9fZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgc3RydWN0IHY0bDJfc3RyZWFtcGFy
bSAqYSkKIHsKIAlzdHJ1Y3QgYWxsZWdyb19jaGFubmVsICpjaGFubmVsID0gZmlsZV90b19jaGFu
bmVsKGZpbGUpOwpAQCAtMzUxNCw3ICszNTI2LDggQEAgc3RhdGljIGludCBhbGxlZ3JvX2dfcGFy
bShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgYWxsZWdyb19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGlu
dCBhbGxlZ3JvX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJ
c3RydWN0IGFsbGVncm9fY2hhbm5lbCAqY2hhbm5lbCA9IGZpbGVfdG9fY2hhbm5lbChmaWxlKTsK
QEAgLTM1MjgsNyArMzU0MSw3IEBAIHN0YXRpYyBpbnQgYWxsZWdyb19zX3Bhcm0oc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAogCXRpbWVwZXJmcmFtZSA9ICZhLT5wYXJtLm91dHB1dC50aW1l
cGVyZnJhbWU7CiAKIAlpZiAodGltZXBlcmZyYW1lLT5udW1lcmF0b3IgPT0gMCB8fCB0aW1lcGVy
ZnJhbWUtPmRlbm9taW5hdG9yID09IDApCi0JCXJldHVybiBhbGxlZ3JvX2dfcGFybShmaWxlLCBm
aCwgYSk7CisJCXJldHVybiBhbGxlZ3JvX2dfcGFybShmaWxlLCBzdGF0ZSwgYSk7CiAKIAlkaXYg
PSBnY2QodGltZXBlcmZyYW1lLT5kZW5vbWluYXRvciwgdGltZXBlcmZyYW1lLT5udW1lcmF0b3Ip
OwogCWNoYW5uZWwtPmZyYW1lcmF0ZS5udW1lcmF0b3IgPSB0aW1lcGVyZnJhbWUtPmRlbm9taW5h
dG9yIC8gZGl2OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hbWxvZ2ljL2Mz
L2lzcC9jMy1pc3AtY2FwdHVyZS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hbWxvZ2ljL2Mz
L2lzcC9jMy1pc3AtY2FwdHVyZS5jCmluZGV4IDExZDg1ZjUzNDJmMGY0MWY5ZjZmNzBjMTgzNDQz
NDRlM2YyNmRhZGUuLmNhOTQwODc2ZjExZGQzZThjNDE2MGFhY2ZmZGE2YzhmYTNlODFmOTggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1sb2dpYy9jMy9pc3AvYzMtaXNwLWNh
cHR1cmUuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtbG9naWMvYzMvaXNwL2MzLWlz
cC1jYXB0dXJlLmMKQEAgLTM4Myw3ICszODMsOCBAQCBzdGF0aWMgdm9pZCBjM19pc3BfY2FwX3Jl
dHVybl9idWZmZXJzKHN0cnVjdCBjM19pc3BfY2FwdHVyZSAqY2FwLAogCX0KIH0KIAotc3RhdGlj
IGludCBjM19pc3BfY2FwX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0
YXRpYyBpbnQgYzNfaXNwX2NhcF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgQzNfSVNQX0RSSVZF
Ul9OQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTM5Miw3ICszOTMsOCBAQCBzdGF0aWMg
aW50IGMzX2lzcF9jYXBfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IGMzX2lzcF9jYXBfZW51bV9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBjM19pc3BfY2FwX2VudW1fZm10KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJY29uc3Qgc3RydWN0IGMzX2lz
cF9jYXBfZm9ybWF0X2luZm8gKmZtdDsKQEAgLTQyMiw3ICs0MjQsOCBAQCBzdGF0aWMgaW50IGMz
X2lzcF9jYXBfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAt
RUlOVkFMOwogfQogCi1zdGF0aWMgaW50IGMzX2lzcF9jYXBfZ19mbXRfbXBsYW5lKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgYzNfaXNwX2NhcF9nX2ZtdF9tcGxhbmUo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjM19pc3BfY2Fw
dHVyZSAqY2FwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQzMiw3ICs0MzUsOCBAQCBzdGF0
aWMgaW50IGMzX2lzcF9jYXBfZ19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjM19pc3BfY2FwX3NfZm10X21wbGFuZShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGMzX2lzcF9jYXBfc19mbXRf
bXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgYzNf
aXNwX2NhcHR1cmUgKmNhcCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00NDUsNyArNDQ5LDgg
QEAgc3RhdGljIGludCBjM19pc3BfY2FwX3NfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYzNfaXNwX2NhcF90cnlfZm10
X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGMzX2lzcF9j
YXBfdHJ5X2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IHsKIAljM19jYXBfdHJ5X2ZtdCgmZi0+Zm10LnBpeF9tcCk7CkBAIC00NTMsNyArNDU4LDggQEAg
c3RhdGljIGludCBjM19pc3BfY2FwX3RyeV9mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjM19pc3BfY2FwX2VudW1fZnJt
c2l6ZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGMzX2lzcF9jYXBf
ZW51bV9mcm1zaXplKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkK
IHsKIAljb25zdCBzdHJ1Y3QgYzNfaXNwX2NhcF9mb3JtYXRfaW5mbyAqZm10OwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hbWxvZ2ljL2MzL2lzcC9jMy1pc3AtcGFyYW1zLmMg
Yi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtbG9naWMvYzMvaXNwL2MzLWlzcC1wYXJhbXMuYwpp
bmRleCBjODA2NjdkZDc2NjIxMGQyYjJlMWVlNjBjODI1NGE1ODE0YjlkODFiLi5iNjc0MDlmOGE2
ZjFkN2RjMmY1MDBlMzYxNjE4NzI1ZjhmYjE0NGJlIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlh
L3BsYXRmb3JtL2FtbG9naWMvYzMvaXNwL2MzLWlzcC1wYXJhbXMuYworKysgYi9kcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL2FtbG9naWMvYzMvaXNwL2MzLWlzcC1wYXJhbXMuYwpAQCAtNjc4LDcgKzY3
OCw4IEBAIHZvaWQgYzNfaXNwX3BhcmFtc19wcmVfY2ZnKHN0cnVjdCBjM19pc3BfZGV2aWNlICpp
c3ApCiAKIC8qIFY0TDIgdmlkZW8gb3BlcmF0aW9ucyAqLwogCi1zdGF0aWMgaW50IGMzX2lzcF9w
YXJhbXNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBj
M19pc3BfcGFyYW1zX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgQzNfSVNQX0RSSVZFUl9OQU1FLCBzaXplb2Yo
Y2FwLT5kcml2ZXIpKTsKQEAgLTY4Nyw3ICs2ODgsOCBAQCBzdGF0aWMgaW50IGMzX2lzcF9wYXJh
bXNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IGMzX2lzcF9wYXJhbXNfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorc3RhdGljIGludCBjM19pc3BfcGFyYW1zX2VudW1fZm10KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1
Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT5pbmRleCkKQEAgLTY5OCw3ICs3MDAsOCBA
QCBzdGF0aWMgaW50IGMzX2lzcF9wYXJhbXNfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGMzX2lzcF9wYXJhbXNfZ19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBjM19pc3BfcGFyYW1zX2df
Zm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
YzNfaXNwX3BhcmFtcyAqcGFyYW1zID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1sb2dpYy9jMy9pc3AvYzMtaXNwLXN0YXRzLmMgYi9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtbG9naWMvYzMvaXNwL2MzLWlzcC1zdGF0cy5jCmluZGV4
IDhhNWQ3ZTFhMzBjOTUyYWRkMTM4ZmZiNGViNWM3YWQzNmQ1NGQyMzMuLjFlNWU1YWU0ODQ0NWM3
YTdmNmY2NjhkYzM0NmE5MWVhYTA1NTMzODMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vYW1sb2dpYy9jMy9pc3AvYzMtaXNwLXN0YXRzLmMKKysrIGIvZHJpdmVycy9tZWRpYS9w
bGF0Zm9ybS9hbWxvZ2ljL2MzL2lzcC9jMy1pc3Atc3RhdHMuYwpAQCAtODUsNyArODUsOCBAQCB2
b2lkIGMzX2lzcF9zdGF0c19wcmVfY2ZnKHN0cnVjdCBjM19pc3BfZGV2aWNlICppc3ApCiAJYzNf
aXNwX3N0YXRzX2NmZ19idWZmKHN0YXRzKTsKIH0KIAotc3RhdGljIGludCBjM19pc3Bfc3RhdHNf
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBjM19pc3Bf
c3RhdHNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJ
c3Ryc2NweShjYXAtPmRyaXZlciwgQzNfSVNQX0RSSVZFUl9OQU1FLCBzaXplb2YoY2FwLT5kcml2
ZXIpKTsKQEAgLTk0LDcgKzk1LDggQEAgc3RhdGljIGludCBjM19pc3Bfc3RhdHNfcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGMzX2lzcF9zdGF0c19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0
aWMgaW50IGMzX2lzcF9zdGF0c19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2ZtdGRlc2Mg
KmYpCiB7CiAJc3RydWN0IGMzX2lzcF9zdGF0cyAqc3RhdHMgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtMTA3LDcgKzEwOSw4IEBAIHN0YXRpYyBpbnQgYzNfaXNwX3N0YXRzX2VudW1fZm10KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBj
M19pc3Bfc3RhdHNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGlu
dCBjM19pc3Bfc3RhdHNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgYzNfaXNwX3N0YXRzICpzdGF0cyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtbG9naWMvbWVzb24tZ2UyZC9n
ZTJkLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtbG9naWMvbWVzb24tZ2UyZC9nZTJkLmMK
aW5kZXggNTc0NDg1M2E0MDAzNWU5OTczZTYwNWRkM2ZmZWM1MDg2NDE0NzBmMi4uNjhkMGNkZDZi
ZWUwODkzYzE5MDg3ZGM2N2FlYzk3MmNjZjg4ZGRlYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9hbWxvZ2ljL21lc29uLWdlMmQvZ2UyZC5jCisrKyBiL2RyaXZlcnMvbWVkaWEv
cGxhdGZvcm0vYW1sb2dpYy9tZXNvbi1nZTJkL2dlMmQuYwpAQCAtNDMyLDcgKzQzMiw4IEBAIHF1
ZXVlX2luaXQodm9pZCAqcHJpdiwgc3RydWN0IHZiMl9xdWV1ZSAqc3JjX3ZxLCBzdHJ1Y3QgdmIy
X3F1ZXVlICpkc3RfdnEpCiB9CiAKIHN0YXRpYyBpbnQKLXZpZGlvY19xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQordmlk
aW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2Fw
LT5kcml2ZXIsIEdFMkRfTkFNRSwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7CiAJc3Ryc2NweShjYXAt
PmNhcmQsIEdFMkRfTkFNRSwgc2l6ZW9mKGNhcC0+Y2FyZCkpOwpAQCAtNDQxLDcgKzQ0Miw5IEBA
IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0
bDJfY2FwYWJpbGl0eSAqY2FwKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19l
bnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVz
YyAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9m
bXRkZXNjICpmKQogewogCWNvbnN0IHN0cnVjdCBnZTJkX2ZtdCAqZm10OwogCkBAIC00NTQsNyAr
NDU3LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJf
c2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBnZTJkX2N0eCAqY3R4ID0gZmlsZV90b19nZTJkX2N0
eChmaWxlKTsKQEAgLTUwNCw3ICs1MDgsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2Nfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJf
c2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBnZTJkX2N0eCAqY3R4ID0gZmlsZV90b19nZTJkX2N0
eChmaWxlKTsKQEAgLTU3Miw3ICs1NzcsOSBAQCBzdGF0aWMgdm9pZCB2aWRpb2Nfc2V0dXBfY2Fw
X2ZtdChzdHJ1Y3QgZ2UyZF9jdHggKmN0eCwgc3RydWN0IHY0bDJfcGl4X2Zvcm1hdCAqZgogCX0K
IH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9m
bXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0
IGdlMmRfY3R4ICpjdHggPSBmaWxlX3RvX2dlMmRfY3R4KGZpbGUpOwogCWNvbnN0IHN0cnVjdCBn
ZTJkX2ZtdCAqZm10ID0gZmluZF9mbXQoZik7CkBAIC01OTMsNyArNjAwLDkgQEAgc3RhdGljIGlu
dCB2aWRpb2NfdHJ5X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVj
dCB2NGwyX2Zvcm1hdAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
K3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCiB7CiAJc3RydWN0IGdlMmRfY3R4ICpjdHggPSBmaWxlX3RvX2dlMmRfY3R4KGZpbGUp
OwogCXN0cnVjdCBtZXNvbl9nZTJkICpnZTJkID0gY3R4LT5nZTJkOwpAQCAtNjA0LDcgKzYxMyw3
IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmCiAJLyogQWRqdXN0IGFsbCB2YWx1ZXMgYWNjb3Jk
aW5nbHkgdG8gdGhlIGhhcmR3YXJlIGNhcGFiaWxpdGllcwogCSAqIGFuZCBjaG9zZW4gZm9ybWF0
LgogCSAqLwotCXJldCA9IHZpZGlvY190cnlfZm10X2NhcChmaWxlLCBwcml2LCBmKTsKKwlyZXQg
PSB2aWRpb2NfdHJ5X2ZtdF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVy
biByZXQ7CiAKQEAgLTYyOSw3ICs2MzgsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZgogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2NfZ19m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBnZTJkX2N0eCAqY3R4ID0gZmls
ZV90b19nZTJkX2N0eChmaWxlKTsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsKQEAgLTY0Nyw3ICs2
NTcsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY190cnlfZm10X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF9vdXQoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAljb25zdCBzdHJ1Y3QgZ2UyZF9mbXQg
KmZtdCA9IGZpbmRfZm10KGYpOwogCkBAIC02NjgsNyArNjgwLDkgQEAgc3RhdGljIGludCB2aWRp
b2NfdHJ5X2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwy
X2Zvcm1hdAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdF9vdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRp
YyBpbnQgdmlkaW9jX3NfZm10X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IGdlMmRfY3R4ICpjdHggPSBmaWxlX3RvX2dlMmRfY3R4KGZpbGUpOwogCXN0
cnVjdCBtZXNvbl9nZTJkICpnZTJkID0gY3R4LT5nZTJkOwpAQCAtNjc5LDcgKzY5Myw3IEBAIHN0
YXRpYyBpbnQgdmlkaW9jX3NfZm10X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
c3RydWN0IHY0bDJfZm9ybWF0ICpmCiAJLyogQWRqdXN0IGFsbCB2YWx1ZXMgYWNjb3JkaW5nbHkg
dG8gdGhlIGhhcmR3YXJlIGNhcGFiaWxpdGllcwogCSAqIGFuZCBjaG9zZW4gZm9ybWF0LgogCSAq
LwotCXJldCA9IHZpZGlvY190cnlfZm10X291dChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSB2aWRp
b2NfdHJ5X2ZtdF9vdXQoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1waGlvbi92ZGVjLmMgYi9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtcGhpb24vdmRlYy5jCmluZGV4IDMyZWVmMmZkMWYyYTkw
MjQzMjU2NzA5ZDJhNmExZjdkNjJhNjgxNmEuLjNiNDFiYmFkMDIxMzljYjM3NmRlZjhmOGE2NTA0
MTZlZjk4ZmZkNzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1waGlvbi92
ZGVjLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hbXBoaW9uL3ZkZWMuYwpAQCAtNDE3
LDcgKzQxNyw4IEBAIHN0YXRpYyB2b2lkIHZkZWNfc2V0X2xhc3RfYnVmZmVyX2RlcXVldWVkKHN0
cnVjdCB2cHVfaW5zdCAqaW5zdCkKIAl9CiB9CiAKLXN0YXRpYyBpbnQgdmRlY19xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkK
K3N0YXRpYyBpbnQgdmRlY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQog
ewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsICJhbXBoaW9uLXZwdSIsIHNpemVvZihjYXAtPmRyaXZl
cikpOwogCXN0cnNjcHkoY2FwLT5jYXJkLCAiYW1waGlvbiB2cHUgZGVjb2RlciIsIHNpemVvZihj
YXAtPmNhcmQpKTsKQEAgLTQyNiw3ICs0MjcsOCBAQCBzdGF0aWMgaW50IHZkZWNfcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYQog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZkZWNfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQorc3RhdGljIGludCB2ZGVjX2Vu
dW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2cHVfaW5zdCAqaW5z
dCA9IHRvX2luc3QoZmlsZSk7CiAJc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7CkBA
IC00NTUsNyArNDU3LDggQEAgc3RhdGljIGludCB2ZGVjX2VudW1fZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIAlyZXR1cm4gcmV0OwogfQog
Ci1zdGF0aWMgaW50IHZkZWNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZkZWNfZ19mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZwdV9pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsK
IAlzdHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsKQEAgLTQ4Niw3ICs0ODksOCBAQCBz
dGF0aWMgaW50IHZkZWNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmRlY190cnlfZm10
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3Rh
dGljIGludCB2ZGVjX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2
cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJc3RydWN0IHZkZWNfdCAqdmRlYyA9IGlu
c3QtPnByaXY7CkBAIC01OTIsNyArNTk2LDggQEAgc3RhdGljIGludCB2ZGVjX3NfZm10X2NvbW1v
bihzdHJ1Y3QgdnB1X2luc3QgKmluc3QsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2ZGVjX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2ZGVjX3NfZm10KHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3Qo
ZmlsZSk7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeG1wID0gJmYtPmZtdC5w
aXhfbXA7CkBAIC02MjUsNyArNjMwLDkgQEAgc3RhdGljIGludCB2ZGVjX3NfZm10KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiByZXQ7
CiB9CiAKLXN0YXRpYyBpbnQgdmRlY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK3N0YXRpYyBpbnQgdmRlY19nX3NlbGVj
dGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IHZw
dV9pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsKIApAQCAtNzEzLDEyICs3MjAsMTQgQEAgc3Rh
dGljIGludCB2ZGVjX2NtZF9zdG9wKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCkKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2ZGVjX2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwgc3RydWN0IHY0bDJfZGVjb2Rlcl9jbWQgKmNtZCkKK3N0YXRpYyBpbnQgdmRlY19kZWNv
ZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9kZWNvZGVyX2NtZCAqY21kKQogewogCXN0
cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJaW50IHJldDsKIAotCXJldCA9
IHY0bDJfbTJtX2lvY3RsX3RyeV9kZWNvZGVyX2NtZChmaWxlLCBmaCwgY21kKTsKKwlyZXQgPSB2
NGwyX20ybV9pb2N0bF90cnlfZGVjb2Rlcl9jbWQoZmlsZSwgc3RhdGUsIGNtZCk7CiAJaWYgKHJl
dCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTg4NSw3ICsxODk0LDYgQEAgc3RhdGljIHN0cnVjdCB2
cHVfaW5zdF9vcHMgdmRlY19pbnN0X29wcyA9IHsKIAogc3RhdGljIHZvaWQgdmRlY19pbml0KHN0
cnVjdCBmaWxlICpmaWxlKQogewotCXN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmls
ZSk7CiAJc3RydWN0IHY0bDJfZm9ybWF0IGY7CiAKIAltZW1zZXQoJmYsIDAsIHNpemVvZihmKSk7
CkBAIC0xODk0LDcgKzE5MDIsNyBAQCBzdGF0aWMgdm9pZCB2ZGVjX2luaXQoc3RydWN0IGZpbGUg
KmZpbGUpCiAJZi5mbXQucGl4X21wLndpZHRoID0gMTI4MDsKIAlmLmZtdC5waXhfbXAuaGVpZ2h0
ID0gNzIwOwogCWYuZm10LnBpeF9tcC5maWVsZCA9IFY0TDJfRklFTERfTk9ORTsKLQl2ZGVjX3Nf
Zm10KGZpbGUsICZpbnN0LT5maCwgJmYpOworCXZkZWNfc19mbXQoZmlsZSwgTlVMTCwgJmYpOwog
CiAJbWVtc2V0KCZmLCAwLCBzaXplb2YoZikpOwogCWYudHlwZSA9IFY0TDJfQlVGX1RZUEVfVklE
RU9fQ0FQVFVSRV9NUExBTkU7CkBAIC0xOTAyLDcgKzE5MTAsNyBAQCBzdGF0aWMgdm9pZCB2ZGVj
X2luaXQoc3RydWN0IGZpbGUgKmZpbGUpCiAJZi5mbXQucGl4X21wLndpZHRoID0gMTI4MDsKIAlm
LmZtdC5waXhfbXAuaGVpZ2h0ID0gNzIwOwogCWYuZm10LnBpeF9tcC5maWVsZCA9IFY0TDJfRklF
TERfTk9ORTsKLQl2ZGVjX3NfZm10KGZpbGUsICZpbnN0LT5maCwgJmYpOworCXZkZWNfc19mbXQo
ZmlsZSwgTlVMTCwgJmYpOwogfQogCiBzdGF0aWMgaW50IHZkZWNfb3BlbihzdHJ1Y3QgZmlsZSAq
ZmlsZSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1waGlvbi92ZW5jLmMg
Yi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtcGhpb24vdmVuYy5jCmluZGV4IGM1YzFmMWZiYWE4
MDM2NmQ1YjE4YjhmMjQ2OTllYjljM2ExOGVmOTIuLjc3YmVmYzI1Njg3OWQ5YTAxOTBhNDMwMGNk
ZGI2ZjcyYTExY2Y3Y2IgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1waGlv
bi92ZW5jLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hbXBoaW9uL3ZlbmMuYwpAQCAt
OTIsNyArOTIsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZwdV9mb3JtYXQgdmVuY19mb3JtYXRz
W10gPSB7CiAJezAsIDAsIDAsIDB9LAogfTsKIAotc3RhdGljIGludCB2ZW5jX3F1ZXJ5Y2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQor
c3RhdGljIGludCB2ZW5jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7
CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgImFtcGhpb24tdnB1Iiwgc2l6ZW9mKGNhcC0+ZHJpdmVy
KSk7CiAJc3Ryc2NweShjYXAtPmNhcmQsICJhbXBoaW9uIHZwdSBlbmNvZGVyIiwgc2l6ZW9mKGNh
cC0+Y2FyZCkpOwpAQCAtMTAxLDcgKzEwMiw4IEBAIHN0YXRpYyBpbnQgdmVuY19xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmVuY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IHZlbmNfZW51
bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHZwdV9pbnN0ICppbnN0
ID0gdG9faW5zdChmaWxlKTsKIAljb25zdCBzdHJ1Y3QgdnB1X2Zvcm1hdCAqZm10OwpAQCAtMTE3
LDcgKzExOSw5IEBAIHN0YXRpYyBpbnQgdmVuY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdmVuY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCitzdGF0aWMgaW50IHZlbmNfZW51bV9mcmFt
ZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKIHsKIAlzdHJ1Y3Qg
dnB1X2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOwogCWNvbnN0IHN0cnVjdCB2cHVfY29yZV9y
ZXNvdXJjZXMgKnJlczsKQEAgLTE0Miw3ICsxNDYsOSBAQCBzdGF0aWMgaW50IHZlbmNfZW51bV9m
cmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZnJtc2l6
ZQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZlbmNfZW51bV9mcmFtZWludGVydmFscyhz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZybWl2YWxlbnVtICpmaXZh
bCkKK3N0YXRpYyBpbnQgdmVuY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgc3Ry
dWN0IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFsKQogewogCXN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9
IHRvX2luc3QoZmlsZSk7CiAJY29uc3Qgc3RydWN0IHZwdV9jb3JlX3Jlc291cmNlcyAqcmVzOwpA
QCAtMTc0LDcgKzE4MCw4IEBAIHN0YXRpYyBpbnQgdmVuY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZnJtCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdmVuY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmVuY19nX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdnB1X2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUp
OwogCXN0cnVjdCB2ZW5jX3QgKnZlbmMgPSBpbnN0LT5wcml2OwpAQCAtMjAzLDcgKzIxMCw4IEBA
IHN0YXRpYyBpbnQgdmVuY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2ZW5jX3RyeV9m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitz
dGF0aWMgaW50IHZlbmNfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0
IHZwdV9pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsKIAlzdHJ1Y3QgdnB1X2Zvcm1hdCBmbXQ7
CkBAIC0yMTMsNyArMjIxLDggQEAgc3RhdGljIGludCB2ZW5jX3RyeV9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdmVuY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmVuY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdnB1X2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOwog
CXN0cnVjdCB2cHVfZm9ybWF0IGZtdDsKQEAgLTI2NSw3ICsyNzQsOCBAQCBzdGF0aWMgaW50IHZl
bmNfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmVuY19nX3Bhcm0oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQorc3RhdGljIGlu
dCB2ZW5jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQogewogCXN0
cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJc3RydWN0IHZlbmNfdCAqdmVu
YyA9IGluc3QtPnByaXY7CkBAIC0yODksNyArMjk5LDggQEAgc3RhdGljIGludCB2ZW5jX2dfcGFy
bShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBh
cm0KIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2ZW5jX3NfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCitzdGF0aWMgaW50
IHZlbmNfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJICAgICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3Ry
dWN0IHZwdV9pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsKIAlzdHJ1Y3QgdmVuY190ICp2ZW5j
ID0gaW5zdC0+cHJpdjsKQEAgLTMyOCw3ICszMzksOSBAQCBzdGF0aWMgaW50IHZlbmNfc19wYXJt
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFy
bQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZlbmNfZ19zZWxlY3Rpb24oc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCitzdGF0aWMgaW50
IHZlbmNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQog
ewogCXN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJc3RydWN0IHZlbmNf
dCAqdmVuYyA9IGluc3QtPnByaXY7CkBAIC0zODIsNyArMzk1LDkgQEAgc3RhdGljIGludCB2ZW5j
X3ZhbGlkX2Nyb3Aoc3RydWN0IHZlbmNfdCAqdmVuYywgY29uc3Qgc3RydWN0IHZwdV9jb3JlX3Jl
c291cmNlcwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZlbmNfc19zZWxlY3Rpb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCitzdGF0
aWMgaW50IHZlbmNfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9u
ICpzKQogewogCXN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJY29uc3Qg
c3RydWN0IHZwdV9jb3JlX3Jlc291cmNlcyAqcmVzOwpAQCAtNDQ5LDEyICs0NjQsMTQgQEAgc3Rh
dGljIGludCB2ZW5jX3JlcXVlc3RfZW9zKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2ZW5jX2VuY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwgc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmNtZCkKK3N0YXRpYyBpbnQgdmVuY19l
bmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9lbmNvZGVyX2NtZCAqY21kKQogewog
CXN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJaW50IHJldDsKIAotCXJl
dCA9IHY0bDJfbTJtX2lvY3RsX3RyeV9lbmNvZGVyX2NtZChmaWxlLCBmaCwgY21kKTsKKwlyZXQg
PSB2NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rlcl9jbWQoZmlsZSwgc3RhdGUsIGNtZCk7CiAJaWYg
KHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTI4OCw3ICsxMzA1LDcgQEAgc3RhdGljIHZvaWQg
dmVuY19pbml0KHN0cnVjdCBmaWxlICpmaWxlKQogCWYuZm10LnBpeF9tcC53aWR0aCA9IDEyODA7
CiAJZi5mbXQucGl4X21wLmhlaWdodCA9IDcyMDsKIAlmLmZtdC5waXhfbXAuZmllbGQgPSBWNEwy
X0ZJRUxEX05PTkU7Ci0JdmVuY19zX2ZtdChmaWxlLCAmaW5zdC0+ZmgsICZmKTsKKwl2ZW5jX3Nf
Zm10KGZpbGUsIE5VTEwsICZmKTsKIAogCW1lbXNldCgmZiwgMCwgc2l6ZW9mKGYpKTsKIAlmLnR5
cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkVfTVBMQU5FOwpAQCAtMTI5NiwxMyArMTMx
MywxMyBAQCBzdGF0aWMgdm9pZCB2ZW5jX2luaXQoc3RydWN0IGZpbGUgKmZpbGUpCiAJZi5mbXQu
cGl4X21wLndpZHRoID0gMTI4MDsKIAlmLmZtdC5waXhfbXAuaGVpZ2h0ID0gNzIwOwogCWYuZm10
LnBpeF9tcC5maWVsZCA9IFY0TDJfRklFTERfTk9ORTsKLQl2ZW5jX3NfZm10KGZpbGUsICZpbnN0
LT5maCwgJmYpOworCXZlbmNfc19mbXQoZmlsZSwgTlVMTCwgJmYpOwogCiAJbWVtc2V0KCZwYXJt
LCAwLCBzaXplb2YocGFybSkpOwogCXBhcm0udHlwZSA9IFY0TDJfQlVGX1RZUEVfVklERU9fT1VU
UFVUX01QTEFORTsKIAlwYXJtLnBhcm0uY2FwdHVyZS50aW1lcGVyZnJhbWUubnVtZXJhdG9yID0g
MTsKIAlwYXJtLnBhcm0uY2FwdHVyZS50aW1lcGVyZnJhbWUuZGVub21pbmF0b3IgPSAzMDsKLQl2
ZW5jX3NfcGFybShmaWxlLCAmaW5zdC0+ZmgsICZwYXJtKTsKKwl2ZW5jX3NfcGFybShmaWxlLCBO
VUxMLCAmcGFybSk7CiB9CiAKIHN0YXRpYyBpbnQgdmVuY19vcGVuKHN0cnVjdCBmaWxlICpmaWxl
KQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hc3BlZWQvYXNwZWVkLXZpZGVv
LmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2FzcGVlZC9hc3BlZWQtdmlkZW8uYwppbmRleCBi
ODNlNDMyNDUyNzdiNDczMDYwMzI4MGU0ZjAwYjJiNzViMjVmMDZiLi5iNzlkOGM0YWFmMTViYTA2
ZDFmNGQ1ZDJiMGFlZWIwZGY0NWMzMDhmIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRm
b3JtL2FzcGVlZC9hc3BlZWQtdmlkZW8uYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2Fz
cGVlZC9hc3BlZWQtdmlkZW8uYwpAQCAtMTQyOCw3ICsxNDI4LDggQEAgc3RhdGljIHZvaWQgYXNw
ZWVkX3ZpZGVvX3N0b3Aoc3RydWN0IGFzcGVlZF92aWRlbyAqdmlkZW8pCiAJdmlkZW8tPmZsYWdz
ID0gMDsKIH0KIAotc3RhdGljIGludCBhc3BlZWRfdmlkZW9fcXVlcnljYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBhc3BlZWRfdmlkZW9fcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CSBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwg
REVWSUNFX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMTQzOSw3ICsxNDQwLDggQEAg
c3RhdGljIGludCBhc3BlZWRfdmlkZW9fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFzcGVlZF92aWRlb19lbnVtX2Zvcm1h
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGFzcGVlZF92aWRlb19l
bnVtX2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3Ry
dWN0IGFzcGVlZF92aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTQ1Miw3
ICsxNDU0LDggQEAgc3RhdGljIGludCBhc3BlZWRfdmlkZW9fZW51bV9mb3JtYXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFzcGVlZF92
aWRlb19nZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
YXNwZWVkX3ZpZGVvX2dldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCBhc3BlZWRfdmlkZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTE0NjIsNyArMTQ2NSw4IEBAIHN0YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX2dldF9mb3JtYXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGFzcGVlZF92aWRlb19zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0
YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX3NldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCBhc3BlZWRfdmlkZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTE0ODUsNyArMTQ4OSw4IEBAIHN0YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX3Nl
dF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGFzcGVlZF92aWRlb19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3Ry
dWN0IHY0bDJfaW5wdXQgKmlucCkKIHsKIAlzdHJ1Y3QgYXNwZWVkX3ZpZGVvICp2aWRlbyA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNTAxLDcgKzE1MDYsOSBAQCBzdGF0aWMgaW50IGFzcGVl
ZF92aWRlb19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBhc3BlZWRfdmlkZW9fZ2V0X2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCBhc3BlZWRfdmlkZW9f
Z2V0X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IGFzcGVlZF92
aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xNTEwLDcgKzE1MTcsOSBA
QCBzdGF0aWMgaW50IGFzcGVlZF92aWRlb19nZXRfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCB1bnNpZ25lZCBpbnQgKmkpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYXNw
ZWVkX3ZpZGVvX3NldF9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVk
IGludCBpKQorc3RhdGljIGludCBhc3BlZWRfdmlkZW9fc2V0X2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICB1bnNp
Z25lZCBpbnQgaSkKIHsKIAlzdHJ1Y3QgYXNwZWVkX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTE1NTcsNyArMTU2Niw4IEBAIHN0YXRpYyBpbnQgYXNwZWVkX3ZpZGVv
X3NldF9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpKQog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFzcGVlZF92aWRlb19nZXRfcGFybShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGFzcGVlZF92aWRlb19nZXRfcGFybShz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IGFzcGVlZF92aWRl
byAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTU3Myw3ICsxNTgzLDggQEAgc3Rh
dGljIGludCBhc3BlZWRfdmlkZW9fZ2V0X3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFzcGVlZF92aWRlb19zZXRfcGFybShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGFzcGVlZF92aWRlb19zZXRfcGFy
bShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJdW5zaWduZWQgaW50IGZy
YW1lX3JhdGUgPSAwOwpAQCAtMTYwMSw3ICsxNjEyLDggQEAgc3RhdGljIGludCBhc3BlZWRfdmlk
ZW9fc2V0X3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IGFzcGVlZF92aWRlb19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBhc3BlZWRfdmlkZW9fZW51bV9mcmFtZXNpemVzKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCBhc3BlZWRf
dmlkZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE2MTksNyArMTYzMSw4IEBA
IHN0YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX2Vu
dW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGlu
dCBhc3BlZWRfdmlkZW9fZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgICAgc3RydWN0
IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFsKQogewogCXN0cnVjdCBhc3BlZWRfdmlkZW8gKnZpZGVv
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE2NDUsNyArMTY1OCw4IEBAIHN0YXRpYyBpbnQg
YXNwZWVkX3ZpZGVvX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFzcGVlZF92aWRlb19zZXRfZHZfdGlt
aW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGFzcGVlZF92aWRl
b19zZXRfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWlu
Z3MgKnRpbWluZ3MpCiB7CiAJc3RydWN0IGFzcGVlZF92aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtMTY2Nyw3ICsxNjgxLDggQEAgc3RhdGljIGludCBhc3BlZWRfdmlkZW9f
c2V0X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IGFzcGVlZF92aWRlb19nZXRfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGFzcGVlZF92aWRlb19nZXRfZHZfdGltaW5ncyhz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJICAgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCiB7CiAJ
c3RydWN0IGFzcGVlZF92aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTY3
OCw3ICsxNjkzLDggQEAgc3RhdGljIGludCBhc3BlZWRfdmlkZW9fZ2V0X2R2X3RpbWluZ3Moc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFz
cGVlZF92aWRlb19xdWVyeV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX3F1ZXJ5X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJIHN0cnVj
dCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCiB7CiAJaW50IHJjOwpAQCAtMTcwNiwxNCArMTcy
MiwxNiBAQCBzdGF0aWMgaW50IGFzcGVlZF92aWRlb19xdWVyeV9kdl90aW1pbmdzKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gdmlkZW8tPnY0bDJfaW5wdXRfc3RhdHVzID8g
LUVOT0xJTksgOiAwOwogfQogCi1zdGF0aWMgaW50IGFzcGVlZF92aWRlb19lbnVtX2R2X3RpbWlu
Z3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBhc3BlZWRfdmlkZW9f
ZW51bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQlzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZW51bV9kdl90aW1pbmdzICp0aW1p
bmdzKQogewogCXJldHVybiB2NGwyX2VudW1fZHZfdGltaW5nc19jYXAodGltaW5ncywgJmFzcGVl
ZF92aWRlb190aW1pbmdzX2NhcCwKIAkJCQkJTlVMTCwgTlVMTCk7CiB9CiAKLXN0YXRpYyBpbnQg
YXNwZWVkX3ZpZGVvX2R2X3RpbWluZ3NfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgYXNwZWVkX3ZpZGVvX2R2X3RpbWluZ3NfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAg
ICAgc3RydWN0IHY0bDJfZHZfdGltaW5nc19jYXAgKmNhcCkKIHsKIAkqY2FwID0gYXNwZWVkX3Zp
ZGVvX3RpbWluZ3NfY2FwOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9hdG1l
bC9hdG1lbC1pc2kuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYXRtZWwvYXRtZWwtaXNpLmMK
aW5kZXggYTA1YTc0NGNiYjc1NjlhYmZmNjBjY2YxYTA4MjVhOWMzYzUyZWQ4YS4uNzE1NGNlZjcz
ZGEwYzIzZmRmMzkzMTkzODY0NWNiY2QxMzVkYzYzMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9hdG1lbC9hdG1lbC1pc2kuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L2F0bWVsL2F0bWVsLWlzaS5jCkBAIC01MjgsNyArNTI4LDggQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCB2YjJfb3BzIGlzaV92aWRlb19xb3BzID0gewogCS5zdG9wX3N0cmVhbWluZwkJPSBzdG9wX3N0
cmVhbWluZywKIH07CiAKLXN0YXRpYyBpbnQgaXNpX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGlzaV9nX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCBhdG1lbF9pc2kgKmlz
aSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02NTEsNyArNjUyLDggQEAgc3RhdGljIGludCBp
c2lfc2V0X2ZtdChzdHJ1Y3QgYXRtZWxfaXNpICppc2ksIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpc2lfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXNpX3NfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBhdG1lbF9pc2kgKmlz
aSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02NjIsNyArNjY0LDggQEAgc3RhdGljIGludCBp
c2lfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
aXNpX3NldF9mbXQoaXNpLCBmKTsKIH0KIAotc3RhdGljIGludCBpc2lfdHJ5X2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBpc2lfdHJ5X2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgYXRt
ZWxfaXNpICppc2kgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNjcwLDcgKzY3Myw4IEBAIHN0
YXRpYyBpbnQgaXNpX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gaXNpX3RyeV9mbXQoaXNpLCBmLCBOVUxMKTsKIH0KIAotc3RhdGljIGludCBp
c2lfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0
aWMgaW50IGlzaV9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYp
CiB7CiAJc3RydWN0IGF0bWVsX2lzaSAqaXNpID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTY4
Miw3ICs2ODYsOCBAQCBzdGF0aWMgaW50IGlzaV9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpc2lfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGlzaV9xdWVy
eWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5k
cml2ZXIsICJhdG1lbC1pc2kiLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTY5MSw3ICs2OTYs
OCBAQCBzdGF0aWMgaW50IGlzaV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpc2lfZW51bV9pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXNpX2VudW1faW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAg
c3RydWN0IHY0bDJfaW5wdXQgKmkpCiB7CiAJaWYgKGktPmluZGV4ICE9IDApCkBAIC03MDIsMzQg
KzcwOCwzOSBAQCBzdGF0aWMgaW50IGlzaV9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGlzaV9nX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IGlz
aV9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJICAgICAgIHVuc2lnbmVkIGludCAqaSkKIHsKIAkqaSA9IDA7CiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgaXNpX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBpc2lfc19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICB1bnNpZ25l
ZCBpbnQgaSkKIHsKIAlpZiAoaSA+IDApCiAJCXJldHVybiAtRUlOVkFMOwogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IGlzaV9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQorc3RhdGljIGludCBpc2lfZ19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3Ry
dWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlzdHJ1Y3QgYXRtZWxfaXNpICppc2kgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCiAJcmV0dXJuIHY0bDJfZ19wYXJtX2NhcCh2aWRlb19kZXZkYXRh
KGZpbGUpLCBpc2ktPmVudGl0eS5zdWJkZXYsIGEpOwogfQogCi1zdGF0aWMgaW50IGlzaV9zX3Bh
cm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICph
KQorc3RhdGljIGludCBpc2lfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkK
IHsKIAlzdHJ1Y3QgYXRtZWxfaXNpICppc2kgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCiAJcmV0
dXJuIHY0bDJfc19wYXJtX2NhcCh2aWRlb19kZXZkYXRhKGZpbGUpLCBpc2ktPmVudGl0eS5zdWJk
ZXYsIGEpOwogfQogCi1zdGF0aWMgaW50IGlzaV9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpc2lfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgICAgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKIHsKIAlzdHJ1Y3QgYXRt
ZWxfaXNpICppc2kgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzU4LDcgKzc2OSw4IEBAIHN0
YXRpYyBpbnQgaXNpX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXNpX2VudW1fZnJhbWVpbnRlcnZhbHMoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpc2lfZW51bV9mcmFtZWludGVy
dmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFsKQogewogCXN0
cnVjdCBhdG1lbF9pc2kgKmlzaSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL2Jyb2FkY29tL2JjbTI4MzUtdW5pY2FtLmMgYi9kcml2ZXJz
L21lZGlhL3BsYXRmb3JtL2Jyb2FkY29tL2JjbTI4MzUtdW5pY2FtLmMKaW5kZXggZjEwMDY0MTA3
ZDU0M2NhZjg2NzI0OWQwNTY2YTBmNDJkNmQ4YzRjNi4uZTVjY2NhZDA0YjAxMGJmOTUzMzAzNWZi
Nzg3ODI0ZjRmNjA2YmVlZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9icm9h
ZGNvbS9iY20yODM1LXVuaWNhbS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYnJvYWRj
b20vYmNtMjgzNS11bmljYW0uYwpAQCAtMTgzMSw3ICsxODMxLDggQEAgc3RhdGljIGNvbnN0IHN0
cnVjdCB2YjJfb3BzIHVuaWNhbV92aWRlb19xb3BzID0gewogICogIFY0TDIgdmlkZW8gZGV2aWNl
IG9wZXJhdGlvbnMKICAqLwogCi1zdGF0aWMgaW50IHVuaWNhbV9xdWVyeWNhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdW5pY2FtX3F1ZXJ5Y2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwg
VU5JQ0FNX01PRFVMRV9OQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTE4NDIsNyArMTg0
Myw4IEBAIHN0YXRpYyBpbnQgdW5pY2FtX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHVuaWNhbV9lbnVtX2ZtdF92aWQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB1bmljYW1fZW51bV9m
bXRfdmlkKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJdW5z
aWduZWQgaW50IGluZGV4OwpAQCAtMTg3Myw3ICsxODc1LDggQEAgc3RhdGljIGludCB1bmljYW1f
ZW51bV9mbXRfdmlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gLUVJ
TlZBTDsKIH0KIAotc3RhdGljIGludCB1bmljYW1fZ19mbXRfdmlkKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB1bmljYW1fZ19mbXRfdmlkKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdW5pY2FtX25vZGUgKm5vZGUgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtMTkwNSw3ICsxOTA4LDggQEAgc3RhdGljIHZvaWQgX191bmlj
YW1fdHJ5X2ZtdF92aWQoc3RydWN0IHVuaWNhbV9ub2RlICpub2RlLAogCQlwaXgtPmZpZWxkID0g
VjRMMl9GSUVMRF9OT05FOwogfQogCi1zdGF0aWMgaW50IHVuaWNhbV90cnlfZm10X3ZpZChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdW5pY2FtX3RyeV9mbXRfdmlk
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHVuaWNh
bV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE5MTQsNyArMTkxOCw4IEBA
IHN0YXRpYyBpbnQgdW5pY2FtX3RyeV9mbXRfdmlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHVuaWNhbV9zX2ZtdF92aWQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHVuaWNhbV9zX2ZtdF92aWQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB1bmljYW1fbm9kZSAq
bm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xOTI4LDcgKzE5MzMsOCBAQCBzdGF0aWMg
aW50IHVuaWNhbV9zX2ZtdF92aWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdW5pY2FtX2VudW1fZm10X21ldGEoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHVuaWNhbV9lbnVtX2ZtdF9tZXRhKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJdW5zaWduZWQgaW50IGksIGluZGV4OwpAQCAt
MTk1MCw3ICsxOTU2LDggQEAgc3RhdGljIGludCB1bmljYW1fZW51bV9mbXRfbWV0YShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gLUVJTlZBTDsKIH0KIAotc3RhdGljIGlu
dCB1bmljYW1fZ19mbXRfbWV0YShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdW5pY2FtX2dfZm10X21ldGEoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCiB7CiAJc3RydWN0IHVuaWNhbV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTE5ODEsNyArMTk4OCw4IEBAIF9fdW5pY2FtX3RyeV9mbXRfbWV0YShzdHJ1Y3QgdW5pY2Ft
X25vZGUgKm5vZGUsIHN0cnVjdCB2NGwyX21ldGFfZm9ybWF0ICptZXRhKQogCXJldHVybiBmbXRp
bmZvOwogfQogCi1zdGF0aWMgaW50IHVuaWNhbV90cnlfZm10X21ldGEoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHVuaWNhbV90cnlfZm10X21ldGEoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB1bmljYW1fbm9kZSAq
bm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xOTkwLDcgKzE5OTgsOCBAQCBzdGF0aWMg
aW50IHVuaWNhbV90cnlfZm10X21ldGEoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdW5pY2FtX3NfZm10X21ldGEoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHVuaWNhbV9zX2ZtdF9tZXRhKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB1bmljYW1fbm9kZSAqbm9k
ZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yMDA0LDcgKzIwMTMsOCBAQCBzdGF0aWMgaW50
IHVuaWNhbV9zX2ZtdF9tZXRhKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHVuaWNhbV9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB1bmljYW1fZW51bV9mcmFtZXNpemVzKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IHVuaWNhbV9u
b2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTIwNDIsNyArMjA1Miw4IEBAIHN0
YXRpYyBpbnQgdW5pY2FtX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdW5pY2FtX2xvZ19zdGF0dXMoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoKQorc3RhdGljIGludCB1bmljYW1fbG9nX3N0YXR1cyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUp
CiB7CiAJc3RydWN0IHVuaWNhbV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlz
dHJ1Y3QgdW5pY2FtX2RldmljZSAqdW5pY2FtID0gbm9kZS0+ZGV2OwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9tZWRpYS9wbGF0Zm9ybS9jaGlwcy1tZWRpYS9jb2RhL2NvZGEtY29tbW9uLmMgYi9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL2NoaXBzLW1lZGlhL2NvZGEvY29kYS1jb21tb24uYwppbmRleCA5
YTU3YjA0MmQ5ZmQwMWFiZDA2NmNhNzgwZjc3Mjc5NjAzMGVjNDczLi4zMDg4ZWZiZjRmZGU2MGM0
ZWYwM2U5MWUyMWNlODU2NTM2ZmQyNTM1IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRm
b3JtL2NoaXBzLW1lZGlhL2NvZGEvY29kYS1jb21tb24uYworKysgYi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL2NoaXBzLW1lZGlhL2NvZGEvY29kYS1jb21tb24uYwpAQCAtNDI0LDcgKzQyNCw4IEBA
IHN0YXRpYyBzdHJ1Y3QgdmRvYV9kYXRhICpjb2RhX2dldF92ZG9hX2RhdGEodm9pZCkKIC8qCiAg
KiBWNEwyIGlvY3RsKCkgb3BlcmF0aW9ucy4KICAqLwotc3RhdGljIGludCBjb2RhX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjb2RhX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgY29kYV9jdHgg
KmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNDQyLDcgKzQ0Myw4IEBAIHN0YXRpYyBjb25z
dCB1MzIgY29kYV9mb3JtYXRzXzQyMFtDT0RBX01BWF9GT1JNQVRTXSA9IHsKIAkJVjRMMl9QSVhf
Rk1UX1lWVTQyMCwKIH07CiAKLXN0YXRpYyBpbnQgY29kYV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY29kYV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19k
ZXZkYXRhKGZpbGUpOwpAQCAtNDkzLDggKzQ5NSw4IEBAIHN0YXRpYyBpbnQgY29kYV9lbnVtX2Zt
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBjb2RhX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkgICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IGNvZGFfZ19mbXQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGNvZGFfcV9kYXRhICpxX2RhdGE7CiAJc3RydWN0
IGNvZGFfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTY1NSw3ICs2NTcsOCBAQCBz
dGF0aWMgaW50IGNvZGFfdHJ5X2ZtdChzdHJ1Y3QgY29kYV9jdHggKmN0eCwgY29uc3Qgc3RydWN0
IGNvZGFfY29kZWMgKmNvZGVjLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNvZGFfdHJ5
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBj
b2RhX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IGNvZGFfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTc2MSw3ICs3NjQsOCBA
QCBzdGF0aWMgdm9pZCBjb2RhX3NldF9kZWZhdWx0X2NvbG9yc3BhY2Uoc3RydWN0IHY0bDJfcGl4
X2Zvcm1hdCAqZm10KQogCWZtdC0+cXVhbnRpemF0aW9uID0gVjRMMl9RVUFOVElaQVRJT05fREVG
QVVMVDsKIH0KIAotc3RhdGljIGludCBjb2RhX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY29kYV90cnlfZm10X3ZpZF9vdXQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjb2RhX2N0eCAqY3R4ID0gZmlsZV90
b19jdHgoZmlsZSk7CkBAIC04NTUsNyArODU5LDggQEAgc3RhdGljIGludCBjb2RhX3NfZm10KHN0
cnVjdCBjb2RhX2N0eCAqY3R4LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgY29kYV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCBjb2RhX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY29kYV9jdHggKmN0eCA9IGZpbGVfdG9f
Y3R4KGZpbGUpOwpAQCAtODc0LDcgKzg3OSw3IEBAIHN0YXRpYyBpbnQgY29kYV9zX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCQl2c2NhbGUgPSBjb2RhX2pwZWdf
c2NhbGUocV9kYXRhX3NyYy0+aGVpZ2h0LCBmLT5mbXQucGl4LmhlaWdodCk7CiAJfQogCi0JcmV0
ID0gY29kYV90cnlfZm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwgZik7CisJcmV0ID0gY29kYV90cnlf
Zm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAK
QEAgLTkwNyw3ICs5MTIsOCBAQCBzdGF0aWMgaW50IGNvZGFfc19mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjb2Rh
X3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IGNvZGFfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCBjb2RhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC05MTYs
NyArOTIyLDcgQEAgc3RhdGljIGludCBjb2RhX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCiAJc3RydWN0IHZiMl9xdWV1ZSAqZHN0X3ZxOwogCWludCByZXQ7CiAK
LQlyZXQgPSBjb2RhX3RyeV9mbXRfdmlkX291dChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSBjb2Rh
X3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJl
dDsKIApAQCAtOTU2LDE0ICs5NjIsMTUgQEAgc3RhdGljIGludCBjb2RhX3NfZm10X3ZpZF9vdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAKIAltZW1zZXQoJmZfY2FwLCAwLCBzaXpl
b2YoZl9jYXApKTsKIAlmX2NhcC50eXBlID0gVjRMMl9CVUZfVFlQRV9WSURFT19DQVBUVVJFOwot
CWNvZGFfZ19mbXQoZmlsZSwgcHJpdiwgJmZfY2FwKTsKKwljb2RhX2dfZm10KGZpbGUsIHN0YXRl
LCAmZl9jYXApOwogCWZfY2FwLmZtdC5waXgud2lkdGggPSBmLT5mbXQucGl4LndpZHRoOwogCWZf
Y2FwLmZtdC5waXguaGVpZ2h0ID0gZi0+Zm10LnBpeC5oZWlnaHQ7CiAKLQlyZXR1cm4gY29kYV9z
X2ZtdF92aWRfY2FwKGZpbGUsIHByaXYsICZmX2NhcCk7CisJcmV0dXJuIGNvZGFfc19mbXRfdmlk
X2NhcChmaWxlLCBzdGF0ZSwgJmZfY2FwKTsKIH0KIAotc3RhdGljIGludCBjb2RhX3JlcWJ1ZnMo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGNvZGFfcmVxYnVmcyhz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJc3RydWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKnJiKQogewogCXN0cnVjdCBjb2RhX2N0eCAq
Y3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC05ODMsNyArOTkwLDggQEAgc3RhdGljIGludCBj
b2RhX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgY29kYV9xYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCBjb2RhX3FidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCSAgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCSAgICAgc3RydWN0IHY0bDJfYnVmZmVyICpidWYp
CiB7CiAJc3RydWN0IGNvZGFfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTk5NSw3
ICsxMDAzLDggQEAgc3RhdGljIGludCBjb2RhX3FidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIHY0bDJfbTJtX3FidWYoZmlsZSwgY3R4LT5maC5tMm1fY3R4LCBidWYp
OwogfQogCi1zdGF0aWMgaW50IGNvZGFfZHFidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQorc3RhdGljIGludCBjb2RhX2RxYnVmKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAg
c3RydWN0IHY0bDJfYnVmZmVyICpidWYpCiB7CiAJc3RydWN0IGNvZGFfY3R4ICpjdHggPSBmaWxl
X3RvX2N0eChmaWxlKTsKIAlpbnQgcmV0OwpAQCAtMTAyMiw3ICsxMDMxLDggQEAgdm9pZCBjb2Rh
X20ybV9idWZfZG9uZShzdHJ1Y3QgY29kYV9jdHggKmN0eCwgc3RydWN0IHZiMl92NGwyX2J1ZmZl
ciAqYnVmLAogCXY0bDJfbTJtX2J1Zl9kb25lKGJ1Ziwgc3RhdGUpOwogfQogCi1zdGF0aWMgaW50
IGNvZGFfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGlu
dCBjb2RhX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykK
IHsKIAlzdHJ1Y3QgY29kYV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtMTA2OCw3
ICsxMDc4LDggQEAgc3RhdGljIGludCBjb2RhX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjb2RhX3Nfc2VsZWN0aW9u
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY29kYV9zX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IGNvZGFf
Y3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTExMDUsNyArMTExNiw3IEBAIHN0YXRp
YyBpbnQgY29kYV9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJCWZh
bGx0aHJvdWdoOwogCWNhc2UgVjRMMl9TRUxfVEdUX05BVElWRV9TSVpFOgogCWNhc2UgVjRMMl9T
RUxfVEdUX0NPTVBPU0U6Ci0JCXJldHVybiBjb2RhX2dfc2VsZWN0aW9uKGZpbGUsIGZoLCBzKTsK
KwkJcmV0dXJuIGNvZGFfZ19zZWxlY3Rpb24oZmlsZSwgc3RhdGUsIHMpOwogCWRlZmF1bHQ6CiAJ
CS8qIHY0bDItY29tcGxpYW5jZSBleHBlY3RzIHRoaXMgdG8gZmFpbCBmb3IgcmVhZC1vbmx5IHRh
cmdldHMgKi8KIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC0xMTIzLDE0ICsxMTM0LDE1IEBAIHN0YXRp
YyB2b2lkIGNvZGFfd2FrZV91cF9jYXB0dXJlX3F1ZXVlKHN0cnVjdCBjb2RhX2N0eCAqY3R4KQog
CXdha2VfdXAoJmRzdF92cS0+ZG9uZV93cSk7CiB9CiAKLXN0YXRpYyBpbnQgY29kYV9lbmNvZGVy
X2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNvZGFfZW5jb2Rl
cl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmVjKQogewogCXN0cnVj
dCBjb2RhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAJc3RydWN0IHZiMl92NGwyX2J1
ZmZlciAqYnVmOwogCWludCByZXQ7CiAKLQlyZXQgPSB2NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rl
cl9jbWQoZmlsZSwgZmgsIGVjKTsKKwlyZXQgPSB2NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rlcl9j
bWQoZmlsZSwgc3RhdGUsIGVjKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAt
MTIwNCw3ICsxMjE2LDggQEAgc3RhdGljIGJvb2wgY29kYV9tYXJrX2xhc3RfZHN0X2J1ZihzdHJ1
Y3QgY29kYV9jdHggKmN0eCkKIAlyZXR1cm4gdHJ1ZTsKIH0KIAotc3RhdGljIGludCBjb2RhX2Rl
Y29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY29kYV9k
ZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9kZWNvZGVyX2NtZCAqZGMpCiB7CiAJ
c3RydWN0IGNvZGFfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTEyMTUsNyArMTIy
OCw3IEBAIHN0YXRpYyBpbnQgY29kYV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCiAJYm9vbCB3YWtldXA7CiAJaW50IHJldDsKIAotCXJldCA9IHY0bDJfbTJtX2lvY3Rs
X3RyeV9kZWNvZGVyX2NtZChmaWxlLCBmaCwgZGMpOworCXJldCA9IHY0bDJfbTJtX2lvY3RsX3Ry
eV9kZWNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgZGMpOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4g
cmV0OwogCkBAIC0xMjgzLDcgKzEyOTYsOCBAQCBzdGF0aWMgaW50IGNvZGFfZGVjb2Rlcl9jbWQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGNvZGFfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRp
YyBpbnQgY29kYV9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0g
KmZzaXplKQogewogCXN0cnVjdCBjb2RhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBA
IC0xMzE2LDcgKzEzMzAsOCBAQCBzdGF0aWMgaW50IGNvZGFfZW51bV9mcmFtZXNpemVzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjb2Rh
X2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGlj
IGludCBjb2RhX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9m
cm1pdmFsZW51bSAqZikKIHsKIAlzdHJ1Y3QgY29kYV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZp
bGUpOwpAQCAtMTM1Niw3ICsxMzcxLDggQEAgc3RhdGljIGludCBjb2RhX2VudW1fZnJhbWVpbnRl
cnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IGNvZGFfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0
bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgY29kYV9nX3Bhcm0oc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0
bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlzdHJ1Y3QgY29kYV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4
KGZpbGUpOwogCXN0cnVjdCB2NGwyX2ZyYWN0ICp0cGY7CkBAIC0xNDM5LDcgKzE0NTUsOCBAQCBz
dGF0aWMgdWludDMyX3QgY29kYV90aW1lcGVyZnJhbWVfdG9fZnJhdGUoc3RydWN0IHY0bDJfZnJh
Y3QgKnRpbWVwZXJmcmFtZSkKIAkJdGltZXBlcmZyYW1lLT5kZW5vbWluYXRvcjsKIH0KIAotc3Rh
dGljIGludCBjb2RhX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX3N0cmVhbXBhcm0gKmEpCitzdGF0aWMgaW50IGNvZGFfc19wYXJtKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIHN0cnVjdCB2
NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IGNvZGFfY3R4ICpjdHggPSBmaWxlX3RvX2N0
eChmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9mcmFjdCAqdHBmOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS9jaGlwcy1tZWRpYS93YXZlNS93YXZlNS1oZWxwZXIuYyBiL2RyaXZlcnMv
bWVkaWEvcGxhdGZvcm0vY2hpcHMtbWVkaWEvd2F2ZTUvd2F2ZTUtaGVscGVyLmMKaW5kZXggZjAz
YWQ5YzBkZTIyMTU3OTRiMjQ1NmMzOTY1Mjc4NWZmZjIzNjk2Ni4uOTkxNmIyMjc3OTI2YTFhODE1
ZDVkYmY3ZDY0NTllOTgyMTI5MDRjMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9y
bS9jaGlwcy1tZWRpYS93YXZlNS93YXZlNS1oZWxwZXIuYworKysgYi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LWhlbHBlci5jCkBAIC0xNDAsNyArMTQwLDcg
QEAgaW50IHdhdmU1X3ZwdV9zdWJzY3JpYmVfZXZlbnQoc3RydWN0IHY0bDJfZmggKmZoLCBjb25z
dCBzdHJ1Y3QgdjRsMl9ldmVudF9zdWJzY3IKIAl9CiB9CiAKLWludCB3YXZlNV92cHVfZ19mbXRf
b3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQor
aW50IHdhdmU1X3ZwdV9nX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZw
dV9pbnN0YW5jZSAqaW5zdCA9IGZpbGVfdG9fdnB1X2luc3QoZmlsZSk7CiAJaW50IGk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LWhl
bHBlci5oIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9jaGlwcy1tZWRpYS93YXZlNS93YXZlNS1o
ZWxwZXIuaAppbmRleCA5NzZhNDAyZTQyNmZmMzI5NDkwNzE3OTI1YTA4YTc2ZDc3N2NiZTNlLi4w
YmIyNzEzNzc4MWFkY2M4OTg3YzU0MTk2ZDE2ODgzYjgxMmNkZjVlIDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LWhlbHBlci5oCisrKyBi
L2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vY2hpcHMtbWVkaWEvd2F2ZTUvd2F2ZTUtaGVscGVyLmgK
QEAgLTIxLDcgKzIxLDggQEAgaW50IHdhdmU1X3ZwdV9yZWxlYXNlX2RldmljZShzdHJ1Y3QgZmls
ZSAqZmlscCwKIGludCB3YXZlNV92cHVfcXVldWVfaW5pdCh2b2lkICpwcml2LCBzdHJ1Y3QgdmIy
X3F1ZXVlICpzcmNfdnEsIHN0cnVjdCB2YjJfcXVldWUgKmRzdF92cSwKIAkJCSBjb25zdCBzdHJ1
Y3QgdmIyX29wcyAqb3BzKTsKIGludCB3YXZlNV92cHVfc3Vic2NyaWJlX2V2ZW50KHN0cnVjdCB2
NGwyX2ZoICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfZXZlbnRfc3Vic2NyaXB0aW9uICpzdWIpOwot
aW50IHdhdmU1X3ZwdV9nX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IHdhdmU1X3ZwdV9nX2ZtdF9vdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKTsKIGNvbnN0IHN0cnVjdCB2cHVfZm9ybWF0ICp3YXZlNV9maW5kX3ZwdV9mbXQo
dW5zaWduZWQgaW50IHY0bDJfcGl4X2ZtdCwKIAkJCQkJICAgIGNvbnN0IHN0cnVjdCB2cHVfZm9y
bWF0IGZtdF9saXN0W01BWF9GTVRTXSk7CiBjb25zdCBzdHJ1Y3QgdnB1X2Zvcm1hdCAqd2F2ZTVf
ZmluZF92cHVfZm10X2J5X2lkeCh1bnNpZ25lZCBpbnQgaWR4LApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9tZWRpYS9wbGF0Zm9ybS9jaGlwcy1tZWRpYS93YXZlNS93YXZlNS12cHUtZGVjLmMgYi9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LXZwdS1kZWMuYwppbmRl
eCA3MmFmMGZhYTNlZjJlNmZiODM3NDkwNDRlYjkxYTU4ZjM5YTNhOTg2Li43ZjBhOGMwZTEzNzAx
Yjg5OTYzYjg1NmU2ZDNlMzM0NDJlMGU3OTM4IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LXZwdS1kZWMuYworKysgYi9kcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LXZwdS1kZWMuYwpAQCAtNDU3LDcg
KzQ1Nyw5IEBAIHN0YXRpYyB2b2lkIHdhdmU1X3ZwdV9kZWNfZmluaXNoX2RlY29kZShzdHJ1Y3Qg
dnB1X2luc3RhbmNlICppbnN0KQogCX0KIH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZGVjX3F1
ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0
eSAqY2FwKQorc3RhdGljIGludCB3YXZlNV92cHVfZGVjX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICBzdHJ1
Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgVlBVX0RF
Q19EUlZfTkFNRSwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7CiAJc3Ryc2NweShjYXAtPmNhcmQsIFZQ
VV9ERUNfRFJWX05BTUUsIHNpemVvZihjYXAtPmNhcmQpKTsKQEAgLTQ2NSw3ICs0NjcsOSBAQCBz
dGF0aWMgaW50IHdhdmU1X3ZwdV9kZWNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYgogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHdhdmU1
X3ZwdV9kZWNfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQorc3RhdGljIGludCB3YXZlNV92cHVfZGVjX2VudW1f
ZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZiwKKwkJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJCQkgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCWNv
bnN0IHN0cnVjdCB2cHVfZm9ybWF0ICp2cHVfZm10OwogCkBAIC00OTAsNyArNDk0LDkgQEAgc3Rh
dGljIGludCB3YXZlNV92cHVfZGVjX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZiwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX2YKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB3YXZlNV92
cHVfZGVjX2VudW1fZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IHdhdmU1X3ZwdV9kZWNfZW51bV9mbXRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJCSAgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJY29uc3Qgc3RydWN0
IHZwdV9mb3JtYXQgKnZwdV9mbXQ7CiAKQEAgLTUwNCw3ICs1MTAsOSBAQCBzdGF0aWMgaW50IHdh
dmU1X3ZwdV9kZWNfZW51bV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3Ry
dWN0IHY0bDJfZgogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHdhdmU1X3ZwdV9kZWNfdHJ5
X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCitzdGF0aWMgaW50IHdhdmU1X3ZwdV9kZWNfdHJ5X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAg
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdnB1X2luc3RhbmNlICppbnN0ID0g
ZmlsZV90b192cHVfaW5zdChmaWxlKTsKIAlzdHJ1Y3QgZGVjX2luZm8gKnBfZGVjX2luZm8gPSAm
aW5zdC0+Y29kZWNfaW5mby0+ZGVjX2luZm87CkBAIC01NDUsNyArNTUzLDkgQEAgc3RhdGljIGlu
dCB3YXZlNV92cHVfZGVjX3RyeV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
c3RydWN0IHY0bDJfZm8KIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZGVj
X3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKK3N0YXRpYyBpbnQgd2F2ZTVfdnB1X2RlY19zX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxl
X3RvX3ZwdV9pbnN0KGZpbGUpOwogCWludCBpLCByZXQ7CkBAIC01NTUsNyArNTY1LDcgQEAgc3Rh
dGljIGludCB3YXZlNV92cHVfZGVjX3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHN0cnVjdCB2NGwyX2Zvcm0KIAkJX19mdW5jX18sIGYtPmZtdC5waXhfbXAucGl4ZWxmb3Jt
YXQsIGYtPmZtdC5waXhfbXAud2lkdGgsIGYtPmZtdC5waXhfbXAuaGVpZ2h0LAogCQlmLT5mbXQu
cGl4X21wLm51bV9wbGFuZXMsIGYtPmZtdC5waXhfbXAuY29sb3JzcGFjZSwgZi0+Zm10LnBpeF9t
cC5maWVsZCk7CiAKLQlyZXQgPSB3YXZlNV92cHVfZGVjX3RyeV9mbXRfY2FwKGZpbGUsIGZoLCBm
KTsKKwlyZXQgPSB3YXZlNV92cHVfZGVjX3RyeV9mbXRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlp
ZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC02MDQsNyArNjE0LDkgQEAgc3RhdGljIGludCB3
YXZlNV92cHVfZGVjX3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2Zvcm0KIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZGVjX2df
Zm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKK3N0YXRpYyBpbnQgd2F2ZTVfdnB1X2RlY19nX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3Rv
X3ZwdV9pbnN0KGZpbGUpOwogCWludCBpOwpAQCAtNjI4LDcgKzY0MCw5IEBAIHN0YXRpYyBpbnQg
d2F2ZTVfdnB1X2RlY19nX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9mb3JtCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgd2F2ZTVfdnB1X2RlY19l
bnVtX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbXRk
ZXNjICpmKQorc3RhdGljIGludCB3YXZlNV92cHVfZGVjX2VudW1fZm10X291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CQkgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2Ug
Kmluc3QgPSBmaWxlX3RvX3ZwdV9pbnN0KGZpbGUpOwogCWNvbnN0IHN0cnVjdCB2cHVfZm9ybWF0
ICp2cHVfZm10OwpAQCAtNjQ1LDcgKzY1OSw5IEBAIHN0YXRpYyBpbnQgd2F2ZTVfdnB1X2RlY19l
bnVtX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgd2F2ZTVfdnB1X2RlY190cnlfZm10X291dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBp
bnQgd2F2ZTVfdnB1X2RlY190cnlfZm10X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3RvX3ZwdV9p
bnN0KGZpbGUpOwogCWNvbnN0IHN0cnVjdCB2NGwyX2ZybXNpemVfc3RlcHdpc2UgKmZybXNpemU7
CkBAIC02NzYsNyArNjkyLDkgQEAgc3RhdGljIGludCB3YXZlNV92cHVfZGVjX3RyeV9mbXRfb3V0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm8KIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZGVjX3NfZm10X291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgd2F2ZTVfdnB1
X2RlY19zX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0
cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3RvX3ZwdV9pbnN0KGZpbGUpOwogCWNvbnN0
IHN0cnVjdCB2cHVfZm9ybWF0ICp2cHVfZm10OwpAQCAtNjg3LDcgKzcwNSw3IEBAIHN0YXRpYyBp
bnQgd2F2ZTVfdnB1X2RlY19zX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9mb3JtCiAJCV9fZnVuY19fLCBmLT5mbXQucGl4X21wLnBpeGVsZm9ybWF0LCBm
LT5mbXQucGl4X21wLndpZHRoLCBmLT5mbXQucGl4X21wLmhlaWdodCwKIAkJZi0+Zm10LnBpeF9t
cC5udW1fcGxhbmVzLCBmLT5mbXQucGl4X21wLmZpZWxkKTsKIAotCXJldCA9IHdhdmU1X3ZwdV9k
ZWNfdHJ5X2ZtdF9vdXQoZmlsZSwgZmgsIGYpOworCXJldCA9IHdhdmU1X3ZwdV9kZWNfdHJ5X2Zt
dF9vdXQoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTcy
NSw3ICs3NDMsOSBAQCBzdGF0aWMgaW50IHdhdmU1X3ZwdV9kZWNfc19mbXRfb3V0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybQogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHdhdmU1X3ZwdV9kZWNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCitzdGF0aWMgaW50IHdhdmU1X3ZwdV9k
ZWNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykK
IHsKIAlzdHJ1Y3QgdnB1X2luc3RhbmNlICppbnN0ID0gZmlsZV90b192cHVfaW5zdChmaWxlKTsK
IApAQCAtNzU5LDcgKzc3OSw5IEBAIHN0YXRpYyBpbnQgd2F2ZTVfdnB1X2RlY19nX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgd2F2ZTVfdnB1X2RlY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK3N0YXRpYyBpbnQgd2F2
ZTVfdnB1X2RlY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJfc2VsZWN0
aW9uICpzKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3RvX3ZwdV9pbnN0
KGZpbGUpOwogCkBAIC04NzAsNyArODkyLDkgQEAgc3RhdGljIGludCB3YXZlNV92cHVfZGVjX3N0
YXJ0KHN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QpCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGlj
IGludCB3YXZlNV92cHVfZGVjX2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfZGVjb2Rlcl9jbWQgKmRjKQorc3RhdGljIGludCB3YXZlNV92cHVfZGVj
X2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgICBzdHJ1Y3QgdjRsMl9kZWNvZGVyX2NtZCAqZGMp
CiB7CiAJc3RydWN0IHZwdV9pbnN0YW5jZSAqaW5zdCA9IGZpbGVfdG9fdnB1X2luc3QoZmlsZSk7
CiAJc3RydWN0IHY0bDJfbTJtX2N0eCAqbTJtX2N0eCA9IGluc3QtPnY0bDJfZmgubTJtX2N0eDsK
QEAgLTg3OCw3ICs5MDIsNyBAQCBzdGF0aWMgaW50IHdhdmU1X3ZwdV9kZWNfZGVjb2Rlcl9jbWQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9kZQogCiAJZGV2X2RiZyhp
bnN0LT5kZXYtPmRldiwgImRlY29kZXIgY29tbWFuZDogJXVcbiIsIGRjLT5jbWQpOwogCi0JcmV0
ID0gdjRsMl9tMm1faW9jdGxfdHJ5X2RlY29kZXJfY21kKGZpbGUsIGZoLCBkYyk7CisJcmV0ID0g
djRsMl9tMm1faW9jdGxfdHJ5X2RlY29kZXJfY21kKGZpbGUsIHN0YXRlLCBkYyk7CiAJaWYgKHJl
dCkKIAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9j
aGlwcy1tZWRpYS93YXZlNS93YXZlNS12cHUtZW5jLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L2NoaXBzLW1lZGlhL3dhdmU1L3dhdmU1LXZwdS1lbmMuYwppbmRleCA1MDZkNmM2MTY2YTZiMGZk
OTE1MTIxOGNmMmMzMDhhY2VmNDM2MzA0Li4zZDdjMGRkMWIxYzM0Yzk0ZmYyMjYzYWUwZTQxMTVk
MmVlYjgyYjQ4IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2NoaXBzLW1lZGlh
L3dhdmU1L3dhdmU1LXZwdS1lbmMuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2NoaXBz
LW1lZGlhL3dhdmU1L3dhdmU1LXZwdS1lbmMuYwpAQCAtMzMwLDcgKzMzMCw5IEBAIHN0YXRpYyB2
b2lkIHdhdmU1X3ZwdV9lbmNfZmluaXNoX2VuY29kZShzdHJ1Y3QgdnB1X2luc3RhbmNlICppbnN0
KQogCX0KIH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZW5jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQorc3RhdGljIGlu
dCB3YXZlNV92cHVfZW5jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5
ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgVlBVX0VOQ19EUlZfTkFNRSwgc2l6ZW9m
KGNhcC0+ZHJpdmVyKSk7CiAJc3Ryc2NweShjYXAtPmNhcmQsIFZQVV9FTkNfRFJWX05BTUUsIHNp
emVvZihjYXAtPmNhcmQpKTsKQEAgLTMzOCw3ICszNDAsOSBAQCBzdGF0aWMgaW50IHdhdmU1X3Zw
dV9lbmNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9j
YXBhYgogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfZW51bV9mcmFt
ZXNpemVzKHN0cnVjdCBmaWxlICpmLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0g
KmZzaXplKQorc3RhdGljIGludCB3YXZlNV92cHVfZW5jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZiwKKwkJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCQkg
c3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCWNvbnN0IHN0cnVjdCB2cHVfZm9y
bWF0ICp2cHVfZm10OwogCkBAIC0zNTgsNyArMzYyLDkgQEAgc3RhdGljIGludCB3YXZlNV92cHVf
ZW5jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZiwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2YKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZW5jX2VudW1fZm10X2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitz
dGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfZW51bV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgIHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHZwdV9pbnN0YW5jZSAqaW5zdCA9IGZp
bGVfdG9fdnB1X2luc3QoZmlsZSk7CiAJY29uc3Qgc3RydWN0IHZwdV9mb3JtYXQgKnZwdV9mbXQ7
CkBAIC0zNzUsNyArMzgxLDkgQEAgc3RhdGljIGludCB3YXZlNV92cHVfZW5jX2VudW1fZm10X2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2YKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZW5jX3RyeV9mbXRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB3YXZlNV92
cHVfZW5jX3RyeV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IHZwdV9pbnN0YW5jZSAqaW5zdCA9IGZpbGVfdG9fdnB1X2luc3QoZmlsZSk7
CiAJY29uc3Qgc3RydWN0IHY0bDJfZnJtc2l6ZV9zdGVwd2lzZSAqZnJtc2l6ZTsKQEAgLTQwOSw3
ICs0MTcsOSBAQCBzdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfdHJ5X2ZtdF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbwogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IHdhdmU1X3ZwdV9lbmNfc19mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB3YXZlNV92cHVfZW5jX3NfZm10
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZwdV9p
bnN0YW5jZSAqaW5zdCA9IGZpbGVfdG9fdnB1X2luc3QoZmlsZSk7CiAJaW50IGksIHJldDsKQEAg
LTQxOCw3ICs0MjgsNyBAQCBzdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfc19mbXRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybQogCQlfX2Z1bmNfXywgZi0+
Zm10LnBpeF9tcC5waXhlbGZvcm1hdCwgZi0+Zm10LnBpeF9tcC53aWR0aCwgZi0+Zm10LnBpeF9t
cC5oZWlnaHQsCiAJCWYtPmZtdC5waXhfbXAubnVtX3BsYW5lcywgZi0+Zm10LnBpeF9tcC5maWVs
ZCk7CiAKLQlyZXQgPSB3YXZlNV92cHVfZW5jX3RyeV9mbXRfY2FwKGZpbGUsIGZoLCBmKTsKKwly
ZXQgPSB3YXZlNV92cHVfZW5jX3RyeV9mbXRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0
KQogCQlyZXR1cm4gcmV0OwogCkBAIC00NDMsNyArNDUzLDkgQEAgc3RhdGljIGludCB3YXZlNV92
cHVfZW5jX3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2Zvcm0KIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB3YXZlNV92cHVfZW5jX2dfZm10X2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0
YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY19nX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3RvX3ZwdV9p
bnN0KGZpbGUpOwogCWludCBpOwpAQCAtNDY3LDcgKzQ3OSw5IEBAIHN0YXRpYyBpbnQgd2F2ZTVf
dnB1X2VuY19nX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRs
Ml9mb3JtCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY19lbnVtX2Zt
dF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpm
KQorc3RhdGljIGludCB3YXZlNV92cHVfZW5jX2VudW1fZm10X291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAg
ICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3Qg
PSBmaWxlX3RvX3ZwdV9pbnN0KGZpbGUpOwogCWNvbnN0IHN0cnVjdCB2cHVfZm9ybWF0ICp2cHVf
Zm10OwpAQCAtNDg0LDcgKzQ5OCw5IEBAIHN0YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY19lbnVtX2Zt
dF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY190cnlfZm10X291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgd2F2
ZTVfdnB1X2VuY190cnlfZm10X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3RvX3ZwdV9pbnN0KGZp
bGUpOwogCWNvbnN0IHN0cnVjdCB2NGwyX2ZybXNpemVfc3RlcHdpc2UgKmZybXNpemU7CkBAIC01
MTMsNyArNTI5LDkgQEAgc3RhdGljIGludCB3YXZlNV92cHVfZW5jX3RyeV9mbXRfb3V0KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm8KIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB3YXZlNV92cHVfZW5jX3NfZm10X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY19z
X2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2
cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3RvX3ZwdV9pbnN0KGZpbGUpOwogCWNvbnN0IHN0cnVj
dCB2cHVfZm9ybWF0ICp2cHVfZm10OwpAQCAtNTI0LDcgKzU0Miw3IEBAIHN0YXRpYyBpbnQgd2F2
ZTVfdnB1X2VuY19zX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9mb3JtCiAJCV9fZnVuY19fLCBmLT5mbXQucGl4X21wLnBpeGVsZm9ybWF0LCBmLT5mbXQu
cGl4X21wLndpZHRoLCBmLT5mbXQucGl4X21wLmhlaWdodCwKIAkJZi0+Zm10LnBpeF9tcC5udW1f
cGxhbmVzLCBmLT5mbXQucGl4X21wLmZpZWxkKTsKIAotCXJldCA9IHdhdmU1X3ZwdV9lbmNfdHJ5
X2ZtdF9vdXQoZmlsZSwgZmgsIGYpOworCXJldCA9IHdhdmU1X3ZwdV9lbmNfdHJ5X2ZtdF9vdXQo
ZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTU3NCw3ICs1
OTIsOSBAQCBzdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfc19mbXRfb3V0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybQogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHdhdmU1X3ZwdV9lbmNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCitzdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfZ19z
ZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlz
dHJ1Y3QgdnB1X2luc3RhbmNlICppbnN0ID0gZmlsZV90b192cHVfaW5zdChmaWxlKTsKIApAQCAt
NjAzLDcgKzYyMyw5IEBAIHN0YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY19nX3NlbGVjdGlvbihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK3N0YXRpYyBpbnQgd2F2ZTVfdnB1
X2VuY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpz
KQogewogCXN0cnVjdCB2cHVfaW5zdGFuY2UgKmluc3QgPSBmaWxlX3RvX3ZwdV9pbnN0KGZpbGUp
OwogCkBAIC02MjYsMTMgKzY0OCwxNSBAQCBzdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfc19zZWxl
Y3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZQogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfZW5jb2Rlcl9jbWQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9lbmNvZGVyX2NtZCAqZWMpCitzdGF0aWMg
aW50IHdhdmU1X3ZwdV9lbmNfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICAgIHN0cnVjdCB2NGwy
X2VuY29kZXJfY21kICplYykKIHsKIAlzdHJ1Y3QgdnB1X2luc3RhbmNlICppbnN0ID0gZmlsZV90
b192cHVfaW5zdChmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9tMm1fY3R4ICptMm1fY3R4ID0gaW5zdC0+
djRsMl9maC5tMm1fY3R4OwogCWludCByZXQ7CiAKLQlyZXQgPSB2NGwyX20ybV9pb2N0bF90cnlf
ZW5jb2Rlcl9jbWQoZmlsZSwgZmgsIGVjKTsKKwlyZXQgPSB2NGwyX20ybV9pb2N0bF90cnlfZW5j
b2Rlcl9jbWQoZmlsZSwgc3RhdGUsIGVjKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBA
IC02NTksNyArNjgzLDkgQEAgc3RhdGljIGludCB3YXZlNV92cHVfZW5jX2VuY29kZXJfY21kKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZW4KIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCB3YXZlNV92cHVfZW5jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCitzdGF0aWMgaW50IHdhdmU1X3ZwdV9l
bmNfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IHZw
dV9pbnN0YW5jZSAqaW5zdCA9IGZpbGVfdG9fdnB1X2luc3QoZmlsZSk7CiAKQEAgLTY3OSw3ICs3
MDUsOSBAQCBzdGF0aWMgaW50IHdhdmU1X3ZwdV9lbmNfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHdhdmU1X3ZwdV9lbmNfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3Ry
dWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgd2F2ZTVfdnB1X2VuY19zX3Bhcm0o
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkJc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlzdHJ1Y3QgdnB1X2luc3RhbmNl
ICppbnN0ID0gZmlsZV90b192cHVfaW5zdChmaWxlKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS9pbWFnaW5hdGlvbi9lNTAxMC1qcGVnLWVuYy5jIGIvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9pbWFnaW5hdGlvbi9lNTAxMC1qcGVnLWVuYy5jCmluZGV4IGM0ZTAwOTdjYjhi
N2ZhMzEwYzJjNTUxOWQ3YWY0ZTZlM2IzNzg5MTUuLjg0MGRlYmJhNDAzMzRlNzk0NmExNzE1Njhm
NmYyYmJmY2Y0NDhiODAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vaW1hZ2lu
YXRpb24vZTUwMTAtanBlZy1lbmMuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2ltYWdp
bmF0aW9uL2U1MDEwLWpwZWctZW5jLmMKQEAgLTIyOCw3ICsyMjgsOCBAQCBzdGF0aWMgaW50IGU1
MDEwX3NldF9pbnB1dF9zdWJzYW1wbGluZyh2b2lkIF9faW9tZW0gKmNvcmVfYmFzZSwgaW50IHN1
YnNhbXBsaW5nKQogCX07CiB9CiAKLXN0YXRpYyBpbnQgZTUwMTBfcXVlcnljYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKK3N0YXRp
YyBpbnQgZTUwMTBfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJ
c3Ryc2NweShjYXAtPmRyaXZlciwgRTUwMTBfTU9EVUxFX05BTUUsIHNpemVvZihjYXAtPmRyaXZl
cikpOwogCXN0cnNjcHkoY2FwLT5jYXJkLCBFNTAxMF9NT0RVTEVfTkFNRSwgc2l6ZW9mKGNhcC0+
Y2FyZCkpOwpAQCAtMjQ5LDcgKzI1MCw4IEBAIHN0YXRpYyBzdHJ1Y3QgZTUwMTBfZm10ICpmaW5k
X2Zvcm1hdChzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIE5VTEw7CiB9CiAKLXN0YXRp
YyBpbnQgZTUwMTBfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVj
dCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IGU1MDEwX2VudW1fZm10KHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0
bDJfZm10ZGVzYyAqZikKIHsKIAlpbnQgaSwgaW5kZXggPSAwOwogCXN0cnVjdCBlNTAxMF9mbXQg
KmZtdCA9IE5VTEw7CkBAIC0yNzcsNyArMjc5LDggQEAgc3RhdGljIGludCBlNTAxMF9lbnVtX2Zt
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBlNTAxMF9nX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBlNTAxMF9n
X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGU1MDEwX2NvbnRl
eHQgKmN0eCA9IHRvX2U1MDEwX2NvbnRleHQoZmlsZSk7CiAJc3RydWN0IGU1MDEwX3FfZGF0YSAq
cXVldWU7CkBAIC0zNzgsMTQgKzM4MSwxNiBAQCBzdGF0aWMgaW50IGU1MDEwX2pwZWdfdHJ5X2Zt
dChzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYsIHN0cnVjdCBlNTAxMF9jb250ZXh0ICpjdHgpCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZTUwMTBfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBlNTAxMF90cnlf
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGU1MDEwX2NvbnRleHQgKmN0
eCA9IHRvX2U1MDEwX2NvbnRleHQoZmlsZSk7CiAKIAlyZXR1cm4gZTUwMTBfanBlZ190cnlfZm10
KGYsIGN0eCk7CiB9CiAKLXN0YXRpYyBpbnQgZTUwMTBfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgZTUwMTBfc19m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBlNTAxMF9jb250ZXh0
ICpjdHggPSB0b19lNTAxMF9jb250ZXh0KGZpbGUpOwogCXN0cnVjdCB2YjJfcXVldWUgKnZxOwpA
QCAtNDM0LDcgKzQzOSw5IEBAIHN0YXRpYyBpbnQgZTUwMTBfc19mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBlNTAxMF9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKK3N0YXRpYyBpbnQgZTUwMTBf
ZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQog
ewogCXN0cnVjdCB2NGwyX2Zvcm1hdCBmOwogCXN0cnVjdCBlNTAxMF9mbXQgKmZtdDsKQEAgLTQ2
MCw3ICs0NjcsOSBAQCBzdGF0aWMgaW50IGU1MDEwX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJtcwogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGU1MDEwX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
c3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQorc3RhdGljIGludCBlNTAxMF9nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgZTUwMTBf
Y29udGV4dCAqY3R4ID0gdG9fZTUwMTBfY29udGV4dChmaWxlKTsKIAlzdHJ1Y3QgZTUwMTBfcV9k
YXRhICpxdWV1ZTsKQEAgLTQ4OCw3ICs0OTcsOSBAQCBzdGF0aWMgaW50IGU1MDEwX2dfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc2VsZWN0aW9uCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZTUwMTBfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCitzdGF0aWMgaW50IGU1
MDEwX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQog
ewogCXN0cnVjdCBlNTAxMF9jb250ZXh0ICpjdHggPSB0b19lNTAxMF9jb250ZXh0KGZpbGUpOwog
CXN0cnVjdCBlNTAxMF9xX2RhdGEgKnF1ZXVlOwpAQCAtMTI1OCw3ICsxMjY5LDggQEAgc3RhdGlj
IHZvaWQgZTUwMTBfYnVmX3F1ZXVlKHN0cnVjdCB2YjJfYnVmZmVyICp2YikKIAl2NGwyX20ybV9i
dWZfcXVldWUoY3R4LT5maC5tMm1fY3R4LCB2YnVmKTsKIH0KIAotc3RhdGljIGludCBlNTAxMF9l
bmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZTUw
MTBfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9lbmNvZGVyX2NtZCAqY21k
KQogewogCXN0cnVjdCBlNTAxMF9jb250ZXh0ICpjdHggPSB0b19lNTAxMF9jb250ZXh0KGZpbGUp
OwpAQCAtMTI2Nyw3ICsxMjc5LDcgQEAgc3RhdGljIGludCBlNTAxMF9lbmNvZGVyX2NtZChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAogCWNhcF92cSA9IHY0bDJfbTJtX2dldF92cShj
dHgtPmZoLm0ybV9jdHgsIFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRV9NUExBTkUpOwogCi0J
cmV0ID0gdjRsMl9tMm1faW9jdGxfdHJ5X2VuY29kZXJfY21kKGZpbGUsICZjdHgtPmZoLCBjbWQp
OworCXJldCA9IHY0bDJfbTJtX2lvY3RsX3RyeV9lbmNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgY21k
KTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTI3NSw3ICsxMjg3LDcgQEAg
c3RhdGljIGludCBlNTAxMF9lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAkgICAgIXZiMl9pc19zdHJlYW1pbmcodjRsMl9tMm1fZ2V0X2RzdF92cShjdHgtPmZoLm0y
bV9jdHgpKSkKIAkJcmV0dXJuIDA7CiAKLQlyZXQgPSB2NGwyX20ybV9pb2N0bF9lbmNvZGVyX2Nt
ZChmaWxlLCAmY3R4LT5maCwgY21kKTsKKwlyZXQgPSB2NGwyX20ybV9pb2N0bF9lbmNvZGVyX2Nt
ZChmaWxlLCBzdGF0ZSwgY21kKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9pbnRlbC9weGFfY2FtZXJhLmMgYi9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL2ludGVsL3B4YV9jYW1lcmEuYwppbmRleCBiZWYxZTcxMzdmMjNm
MDJlZjAwMDUwNThjNTlmYjcxMmJhNDY3Y2VhLi5hYTM5N2VjY2QzMWE3MzJkYTU0MzMwYmI3NjFm
MWFmMjE5Zjc1ZWQxIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2ludGVsL3B4
YV9jYW1lcmEuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL2ludGVsL3B4YV9jYW1lcmEu
YwpAQCAtMTcyNCw3ICsxNzI0LDggQEAgc3RhdGljIGludCBweGFfY2FtZXJhX2NoZWNrX2ZyYW1l
KHUzMiB3aWR0aCwgdTMyIGhlaWdodCkKIH0KIAogI2lmZGVmIENPTkZJR19WSURFT19BRFZfREVC
VUcKLXN0YXRpYyBpbnQgcHhhY192aWRpb2NfZ19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcHhhY192aWRpb2NfZ19yZWdpc3RlcihzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAg
c3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IHB4YV9jYW1lcmFfZGV2
ICpwY2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNzM3LDcgKzE3MzgsOCBAQCBzdGF0
aWMgaW50IHB4YWNfdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcHhhY192aWRpb2Nfc19yZWdpc3Rlcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcHhhY192aWRpb2Nfc19y
ZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCSAgY29uc3Qgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7
CiAJc3RydWN0IHB4YV9jYW1lcmFfZGV2ICpwY2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xNzUxLDcgKzE3NTMsOCBAQCBzdGF0aWMgaW50IHB4YWNfdmlkaW9jX3NfcmVnaXN0ZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAjZW5kaWYKIAotc3RhdGljIGludCBweGFj
X3ZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICAqcHJpdiwK
K3N0YXRpYyBpbnQgcHhhY192aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
cCwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHB4YV9jYW1lcmFfZGV2ICpwY2RldiA9IHZpZGVv
X2RydmRhdGEoZmlscCk7CkBAIC0xNzY3LDcgKzE3NzAsOCBAQCBzdGF0aWMgaW50IHB4YWNfdmlk
aW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB4YWNfdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHB4YWNfdmlkaW9jX2dfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBw
eGFfY2FtZXJhX2RldiAqcGNkZXYgPSB2aWRlb19kcnZkYXRhKGZpbHApOwpAQCAtMTc4NSw3ICsx
Nzg5LDggQEAgc3RhdGljIGludCBweGFjX3ZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxwLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB4YWNfdmlk
aW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgcHhhY192aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJ
CSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHB4YV9jYW1lcmFfZGV2ICpwY2RldiA9IHZp
ZGVvX2RydmRhdGEoZmlscCk7CkBAIC0xODUyLDcgKzE4NTcsOCBAQCBzdGF0aWMgaW50IHB4YWNf
dmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBweGFjX3ZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAorc3RhdGljIGludCBweGFjX3ZpZGlvY19zX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
cHhhX2NhbWVyYV9kZXYgKnBjZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKQEAgLTE4NzUsNyAr
MTg4MSw3IEBAIHN0YXRpYyBpbnQgcHhhY192aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlpZiAoaXNfYnVzeSkKIAkJcmV0dXJuIC1FQlVTWTsKIAot
CXJldCA9IHB4YWNfdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxwLCBwcml2LCBmKTsKKwlyZXQg
PSBweGFjX3ZpZGlvY190cnlfZm10X3ZpZF9jYXAoZmlscCwgc3RhdGUsIGYpOwogCWlmIChyZXQp
CiAJCXJldHVybiByZXQ7CiAKQEAgLTE5MDEsNyArMTkwNyw4IEBAIHN0YXRpYyBpbnQgcHhhY192
aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHB4YWNfdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBweGFjX3ZpZGlvY19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmJ1c19pbmZv
LCAicGxhdGZvcm06cHhhLWNhbWVyYSIsIHNpemVvZihjYXAtPmJ1c19pbmZvKSk7CkBAIC0xOTEw
LDcgKzE5MTcsOCBAQCBzdGF0aWMgaW50IHB4YWNfdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB4YWNfdmlk
aW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHB4YWNfdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2lucHV0ICppKQog
ewogCWlmIChpLT5pbmRleCA+IDApCkBAIC0xOTIyLDE0ICsxOTMwLDE4IEBAIHN0YXRpYyBpbnQg
cHhhY192aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBweGFjX3ZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHB4YWNfdmlk
aW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICAgdW5zaWduZWQgaW50ICppKQogewogCSppID0g
MDsKIAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB4YWNfdmlkaW9jX3NfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBw
eGFjX3ZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgIHVuc2lnbmVkIGludCBpKQogewog
CWlmIChpID4gMCkKIAkJcmV0dXJuIC1FSU5WQUw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlh
L3BsYXRmb3JtL20ybS1kZWludGVybGFjZS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9tMm0t
ZGVpbnRlcmxhY2UuYwppbmRleCBlMDdlNTdkNDIwNmJhYTVlN2E0NjcyOThjYjI0MGMzYTJjZDU3
Y2Q4Li5iMTdkMTUzZTA0NDBhZjk5NmQ0OTBiZDU0NjhlNjhhMDE5ZGY5ZTMwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL20ybS1kZWludGVybGFjZS5jCisrKyBiL2RyaXZlcnMv
bWVkaWEvcGxhdGZvcm0vbTJtLWRlaW50ZXJsYWNlLmMKQEAgLTQzMyw3ICs0MzMsOCBAQCBzdGF0
aWMgdm9pZCBkZWludGVybGFjZV9kZXZpY2VfcnVuKHZvaWQgKnByaXYpCiAvKgogICogdmlkZW8g
aW9jdGxzCiAgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVj
dCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBNRU0yTUVN
X05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtNDcxLDEzICs0NzIsMTUgQEAgc3RhdGlj
IGludCBlbnVtX2ZtdChzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmLCB1MzIgdHlwZSkKIAlyZXR1cm4g
LUVJTlZBTDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlyZXR1cm4gZW51bV9m
bXQoZiwgTUVNMk1FTV9DQVBUVVJFKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRf
dmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9j
X2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsK
IAlyZXR1cm4gZW51bV9mbXQoZiwgTUVNMk1FTV9PVVRQVVQpOwpAQCAtNTE0LDEzICs1MTcsMTUg
QEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXQoc3RydWN0IGRlaW50ZXJsYWNlX2N0eCAqY3R4LCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHZpZGlvY19nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAly
ZXR1cm4gdmlkaW9jX2dfZm10KGZpbGVfdG9fY3R4KGZpbGUpLCBmKTsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXJldHVybiB2aWRpb2NfZ19mbXQoZmlsZV90b19jdHgoZmlsZSksIGYpOwpAQCAtNTQx
LDcgKzU0Niw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXQoc3RydWN0IHY0bDJfZm9ybWF0
ICpmLCBzdHJ1Y3QgZGVpbnRlcmxhY2VfZm10ICpmbXQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBkZWludGVybGFjZV9jdHggKmN0eCA9IGZpbGVfdG9f
Y3R4KGZpbGUpOwpAQCAtNTYxLDcgKzU2Nyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gdmlkaW9jX3Ry
eV9mbXQoZiwgZm10KTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92
aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGRlaW50
ZXJsYWNlX2ZtdCAqZm10OwpAQCAtNjMwLDI0ICs2MzcsMjYgQEAgc3RhdGljIGludCB2aWRpb2Nf
c19mbXQoc3RydWN0IGRlaW50ZXJsYWNlX2N0eCAqY3R4LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlpbnQgcmV0OwogCi0JcmV0ID0gdmlk
aW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSB2aWRpb2NfdHJ5X2Zt
dF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCXJl
dHVybiB2aWRpb2Nfc19mbXQoZmlsZV90b19jdHgoZmlsZSksIGYpOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCB2aWRpb2Nfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IGRlaW50ZXJsYWNlX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAJ
aW50IHJldDsKIAotCXJldCA9IHZpZGlvY190cnlfZm10X3ZpZF9vdXQoZmlsZSwgcHJpdiwgZik7
CisJcmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJl
dCkKIAkJcmV0dXJuIHJldDsKIApAQCAtNjU4LDcgKzY2Nyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJl
dDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgZW51bSB2NGwy
X2J1Zl90eXBlIHR5cGUpCiB7CiAJc3RydWN0IGRlaW50ZXJsYWNlX2N0eCAqY3R4ID0gZmlsZV90
b19jdHgoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL21hcnZlbGwv
bWNhbS1jb3JlLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL21hcnZlbGwvbWNhbS1jb3JlLmMK
aW5kZXggYjgzNjBkMzcwMDBhN2QwNzE0ZDI4ZGM4YzNjZmYwZGU2NzUwM2ZkMy4uOTI3MTg3YzYx
NjM2NGIzNGRjMzA0NTVhZjFmY2JlM2YxOWY5OTY1ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9tYXJ2ZWxsL21jYW0tY29yZS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZv
cm0vbWFydmVsbC9tY2FtLWNvcmUuYwpAQCAtMTMyMyw4ICsxMzIzLDggQEAgc3RhdGljIGludCBt
Y2FtX3NldHVwX3ZiMihzdHJ1Y3QgbWNhbV9jYW1lcmEgKmNhbSkKICAqIFRoZSBsb25nIGxpc3Qg
b2YgVjRMMiBpb2N0bCgpIG9wZXJhdGlvbnMuCiAgKi8KIAotc3RhdGljIGludCBtY2FtX3ZpZGlv
Y19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJf
Y2FwYWJpbGl0eSAqY2FwKQorc3RhdGljIGludCBtY2FtX3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0
IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBtY2FtX2NhbWVyYSAqY2FtID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTMzNiw3ICsxMzM2LDcgQEAgc3RhdGljIGludCBtY2Ft
X3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAogCiBzdGF0
aWMgaW50IG1jYW1fdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsCi0J
CXZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmZtdCkKKwkJc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmZtdCkKIHsKIAlpZiAoZm10
LT5pbmRleCA+PSBOX01DQU1fRk1UUykKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC0xMzQ0LDggKzEz
NDQsOCBAQCBzdGF0aWMgaW50IG1jYW1fdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbHAsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbWNhbV92aWRpb2NfdHJ5X2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmZtdCkKK3N0YXRpYyBpbnQgbWNhbV92aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxwLAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IG1jYW1fY2FtZXJhICpjYW0g
PSB2aWRlb19kcnZkYXRhKGZpbHApOwogCXN0cnVjdCBtY2FtX2Zvcm1hdF9zdHJ1Y3QgKmY7CkBA
IC0xMzc4LDggKzEzNzgsOCBAQCBzdGF0aWMgaW50IG1jYW1fdmlkaW9jX3RyeV9mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0
aWMgaW50IG1jYW1fdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQg
KnByaXYsCi0JCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQorc3RhdGljIGludCBtY2FtX3ZpZGlv
Y19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJCSAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVj
dCBtY2FtX2NhbWVyYSAqY2FtID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKIAlzdHJ1Y3QgbWNhbV9m
b3JtYXRfc3RydWN0ICpmOwpAQCAtMTM5Nyw3ICsxMzk3LDcgQEAgc3RhdGljIGludCBtY2FtX3Zp
ZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAogCS8qCiAJ
ICogU2VlIGlmIHRoZSBmb3JtYXR0aW5nIHdvcmtzIGluIHByaW5jaXBsZS4KIAkgKi8KLQlyZXQg
PSBtY2FtX3ZpZGlvY190cnlfZm10X3ZpZF9jYXAoZmlscCwgcHJpdiwgZm10KTsKKwlyZXQgPSBt
Y2FtX3ZpZGlvY190cnlfZm10X3ZpZF9jYXAoZmlscCwgc3RhdGUsIGZtdCk7CiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKIAkvKgpAQCAtMTQyNSw4ICsxNDI1LDggQEAgc3RhdGljIGludCBtY2Ft
X3ZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAogICog
VGhlIFY0bDIgc3BlYyB3YW50cyB1cyB0byBiZSBzbWFydGVyLCBhbmQgYWN0dWFsbHkgZ2V0IHRo
aXMgZnJvbQogICogdGhlIGNhbWVyYSAoYW5kIG5vdCBtZXNzIHdpdGggaXQgYXQgb3BlbiB0aW1l
KS4gIFNvbWVkYXkuCiAgKi8KLXN0YXRpYyBpbnQgbWNhbV92aWRpb2NfZ19mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQor
c3RhdGljIGludCBtY2FtX3ZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLAor
CQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgbWNhbV9jYW1lcmEgKmNhbSA9IHZpZGVvX2RydmRhdGEoZmls
cCk7CiAKQEAgLTE0MzcsOCArMTQzNyw4IEBAIHN0YXRpYyBpbnQgbWNhbV92aWRpb2NfZ19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIC8qCiAgKiBXZSBvbmx5IGhh
dmUgb25lIGlucHV0IC0gdGhlIHNlbnNvciAtIHNvIG1pbmltaXplIHRoZSBub25zZW5zZSBoZXJl
LgogICovCi1zdGF0aWMgaW50IG1jYW1fdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZp
bHAsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2NGwyX2lucHV0ICppbnB1dCkKK3N0YXRpYyBpbnQg
bWNhbV92aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCQkgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wdXQpCiB7CiAJ
aWYgKGlucHV0LT5pbmRleCAhPSAwKQogCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTE0NDgsMTMgKzE0
NDgsMTcgQEAgc3RhdGljIGludCBtY2FtX3ZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxwLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1jYW1fdmlkaW9j
X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkK
K3N0YXRpYyBpbnQgbWNhbV92aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCSAg
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgICB1bnNpZ25l
ZCBpbnQgKmkpCiB7CiAJKmkgPSAwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1jYW1f
dmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGlu
dCBpKQorc3RhdGljIGludCBtY2FtX3ZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxwLAor
CQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgIHVu
c2lnbmVkIGludCBpKQogewogCWlmIChpICE9IDApCiAJCXJldHVybiAtRUlOVkFMOwpAQCAtMTQ2
NSw4ICsxNDY5LDggQEAgc3RhdGljIGludCBtY2FtX3ZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxwLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKICAqIEcvU19QQVJNLiAgTW9zdCBv
ZiB0aGlzIGlzIGRvbmUgYnkgdGhlIHNlbnNvciwgYnV0IHdlIGFyZQogICogdGhlIGxldmVsIHdo
aWNoIGNvbnRyb2xzIHRoZSBudW1iZXIgb2YgcmVhZCBidWZmZXJzLgogICovCi1zdGF0aWMgaW50
IG1jYW1fdmlkaW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKLQkJc3Ry
dWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgbWNhbV92aWRpb2NfZ19wYXJtKHN0
cnVjdCBmaWxlICpmaWxwLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IG1jYW1fY2FtZXJhICpj
YW0gPSB2aWRlb19kcnZkYXRhKGZpbHApOwogCWludCByZXQ7CkBAIC0xNDc2LDggKzE0ODAsOCBA
QCBzdGF0aWMgaW50IG1jYW1fdmlkaW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IG1jYW1fdmlkaW9jX3NfcGFybShz
dHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfc3RyZWFtcGFybSAq
YSkKK3N0YXRpYyBpbnQgbWNhbV92aWRpb2Nfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJ
ICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX3N0cmVh
bXBhcm0gKmEpCiB7CiAJc3RydWN0IG1jYW1fY2FtZXJhICpjYW0gPSB2aWRlb19kcnZkYXRhKGZp
bHApOwogCWludCByZXQ7CkBAIC0xNDg3LDcgKzE0OTEsOCBAQCBzdGF0aWMgaW50IG1jYW1fdmlk
aW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0Owog
fQogCi1zdGF0aWMgaW50IG1jYW1fdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAq
ZmlscCwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbWNhbV92aWRpb2NfZW51bV9mcmFtZXNpemVz
KHN0cnVjdCBmaWxlICpmaWxwLAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKnNpemVzKQogewogCXN0cnVjdCBt
Y2FtX2NhbWVyYSAqY2FtID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKQEAgLTE1MjIsNyArMTUyNyw4
IEBAIHN0YXRpYyBpbnQgbWNhbV92aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpm
aWxwLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1jYW1fdmlkaW9j
X2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IG1jYW1fdmlkaW9jX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbHAs
CisJCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQlzdHJ1Y3QgdjRs
Ml9mcm1pdmFsZW51bSAqaW50ZXJ2YWwpCiB7CiAJc3RydWN0IG1jYW1fY2FtZXJhICpjYW0gPSB2
aWRlb19kcnZkYXRhKGZpbHApOwpAQCAtMTU0OCw3ICsxNTU0LDggQEAgc3RhdGljIGludCBtY2Ft
X3ZpZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2
LAogfQogCiAjaWZkZWYgQ09ORklHX1ZJREVPX0FEVl9ERUJVRwotc3RhdGljIGludCBtY2FtX3Zp
ZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBtY2FtX3ZpZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCXN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAq
cmVnKQogewogCXN0cnVjdCBtY2FtX2NhbWVyYSAqY2FtID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTE1NjAsNyArMTU2Nyw4IEBAIHN0YXRpYyBpbnQgbWNhbV92aWRpb2NfZ19yZWdpc3Rlcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBtY2FtX3ZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCBtY2FtX3ZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCWNvbnN0IHN0cnVjdCB2NGwy
X2RiZ19yZWdpc3RlciAqcmVnKQogewogCXN0cnVjdCBtY2FtX2NhbWVyYSAqY2FtID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWVkaWF0
ZWsvanBlZy9tdGtfanBlZ19jb3JlLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL21lZGlhdGVr
L2pwZWcvbXRrX2pwZWdfY29yZS5jCmluZGV4IDYyNjhkNjUxYmRjZmQyMTJiNThiZjY4NmM1NTY2
MGQ2NGI2NTlkZmUuLmExYzEwYjMzNDUzNWViYjAyZjIwZTQ3MDljOTZkZDRhMjJmYzJlYWEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWVkaWF0ZWsvanBlZy9tdGtfanBlZ19j
b3JlLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9tZWRpYXRlay9qcGVnL210a19qcGVn
X2NvcmUuYwpAQCAtMTMwLDcgKzEzMCw4IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IG10a19qcGVn
X3NyY19idWYgKm10a19qcGVnX3ZiMl90b19zcmNidWYoCiAJcmV0dXJuIGNvbnRhaW5lcl9vZih0
b192YjJfdjRsMl9idWZmZXIodmIpLCBzdHJ1Y3QgbXRrX2pwZWdfc3JjX2J1ZiwgYik7CiB9CiAK
LXN0YXRpYyBpbnQgbXRrX2pwZWdfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IG10a19qcGVnX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0
bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBtdGtfanBlZ19kZXYgKmpwZWcgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtMjA5LDcgKzIxMCw4IEBAIHN0YXRpYyBpbnQgbXRrX2pwZWdf
ZW51bV9mbXQoc3RydWN0IG10a19qcGVnX2ZtdCAqbXRrX2pwZWdfZm9ybWF0cywgaW50IG4sCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX2pwZWdfZW51bV9mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXRrX2pwZWdfZW51bV9mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1
Y3QgbXRrX2pwZWdfY3R4ICpjdHggPSBtdGtfanBlZ19maWxlX3RvX2N0eChmaWxlKTsKQEAgLTIy
MCw3ICsyMjIsOCBAQCBzdGF0aWMgaW50IG10a19qcGVnX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQkJIE1US19KUEVHX0ZNVF9GTEFHX0NBUFRVUkUp
OwogfQogCi1zdGF0aWMgaW50IG10a19qcGVnX2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG10a19qcGVnX2VudW1fZm10X3ZpZF9vdXQo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IG10a19q
cGVnX2N0eCAqY3R4ID0gbXRrX2pwZWdfZmlsZV90b19jdHgoZmlsZSk7CkBAIC0yOTksNyArMzAy
LDggQEAgc3RhdGljIGludCBtdGtfanBlZ190cnlfZm10X21wbGFuZShzdHJ1Y3QgdjRsMl9waXhf
Zm9ybWF0X21wbGFuZSAqcGl4X21wLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG10a19q
cGVnX2dfZm10X3ZpZF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IG10a19qcGVnX2dfZm10X3ZpZF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsKQEAgLTM0OCw3ICszNTIs
OCBAQCBzdGF0aWMgaW50IG10a19qcGVnX2dfZm10X3ZpZF9tcGxhbmUoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX2pwZWdfdHJ5
X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgbXRrX2pwZWdfdHJ5X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbXRrX2pwZWdfY3R4ICpjdHggPSBtdGtfanBl
Z19maWxlX3RvX2N0eChmaWxlKTsKQEAgLTM3MCwxNCArMzc1LDE1IEBAIHN0YXRpYyBpbnQgbXRr
X2pwZWdfdHJ5X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAkJIChmbXQtPmZvdXJjYyA+PiAyNCAmIDB4ZmYpKTsKIAogCWlmIChjdHgtPnN0YXRlICE9
IE1US19KUEVHX0lOSVQpIHsKLQkJbXRrX2pwZWdfZ19mbXRfdmlkX21wbGFuZShmaWxlLCBwcml2
LCBmKTsKKwkJbXRrX2pwZWdfZ19mbXRfdmlkX21wbGFuZShmaWxlLCBzdGF0ZSwgZik7CiAJCXJl
dHVybiAwOwogCX0KIAogCXJldHVybiBtdGtfanBlZ190cnlfZm10X21wbGFuZSgmZi0+Zm10LnBp
eF9tcCwgZm10KTsKIH0KIAotc3RhdGljIGludCBtdGtfanBlZ190cnlfZm10X3ZpZF9vdXRfbXBs
YW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBtdGtfanBlZ190
cnlfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCBtdGtfanBlZ19jdHggKmN0eCA9IG10a19qcGVnX2ZpbGVfdG9fY3R4KGZp
bGUpOwpAQCAtMzk5LDcgKzQwNSw3IEBAIHN0YXRpYyBpbnQgbXRrX2pwZWdfdHJ5X2ZtdF92aWRf
b3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAkJIChmbXQtPmZvdXJj
YyA+PiAyNCAmIDB4ZmYpKTsKIAogCWlmIChjdHgtPnN0YXRlICE9IE1US19KUEVHX0lOSVQpIHsK
LQkJbXRrX2pwZWdfZ19mbXRfdmlkX21wbGFuZShmaWxlLCBwcml2LCBmKTsKKwkJbXRrX2pwZWdf
Z19mbXRfdmlkX21wbGFuZShmaWxlLCBzdGF0ZSwgZik7CiAJCXJldHVybiAwOwogCX0KIApAQCAt
NDYxLDEyICs0NjcsMTMgQEAgc3RhdGljIGludCBtdGtfanBlZ19zX2ZtdF9tcGxhbmUoc3RydWN0
IG10a19qcGVnX2N0eCAqY3R4LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG10a19qcGVn
X3NfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCBtdGtfanBlZ19zX2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQogewogCWludCByZXQ7CiAKLQlyZXQgPSBtdGtfanBlZ190cnlfZm10X3Zp
ZF9vdXRfbXBsYW5lKGZpbGUsIHByaXYsIGYpOworCXJldCA9IG10a19qcGVnX3RyeV9mbXRfdmlk
X291dF9tcGxhbmUoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAK
QEAgLTQ3NCwxMiArNDgxLDEzIEBAIHN0YXRpYyBpbnQgbXRrX2pwZWdfc19mbXRfdmlkX291dF9t
cGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQkJICAgICBNVEtfSlBFR19G
TVRfRkxBR19PVVRQVVQpOwogfQogCi1zdGF0aWMgaW50IG10a19qcGVnX3NfZm10X3ZpZF9jYXBf
bXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBtdGtfanBl
Z19zX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCWludCByZXQ7CiAKLQlyZXQgPSBtdGtfanBlZ190cnlfZm10X3ZpZF9jYXBfbXBsYW5lKGZp
bGUsIHByaXYsIGYpOworCXJldCA9IG10a19qcGVnX3RyeV9mbXRfdmlkX2NhcF9tcGxhbmUoZmls
ZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTUwOSw3ICs1MTcs
OCBAQCBzdGF0aWMgaW50IG10a19qcGVnX3N1YnNjcmliZV9ldmVudChzdHJ1Y3QgdjRsMl9maCAq
ZmgsCiAJcmV0dXJuIHY0bDJfY3RybF9zdWJzY3JpYmVfZXZlbnQoZmgsIHN1Yik7CiB9CiAKLXN0
YXRpYyBpbnQgbXRrX2pwZWdfZW5jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCBtdGtfanBlZ19lbmNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAg
ICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IG10a19qcGVnX2N0eCAqY3R4
ID0gbXRrX2pwZWdfZmlsZV90b19jdHgoZmlsZSk7CkBAIC01MzQsNyArNTQzLDggQEAgc3RhdGlj
IGludCBtdGtfanBlZ19lbmNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX2pwZWdfZGVjX2dfc2VsZWN0aW9u
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBtdGtfanBlZ19kZWNf
Z19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJ
c3RydWN0IG10a19qcGVnX2N0eCAqY3R4ID0gbXRrX2pwZWdfZmlsZV90b19jdHgoZmlsZSk7CkBA
IC01NjMsNyArNTczLDggQEAgc3RhdGljIGludCBtdGtfanBlZ19kZWNfZ19zZWxlY3Rpb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
bXRrX2pwZWdfZW5jX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCBtdGtfanBlZ19lbmNfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3Qg
djRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IG10a19qcGVnX2N0eCAqY3R4ID0gbXRrX2pw
ZWdfZmlsZV90b19jdHgoZmlsZSk7CkBAIC01ODYsNyArNTk3LDggQEAgc3RhdGljIGludCBtdGtf
anBlZ19lbmNfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX2pwZWdfcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYnVmZmVyICpidWYpCitzdGF0aWMgaW50IG10a19qcGVn
X3FidWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJIHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQogewogCXN0cnVjdCB2NGwyX2ZoICpmaCA9
IGZpbGVfdG9fdjRsMl9maChmaWxlKTsKIAlzdHJ1Y3QgbXRrX2pwZWdfY3R4ICpjdHggPSBtdGtf
anBlZ19maWxlX3RvX2N0eChmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZv
cm0vbWVkaWF0ZWsvbWRwL210a19tZHBfbTJtLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL21l
ZGlhdGVrL21kcC9tdGtfbWRwX20ybS5jCmluZGV4IDAzYzA3OTQ4ZGZkZDA3YzYzOTVjMzkxY2Nh
ZDE3ODhiMDhiMWE4NjcuLjNjYTIwMzY0NzMwZTEzMWZhZDRmNGRiNTRjZWE3MGEyZWUyMDA2YzUg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWVkaWF0ZWsvbWRwL210a19tZHBf
bTJtLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9tZWRpYXRlay9tZHAvbXRrX21kcF9t
Mm0uYwpAQCAtNTg2LDcgKzU4Niw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBtdGtf
bWRwX20ybV9xb3BzID0gewogCS5zdGFydF9zdHJlYW1pbmcgPSBtdGtfbWRwX20ybV9zdGFydF9z
dHJlYW1pbmcsCiB9OwogCi1zdGF0aWMgaW50IG10a19tZHBfbTJtX3F1ZXJ5Y2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgbXRrX21kcF9tMm1fcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBtdGtfbWRwX2N0eCAq
Y3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC02MTIsMTkgKzYxMywyMiBAQCBzdGF0aWMgaW50
IG10a19tZHBfZW51bV9mbXQoc3RydWN0IHY0bDJfZm10ZGVzYyAqZiwgdTMyIHR5cGUpCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX21kcF9tMm1fZW51bV9mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXRrX21kcF9tMm1fZW51bV9m
bXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJcmV0dXJuIG10
a19tZHBfZW51bV9mbXQoZiwgVjRMMl9CVUZfVFlQRV9WSURFT19DQVBUVVJFX01QTEFORSk7CiB9
CiAKLXN0YXRpYyBpbnQgbXRrX21kcF9tMm1fZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXRrX21kcF9tMm1fZW51bV9mbXRfdmlkX291
dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJcmV0dXJuIG10a19tZHBfZW51
bV9mbXQoZiwgVjRMMl9CVUZfVFlQRV9WSURFT19PVVRQVVRfTVBMQU5FKTsKIH0KIAotc3RhdGlj
IGludCBtdGtfbWRwX20ybV9nX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LAorc3RhdGljIGludCBtdGtfbWRwX20ybV9nX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG10a19tZHBfY3R4ICpjdHggPSBmaWxlX3Rv
X2N0eChmaWxlKTsKQEAgLTY2Myw3ICs2NjcsOCBAQCBzdGF0aWMgaW50IG10a19tZHBfbTJtX2df
Zm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgbXRrX21kcF9tMm1fdHJ5X2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAorc3RhdGljIGludCBtdGtfbWRwX20ybV90cnlfZm10X21wbGFuZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG10a19tZHBfY3R4
ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTY3Myw3ICs2NzgsOCBAQCBzdGF0aWMgaW50
IG10a19tZHBfbTJtX3RyeV9mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBtdGtfbWRwX20ybV9zX2ZtdF9tcGxhbmUoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBtdGtfbWRwX20ybV9zX2ZtdF9t
cGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG10
a19tZHBfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTcxOSw3ICs3MjUsOCBAQCBz
dGF0aWMgaW50IG10a19tZHBfbTJtX3NfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX21kcF9tMm1fcmVxYnVmcyhz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG10a19tZHBfbTJtX3JlcWJ1
ZnMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKnJlcWJ1ZnMp
CiB7CiAJc3RydWN0IG10a19tZHBfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTcy
Nyw3ICs3MzQsOCBAQCBzdGF0aWMgaW50IG10a19tZHBfbTJtX3JlcWJ1ZnMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiB2NGwyX20ybV9yZXFidWZzKGZpbGUsIGN0eC0+bTJt
X2N0eCwgcmVxYnVmcyk7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX21kcF9tMm1fc3RyZWFtb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBtdGtfbWRwX20ybV9zdHJlYW1v
bihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQllbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgbXRrX21kcF9jdHgg
KmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNzY1LDcgKzc3Myw4IEBAIHN0YXRpYyBpbmxp
bmUgYm9vbCBtdGtfbWRwX2lzX3RhcmdldF9jcm9wKHUzMiB0YXJnZXQpCiAJcmV0dXJuIGZhbHNl
OwogfQogCi1zdGF0aWMgaW50IG10a19tZHBfbTJtX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgbXRrX21kcF9tMm1fZ19zZWxlY3Rpb24oc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICAgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgbXRrX21kcF9j
dHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtODMyLDcgKzg0MSw4IEBAIHN0YXRpYyBp
bnQgbXRrX21kcF9jaGVja19zY2FsZXJfcmF0aW8oc3RydWN0IG10a19tZHBfdmFyaWFudCAqdmFy
LCBpbnQgc3JjX3csCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX21kcF9tMm1fc19z
ZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBtdGtfbWRw
X20ybV9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7
CiAJc3RydWN0IG10a19tZHBfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTExMTEs
OSArMTEyMSw5IEBAIHN0YXRpYyBpbnQgbXRrX21kcF9tMm1fb3BlbihzdHJ1Y3QgZmlsZSAqZmls
ZSkKIAlkZWZhdWx0X2Zvcm1hdC5mbXQucGl4X21wLndpZHRoID0gMzI7CiAJZGVmYXVsdF9mb3Jt
YXQuZm10LnBpeF9tcC5oZWlnaHQgPSAzMjsKIAlkZWZhdWx0X2Zvcm1hdC5mbXQucGl4X21wLnBp
eGVsZm9ybWF0ID0gVjRMMl9QSVhfRk1UX1lVVjQyME07Ci0JbXRrX21kcF9tMm1fc19mbXRfbXBs
YW5lKGZpbGUsICZjdHgtPmZoLCAmZGVmYXVsdF9mb3JtYXQpOworCW10a19tZHBfbTJtX3NfZm10
X21wbGFuZShmaWxlLCBjdHgtPmZoLnN0YXRlLCAmZGVmYXVsdF9mb3JtYXQpOwogCWRlZmF1bHRf
Zm9ybWF0LnR5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkVfTVBMQU5FOwotCW10a19t
ZHBfbTJtX3NfZm10X21wbGFuZShmaWxlLCAmY3R4LT5maCwgJmRlZmF1bHRfZm9ybWF0KTsKKwlt
dGtfbWRwX20ybV9zX2ZtdF9tcGxhbmUoZmlsZSwgY3R4LT5maC5zdGF0ZSwgJmRlZmF1bHRfZm9y
bWF0KTsKIAogCW10a19tZHBfZGJnKDAsICIlcyBbJWRdIiwgZGV2X25hbWUoJm1kcC0+cGRldi0+
ZGV2KSwgY3R4LT5pZCk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWVk
aWF0ZWsvbWRwMy9tdGstbWRwMy1tMm0uYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWVkaWF0
ZWsvbWRwMy9tdGstbWRwMy1tMm0uYwppbmRleCA5ZWY5NTZiNTY1YTc5MTQyOWE0NzdkYzk2NTY3
NDUzY2IxODlkODE3Li5jZTM4MDZiMzgyZTM0YWMzNzAwOTlhMzViMzBhY2U3MmY0MzU4NjZiIDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL21lZGlhdGVrL21kcDMvbXRrLW1kcDMt
bTJtLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9tZWRpYXRlay9tZHAzL210ay1tZHAz
LW0ybS5jCkBAIC0yNzMsNyArMjczLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIG1k
cF9tMm1fcW9wcyA9IHsKIAkuYnVmX291dF92YWxpZGF0ZSA9IG1kcF9tMm1fYnVmX291dF92YWxp
ZGF0ZSwKIH07CiAKLXN0YXRpYyBpbnQgbWRwX20ybV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG1kcF9tMm1fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3Ry
dWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIE1EUF9N
T0RVTEVfTkFNRSwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7CkBAIC0yODIsNyArMjgzLDggQEAgc3Rh
dGljIGludCBtZHBfbTJtX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBtZHBfbTJtX2VudW1fZm10X21wbGFuZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG1kcF9tMm1fZW51bV9mbXRfbXBsYW5l
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IG1kcF9tMm1f
Y3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTI5MCw3ICsyOTIsOCBAQCBzdGF0aWMg
aW50IG1kcF9tMm1fZW51bV9mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IAlyZXR1cm4gbWRwX2VudW1fZm10X21wbGFuZShjdHgtPm1kcF9kZXYsIGYpOwogfQogCi1zdGF0
aWMgaW50IG1kcF9tMm1fZ19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgbWRwX20ybV9nX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCBtZHBfbTJtX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBA
IC0zMDgsNyArMzExLDggQEAgc3RhdGljIGludCBtZHBfbTJtX2dfZm10X21wbGFuZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbWRwX20y
bV9zX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBt
ZHBfbTJtX3NfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IG1kcF9tMm1fY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTM1MSw3ICszNTUs
OCBAQCBzdGF0aWMgaW50IG1kcF9tMm1fc19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBtZHBfbTJtX3RyeV9mbXRfbXBs
YW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgbWRwX20ybV90cnlf
Zm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBt
ZHBfbTJtX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC0zNjIsNyArMzY3LDggQEAg
c3RhdGljIGludCBtZHBfbTJtX3RyeV9mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBtZHBfbTJtX2dfc2VsZWN0aW9uKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgbWRwX20ybV9nX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0
IG1kcF9tMm1fY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTQxNCw3ICs0MjAsOCBA
QCBzdGF0aWMgaW50IG1kcF9tMm1fZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IG1kcF9tMm1fc19zZWxlY3Rp
b24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBtZHBfbTJtX3Nfc2Vs
ZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlz
dHJ1Y3QgbWRwX20ybV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNjE2LDkgKzYy
Myw5IEBAIHN0YXRpYyBpbnQgbWRwX20ybV9vcGVuKHN0cnVjdCBmaWxlICpmaWxlKQogCWRlZmF1
bHRfZm9ybWF0LmZtdC5waXhfbXAud2lkdGggPSBsaW1pdC0+b3V0X2xpbWl0LndtaW47CiAJZGVm
YXVsdF9mb3JtYXQuZm10LnBpeF9tcC5oZWlnaHQgPSBsaW1pdC0+b3V0X2xpbWl0LmhtaW47CiAJ
ZGVmYXVsdF9mb3JtYXQuZm10LnBpeF9tcC5waXhlbGZvcm1hdCA9IFY0TDJfUElYX0ZNVF9ZVVY0
MjBNOwotCW1kcF9tMm1fc19mbXRfbXBsYW5lKGZpbGUsICZjdHgtPmZoLCAmZGVmYXVsdF9mb3Jt
YXQpOworCW1kcF9tMm1fc19mbXRfbXBsYW5lKGZpbGUsIE5VTEwsICZkZWZhdWx0X2Zvcm1hdCk7
CiAJZGVmYXVsdF9mb3JtYXQudHlwZSA9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRV9NUExB
TkU7Ci0JbWRwX20ybV9zX2ZtdF9tcGxhbmUoZmlsZSwgJmN0eC0+ZmgsICZkZWZhdWx0X2Zvcm1h
dCk7CisJbWRwX20ybV9zX2ZtdF9tcGxhbmUoZmlsZSwgTlVMTCwgJmRlZmF1bHRfZm9ybWF0KTsK
IAogCWRldl9kYmcoZGV2LCAiJXM6WyVkXSIsIF9fZnVuY19fLCBjdHgtPmlkKTsKIApkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9tZWRpYXRlay92Y29kZWMvZGVjb2Rlci9tdGtf
dmNvZGVjX2RlYy5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9tZWRpYXRlay92Y29kZWMvZGVj
b2Rlci9tdGtfdmNvZGVjX2RlYy5jCmluZGV4IGQ2OTFiZDUzMzEwM2IxMDBlN2QxODE3ZTgzNDY5
NmNjNWIzOTkwY2UuLmE2OWQ0ZjQ2MjBmNmQ3YjNhMTNlZWFhZWVkYTJiZWUxYjkzMTM0OTggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWVkaWF0ZWsvdmNvZGVjL2RlY29kZXIv
bXRrX3Zjb2RlY19kZWMuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL21lZGlhdGVrL3Zj
b2RlYy9kZWNvZGVyL210a192Y29kZWNfZGVjLmMKQEAgLTE1NiwyNCArMTU2LDI4IEBAIHN0YXRp
YyBpbnQgc3RhdGVsZXNzX2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCBzdHJ1Y3QgdjRsMl9kZWNvCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3Ry
eV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJf
ZGVjb2Rlcl9jbWQgKmNtZCkKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9kZWNvZGVyX2NtZChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJCSAgc3RydWN0IHY0bDJfZGVjb2Rlcl9jbWQgKmNtZCkKIHsKIAlzdHJ1Y3QgbXRrX3Zjb2Rl
Y19kZWNfY3R4ICpjdHggPSBmaWxlX3RvX2RlY19jdHgoZmlsZSk7CiAKIAlpZiAoY3R4LT5kZXYt
PnZkZWNfcGRhdGEtPnVzZXNfc3RhdGVsZXNzX2FwaSkKLQkJcmV0dXJuIHN0YXRlbGVzc190cnlf
ZGVjb2Rlcl9jbWQoZmlsZSwgcHJpdiwgY21kKTsKKwkJcmV0dXJuIHN0YXRlbGVzc190cnlfZGVj
b2Rlcl9jbWQoZmlsZSwgc3RhdGUsIGNtZCk7CiAKLQlyZXR1cm4gc3RhdGVmdWxfdHJ5X2RlY29k
ZXJfY21kKGZpbGUsIHByaXYsIGNtZCk7CisJcmV0dXJuIHN0YXRlZnVsX3RyeV9kZWNvZGVyX2Nt
ZChmaWxlLCBzdGF0ZSwgY21kKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZGVjb2Rlcl9jbWQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2RlY29kZXJfY21kICpj
bWQpCitzdGF0aWMgaW50IHZpZGlvY19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgc3RydWN0
IHY0bDJfZGVjb2Rlcl9jbWQgKmNtZCkKIHsKIAlzdHJ1Y3QgbXRrX3Zjb2RlY19kZWNfY3R4ICpj
dHggPSBmaWxlX3RvX2RlY19jdHgoZmlsZSk7CiAKIAlpZiAoY3R4LT5kZXYtPnZkZWNfcGRhdGEt
PnVzZXNfc3RhdGVsZXNzX2FwaSkKLQkJcmV0dXJuIHN0YXRlbGVzc19kZWNvZGVyX2NtZChmaWxl
LCBwcml2LCBjbWQpOworCQlyZXR1cm4gc3RhdGVsZXNzX2RlY29kZXJfY21kKGZpbGUsIHN0YXRl
LCBjbWQpOwogCi0JcmV0dXJuIHN0YXRlZnVsX2RlY29kZXJfY21kKGZpbGUsIHByaXYsIGNtZCk7
CisJcmV0dXJuIHN0YXRlZnVsX2RlY29kZXJfY21kKGZpbGUsIHN0YXRlLCBjbWQpOwogfQogCiB2
b2lkIG10a192ZGVjX3VubG9jayhzdHJ1Y3QgbXRrX3Zjb2RlY19kZWNfY3R4ICpjdHgpCkBAIC0y
MzAsNyArMjM0LDggQEAgdm9pZCBtdGtfdmNvZGVjX2RlY19zZXRfZGVmYXVsdF9wYXJhbXMoc3Ry
dWN0IG10a192Y29kZWNfZGVjX2N0eCAqY3R4KQogCXFfZGF0YS0+Ynl0ZXNwZXJsaW5lWzFdID0g
cV9kYXRhLT5jb2RlZF93aWR0aDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdmRlY19xYnVmKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdmRlY19xYnVm
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQogewogCXN0cnVjdCBtdGtfdmNv
ZGVjX2RlY19jdHggKmN0eCA9IGZpbGVfdG9fZGVjX2N0eChmaWxlKTsKQEAgLTI0Myw3ICsyNDgs
OCBAQCBzdGF0aWMgaW50IHZpZGlvY192ZGVjX3FidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIHY0bDJfbTJtX3FidWYoZmlsZSwgY3R4LT5tMm1fY3R4LCBidWYpOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY192ZGVjX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdmRlY19kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVj
dCB2NGwyX2J1ZmZlciAqYnVmKQogewogCXN0cnVjdCBtdGtfdmNvZGVjX2RlY19jdHggKmN0eCA9
IGZpbGVfdG9fZGVjX2N0eChmaWxlKTsKQEAgLTI1Niw3ICsyNjIsOCBAQCBzdGF0aWMgaW50IHZp
ZGlvY192ZGVjX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB2
NGwyX20ybV9kcWJ1ZihmaWxlLCBjdHgtPm0ybV9jdHgsIGJ1Zik7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX3ZkZWNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZpZGlvY192ZGVjX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkg
KmNhcCkKIHsKIAlzdHJ1Y3QgbXRrX3Zjb2RlY19kZWNfY3R4ICpjdHggPSBmaWxlX3RvX2RlY19j
dHgoZmlsZSk7CkBAIC0zNTAsNyArMzU3LDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdChz
dHJ1Y3QgbXRrX3Zjb2RlY19kZWNfY3R4ICpjdHgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwX21wbGFuZShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRf
dmlkX2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJY29uc3Qg
c3RydWN0IG10a192aWRlb19mbXQgKmZtdDsKQEAgLTM2Nyw3ICszNzUsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY190cnlfZm10X3ZpZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogCXJldHVybiB2aWRpb2NfdHJ5X2ZtdChjdHgsIGYsIGZtdCk7CiB9CiAKLXN0YXRpYyBp
bnQgdmlkaW9jX3RyeV9mbXRfdmlkX291dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBsYW5l
ICpwaXhfZm10X21wID0gJmYtPmZtdC5waXhfbXA7CkBAIC0zOTAsNyArMzk5LDggQEAgc3RhdGlj
IGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gdmlkaW9jX3RyeV9mbXQoY3R4LCBmLCBmbXQpOwogfQogCi1zdGF0
aWMgaW50IHZpZGlvY192ZGVjX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCB2aWRpb2NfdmRlY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2
NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgbXRrX3Zjb2RlY19kZWNfY3R4ICpjdHggPSBm
aWxlX3RvX2RlY19jdHgoZmlsZSk7CkBAIC00MzksNyArNDQ5LDggQEAgc3RhdGljIGludCB2aWRp
b2NfdmRlY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdmRlY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3ZkZWNfc19zZWxlY3Rpb24o
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBtdGtfdmNvZGVj
X2RlY19jdHggKmN0eCA9IGZpbGVfdG9fZGVjX2N0eChmaWxlKTsKQEAgLTQ2MSw3ICs0NzIsOCBA
QCBzdGF0aWMgaW50IHZpZGlvY192ZGVjX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY192ZGVjX3NfZm10
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdmRlY19z
X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbXRr
X3Zjb2RlY19kZWNfY3R4ICpjdHggPSBmaWxlX3RvX2RlY19jdHgoZmlsZSk7CkBAIC01OTAsNyAr
NjAyLDggQEAgc3RhdGljIGludCB2aWRpb2NfdmRlY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFt
ZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nf
ZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQog
ewogCWludCBpID0gMDsKQEAgLTY1NywxOSArNjcwLDIyIEBAIHN0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmLAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY192ZGVjX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY192ZGVjX2VudW1fZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXJldHVybiB2aWRp
b2NfZW51bV9mbXQoZmlsZSwgZiwgZmFsc2UpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY192ZGVj
X2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY192ZGVjX2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mbXRk
ZXNjICpmKQogewogCXJldHVybiB2aWRpb2NfZW51bV9mbXQoZmlsZSwgZiwgdHJ1ZSk7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX3ZkZWNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IHZpZGlvY192ZGVjX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBtdGtfdmNvZGVjX2RlY19jdHggKmN0eCA9IGZpbGVf
dG9fZGVjX2N0eChmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWVk
aWF0ZWsvdmNvZGVjL2VuY29kZXIvbXRrX3Zjb2RlY19lbmMuYyBiL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vbWVkaWF0ZWsvdmNvZGVjL2VuY29kZXIvbXRrX3Zjb2RlY19lbmMuYwppbmRleCBkODE1
ZTk2MmFiODk4MWM1MzAwMDg1MWU4ZjJiYzYxZmFmMjgwNTZkLi5jZTQ2MzZmMDNlNGIxOTYzYTQ5
YTAzNzQzZGFlM2FjNTVhMDE0NDEyIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L21lZGlhdGVrL3Zjb2RlYy9lbmNvZGVyL210a192Y29kZWNfZW5jLmMKKysrIGIvZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS9tZWRpYXRlay92Y29kZWMvZW5jb2Rlci9tdGtfdmNvZGVjX2VuYy5jCkBA
IC0xNTUsNyArMTU1LDggQEAgbXRrX3ZlbmNfZmluZF9mb3JtYXQodTMyIGZvdXJjYywgY29uc3Qg
c3RydWN0IG10a192Y29kZWNfZW5jX3BkYXRhICpwZGF0YSkKIAlyZXR1cm4gTlVMTDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0
IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCWNvbnN0IHN0cnVjdCBtdGtfdmlkZW9fZm10
ICpmbXQ7CkBAIC0xNzksNyArMTgwLDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZXNp
emVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0
IHY0bDJfZm10ZGVzYyAqZikKIHsKIAljb25zdCBzdHJ1Y3QgbXRrX3Zjb2RlY19lbmNfcGRhdGEg
KnBkYXRhID0KQEAgLTE4OSw3ICsxOTEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCQkJICAgICAgIHBkYXRhLT5u
dW1fY2FwdHVyZV9mb3JtYXRzKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlk
X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlj
b25zdCBzdHJ1Y3QgbXRrX3Zjb2RlY19lbmNfcGRhdGEgKnBkYXRhID0KQEAgLTIxNyw3ICsyMjAs
OCBAQCBzdGF0aWMgaW50IG10a192Y29kZWNfZW5jX2dldF9jaGlwX25hbWUoc3RydWN0IG10a192
Y29kZWNfZW5jX2N0eCAqY3R4KQogCQlyZXR1cm4gODE3MzsKIH0KIAotc3RhdGljIGludCB2aWRp
b2NfdmVuY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX3ZlbmNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2Fw
KQogewogCXN0cnVjdCBtdGtfdmNvZGVjX2VuY19jdHggKmN0eCA9IGZpbGVfdG9fZW5jX2N0eChm
aWxlKTsKQEAgLTIzMCw3ICsyMzQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY192ZW5jX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY192ZW5jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX3ZlbmNfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9z
dHJlYW1wYXJtICphKQogewogCXN0cnVjdCBtdGtfdmNvZGVjX2VuY19jdHggKmN0eCA9IGZpbGVf
dG9fZW5jX2N0eChmaWxlKTsKQEAgLTI1Myw3ICsyNTgsOCBAQCBzdGF0aWMgaW50IHZpZGlvY192
ZW5jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCB2aWRpb2NfdmVuY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHZpZGlvY192ZW5jX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3Ry
dWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlzdHJ1Y3QgbXRrX3Zjb2RlY19lbmNfY3R4ICpj
dHggPSBmaWxlX3RvX2VuY19jdHgoZmlsZSk7CkBAIC00MTAsNyArNDE2LDggQEAgc3RhdGljIHZv
aWQgbXRrX3ZlbmNfc2V0X3BhcmFtKHN0cnVjdCBtdGtfdmNvZGVjX2VuY19jdHggKmN0eCwKIAkJ
CSAgcGFyYW0tPmdvcF9zaXplLCBwYXJhbS0+aW50cmFfcGVyaW9kKTsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2NfdmVuY19zX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY192ZW5jX3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgbXRrX3Zjb2RlY19lbmNfY3R4ICpjdHggPSBmaWxlX3RvX2Vu
Y19jdHgoZmlsZSk7CkBAIC00NjUsNyArNDcyLDggQEAgc3RhdGljIGludCB2aWRpb2NfdmVuY19z
X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX3ZlbmNfc19mbXRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdmVuY19zX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG10a192Y29kZWNfZW5jX2N0eCAqY3R4ID0g
ZmlsZV90b19lbmNfY3R4KGZpbGUpOwpAQCAtNTE5LDcgKzUyNyw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3ZlbmNfc19mbXRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY192ZW5jX2dfZm10KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdmVuY19nX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAg
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0X21wbGFu
ZSAqcGl4ID0gJmYtPmZtdC5waXhfbXA7CkBAIC01NTIsNyArNTYxLDggQEAgc3RhdGljIGludCB2
aWRpb2NfdmVuY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2Nh
cF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAljb25zdCBzdHJ1
Y3QgbXRrX3ZpZGVvX2ZtdCAqZm10OwpAQCAtNTc0LDcgKzU4NCw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3RyeV9mbXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX291dF9tcGxh
bmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlf
Zm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
Y29uc3Qgc3RydWN0IG10a192aWRlb19mbXQgKmZtdDsKQEAgLTU5Niw3ICs2MDcsOCBAQCBzdGF0
aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiB2aWRpb2NfdHJ5X2ZtdF9vdXQoY3R4LCBmLCBmbXQpOwogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY192ZW5jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfdmVuY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
ICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgbXRrX3Zjb2RlY19lbmNf
Y3R4ICpjdHggPSBmaWxlX3RvX2VuY19jdHgoZmlsZSk7CkBAIC02MjYsNyArNjM4LDggQEAgc3Rh
dGljIGludCB2aWRpb2NfdmVuY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdmVuY19zX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3ZlbmNf
c19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJ
c3RydWN0IG10a192Y29kZWNfZW5jX2N0eCAqY3R4ID0gZmlsZV90b19lbmNfY3R4KGZpbGUpOwpA
QCAtNjUxLDcgKzY2NCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3ZlbmNfc19zZWxlY3Rpb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX3ZlbmNfcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX3ZlbmNfcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikK
IHsKIAlzdHJ1Y3QgbXRrX3Zjb2RlY19lbmNfY3R4ICpjdHggPSBmaWxlX3RvX2VuY19jdHgoZmls
ZSk7CkBAIC02NjUsNyArNjc5LDggQEAgc3RhdGljIGludCB2aWRpb2NfdmVuY19xYnVmKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB2NGwyX20ybV9xYnVmKGZpbGUsIGN0
eC0+bTJtX2N0eCwgYnVmKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdmVuY19kcWJ1ZihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3ZlbmNfZHFidWYo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKIHsKIAlzdHJ1Y3QgbXRrX3Zj
b2RlY19lbmNfY3R4ICpjdHggPSBmaWxlX3RvX2VuY19jdHgoZmlsZSk7CkBAIC03MDMsNyArNzE4
LDggQEAgc3RhdGljIGludCB2aWRpb2NfdmVuY19kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW5jb2Rlcl9jbWQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19lbmNvZGVy
X2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmNtZCkKIHsKIAlz
dHJ1Y3QgbXRrX3Zjb2RlY19lbmNfY3R4ICpjdHggPSBmaWxlX3RvX2VuY19jdHgoZmlsZSk7CkBA
IC03MTYsNyArNzMyLDcgQEAgc3RhdGljIGludCB2aWRpb2NfZW5jb2Rlcl9jbWQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCXJldHVybiAtRUlPOwogCX0KIAotCXJldCA9IHY0bDJf
bTJtX2lvY3RsX3RyeV9lbmNvZGVyX2NtZChmaWxlLCBwcml2LCBjbWQpOworCXJldCA9IHY0bDJf
bTJtX2lvY3RsX3RyeV9lbmNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgY21kKTsKIAlpZiAocmV0KQog
CQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL21pY3Jv
Y2hpcC9taWNyb2NoaXAtaXNjLWJhc2UuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWljcm9j
aGlwL21pY3JvY2hpcC1pc2MtYmFzZS5jCmluZGV4IGE3Y2RjNzQzZmRhNzFkYjBmZmJmNDk5Y2I0
YjljYTE4YzllN2FiZjIuLjlhMWEwMWQyMzFkNTYxYmQyZjM2MGYzMjBiMWIwNDM4YTQ2ZDM2Zjkg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWljcm9jaGlwL21pY3JvY2hpcC1p
c2MtYmFzZS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbWljcm9jaGlwL21pY3JvY2hp
cC1pc2MtYmFzZS5jCkBAIC00NzMsNyArNDczLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJf
b3BzIGlzY192YjJfb3BzID0gewogCS51bnByZXBhcmVfc3RyZWFtaW5nCT0gaXNjX3VucHJlcGFy
ZV9zdHJlYW1pbmcsCiB9OwogCi1zdGF0aWMgaW50IGlzY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXNjX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRs
Ml9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgIm1pY3JvY2hpcC1p
c2MiLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTQ4Miw3ICs0ODMsOCBAQCBzdGF0aWMgaW50
IGlzY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBpc2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXNjX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0
IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgaXNjX2RldmljZSAqaXNjID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTU0Niw3ICs1NDgsOCBAQCBzdGF0aWMgaW50IGlzY19lbnVtX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAtRUlOVkFMOwog
fQogCi1zdGF0aWMgaW50IGlzY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCBpc2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCBpc2NfZGV2aWNlICppc2MgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtOTg1LDcgKzk4OCw4IEBAIHN0YXRpYyBpbnQgaXNjX2xpbmtfdmFs
aWRhdGUoc3RydWN0IG1lZGlhX2xpbmsgKmxpbmspCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgaXNjX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IGlzY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCBpc2NfZGV2aWNlICppc2MgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtOTk2LDcgKzEwMDAsOCBAQCBzdGF0aWMgaW50IGlzY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBpc2Nfc2V0X2ZtdChpc2MsIGYpOwogfQog
Ci1zdGF0aWMgaW50IGlzY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IGlzY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBpc2NfZGV2aWNlICppc2MgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtMTAwNCw3ICsxMDA5LDggQEAgc3RhdGljIGludCBpc2NfdHJ5
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBpc2Nf
dHJ5X2ZtdChpc2MsIGYpOwogfQogCi1zdGF0aWMgaW50IGlzY19lbnVtX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBpc2NfZW51bV9pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
IHN0cnVjdCB2NGwyX2lucHV0ICppbnApCiB7CiAJaWYgKGlucC0+aW5kZXggIT0gMCkKQEAgLTEw
MTcsMTQgKzEwMjMsMTYgQEAgc3RhdGljIGludCBpc2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpc2NfZ19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGlj
IGludCBpc2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCSAgICAgICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJKmkgPSAwOwogCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXNjX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBpc2Nfc19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAg
ICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlpZiAoaSA+IDApCiAJCXJldHVybiAtRUlOVkFMOwpAQCAt
MTAzMiwyMSArMTA0MCwyNCBAQCBzdGF0aWMgaW50IGlzY19zX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBpc2NfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
c3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgaXNjX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVjdCB2NGwyX3N0
cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IGlzY19kZXZpY2UgKmlzYyA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAKIAlyZXR1cm4gdjRsMl9nX3Bhcm1fY2FwKHZpZGVvX2RldmRhdGEoZmlsZSksIGlz
Yy0+Y3VycmVudF9zdWJkZXYtPnNkLCBhKTsKIH0KIAotc3RhdGljIGludCBpc2Nfc19wYXJtKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0
YXRpYyBpbnQgaXNjX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJ
c3RydWN0IGlzY19kZXZpY2UgKmlzYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlyZXR1cm4g
djRsMl9zX3Bhcm1fY2FwKHZpZGVvX2RldmRhdGEoZmlsZSksIGlzYy0+Y3VycmVudF9zdWJkZXYt
PnNkLCBhKTsKIH0KIAotc3RhdGljIGludCBpc2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaXNjX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IGlz
Y19kZXZpY2UgKmlzYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L21lZGlhL3BsYXRmb3JtL251dm90b24vbnBjbS12aWRlby5jIGIvZHJpdmVycy9tZWRpYS9wbGF0
Zm9ybS9udXZvdG9uL25wY20tdmlkZW8uYwppbmRleCA0NGU5MDRlNjE4MDFlOGMzYjBkM2JiOGNh
ODNhZWYwYTUwZmM1OTkyLi45ZDY4MGE2MGI0ZTA4YTRhN2NhNmNiYTU0NTExY2JmN2QzOTk4Yzc4
IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL251dm90b24vbnBjbS12aWRlby5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbnV2b3Rvbi9ucGNtLXZpZGVvLmMKQEAgLTEx
MjksNyArMTEyOSw4IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBucGNtX3ZpZGVvX2lycShpbnQgaXJx
LCB2b2lkICphcmcpCiAJcmV0dXJuIElSUV9IQU5ETEVEOwogfQogCi1zdGF0aWMgaW50IG5wY21f
dmlkZW9fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBu
cGNtX3ZpZGVvX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2NhcGFiaWxp
dHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBERVZJQ0VfTkFNRSwgc2l6ZW9mKGNh
cC0+ZHJpdmVyKSk7CkBAIC0xMTM4LDcgKzExMzksOCBAQCBzdGF0aWMgaW50IG5wY21fdmlkZW9f
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IG5wY21fdmlkZW9fZW51bV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAorc3RhdGljIGludCBucGNtX3ZpZGVvX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCBucGNtX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC0xMTU1LDcgKzExNTcsOCBAQCBzdGF0aWMgaW50IG5wY21fdmlkZW9f
ZW51bV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IG5wY21fdmlkZW9fdHJ5X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCitzdGF0aWMgaW50IG5wY21fdmlkZW9fdHJ5X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbnBjbV92aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtMTE3OCw3ICsxMTgxLDggQEAgc3RhdGljIGludCBucGNtX3ZpZGVvX3Ry
eV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IG5wY21fdmlkZW9fZ2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCitzdGF0aWMgaW50IG5wY21fdmlkZW9fZ2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbnBjbV92aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMTE4NywxMyArMTE5MSwxNCBAQCBzdGF0aWMgaW50IG5wY21fdmlkZW9fZ2V0
X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgbnBjbV92aWRlb19zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKK3N0YXRpYyBpbnQgbnBjbV92aWRlb19zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCBucGNtX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAJaW50IHJldDsKIAotCXJldCA9IG5wY21fdmlkZW9fdHJ5X2Zvcm1hdChmaWxlLCBm
aCwgZik7CisJcmV0ID0gbnBjbV92aWRlb190cnlfZm9ybWF0KGZpbGUsIHN0YXRlLCBmKTsKIAlp
ZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC0xMjA2LDcgKzEyMTEsOCBAQCBzdGF0aWMgaW50
IG5wY21fdmlkZW9fc2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbnBjbV92aWRlb19lbnVtX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgbnBjbV92aWRlb19lbnVtX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkgc3RydWN0IHY0bDJfaW5wdXQgKmlucCkKIHsKIAlzdHJ1Y3QgbnBjbV92aWRlbyAqdmlkZW8g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTIyMiwxNCArMTIyOCwxOCBAQCBzdGF0aWMgaW50
IG5wY21fdmlkZW9fZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbnBjbV92aWRlb19nZXRfaW5wdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IG5wY21fdmlkZW9f
Z2V0X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJCXVuc2lnbmVkIGludCAqaSkKIHsKIAkqaSA9IDA7CiAKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBucGNtX3ZpZGVvX3NldF9pbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBucGNtX3ZpZGVvX3NldF9p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCQl1bnNpZ25lZCBpbnQgaSkKIHsKIAlpZiAoaSkKIAkJcmV0dXJuIC1FSU5WQUw7
CkBAIC0xMjM3LDcgKzEyNDcsOCBAQCBzdGF0aWMgaW50IG5wY21fdmlkZW9fc2V0X2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGkpCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgbnBjbV92aWRlb19zZXRfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG5wY21fdmlkZW9fc2V0X2R2X3RpbWluZ3Moc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCiB7CiAJc3RydWN0IG5w
Y21fdmlkZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEyNjEsNyArMTI3Miw4
IEBAIHN0YXRpYyBpbnQgbnBjbV92aWRlb19zZXRfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbnBjbV92aWRlb19nZXRf
ZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG5wY21f
dmlkZW9fZ2V0X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWlu
Z3MgKnRpbWluZ3MpCiB7CiAJc3RydWN0IG5wY21fdmlkZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTEyNzIsNyArMTI4NCw4IEBAIHN0YXRpYyBpbnQgbnBjbV92aWRlb19nZXRf
ZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgbnBjbV92aWRlb19xdWVyeV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgbnBjbV92aWRlb19xdWVyeV9kdl90aW1pbmdzKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkgICAgICAgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlzdHJ1
Y3QgbnBjbV92aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTI4NCwxNCAr
MTI5NywxNiBAQCBzdGF0aWMgaW50IG5wY21fdmlkZW9fcXVlcnlfZHZfdGltaW5ncyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIHZpZGVvLT52NGwyX2lucHV0X3N0YXR1cyA/
IC1FTk9MSU5LIDogMDsKIH0KIAotc3RhdGljIGludCBucGNtX3ZpZGVvX2VudW1fZHZfdGltaW5n
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG5wY21fdmlkZW9fZW51
bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2VudW1fZHZfdGltaW5n
cyAqdGltaW5ncykKIHsKIAlyZXR1cm4gdjRsMl9lbnVtX2R2X3RpbWluZ3NfY2FwKHRpbWluZ3Ms
ICZucGNtX3ZpZGVvX3RpbWluZ3NfY2FwLAogCQkJCQlOVUxMLCBOVUxMKTsKIH0KIAotc3RhdGlj
IGludCBucGNtX3ZpZGVvX2R2X3RpbWluZ3NfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKK3N0YXRpYyBpbnQgbnBjbV92aWRlb19kdl90aW1pbmdzX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAg
c3RydWN0IHY0bDJfZHZfdGltaW5nc19jYXAgKmNhcCkKIHsKIAkqY2FwID0gbnBjbV92aWRlb190
aW1pbmdzX2NhcDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbnZpZGlhL3Rl
Z3JhLXZkZS92NGwyLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL252aWRpYS90ZWdyYS12ZGUv
djRsMi5jCmluZGV4IGQ5NDk3OGFlMmJhZjMzOTQyMDZhZDdjM2ViN2E0MDBhZWVlNDdjZjcuLjdl
OTYwNDNmMGE4MDQzODcyYzcyZjc3Y2NlMDk1NTYyMmUwYjhlMGYgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvbWVkaWEvcGxhdGZvcm0vbnZpZGlhL3RlZ3JhLXZkZS92NGwyLmMKKysrIGIvZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS9udmlkaWEvdGVncmEtdmRlL3Y0bDIuYwpAQCAtNDkzLDcgKzQ5Myw4IEBA
IHN0YXRpYyB2b2lkIHRlZ3JhX2RlY29kZV9jb21wbGV0ZShzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndv
cmspCiAJCXRlZ3JhX2pvYl9maW5pc2goY3R4LCBWQjJfQlVGX1NUQVRFX0RPTkUpOwogfQogCi1z
dGF0aWMgaW50IHRlZ3JhX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCB0ZWdyYV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkg
KmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+YnVzX2luZm8sICJwbGF0Zm9ybTp0ZWdyYS12ZGUiLCBz
aXplb2YoY2FwLT5idXNfaW5mbykpOwpAQCAtNTAzLDcgKzUwNCw4IEBAIHN0YXRpYyBpbnQgdGVn
cmFfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdGVncmFfZW51bV9kZWNvZGVkX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdGVncmFfZW51bV9kZWNvZGVkX2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAg
c3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgdGVncmFfY3R4ICpjdHggPSBmaWxl
X3RvX3RlZ3JhX2N0eChmaWxlKTsKQEAgLTUxOSw3ICs1MjEsOCBAQCBzdGF0aWMgaW50IHRlZ3Jh
X2VudW1fZGVjb2RlZF9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdGVncmFfZ19kZWNvZGVkX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdGVncmFfZ19kZWNvZGVkX2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHRlZ3JhX2N0eCAqY3R4
ID0gZmlsZV90b190ZWdyYV9jdHgoZmlsZSk7CkBAIC01MjgsNyArNTMxLDggQEAgc3RhdGljIGlu
dCB0ZWdyYV9nX2RlY29kZWRfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX3RyeV9kZWNvZGVkX2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdGVncmFfdHJ5X2RlY29kZWRfZm10KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB0ZWdyYV9jdHggKmN0eCA9
IGZpbGVfdG9fdGVncmFfY3R4KGZpbGUpOwpAQCAtNTY4LDcgKzU3Miw4IEBAIHN0YXRpYyBpbnQg
dGVncmFfdHJ5X2RlY29kZWRfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX3NfZGVjb2RlZF9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHRlZ3JhX3NfZGVjb2RlZF9mbXQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB0ZWdyYV9jdHgg
KmN0eCA9IGZpbGVfdG9fdGVncmFfY3R4KGZpbGUpOwpAQCAtNTgxLDcgKzU4Niw3IEBAIHN0YXRp
YyBpbnQgdGVncmFfc19kZWNvZGVkX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlpZiAodmIyX2lzX2J1c3kodnEpKQogCQlyZXR1cm4gLUVCVVNZOwogCi0JZXJyID0gdGVncmFf
dHJ5X2RlY29kZWRfZm10KGZpbGUsIHByaXYsIGYpOworCWVyciA9IHRlZ3JhX3RyeV9kZWNvZGVk
X2ZtdChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIApAQCAtNTkw
LDcgKzU5NSw4IEBAIHN0YXRpYyBpbnQgdGVncmFfc19kZWNvZGVkX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0ZWdyYV9lbnVt
X2NvZGVkX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdGVn
cmFfZW51bV9jb2RlZF9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1
Y3QgdGVncmFfY3R4ICpjdHggPSBmaWxlX3RvX3RlZ3JhX2N0eChmaWxlKTsKQEAgLTYwNCw3ICs2
MTAsOCBAQCBzdGF0aWMgaW50IHRlZ3JhX2VudW1fY29kZWRfZm10KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX2dfY29kZWRf
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0ZWdyYV9nX2Nv
ZGVkX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
dGVncmFfY3R4ICpjdHggPSBmaWxlX3RvX3RlZ3JhX2N0eChmaWxlKTsKQEAgLTYyNyw3ICs2MzQs
OCBAQCB0ZWdyYV9maW5kX2NvZGVkX2ZtdF9kZXNjKHN0cnVjdCB0ZWdyYV9jdHggKmN0eCwgdTMy
IGZvdXJjYykKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGljIGludCB0ZWdyYV90cnlfY29kZWRf
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0ZWdyYV90cnlf
Y29kZWRfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgdjRsMl9waXhfZm9ybWF0X21wbGFuZSAqcGl4X21wID0gJmYtPmZtdC5waXhfbXA7CkBA
IC02NTMsNyArNjYxLDggQEAgc3RhdGljIGludCB0ZWdyYV90cnlfY29kZWRfZm10KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRlZ3Jh
X3NfY29kZWRfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0
ZWdyYV9zX2NvZGVkX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlzdHJ1Y3QgdGVncmFfY3R4ICpjdHggPSBmaWxlX3RvX3RlZ3JhX2N0eChmaWxlKTsKQEAgLTY4
Myw3ICs2OTIsNyBAQCBzdGF0aWMgaW50IHRlZ3JhX3NfY29kZWRfZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCWlmICh2YjJfaXNfYnVzeShwZWVyX3ZxKSkKIAkJcmV0dXJuIC1F
QlVTWTsKIAotCWVyciA9IHRlZ3JhX3RyeV9jb2RlZF9mbXQoZmlsZSwgcHJpdiwgZik7CisJZXJy
ID0gdGVncmFfdHJ5X2NvZGVkX2ZtdChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKGVycikKIAkJcmV0
dXJuIGVycjsKIApAQCAtNzE1LDcgKzcyNCw4IEBAIHN0YXRpYyBpbnQgdGVncmFfc19jb2RlZF9m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdGVncmFfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB0ZWdyYV9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9m
cm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IHRlZ3JhX2N0eCAqY3R4ID0gZmlsZV90b190
ZWdyYV9jdHgoZmlsZSk7CkBAIC04MzUsMTAgKzg0NSwxMCBAQCBzdGF0aWMgaW50IHRlZ3JhX29w
ZW4oc3RydWN0IGZpbGUgKmZpbGUpCiAJdjRsMl9maF9hZGQoJmN0eC0+ZmgsIGZpbGUpOwogCiAJ
dGVncmFfcmVzZXRfY29kZWRfZm10KGN0eCk7Ci0JdGVncmFfdHJ5X2NvZGVkX2ZtdChmaWxlLCAm
Y3R4LT5maCwgJmN0eC0+Y29kZWRfZm10KTsKKwl0ZWdyYV90cnlfY29kZWRfZm10KGZpbGUsIGN0
eC0+Zmguc3RhdGUsICZjdHgtPmNvZGVkX2ZtdCk7CiAKIAl0ZWdyYV9yZXNldF9kZWNvZGVkX2Zt
dChjdHgpOwotCXRlZ3JhX3RyeV9kZWNvZGVkX2ZtdChmaWxlLCAmY3R4LT5maCwgJmN0eC0+ZGVj
b2RlZF9mbXQpOworCXRlZ3JhX3RyeV9kZWNvZGVkX2ZtdChmaWxlLCBjdHgtPmZoLnN0YXRlLCAm
Y3R4LT5kZWNvZGVkX2ZtdCk7CiAKIAlyZXR1cm4gMDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS9ueHAvZHcxMDAvZHcxMDAuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
bnhwL2R3MTAwL2R3MTAwLmMKaW5kZXggOTc3NDRjN2I3YzAzNGNhZGZkZDNmNmQ3NjE2NWI0ZGE4
NWZhM2QxNi4uN2YxMjdmMGRiZTE2MjI3OTk0OTk4ZDM1NWEyMjEyNWQ1OGUxMzljOCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvZHcxMDAvZHcxMDAuYworKysgYi9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL254cC9kdzEwMC9kdzEwMC5jCkBAIC02ODYsNyArNjg2LDggQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVfb3BlcmF0aW9ucyBkdzEwMF9mb3BzID0gewog
CS5tbWFwCQk9IHY0bDJfbTJtX2ZvcF9tbWFwLAogfTsKIAotc3RhdGljIGludCBkdzEwMF9xdWVy
eWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZHcxMDBfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShj
YXAtPmRyaXZlciwgRFJWX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtNjk1LDcgKzY5
Niw4IEBAIHN0YXRpYyBpbnQgZHcxMDBfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZHcxMDBfZW51bV9mbXRfdmlkKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBkdzEwMF9lbnVtX2ZtdF92
aWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaW50IGksIG51
bSA9IDA7CkBAIC03MTMsNyArNzE1LDggQEAgc3RhdGljIGludCBkdzEwMF9lbnVtX2ZtdF92aWQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0
YXRpYyBpbnQgZHcxMDBfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCBkdzEwMF9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRs
Ml9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJY29uc3Qgc3RydWN0IGR3MTAwX2ZtdCAqZm10OwpA
QCAtNzMyLDcgKzczNSw5IEBAIHN0YXRpYyBpbnQgZHcxMDBfZW51bV9mcmFtZXNpemVzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGR3
MTAwX2dfZm10X3ZpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQorc3RhdGljIGludCBkdzEwMF9nX2ZtdF92aWQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZHcxMDBfY3R4ICpjdHggPSBkdzEwMF9maWxlMmN0
eChmaWxlKTsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsKQEAgLTg2MSw3ICs4NjYsOCBAQCBzdGF0
aWMgaW50IGR3MTAwX3NfZm10KHN0cnVjdCBkdzEwMF9jdHggKmN0eCwgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGR3MTAwX3RyeV9mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZHcxMDBfdHJ5X2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCWlmIChmLT50eXBl
ICE9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRV9NUExBTkUpCkBAIC04NzAsMTMgKzg3Niwx
NCBAQCBzdGF0aWMgaW50IGR3MTAwX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gZHcxMDBfdHJ5X2ZtdChmaWxlLCBmKTsKIH0KIAotc3RhdGlj
IGludCBkdzEwMF9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCBkdzEwMF9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZHcxMDBfY3R4ICpjdHggPSBkdzEwMF9maWxlMmN0
eChmaWxlKTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gZHcxMDBfdHJ5X2ZtdF92aWRfY2FwKGZpbGUs
IHByaXYsIGYpOworCXJldCA9IGR3MTAwX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7
CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtODg3LDcgKzg5NCw4IEBAIHN0YXRpYyBp
bnQgZHcxMDBfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkdzEwMF90cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGR3MTAwX3RyeV9mbXRfdmlkX291dChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlpZiAoZi0+dHlwZSAhPSBWNEwyX0JV
Rl9UWVBFX1ZJREVPX09VVFBVVF9NUExBTkUpCkBAIC04OTYsMTMgKzkwNCwxNCBAQCBzdGF0aWMg
aW50IGR3MTAwX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gZHcxMDBfdHJ5X2ZtdChmaWxlLCBmKTsKIH0KIAotc3RhdGljIGludCBkdzEwMF9z
X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBk
dzEwMF9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgZHcxMDBfY3R4ICpjdHggPSBkdzEwMF9maWxlMmN0eChmaWxlKTsKIAlp
bnQgcmV0OwogCi0JcmV0ID0gZHcxMDBfdHJ5X2ZtdF92aWRfb3V0KGZpbGUsIHByaXYsIGYpOwor
CXJldCA9IGR3MTAwX3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKIApAQCAtOTEzLDcgKzkyMiw4IEBAIHN0YXRpYyBpbnQgZHcxMDBfc19m
bXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBkdzEwMF9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCitzdGF0aWMgaW50IGR3MTAwX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0
bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0IGR3MTAwX2N0eCAqY3R4ID0gZHcxMDBfZmls
ZTJjdHgoZmlsZSk7CkBAIC05NDUsNyArOTU1LDggQEAgc3RhdGljIGludCBkdzEwMF9nX3NlbGVj
dGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgZHcxMDBfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3Rh
dGljIGludCBkdzEwMF9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX3NlbGVj
dGlvbiAqc2VsKQogewogCXN0cnVjdCBkdzEwMF9jdHggKmN0eCA9IGR3MTAwX2ZpbGUyY3R4KGZp
bGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvaW14LWpwZWcvbXhj
LWpwZWcuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbnhwL2lteC1qcGVnL214Yy1qcGVnLmMK
aW5kZXggZGYzY2NkZjc2N2JhZjBiZjY2ODc4MDhlMmMwMTcwNjMxODFhNzIyMC4uYzRjY2ExZjlk
YWJkMDNhYzM0YTkzNWIxYmM4YjViYzliN2IxZjQ5MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9ueHAvaW14LWpwZWcvbXhjLWpwZWcuYworKysgYi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL254cC9pbXgtanBlZy9teGMtanBlZy5jCkBAIC0xNjAxLDcgKzE2MDEsOCBAQCBzdGF0
aWMgdm9pZCBteGNfanBlZ19kZXZpY2VfcnVuKHZvaWQgKnByaXYpCiAJc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmY3R4LT5teGNfanBlZy0+aHdfbG9jaywgZmxhZ3MpOwogfQogCi1zdGF0aWMgaW50
IG14Y19qcGVnX2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCBteGNfanBlZ19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9kZWNvZGVyX2Nt
ZCAqY21kKQogewogCXN0cnVjdCB2NGwyX2ZoICpmaCA9IGZpbGVfdG9fdjRsMl9maChmaWxlKTsK
QEAgLTE2MDksNyArMTYxMCw3IEBAIHN0YXRpYyBpbnQgbXhjX2pwZWdfZGVjb2Rlcl9jbWQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJdW5zaWduZWQgbG9uZyBmbGFnczsKIAlpbnQg
cmV0OwogCi0JcmV0ID0gdjRsMl9tMm1faW9jdGxfdHJ5X2RlY29kZXJfY21kKGZpbGUsIGZoLCBj
bWQpOworCXJldCA9IHY0bDJfbTJtX2lvY3RsX3RyeV9kZWNvZGVyX2NtZChmaWxlLCBzdGF0ZSwg
Y21kKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTYxNyw3ICsxNjE4LDcg
QEAgc3RhdGljIGludCBteGNfanBlZ19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAkJcmV0dXJuIDA7CiAKIAlzcGluX2xvY2tfaXJxc2F2ZSgmY3R4LT5teGNfanBl
Zy0+aHdfbG9jaywgZmxhZ3MpOwotCXJldCA9IHY0bDJfbTJtX2lvY3RsX2RlY29kZXJfY21kKGZp
bGUsIHByaXYsIGNtZCk7CisJcmV0ID0gdjRsMl9tMm1faW9jdGxfZGVjb2Rlcl9jbWQoZmlsZSwg
c3RhdGUsIGNtZCk7CiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmY3R4LT5teGNfanBlZy0+aHdf
bG9jaywgZmxhZ3MpOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4gcmV0OwpAQCAtMTYzNCw3ICsx
NjM1LDggQEAgc3RhdGljIGludCBteGNfanBlZ19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBteGNfanBlZ19lbmNv
ZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXhjX2pw
ZWdfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmNtZCkKIHsKIAlz
dHJ1Y3QgdjRsMl9maCAqZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CkBAIC0xNjQyLDcgKzE2
NDQsNyBAQCBzdGF0aWMgaW50IG14Y19qcGVnX2VuY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CiAJaW50IHJldDsKIAotCXJldCA9
IHY0bDJfbTJtX2lvY3RsX3RyeV9lbmNvZGVyX2NtZChmaWxlLCBmaCwgY21kKTsKKwlyZXQgPSB2
NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rlcl9jbWQoZmlsZSwgc3RhdGUsIGNtZCk7CiAJaWYgKHJl
dCA8IDApCiAJCXJldHVybiByZXQ7CiAKQEAgLTE2NTEsNyArMTY1Myw3IEBAIHN0YXRpYyBpbnQg
bXhjX2pwZWdfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCXJl
dHVybiAwOwogCiAJc3Bpbl9sb2NrX2lycXNhdmUoJmN0eC0+bXhjX2pwZWctPmh3X2xvY2ssIGZs
YWdzKTsKLQlyZXQgPSB2NGwyX20ybV9pb2N0bF9lbmNvZGVyX2NtZChmaWxlLCBmaCwgY21kKTsK
KwlyZXQgPSB2NGwyX20ybV9pb2N0bF9lbmNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgY21kKTsKIAlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZjdHgtPm14Y19qcGVnLT5od19sb2NrLCBmbGFncyk7CiAJ
aWYgKHJldCA8IDApCiAJCXJldHVybiAwOwpAQCAtMjI0MSw3ICsyMjQzLDggQEAgc3RhdGljIGlu
dCBteGNfanBlZ19vcGVuKHN0cnVjdCBmaWxlICpmaWxlKQogCXJldHVybiByZXQ7CiB9CiAKLXN0
YXRpYyBpbnQgbXhjX2pwZWdfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IG14Y19qcGVnX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJf
Y2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIE1YQ19KUEVHX05BTUUg
IiBjb2RlYyIsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMjI1Miw3ICsyMjU1LDggQEAgc3Rh
dGljIGludCBteGNfanBlZ19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBteGNfanBlZ19lbnVtX2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBteGNfanBlZ19lbnVtX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0
cnVjdCBteGNfanBlZ19jdHggKmN0eCA9IG14Y19qcGVnX2ZpbGVfdG9fY3R4KGZpbGUpOwpAQCAt
MjI5Miw3ICsyMjk2LDggQEAgc3RhdGljIGludCBteGNfanBlZ19lbnVtX2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCX0KIH0KIAotc3RhdGljIGludCBteGNfanBl
Z19lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBteGNfanBlZ19lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRs
Ml9mbXRkZXNjICpmKQogewogCXN0cnVjdCBteGNfanBlZ19jdHggKmN0eCA9IG14Y19qcGVnX2Zp
bGVfdG9fY3R4KGZpbGUpOwpAQCAtMjQzMyw3ICsyNDM4LDggQEAgc3RhdGljIGludCBteGNfanBl
Z190cnlfZm10KHN0cnVjdCB2NGwyX2Zvcm1hdCAqZiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBteGNfanBlZ190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IG14Y19qcGVnX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbXhjX2pwZWdfY3R4ICpjdHggPSBteGNf
anBlZ19maWxlX3RvX2N0eChmaWxlKTsKQEAgLTI0NTIsNyArMjQ1OCw4IEBAIHN0YXRpYyBpbnQg
bXhjX2pwZWdfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiBteGNfanBlZ190cnlfZm10KGYsIGN0eCwgJnRtcF9xKTsKIH0KIAotc3RhdGljIGlu
dCBteGNfanBlZ190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IG14Y19qcGVnX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbXhjX2pwZWdfY3R4ICpjdHggPSBteGNfanBl
Z19maWxlX3RvX2N0eChmaWxlKTsKQEAgLTI1MDQsMTMgKzI1MTEsMTUgQEAgc3RhdGljIGludCBt
eGNfanBlZ19zX2ZtdChzdHJ1Y3QgbXhjX2pwZWdfY3R4ICpjdHgsCiAJcmV0dXJuIG14Y19qcGVn
X3RyeV9mbXQoZiwgY3R4LCBteGNfanBlZ19nZXRfcV9kYXRhKGN0eCwgZi0+dHlwZSkpOwogfQog
Ci1zdGF0aWMgaW50IG14Y19qcGVnX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IG14Y19qcGVnX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlyZXR1cm4gbXhjX2pwZWdfc19mbXQobXhjX2pwZWdf
ZmlsZV90b19jdHgoZmlsZSksIGYpOwogfQogCi1zdGF0aWMgaW50IG14Y19qcGVnX3NfZm10X3Zp
ZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG14Y19qcGVn
X3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlpbnQg
cmV0OwpAQCAtMjU0MywxMCArMjU1MiwxMSBAQCBzdGF0aWMgaW50IG14Y19qcGVnX3NfZm10X3Zp
ZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJZmMuZm10LnBpeF9tcC53aWR0
aCA9IGYtPmZtdC5waXhfbXAud2lkdGg7CiAJZmMuZm10LnBpeF9tcC5oZWlnaHQgPSBmLT5mbXQu
cGl4X21wLmhlaWdodDsKIAotCXJldHVybiBteGNfanBlZ19zX2ZtdF92aWRfY2FwKGZpbGUsIHBy
aXYsICZmYyk7CisJcmV0dXJuIG14Y19qcGVnX3NfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsICZm
Yyk7CiB9CiAKLXN0YXRpYyBpbnQgbXhjX2pwZWdfZ19mbXRfdmlkKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBteGNfanBlZ19nX2ZtdF92aWQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
ICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbXhjX2pwZWdfY3R4ICpjdHgg
PSBteGNfanBlZ19maWxlX3RvX2N0eChmaWxlKTsKQEAgLTI2NDIsMTcgKzI2NTIsMjEgQEAgc3Rh
dGljIGludCBteGNfanBlZ19lbmNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9zZWwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBteGNfanBl
Z19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3Nl
bGVjdGlvbiAqcykKK3N0YXRpYyBpbnQgbXhjX2pwZWdfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0
IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBteGNfanBlZ19jdHggKmN0eCA9IG14Y19q
cGVnX2ZpbGVfdG9fY3R4KGZpbGUpOwogCiAJaWYgKGN0eC0+bXhjX2pwZWctPm1vZGUgPT0gTVhD
X0pQRUdfREVDT0RFKQotCQlyZXR1cm4gbXhjX2pwZWdfZGVjX2dfc2VsZWN0aW9uKGZpbGUsIGZo
LCBzKTsKKwkJcmV0dXJuIG14Y19qcGVnX2RlY19nX3NlbGVjdGlvbihmaWxlLCBzdGF0ZSwgcyk7
CiAJZWxzZQotCQlyZXR1cm4gbXhjX2pwZWdfZW5jX2dfc2VsZWN0aW9uKGZpbGUsIGZoLCBzKTsK
KwkJcmV0dXJuIG14Y19qcGVnX2VuY19nX3NlbGVjdGlvbihmaWxlLCBzdGF0ZSwgcyk7CiB9CiAK
LXN0YXRpYyBpbnQgbXhjX2pwZWdfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCitzdGF0aWMgaW50IG14Y19qcGVnX3Nfc2Vs
ZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgbXhjX2pw
ZWdfY3R4ICpjdHggPSBteGNfanBlZ19maWxlX3RvX2N0eChmaWxlKTsKIAlzdHJ1Y3QgbXhjX2pw
ZWdfcV9kYXRhICpxX2RhdGFfb3V0OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9y
bS9ueHAvaW14LXB4cC5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvaW14LXB4cC5jCmlu
ZGV4IDZjYzliMDdlYTUzYTAwMmMyZWRhMGZkNjA2MjA5NmY1NTI3YWQ2MmMuLmVkNDgwYTYzZWFl
MDcxYWRkZmExNGY1MTBiODY3Y2VhOWQwNTgzOTYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEv
cGxhdGZvcm0vbnhwL2lteC1weHAuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL254cC9p
bXgtcHhwLmMKQEAgLTExMjcsNyArMTEyNyw4IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBweHBfaXJx
X2hhbmRsZXIoaW50IGlycSwgdm9pZCAqZGV2X2lkKQogLyoKICAqIHZpZGVvIGlvY3RscwogICov
Ci1zdGF0aWMgaW50IHB4cF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgcHhwX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgTUVNMk1FTV9OQU1FLCBzaXplb2YoY2FwLT5k
cml2ZXIpKTsKQEAgLTExNjYsMTMgKzExNjcsMTUgQEAgc3RhdGljIGludCBweHBfZW51bV9mbXQo
c3RydWN0IHY0bDJfZm10ZGVzYyAqZiwgdTMyIHR5cGUpCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAK
LXN0YXRpYyBpbnQgcHhwX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHB4cF9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwy
X2ZtdGRlc2MgKmYpCiB7CiAJcmV0dXJuIHB4cF9lbnVtX2ZtdChmLCBNRU0yTUVNX0NBUFRVUkUp
OwogfQogCi1zdGF0aWMgaW50IHB4cF9lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBweHBfZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1
Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXJldHVybiBweHBfZW51bV9mbXQoZiwgTUVNMk1FTV9P
VVRQVVQpOwpAQCAtMTIwMywxMyArMTIwNiwxNSBAQCBzdGF0aWMgaW50IHB4cF9nX2ZtdChzdHJ1
Y3QgcHhwX2N0eCAqY3R4LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgcHhwX2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IHB4cF9nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJcmV0dXJuIHB4cF9nX2ZtdChmaWxlMmN0eChmaWxlKSwgZik7CiB9CiAK
LXN0YXRpYyBpbnQgcHhwX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IHB4cF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJcmV0dXJuIHB4cF9nX2ZtdChmaWxlMmN0eChmaWxlKSwgZik7CkBAIC0x
MjcxLDcgKzEyNzYsOCBAQCBweHBfZml4dXBfY29sb3JpbWV0cnlfY2FwKHN0cnVjdCBweHBfY3R4
ICpjdHgsIHUzMiBkc3RfZm91cmNjLAogCX0KIH0KIAotc3RhdGljIGludCBweHBfdHJ5X2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBweHBfdHJ5
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlzdHJ1Y3QgcHhwX2ZtdCAqZm10OwpAQCAtMTI5OSw3ICsxMzA1LDggQEAgc3RhdGljIGludCBw
eHBfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biBweHBfdHJ5X2ZtdChmLCBmbXQpOwogfQogCi1zdGF0aWMgaW50IHB4cF90cnlfZm10X3ZpZF9v
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHB4cF90cnlfZm10
X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0
cnVjdCBweHBfZm10ICpmbXQ7CkBAIC0xMzU0LDEzICsxMzYxLDE0IEBAIHN0YXRpYyBpbnQgcHhw
X3NfZm10KHN0cnVjdCBweHBfY3R4ICpjdHgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCBweHBfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcHhwX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAg
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHB4cF9jdHggKmN0eCA9IGZpbGUy
Y3R4KGZpbGUpOwogCWludCByZXQ7CiAKLQlyZXQgPSBweHBfdHJ5X2ZtdF92aWRfY2FwKGZpbGUs
IHByaXYsIGYpOworCXJldCA9IHB4cF90cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwog
CWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTEzNzQsMTMgKzEzODIsMTQgQEAgc3RhdGlj
IGludCBweHBfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBweHBfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcHhwX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
ICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHB4cF9jdHggKmN0eCA9IGZp
bGUyY3R4KGZpbGUpOwogCWludCByZXQ7CiAKLQlyZXQgPSBweHBfdHJ5X2ZtdF92aWRfb3V0KGZp
bGUsIHByaXYsIGYpOworCXJldCA9IHB4cF90cnlfZm10X3ZpZF9vdXQoZmlsZSwgc3RhdGUsIGYp
OwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTE0MDAsNyArMTQwOSw4IEBAIHN0YXRp
YyBpbnQgcHhwX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcHhwX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHB4cF9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgICAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCWlmIChmc2l6
ZS0+aW5kZXggPiAwKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvaW14
Ny1tZWRpYS1jc2kuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbnhwL2lteDctbWVkaWEtY3Np
LmMKaW5kZXggMzRhOTI2NDJiYmZlN2I3Y2U5Yzg1ZmJhZjM0NmM2ZjU5NTQyNWNjOS4uNDQ2NjRj
NDhkNzcwNjAxYThiZWQ0YTc2YTU0N2FjMzc3ZTMzNjA2NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS9ueHAvaW14Ny1tZWRpYS1jc2kuYworKysgYi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL254cC9pbXg3LW1lZGlhLWNzaS5jCkBAIC0xMDM1LDcgKzEwMzUsOCBAQCBzdGF0aWMg
aW50IGlteDdfY3NpX2VudW1fbWJ1c19mb3JtYXRzKHUzMiAqY29kZSwgdTMyIGluZGV4KQogICog
VmlkZW8gQ2FwdHVyZSBEZXZpY2UgLSBJT0NUTHMKICAqLwogCi1zdGF0aWMgaW50IGlteDdfY3Np
X3ZpZGVvX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
aW14N19jc2lfdmlkZW9fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0
eSAqY2FwKQogewogCXN0cnVjdCBpbXg3X2NzaSAqY3NpID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTEwNDgsNyArMTA0OSw4IEBAIHN0YXRpYyBpbnQgaW14N19jc2lfdmlkZW9fcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGlteDdfY3NpX3ZpZGVvX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAorc3RhdGljIGludCBpbXg3X2NzaV92aWRlb19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAl1bnNpZ25lZCBpbnQgaW5kZXggPSBm
LT5pbmRleDsKQEAgLTEwODcsNyArMTA4OSw4IEBAIHN0YXRpYyBpbnQgaW14N19jc2lfdmlkZW9f
ZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIC1F
SU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgaW14N19jc2lfdmlkZW9fZW51bV9mcmFtZXNpemVzKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaW14N19jc2lfdmlkZW9fZW51
bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkK
IHsKIAljb25zdCBzdHJ1Y3QgaW14N19jc2lfcGl4Zm10ICpjYzsKQEAgLTExMTcsNyArMTEyMCw4
IEBAIHN0YXRpYyBpbnQgaW14N19jc2lfdmlkZW9fZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpbXg3X2NzaV92
aWRlb19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBp
bnQgaW14N19jc2lfdmlkZW9fZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJ
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgaW14N19jc2kgKmNzaSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xMTY3LDE0ICsxMTcxLDE2IEBAIF9faW14N19jc2lfdmlkZW9fdHJ5X2ZtdChzdHJ1Y3QgdjRs
Ml9waXhfZm9ybWF0ICpwaXhmbXQsCiAJcmV0dXJuIGNjOwogfQogCi1zdGF0aWMgaW50IGlteDdf
Y3NpX3ZpZGVvX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitz
dGF0aWMgaW50IGlteDdfY3NpX3ZpZGVvX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJX19pbXg3X2NzaV92aWRlb190cnlfZm10KCZmLT5mbXQu
cGl4LCBOVUxMKTsKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpbXg3X2NzaV92aWRlb19z
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaW14
N19jc2lfdmlkZW9fc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IHsKIAlzdHJ1Y3QgaW14N19jc2kgKmNzaSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTkz
LDcgKzExOTksOCBAQCBzdGF0aWMgaW50IGlteDdfY3NpX3ZpZGVvX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGlt
eDdfY3NpX3ZpZGVvX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0
YXRpYyBpbnQgaW14N19jc2lfdmlkZW9fZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3Ry
dWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBpbXg3X2NzaSAqY3NpID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbnhwL2lt
eDgtaXNpL2lteDgtaXNpLW0ybS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvaW14OC1p
c2kvaW14OC1pc2ktbTJtLmMKaW5kZXggMDBhZmNiZmJkZGU0ODQwMTQ1YTJjZWM4YWNiYWZlYTYw
NGNlMmYwZS4uZDQ0N2I3NTJkNmYxOGQ0MTYwMmIyMjgwNmExN2M2NzM2NmFlMzQ2YiAxMDA2NDQK
LS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvaW14OC1pc2kvaW14OC1pc2ktbTJtLmMK
KysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvaW14OC1pc2kvaW14OC1pc2ktbTJtLmMK
QEAgLTQ3Myw3ICs0NzMsOCBAQCBzdGF0aWMgdm9pZCBteGNfaXNpX20ybV9jdHhfY3RybHNfZGVs
ZXRlKHN0cnVjdCBteGNfaXNpX20ybV9jdHggKmN0eCkKICAqIFY0TDIgaW9jdGxzCiAgKi8KIAot
c3RhdGljIGludCBteGNfaXNpX20ybV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCitzdGF0aWMgaW50IG14Y19pc2lfbTJtX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Nh
cGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBNWENfSVNJX0RSSVZFUl9O
QU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTQ4NCw3ICs0ODUsOCBAQCBzdGF0aWMgaW50
IG14Y19pc2lfbTJtX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCBteGNfaXNpX20ybV9lbnVtX2ZtdF92aWQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBteGNfaXNpX20ybV9lbnVtX2ZtdF92aWQo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWNvbnN0IGVudW0gbXhj
X2lzaV92aWRlb190eXBlIHR5cGUgPQpAQCAtNTE3LDcgKzUxOSw4IEBAIF9fbXhjX2lzaV9tMm1f
dHJ5X2ZtdF92aWQoc3RydWN0IG14Y19pc2lfbTJtX2N0eCAqY3R4LAogCXJldHVybiBteGNfaXNp
X2Zvcm1hdF90cnkoY3R4LT5tMm0tPnBpcGUsIHBpeCwgdHlwZSk7CiB9CiAKLXN0YXRpYyBpbnQg
bXhjX2lzaV9tMm1fdHJ5X2ZtdF92aWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3Rh
dGljIGludCBteGNfaXNpX20ybV90cnlfZm10X3ZpZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJY29uc3QgZW51bSBteGNfaXNpX3ZpZGVvX3R5cGUgdHlwZSA9CkBAIC01
MzAsNyArNTMzLDggQEAgc3RhdGljIGludCBteGNfaXNpX20ybV90cnlfZm10X3ZpZChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXhjX2lz
aV9tMm1fZ19mbXRfdmlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
bXhjX2lzaV9tMm1fZ19mbXRfdmlkKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CXN0cnVjdCBteGNfaXNpX20ybV9jdHggKmN0eCA9IGZpbGVfdG9faXNpX20ybV9jdHgoZmlsZSk7
CkBAIC01NDIsNyArNTQ2LDggQEAgc3RhdGljIGludCBteGNfaXNpX20ybV9nX2ZtdF92aWQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG14
Y19pc2lfbTJtX3NfZm10X3ZpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMg
aW50IG14Y19pc2lfbTJtX3NfZm10X3ZpZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IHsKIAljb25zdCBlbnVtIG14Y19pc2lfdmlkZW9fdHlwZSB0eXBlID0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvcGxhdGZvcm0vbnhwL2lteDgtaXNpL2lteDgtaXNpLXZpZGVvLmMgYi9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL254cC9pbXg4LWlzaS9pbXg4LWlzaS12aWRlby5jCmluZGV4IDEz
NjgyYmY2ZTlmODg5NWJiOWViMWY5MmQ1Zjc0YjBkNTk2ODU0NGUuLmU4ZmFmZDE1OTMwNTY0YzBk
ODFkNTc5Njc0Yzg3ZmYzOGJjOGVkYmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZv
cm0vbnhwL2lteDgtaXNpL2lteDgtaXNpLXZpZGVvLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0
Zm9ybS9ueHAvaW14OC1pc2kvaW14OC1pc2ktdmlkZW8uYwpAQCAtMTExNCw3ICsxMTE0LDggQEAg
c3RhdGljIHZvaWQgbXhjX2lzaV92aWRlb19jdHJsc19kZWxldGUoc3RydWN0IG14Y19pc2lfdmlk
ZW8gKnZpZGVvKQogICogVjRMMiBpb2N0bHMKICAqLwogCi1zdGF0aWMgaW50IG14Y19pc2lfdmlk
ZW9fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG14
Y19pc2lfdmlkZW9fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNh
cCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBNWENfSVNJX0RSSVZFUl9OQU1FLCBzaXplb2Yo
Y2FwLT5kcml2ZXIpKTsKQEAgLTExMjMsNyArMTEyNCw4IEBAIHN0YXRpYyBpbnQgbXhjX2lzaV92
aWRlb19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBteGNfaXNpX3ZpZGVvX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBteGNfaXNpX3ZpZGVvX2VudW1fZm10KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWNvbnN0IHN0cnVjdCBteGNfaXNpX2Zvcm1h
dF9pbmZvICpmbXQ7CkBAIC0xMTYzLDcgKzExNjUsOCBAQCBzdGF0aWMgaW50IG14Y19pc2lfdmlk
ZW9fZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgbXhjX2lzaV92aWRlb19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCitzdGF0aWMgaW50IG14Y19pc2lfdmlkZW9fZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBteGNfaXNpX3ZpZGVvICp2aWRlbyA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTczLDcgKzExNzYsOCBAQCBzdGF0aWMgaW50IG14
Y19pc2lfdmlkZW9fZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IG14Y19pc2lfdmlkZW9fdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IG14Y19pc2lfdmlkZW9fdHJ5X2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgbXhjX2lzaV92aWRlbyAqdmlkZW8gPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTE4Miw3ICsxMTg2LDggQEAgc3RhdGljIGludCBteGNf
aXNpX3ZpZGVvX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IG14Y19pc2lfdmlkZW9fc19mbXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG14Y19pc2lfdmlkZW9fc19mbXQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBteGNfaXNpX3ZpZGVvICp2
aWRlbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTk3LDcgKzEyMDIsOCBAQCBzdGF0aWMg
aW50IG14Y19pc2lfdmlkZW9fc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXhjX2lzaV92aWRlb19lbnVtX2ZyYW1lc2l6ZXMo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG14Y19pc2lfdmlkZW9f
ZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUp
CiB7CiAJc3RydWN0IG14Y19pc2lfdmlkZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbnhwL214Ml9lbW1hcHJwLmMgYi9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL254cC9teDJfZW1tYXBycC5jCmluZGV4IDNhYWU4YzBiNjkw
YzBiMWIwZGQ0ZjA1YTFjOTE4NGIwODk3MTlhMjAuLjlmZWM2MDIxMGEwODgxMTAxNDcyNDY4NjVm
ZTlkODQ0YzdjYjVkNDQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vbnhwL214
Ml9lbW1hcHJwLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9ueHAvbXgyX2VtbWFwcnAu
YwpAQCAtMzgwLDcgKzM4MCw4IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBlbW1hcHJwX2lycShpbnQg
aXJxX2VtbWEsIHZvaWQgKmRhdGEpCiAvKgogICogdmlkZW8gaW9jdGxzCiAgKi8KLXN0YXRpYyBp
bnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNh
cCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBNRU0yTUVNX05BTUUsIHNpemVvZihjYXAtPmRy
aXZlcikpOwpAQCAtNDE3LDEzICs0MTgsMTUgQEAgc3RhdGljIGludCBlbnVtX2ZtdChzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmLCB1MzIgdHlwZSkKIAlyZXR1cm4gLUVJTlZBTDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0
IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlyZXR1cm4gZW51bV9mbXQoZiwgTUVNMk1FTV9DQVBUVVJF
KTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9vdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlyZXR1cm4gZW51bV9mbXQoZiwg
TUVNMk1FTV9PVVRQVVQpOwpAQCAtNDUzLDEzICs0NTYsMTUgQEAgc3RhdGljIGludCB2aWRpb2Nf
Z19mbXQoc3RydWN0IGVtbWFwcnBfY3R4ICpjdHgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9vdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXJldHVybiB2aWRpb2NfZ19mbXQoZmlsZV90
b19lbW1hcHJwX2N0eChmaWxlKSwgZik7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19n
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlyZXR1cm4gdmlk
aW9jX2dfZm10KGZpbGVfdG9fZW1tYXBycF9jdHgoZmlsZSksIGYpOwpAQCAtNDk5LDcgKzUwNCw4
IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXQoc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZW1tYXBycF9jdHgg
KmN0eCA9IGZpbGVfdG9fZW1tYXBycF9jdHgoZmlsZSk7CkBAIC01MTYsNyArNTIyLDggQEAgc3Rh
dGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogCXJldHVybiB2aWRpb2NfdHJ5X2ZtdChmKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
dHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IGVtbWFwcnBfY3R4ICpjdHggPSBmaWxlX3RvX2VtbWFwcnBfY3R4KGZpbGUp
OwpAQCAtNTcxLDI0ICs1NzgsMjYgQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXQoc3RydWN0IGVt
bWFwcnBfY3R4ICpjdHgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCWludCByZXQ7CiAKLQlyZXQgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2Fw
KGZpbGUsIHByaXYsIGYpOworCXJldCA9IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3Rh
dGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKIAlyZXR1cm4gdmlkaW9jX3NfZm10
KGZpbGVfdG9fZW1tYXBycF9jdHgoZmlsZSksIGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19z
X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aWRpb2Nfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJaW50
IHJldDsKIAotCXJldCA9IHZpZGlvY190cnlfZm10X3ZpZF9vdXQoZmlsZSwgcHJpdiwgZik7CisJ
cmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9xY29t
L2NhbXNzL2NhbXNzLXZpZGVvLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Fjb20vY2Ftc3Mv
Y2Ftc3MtdmlkZW8uYwppbmRleCA4MzE0ODZlMTQ3NTRhYjNhMjRiMDc3ZTIxYmUxNGVhMzE2OTIy
MGE0Li5lNTMxNWRmODkyOWRhNDFjOWM5NTJhZGJiOGYxNDY1NjkxYTc2M2UzIDEwMDY0NAotLS0g
YS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Fjb20vY2Ftc3MvY2Ftc3MtdmlkZW8uYworKysgYi9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL3Fjb20vY2Ftc3MvY2Ftc3MtdmlkZW8uYwpAQCAtMzQ2LDcg
KzM0Niw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBtc21fdmlkZW9fdmIyX3Ffb3Bz
ID0gewogICogVjRMMiBpb2N0bHMKICAqLwogCi1zdGF0aWMgaW50IHZpZGVvX3F1ZXJ5Y2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkZW9fcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZl
ciwgInFjb20tY2Ftc3MiLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTM1NSw3ICszNTYsOCBA
QCBzdGF0aWMgaW50IHZpZGVvX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRlb19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IHZpZGVv
X2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgY2Ftc3Nfdmlk
ZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlpbnQgaSwgaiwgazsKQEAgLTQxMiw3
ICs0MTQsOCBAQCBzdGF0aWMgaW50IHZpZGVvX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2aWRlb19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAor
c3RhdGljIGludCB2aWRlb19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9mcm1z
aXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IGNhbXNzX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC00NDIsNyArNDQ1LDggQEAgc3RhdGljIGludCB2aWRlb19lbnVtX2Zy
YW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpZGVvX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRlb19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGNhbXNzX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTUzMSwxNCArNTM1LDE2IEBAIHN0YXRpYyBpbnQgX192aWRlb190cnlf
Zm10KHN0cnVjdCBjYW1zc192aWRlbyAqdmlkZW8sIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRlb190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRlb190cnlf
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGNhbXNzX3ZpZGVvICp2aWRl
byA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlyZXR1cm4gX192aWRlb190cnlfZm10KHZpZGVv
LCBmKTsKIH0KIAotc3RhdGljIGludCB2aWRlb19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkZW9fc19mbXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAg
ICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjYW1zc192aWRlbyAqdmlkZW8g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWludCByZXQ7CkBAIC01NTUsNyArNTYxLDggQEAgc3Rh
dGljIGludCB2aWRlb19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRlb19lbnVtX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkZW9fZW51bV9p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wdXQpCiB7CiAJaWYgKGlucHV0
LT5pbmRleCA+IDApCkBAIC01NjcsMTQgKzU3NCwxNiBAQCBzdGF0aWMgaW50IHZpZGVvX2VudW1f
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IHZpZGVvX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25l
ZCBpbnQgKmlucHV0KQorc3RhdGljIGludCB2aWRlb19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSB1bnNpZ25lZCBpbnQgKmlu
cHV0KQogewogCSppbnB1dCA9IDA7CiAKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRl
b19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGlucHV0
KQorc3RhdGljIGludCB2aWRlb19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSB1bnNpZ25lZCBpbnQgaW5wdXQpCiB7CiAJcmV0
dXJuIGlucHV0ID09IDAgPyAwIDogLUVJTlZBTDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcGxhdGZvcm0vcWNvbS9pcmlzL2lyaXNfdmlkYy5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9y
bS9xY29tL2lyaXMvaXJpc192aWRjLmMKaW5kZXggZDM4ZDBmNjk2MWNkNWNiOTkyOWUyYWVjYmVj
NzM1M2RjYzJkNGE3ZC4uOWY1NDFhZDIxOTcwMDM1Njg0NmU2OTNmZDg0ODcxNGRmNmM2ZGFjMSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9xY29tL2lyaXMvaXJpc192aWRjLmMK
KysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9xY29tL2lyaXMvaXJpc192aWRjLmMKQEAgLTMw
OCw3ICszMDgsOCBAQCBpbnQgaXJpc19jbG9zZShzdHJ1Y3QgZmlsZSAqZmlscCkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBpcmlzX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxwLCB2b2lk
ICpmaCwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgaXJpc19lbnVtX2ZtdChz
dHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkg
c3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgaXJpc19pbnN0ICppbnN0ID0gaXJp
c19nZXRfaW5zdChmaWxwKTsKIApAQCAtMzIwLDcgKzMyMSw5IEBAIHN0YXRpYyBpbnQgaXJpc19l
bnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2Mg
KmYpCiAJCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IGlyaXNfdHJ5X2ZtdF92aWRf
bXBsYW5lKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQorc3RhdGljIGludCBpcmlzX3RyeV9mbXRfdmlkX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlscCwK
KwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGlyaXNfaW5zdCAqaW5zdCA9IGlyaXNfZ2V0X2lu
c3QoZmlscCk7CiAJaW50IHJldCA9IDA7CkBAIC0zMzcsNyArMzQwLDkgQEAgc3RhdGljIGludCBp
cmlzX3RyeV9mbXRfdmlkX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2Zvcm0KIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IGlyaXNfc19mbXRfdmlk
X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKK3N0YXRpYyBpbnQgaXJpc19zX2ZtdF92aWRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxwLAor
CQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCBpcmlzX2luc3QgKmluc3QgPSBpcmlzX2dldF9pbnN0KGZp
bHApOwogCWludCByZXQgPSAwOwpAQCAtMzU0LDcgKzM1OSw5IEBAIHN0YXRpYyBpbnQgaXJpc19z
X2ZtdF92aWRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
Zm9ybWF0CiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBpcmlzX2dfZm10X3ZpZF9tcGxh
bmUoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitz
dGF0aWMgaW50IGlyaXNfZ19mbXRfdmlkX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCQkg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgaXJpc19pbnN0ICppbnN0ID0gaXJpc19nZXRfaW5zdChmaWxwKTsK
IAlpbnQgcmV0ID0gMDsKQEAgLTM3Miw3ICszNzksOCBAQCBzdGF0aWMgaW50IGlyaXNfZ19mbXRf
dmlkX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1h
dAogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgaXJpc19lbnVtX2ZyYW1lc2l6ZXMoc3Ry
dWN0IGZpbGUgKmZpbHAsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcmlzX2VudW1fZnJhbWVzaXpl
cyhzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IGlyaXNf
aW5zdCAqaW5zdCA9IGlyaXNfZ2V0X2luc3QoZmlscCk7CkBAIC00MDMsNyArNDExLDggQEAgc3Rh
dGljIGludCBpcmlzX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgs
CiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBpcmlzX2VudW1fZnJhbWVpbnRlcnZhbHMo
c3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcmlzX2VudW1fZnJhbWVp
bnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbHAsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mcm1pdmFsZW51bSAqZml2YWwpCiAK
IHsKQEAgLTQ0OCw3ICs0NTcsOCBAQCBzdGF0aWMgaW50IGlyaXNfZW51bV9mcmFtZWludGVydmFs
cyhzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgaXJpc19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2NhcGFiaWxpdHkgKmNhcCkKK3N0YXRpYyBpbnQgaXJpc19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlscCwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJf
Y2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBpcmlzX2luc3QgKmluc3QgPSBpcmlzX2dldF9p
bnN0KGZpbHApOwogCkBAIC00NjIsNyArNDcyLDkgQEAgc3RhdGljIGludCBpcmlzX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2EK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpcmlzX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxl
ICpmaWxwLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQorc3RhdGljIGludCBp
cmlzX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsK
IAlzdHJ1Y3QgaXJpc19pbnN0ICppbnN0ID0gaXJpc19nZXRfaW5zdChmaWxwKTsKIApAQCAtNTEy
LDcgKzUyNCw5IEBAIHN0YXRpYyBpbnQgaXJpc19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmls
cCwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgaXJpc19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgsIHN0
cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK3N0YXRpYyBpbnQgaXJpc19zX3NlbGVjdGlvbihzdHJ1
Y3QgZmlsZSAqZmlscCwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IGlyaXNfaW5zdCAq
aW5zdCA9IGlyaXNfZ2V0X2luc3QoZmlscCk7CiAKQEAgLTUzNiw3ICs1NTAsOCBAQCBzdGF0aWMg
aW50IGlyaXNfc3Vic2NyaWJlX2V2ZW50KHN0cnVjdCB2NGwyX2ZoICpmaCwgY29uc3Qgc3RydWN0
IHY0bDJfZXZlbnRfc3VicwogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IGlyaXNf
c19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcGFy
bSAqYSkKK3N0YXRpYyBpbnQgaXJpc19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbHAsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFy
bSAqYSkKIHsKIAlzdHJ1Y3QgaXJpc19pbnN0ICppbnN0ID0gaXJpc19nZXRfaW5zdChmaWxwKTsK
IApAQCAtNTUwLDcgKzU2NSw4IEBAIHN0YXRpYyBpbnQgaXJpc19zX3Bhcm0oc3RydWN0IGZpbGUg
KmZpbHAsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQogCQlyZXR1cm4gLUVJ
TlZBTDsKIH0KIAotc3RhdGljIGludCBpcmlzX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCitzdGF0aWMgaW50IGlyaXNfZ19wYXJt
KHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
ICAgICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IGlyaXNfaW5zdCAq
aW5zdCA9IGlyaXNfZ2V0X2luc3QoZmlscCk7CiAKQEAgLTU2NCw3ICs1ODAsOCBAQCBzdGF0aWMg
aW50IGlyaXNfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
c3RyZWFtcGFybSAqYSkKIAkJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgaXJpc19k
ZWNfY21kKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaXJpc19kZWNf
Y21kKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQlzdHJ1Y3QgdjRsMl9kZWNvZGVyX2NtZCAqZGVjKQogewogCXN0cnVjdCBpcmlzX2lu
c3QgKmluc3QgPSBpcmlzX2dldF9pbnN0KGZpbHApOwpAQCAtNTcyLDcgKzU4OSw3IEBAIHN0YXRp
YyBpbnQgaXJpc19kZWNfY21kKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpmaCwKIAogCW11dGV4
X2xvY2soJmluc3QtPmxvY2spOwogCi0JcmV0ID0gdjRsMl9tMm1faW9jdGxfZGVjb2Rlcl9jbWQo
ZmlscCwgZmgsIGRlYyk7CisJcmV0ID0gdjRsMl9tMm1faW9jdGxfZGVjb2Rlcl9jbWQoZmlscCwg
c3RhdGUsIGRlYyk7CiAJaWYgKHJldCkKIAkJZ290byB1bmxvY2s7CiAKQEAgLTU5Nyw3ICs2MTQs
OCBAQCBzdGF0aWMgaW50IGlyaXNfZGVjX2NtZChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqZmgs
CiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBpcmlzX2VuY19jbWQoc3RydWN0IGZpbGUg
KmZpbHAsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcmlzX2VuY19jbWQoc3RydWN0IGZpbGUgKmZp
bHAsCisJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2NGwy
X2VuY29kZXJfY21kICplbmMpCiB7CiAJc3RydWN0IGlyaXNfaW5zdCAqaW5zdCA9IGlyaXNfZ2V0
X2luc3QoZmlscCk7CkBAIC02MDUsNyArNjIzLDcgQEAgc3RhdGljIGludCBpcmlzX2VuY19jbWQo
c3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKmZoLAogCiAJbXV0ZXhfbG9jaygmaW5zdC0+bG9jayk7
CiAKLQlyZXQgPSB2NGwyX20ybV9pb2N0bF9lbmNvZGVyX2NtZChmaWxwLCBmaCwgZW5jKTsKKwly
ZXQgPSB2NGwyX20ybV9pb2N0bF9lbmNvZGVyX2NtZChmaWxwLCBzdGF0ZSwgZW5jKTsKIAlpZiAo
cmV0KQogCQlnb3RvIHVubG9jazsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9y
bS9xY29tL3ZlbnVzL3ZkZWMuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcWNvbS92ZW51cy92
ZGVjLmMKaW5kZXggNTVjMjczNDViN2Q4OWJmNDAwZTIxNmVkOWFhNTlhODcxZTUwMWE0NC4uNGM0
NDBiZjJmNTJiZGQ2MTkwOWVhM2UzNjRlY2NiMDg2NTA3MmZlYiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9tZWRpYS9wbGF0Zm9ybS9xY29tL3ZlbnVzL3ZkZWMuYworKysgYi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL3Fjb20vdmVudXMvdmRlYy5jCkBAIC0yMzgsNyArMjM4LDggQEAgdmRlY190cnlfZm10
X2NvbW1vbihzdHJ1Y3QgdmVudXNfaW5zdCAqaW5zdCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
CXJldHVybiBmbXQ7CiB9CiAKLXN0YXRpYyBpbnQgdmRlY190cnlfZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2ZGVjX3Ry
eV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2ZW51c19pbnN0ICppbnN0
ID0gdG9faW5zdChmaWxlKTsKIApAQCAtMjgxLDcgKzI4Miw4IEBAIHN0YXRpYyBpbnQgdmRlY19j
aGVja19zcmNfY2hhbmdlKHN0cnVjdCB2ZW51c19pbnN0ICppbnN0KQogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHZkZWNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZkZWNfZ19mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZlbnVzX2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUp
OwogCWNvbnN0IHN0cnVjdCB2ZW51c19mb3JtYXQgKmZtdCA9IE5VTEw7CkBAIC0zMTgsNyArMzIw
LDggQEAgc3RhdGljIGludCB2ZGVjX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZkZWNf
c19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CitzdGF0aWMgaW50IHZkZWNfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHZlbnVzX2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOwogCXN0cnVjdCB2NGwyX3Bp
eF9mb3JtYXRfbXBsYW5lICpwaXhtcCA9ICZmLT5mbXQucGl4X21wOwpAQCAtMzkyLDcgKzM5NSw4
IEBAIHN0YXRpYyBpbnQgdmRlY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIH0KIAogc3RhdGljIGludAotdmRlY19nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK3Zk
ZWNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCB2ZW51
c19pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsKIApAQCAtNDMzLDcgKzQzNyw4IEBAIHZkZWNf
Z19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxl
Y3Rpb24gKnMpCiB9CiAKIHN0YXRpYyBpbnQKLXZkZWNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCit2ZGVjX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkg
ICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZl
ciwgInFjb20tdmVudXMiLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKIAlzdHJzY3B5KGNhcC0+Y2Fy
ZCwgIlF1YWxjb21tIFZlbnVzIHZpZGVvIGRlY29kZXIiLCBzaXplb2YoY2FwLT5jYXJkKSk7CkBA
IC00NDIsNyArNDQ3LDggQEAgdmRlY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2ZGVjX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0
bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgdmRlY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZm10
ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgdmVudXNfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJ
Y29uc3Qgc3RydWN0IHZlbnVzX2Zvcm1hdCAqZm10OwpAQCAtNDU5LDcgKzQ2NSw4IEBAIHN0YXRp
YyBpbnQgdmRlY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmRlY19zX3Bhcm0o
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQor
c3RhdGljIGludCB2ZGVjX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQog
ewogCXN0cnVjdCB2ZW51c19pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsKIAlzdHJ1Y3QgdjRs
Ml9jYXB0dXJlcGFybSAqY2FwID0gJmEtPnBhcm0uY2FwdHVyZTsKQEAgLTQ5MSw3ICs0OTgsOCBA
QCBzdGF0aWMgaW50IHZkZWNfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3Ry
dWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2ZGVj
X2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50
IHZkZWNfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6
ZSkKIHsKIAlzdHJ1Y3QgdmVudXNfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CkBAIC01NDQs
MTQgKzU1MiwxNSBAQCBzdGF0aWMgaW50IHZkZWNfc3Vic2NyaWJlX2V2ZW50KHN0cnVjdCB2NGwy
X2ZoICpmaCwKIH0KIAogc3RhdGljIGludAotdmRlY19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2RlY29kZXJfY21kICpjbWQpCit2ZGVjX2RlY29k
ZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJIHN0cnVjdCB2NGwyX2RlY29kZXJfY21kICpjbWQpCiB7CiAJc3RydWN0IHZlbnVzX2lu
c3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOwogCXN0cnVjdCB2YjJfcXVldWUgKmRzdF92cTsKIAlz
dHJ1Y3QgaGZpX2ZyYW1lX2RhdGEgZmRhdGEgPSB7MH07CiAJaW50IHJldDsKIAotCXJldCA9IHY0
bDJfbTJtX2lvY3RsX3RyeV9kZWNvZGVyX2NtZChmaWxlLCBmaCwgY21kKTsKKwlyZXQgPSB2NGwy
X20ybV9pb2N0bF90cnlfZGVjb2Rlcl9jbWQoZmlsZSwgc3RhdGUsIGNtZCk7CiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9xY29t
L3ZlbnVzL3ZlbmMuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcWNvbS92ZW51cy92ZW5jLmMK
aW5kZXggZmJhMDc1NTdhMzk5NmE1NWZjZDZhNGY2NTM3NmM0MThlYzBjOTJhNy4uOGZlODYxMzlh
NWQ2ZTBiMWU4OTZhNGJjZDYxOWFhNDUwY2EyZmQyNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9xY29tL3ZlbnVzL3ZlbmMuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L3Fjb20vdmVudXMvdmVuYy5jCkBAIC0xNDIsNyArMTQyLDggQEAgc3RhdGljIGludCB2ZW5jX3Y0
bDJfdG9faGZpKGludCBpZCwgaW50IHZhbHVlKQogfQogCiBzdGF0aWMgaW50Ci12ZW5jX3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAq
Y2FwKQordmVuY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJICAgICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewog
CXN0cnNjcHkoY2FwLT5kcml2ZXIsICJxY29tLXZlbnVzIiwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7
CiAJc3Ryc2NweShjYXAtPmNhcmQsICJRdWFsY29tbSBWZW51cyB2aWRlbyBlbmNvZGVyIiwgc2l6
ZW9mKGNhcC0+Y2FyZCkpOwpAQCAtMTUxLDcgKzE1Miw4IEBAIHZlbmNfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmVuY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IHZlbmNfZW51bV9m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHZlbnVzX2luc3QgKmluc3Qg
PSB0b19pbnN0KGZpbGUpOwogCWNvbnN0IHN0cnVjdCB2ZW51c19mb3JtYXQgKmZtdDsKQEAgLTIy
MSw3ICsyMjMsOCBAQCB2ZW5jX3RyeV9mbXRfY29tbW9uKHN0cnVjdCB2ZW51c19pbnN0ICppbnN0
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIGZtdDsKIH0KIAotc3RhdGljIGludCB2
ZW5jX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCitzdGF0aWMgaW50IHZlbmNfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHZlbnVzX2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOwogCkBAIC0yMzAsNyAr
MjMzLDggQEAgc3RhdGljIGludCB2ZW5jX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmVuY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKK3N0YXRpYyBpbnQgdmVuY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IHsKIAlzdHJ1Y3QgdmVudXNfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJc3RydWN0IHY0
bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeG1wID0gJmYtPmZtdC5waXhfbXA7CkBAIC0yOTksNyAr
MzAzLDggQEAgc3RhdGljIGludCB2ZW5jX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZl
bmNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCitzdGF0aWMgaW50IHZlbmNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeG1wID0gJmYtPmZtdC5waXhfbXA7
CiAJc3RydWN0IHZlbnVzX2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOwpAQCAtMzMyLDcgKzMz
Nyw4IEBAIHN0YXRpYyBpbnQgdmVuY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIH0KIAogc3RhdGljIGludAotdmVuY19nX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykK
K3ZlbmNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCB2
ZW51c19pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsKIApAQCAtMzYwLDcgKzM2Niw4IEBAIHZl
bmNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9z
ZWxlY3Rpb24gKnMpCiB9CiAKIHN0YXRpYyBpbnQKLXZlbmNfc19zZWxlY3Rpb24oc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCit2ZW5jX3Nfc2Vs
ZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgdmVudXNfaW5zdCAq
aW5zdCA9IHRvX2luc3QoZmlsZSk7CiAKQEAgLTM4OCw3ICszOTUsOCBAQCB2ZW5jX3Nfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpz
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZlbmNfc19wYXJtKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgdmVu
Y19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlzdHJ1Y3QgdmVu
dXNfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJc3RydWN0IHY0bDJfb3V0cHV0cGFybSAq
b3V0ID0gJmEtPnBhcm0ub3V0cHV0OwpAQCAtNDIxLDcgKzQyOSw4IEBAIHN0YXRpYyBpbnQgdmVu
Y19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1w
YXJtICphKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZlbmNfZ19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBp
bnQgdmVuY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlzdHJ1
Y3QgdmVudXNfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAKQEAgLTQzNSw3ICs0NDQsOCBA
QCBzdGF0aWMgaW50IHZlbmNfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3Ry
dWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2ZW5j
X2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50
IHZlbmNfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6
ZSkKIHsKIAlzdHJ1Y3QgdmVudXNfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CkBAIC00NjUs
NyArNDc1LDggQEAgc3RhdGljIGludCB2ZW5jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmVuY19lbnVtX2Zy
YW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmVu
Y19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZnJtaXZhbGVu
dW0gKmZpdmFsKQogewogCXN0cnVjdCB2ZW51c19pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsK
QEAgLTUyNCwxMyArNTM1LDE0IEBAIHN0YXRpYyBpbnQgdmVuY19zdWJzY3JpYmVfZXZlbnQoc3Ry
dWN0IHY0bDJfZmggKmZoLAogfQogCiBzdGF0aWMgaW50Ci12ZW5jX2VuY29kZXJfY21kKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmNtZCkKK3Zl
bmNfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkgc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmNtZCkKIHsKIAlzdHJ1Y3Qg
dmVudXNfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7CiAJc3RydWN0IGhmaV9mcmFtZV9kYXRh
IGZkYXRhID0gezB9OwogCWludCByZXQgPSAwOwogCi0JcmV0ID0gdjRsMl9tMm1faW9jdGxfdHJ5
X2VuY29kZXJfY21kKGZpbGUsIGZoLCBjbWQpOworCXJldCA9IHY0bDJfbTJtX2lvY3RsX3RyeV9l
bmNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgY21kKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0Owog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Jhc3BiZXJyeXBpL3Bpc3BfYmUv
cGlzcF9iZS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yYXNwYmVycnlwaS9waXNwX2JlL3Bp
c3BfYmUuYwppbmRleCBiMzA4OTE3MThkOGRmOWM0OGNlMWI4M2FkOWZjYWZiMjAxMTA1NjI1Li44
ZjBkODJkMDcwYmJjN2I0OTAxODNmM2E2NjVjOTY0NjE1OGU1NTAzIDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL3Jhc3BiZXJyeXBpL3Bpc3BfYmUvcGlzcF9iZS5jCisrKyBiL2Ry
aXZlcnMvbWVkaWEvcGxhdGZvcm0vcmFzcGJlcnJ5cGkvcGlzcF9iZS9waXNwX2JlLmMKQEAgLTk3
NCw3ICs5NzQsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZmlsZV9vcGVyYXRpb25zIHBp
c3BiZV9mb3BzID0gewogCS5tbWFwICAgICAgICAgICA9IHZiMl9mb3BfbW1hcAogfTsKIAotc3Rh
dGljIGludCBwaXNwYmVfbm9kZV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgcGlzcGJlX25vZGVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfY2Fw
YWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBwaXNwYmVfbm9kZSAqbm9kZSA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC05OTAsNyArOTkxLDggQEAgc3RhdGljIGludCBwaXNwYmVfbm9kZV9xdWVy
eWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBwaXNwYmVfbm9kZV9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCBwaXNwYmVfbm9kZV9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHBpc3BiZV9ub2RlICpub2Rl
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEwMTAsNyArMTAxMiw4IEBAIHN0YXRpYyBpbnQg
cGlzcGJlX25vZGVfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwaXNwYmVfbm9kZV9nX2ZtdF92aWRfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBwaXNwYmVfbm9kZV9nX2Zt
dF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHBpc3BiZV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEwMzAsNyAr
MTAzMyw4IEBAIHN0YXRpYyBpbnQgcGlzcGJlX25vZGVfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwaXNwYmVf
bm9kZV9nX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgcGlzcGJlX25vZGVfZ19mbXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
ICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBwaXNwYmVfbm9kZSAqbm9kZSA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC0xMTUzLDcgKzExNTcsOCBAQCBzdGF0aWMgdm9pZCBwaXNwYmVfdHJ5
X2Zvcm1hdChzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYsIHN0cnVjdCBwaXNwYmVfbm9kZSAqbm9kZSkK
IAl9CiB9CiAKLXN0YXRpYyBpbnQgcGlzcGJlX25vZGVfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBwaXNwYmVfbm9kZV90cnlfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHBpc3BiZV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTExNzEsNyAr
MTE3Niw4IEBAIHN0YXRpYyBpbnQgcGlzcGJlX25vZGVfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHBpc3Bi
ZV9ub2RlX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgcGlzcGJlX25vZGVfdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICAg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBwaXNwYmVfbm9kZSAqbm9kZSA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTg5LDcgKzExOTUsOCBAQCBzdGF0aWMgaW50IHBpc3Bi
ZV9ub2RlX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwaXNwYmVfbm9kZV90cnlfZm10X21ldGFfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBwaXNwYmVfbm9kZV90cnlf
Zm10X21ldGFfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBw
aXNwYmVfbm9kZSAqbm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMjA4LDE0ICsxMjE1
LDE1IEBAIHN0YXRpYyBpbnQgcGlzcGJlX25vZGVfdHJ5X2ZtdF9tZXRhX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwaXNwYmVf
bm9kZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBwaXNwYmVfbm9kZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHBpc3BiZV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIAlzdHJ1Y3QgcGlzcGJlX2RldiAqcGlzcGJlID0gbm9kZS0+cGlzcGJlOwogCWlu
dCByZXQ7CiAKLQlyZXQgPSBwaXNwYmVfbm9kZV90cnlfZm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwg
Zik7CisJcmV0ID0gcGlzcGJlX25vZGVfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsK
IAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTIzMSwxNCArMTIzOSwxNSBAQCBz
dGF0aWMgaW50IHBpc3BiZV9ub2RlX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcGlzcGJlX25vZGVfc19mbXRf
dmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcGlzcGJl
X25vZGVfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCBwaXNwYmVfbm9kZSAqbm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJ
c3RydWN0IHBpc3BiZV9kZXYgKnBpc3BiZSA9IG5vZGUtPnBpc3BiZTsKIAlpbnQgcmV0OwogCi0J
cmV0ID0gcGlzcGJlX25vZGVfdHJ5X2ZtdF92aWRfb3V0KGZpbGUsIHByaXYsIGYpOworCXJldCA9
IHBpc3BiZV9ub2RlX3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCA8
IDApCiAJCXJldHVybiByZXQ7CiAKQEAgLTEyNTQsMTQgKzEyNjMsMTUgQEAgc3RhdGljIGludCBw
aXNwYmVfbm9kZV9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHBpc3BiZV9ub2RlX3NfZm10X21ldGFfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBwaXNwYmVfbm9kZV9zX2Zt
dF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHBpc3BiZV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3Qg
cGlzcGJlX2RldiAqcGlzcGJlID0gbm9kZS0+cGlzcGJlOwogCWludCByZXQ7CiAKLQlyZXQgPSBw
aXNwYmVfbm9kZV90cnlfZm10X21ldGFfb3V0KGZpbGUsIHByaXYsIGYpOworCXJldCA9IHBpc3Bi
ZV9ub2RlX3RyeV9mbXRfbWV0YV9vdXQoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQgPCAwKQog
CQlyZXR1cm4gcmV0OwogCkBAIC0xMjc3LDcgKzEyODcsOCBAQCBzdGF0aWMgaW50IHBpc3BiZV9u
b2RlX3NfZm10X21ldGFfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHBpc3BiZV9ub2RlX2VudW1fZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgcGlzcGJlX25vZGVfZW51bV9mbXQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
c3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgcGlzcGJlX25vZGUgKm5vZGUgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTMwMyw3ICsxMzE0LDggQEAgc3RhdGljIGludCBwaXNw
YmVfbm9kZV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgcGlzcGJlX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcGlzcGJlX2VudW1fZnJhbWVzaXplcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCBwaXNwYmVf
bm9kZSAqbm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL3Jhc3BiZXJyeXBpL3JwMS1jZmUvY2ZlLmMgYi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL3Jhc3BiZXJyeXBpL3JwMS1jZmUvY2ZlLmMKaW5kZXggNjJkY2E3NmI0NjhkMWJlNGVm
YTZmZDRlNjhhODliOWJlMGNjNDU0Yi4uOWY0ZGQ2NThlYzJmMWM1NWY2MWM2ODZiODRiOTg3MDY2
NmQ4NTEyZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yYXNwYmVycnlwaS9y
cDEtY2ZlL2NmZS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmFzcGJlcnJ5cGkvcnAx
LWNmZS9jZmUuYwpAQCAtMTMyNCw3ICsxMzI0LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJf
b3BzIGNmZV92aWRlb19xb3BzID0gewogICogdjRsMiBpb2N0bCBvcHMKICAqLwogCi1zdGF0aWMg
aW50IGNmZV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgY2ZlX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ry
c2NweShjYXAtPmRyaXZlciwgQ0ZFX01PRFVMRV9OQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsK
QEAgLTEzMzYsNyArMTMzNyw4IEBAIHN0YXRpYyBpbnQgY2ZlX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNmZV9lbnVt
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBj
ZmVfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0
cnVjdCBjZmVfbm9kZSAqbm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzcxLDcgKzEz
NzMsOCBAQCBzdGF0aWMgaW50IGNmZV9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IGNmZV9nX2Zt
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQor
c3RhdGljIGludCBjZmVfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3QgY2ZlX25vZGUgKm5vZGUgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xNDE3LDcgKzE0
MjAsOCBAQCBzdGF0aWMgaW50IGNmZV92YWxpZGF0ZV9mbXRfdmlkX2NhcChzdHJ1Y3QgY2ZlX25v
ZGUgKm5vZGUsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY2ZlX3NfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGNmZV9zX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjZmVf
bm9kZSAqbm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNDQxLDcgKzE0NDUsOCBAQCBz
dGF0aWMgaW50IGNmZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNmZV90cnlfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGNmZV90cnlfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjZmVf
bm9kZSAqbm9kZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNDUyLDcgKzE0NTcsOCBAQCBz
dGF0aWMgaW50IGNmZV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIGNmZV92YWxpZGF0ZV9mbXRfdmlkX2NhcChub2RlLCBmKTsKIH0KIAotc3Rh
dGljIGludCBjZmVfZW51bV9mbXRfbWV0YShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgY2ZlX2VudW1fZm10X21ldGEoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9m
bXRkZXNjICpmKQogewogCXN0cnVjdCBjZmVfbm9kZSAqbm9kZSA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC0xNTQ3LDcgKzE1NTMsOCBAQCBzdGF0aWMgaW50IGNmZV92YWxpZGF0ZV9mbXRfbWV0
YShzdHJ1Y3QgY2ZlX25vZGUgKm5vZGUsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAl9CiB9CiAK
LXN0YXRpYyBpbnQgY2ZlX2dfZm10X21ldGEoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgY2ZlX2dfZm10X21ldGEoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGNmZV9ub2RlICpub2RlID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgY2ZlX2RldmljZSAqY2ZlID0gbm9kZS0+Y2ZlOwpAQCAtMTU2
Miw3ICsxNTY5LDggQEAgc3RhdGljIGludCBjZmVfZ19mbXRfbWV0YShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGNmZV9zX2ZtdF9tZXRhKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IGNmZV9zX2ZtdF9tZXRhKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjZmVfbm9kZSAqbm9kZSA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAJc3RydWN0IGNmZV9kZXZpY2UgKmNmZSA9IG5vZGUtPmNmZTsKQEAgLTE1ODks
NyArMTU5Nyw4IEBAIHN0YXRpYyBpbnQgY2ZlX3NfZm10X21ldGEoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBjZmVfdHJ5X2ZtdF9tZXRhKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCBjZmVfdHJ5X2ZtdF9tZXRhKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgY2ZlX25vZGUgKm5vZGUgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtMTU5OSw3ICsxNjA4LDggQEAgc3RhdGljIGludCBjZmVfdHJ5X2ZtdF9tZXRhKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBjZmVfdmFsaWRhdGVfZm10X21ldGEobm9k
ZSwgZik7CiB9CiAKLXN0YXRpYyBpbnQgY2ZlX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY2ZlX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IGNm
ZV9ub2RlICpub2RlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE2MzEsNyArMTY0MSw4IEBA
IHN0YXRpYyBpbnQgY2ZlX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjZmVfdmIyX2lvY3RsX3JlcWJ1ZnMo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGNmZV92YjJfaW9jdGxf
cmVxYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX3JlcXVlc3RidWZmZXJzICpwKQogewogCXN0cnVj
dCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMTY1MSwxMCAr
MTY2MiwxMSBAQCBzdGF0aWMgaW50IGNmZV92YjJfaW9jdGxfcmVxYnVmcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0JcmV0dXJuIHZi
Ml9pb2N0bF9yZXFidWZzKGZpbGUsIHByaXYsIHApOworCXJldHVybiB2YjJfaW9jdGxfcmVxYnVm
cyhmaWxlLCBzdGF0ZSwgcCk7CiB9CiAKLXN0YXRpYyBpbnQgY2ZlX3ZiMl9pb2N0bF9jcmVhdGVf
YnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY2ZlX3ZiMl9p
b2N0bF9jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3RydWN0IHY0bDJfY3JlYXRlX2J1ZmZl
cnMgKnApCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmls
ZSk7CkBAIC0xNjc0LDcgKzE2ODYsNyBAQCBzdGF0aWMgaW50IGNmZV92YjJfaW9jdGxfY3JlYXRl
X2J1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHJldCkKIAkJcmV0dXJu
IHJldDsKIAotCXJldHVybiB2YjJfaW9jdGxfY3JlYXRlX2J1ZnMoZmlsZSwgcHJpdiwgcCk7CisJ
cmV0dXJuIHZiMl9pb2N0bF9jcmVhdGVfYnVmcyhmaWxlLCBzdGF0ZSwgcCk7CiB9CiAKIHN0YXRp
YyBpbnQgY2ZlX3N1YnNjcmliZV9ldmVudChzdHJ1Y3QgdjRsMl9maCAqZmgsCmRpZmYgLS1naXQg
YS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMvcmNhci12aW4vcmNhci12NGwyLmMgYi9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMvcmNhci12aW4vcmNhci12NGwyLmMKaW5kZXgg
MDc5ZGJhZjAxNmMyNTEzOWUyYWM4MmJlNjNkOGZjZTBkMTFmZDIwOC4uNWY1ZGMxYzk5MDRlNjVh
MjNkYWRiMTgxY2FmZGE3ZGIxNzg0ODZlMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0
Zm9ybS9yZW5lc2FzL3JjYXItdmluL3JjYXItdjRsMi5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vcmVuZXNhcy9yY2FyLXZpbi9yY2FyLXY0bDIuYwpAQCAtMjI5LDcgKzIyOSw4IEBAIHN0
YXRpYyB2b2lkIHJ2aW5fZm9ybWF0X2FsaWduKHN0cnVjdCBydmluX2RldiAqdmluLCBzdHJ1Y3Qg
djRsMl9waXhfZm9ybWF0ICpwaXgpCiAgKiBWNEwyCiAgKi8KIAotc3RhdGljIGludCBydmluX3F1
ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBydmluX3F1
ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNh
cC0+ZHJpdmVyLCBLQlVJTERfTU9ETkFNRSwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7CkBAIC0yMzcs
NyArMjM4LDggQEAgc3RhdGljIGludCBydmluX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJ2aW5fZ19mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcnZpbl9nX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0
IHJ2aW5fZGV2ICp2aW4gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjQ3LDcgKzI0OSw4IEBA
IHN0YXRpYyBpbnQgcnZpbl9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJ2aW5fZW51bV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcnZpbl9lbnVtX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgcnZpbl9k
ZXYgKnZpbiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zNjksNyArMzcyLDggQEAgc3RhdGlj
IGludCBydmluX3JlbW90ZV9yZWN0YW5nbGUoc3RydWN0IHJ2aW5fZGV2ICp2aW4sIHN0cnVjdCB2
NGwyX3JlY3QgKnJlY3QpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcnZpbl9nX3NlbGVj
dGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHJ2aW5fZ19zZWxl
Y3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBy
dmluX2RldiAqdmluID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQwOCw3ICs0MTIsOCBAQCBz
dGF0aWMgaW50IHJ2aW5fZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJ2aW5fc19zZWxlY3Rpb24oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBydmluX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAg
IHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgcnZpbl9kZXYgKnZpbiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01MTUsNyArNTIwLDggQEAgc3RhdGljIHZvaWQgcnZpbl9t
Y190cnlfZm9ybWF0KHN0cnVjdCBydmluX2RldiAqdmluLAogCXJ2aW5fZm9ybWF0X2FsaWduKHZp
biwgcGl4KTsKIH0KIAotc3RhdGljIGludCBydmluX21jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcnZpbl9tY190cnlfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBydmluX2Rl
diAqdmluID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTUyNSw3ICs1MzEsOCBAQCBzdGF0aWMg
aW50IHJ2aW5fbWNfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJ2aW5fbWNfc19mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcnZpbl9tY19zX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBydmluX2RldiAq
dmluID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vcmVuZXNhcy9yY2FyX2RyaWYuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNh
cy9yY2FyX2RyaWYuYwppbmRleCAxMWJmNDdmYjgyNjZkYzQ1ZGY0MGNhYzAwM2YwMzk1ODIyNTFi
OTQ1Li43OWQzYWY5YzdiMGRhOWU5YjU5YzRmM2U4ZTU1MzVjNGUzZjczYjQ4IDEwMDY0NAotLS0g
YS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMvcmNhcl9kcmlmLmMKKysrIGIvZHJpdmVy
cy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3JjYXJfZHJpZi5jCkBAIC04NjMsNyArODYzLDggQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIHJjYXJfZHJpZl92YjJfb3BzID0gewogCS5zdG9w
X3N0cmVhbWluZyAgICAgICAgID0gcmNhcl9kcmlmX3N0b3Bfc3RyZWFtaW5nLAogfTsKIAotc3Rh
dGljIGludCByY2FyX2RyaWZfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAor
c3RhdGljIGludCByY2FyX2RyaWZfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwy
X2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgcmNhcl9kcmlmX3NkciAqc2RyID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTg5Myw3ICs4OTQsOCBAQCBzdGF0aWMgaW50IHJjYXJfZHJpZl9z
ZXRfZGVmYXVsdF9mb3JtYXQoc3RydWN0IHJjYXJfZHJpZl9zZHIgKnNkcikKIAlyZXR1cm4gLUVJ
TlZBTDsKIH0KIAotc3RhdGljIGludCByY2FyX2RyaWZfZW51bV9mbXRfc2RyX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmNhcl9kcmlmX2VudW1fZm10X3Nk
cl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlpZiAo
Zi0+aW5kZXggPj0gQVJSQVlfU0laRShmb3JtYXRzKSkKQEAgLTkwNCw3ICs5MDYsOCBAQCBzdGF0
aWMgaW50IHJjYXJfZHJpZl9lbnVtX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJjYXJfZHJpZl9nX2ZtdF9zZHJf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByY2FyX2RyaWZf
Z19mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHJjYXJfZHJpZl9zZHIgKnNkciA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05MTUsNyAr
OTE4LDggQEAgc3RhdGljIGludCByY2FyX2RyaWZfZ19mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByY2FyX2RyaWZf
c19mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
cmNhcl9kcmlmX3NfZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCByY2FyX2RyaWZfc2RyICpzZHIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtOTU2LDcgKzk2MCw4IEBAIHN0YXRpYyBpbnQgcmNhcl9kcmlmX3NfZm10X3Nkcl9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
cmNhcl9kcmlmX3RyeV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgcmNhcl9kcmlmX3RyeV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXVuc2lnbmVkIGludCBpOwpAQCAtOTc2LDcgKzk4MSw4
IEBAIHN0YXRpYyBpbnQgcmNhcl9kcmlmX3RyeV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIH0KIAogLyogVHVuZXIgc3ViZGV2IGlvY3RscyAqLwotc3RhdGljIGlu
dCByY2FyX2RyaWZfZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCByY2FyX2RyaWZfZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBz
dHJ1Y3QgdjRsMl9mcmVxdWVuY3lfYmFuZCAqYmFuZCkKIHsKIAlzdHJ1Y3QgcmNhcl9kcmlmX3Nk
ciAqc2RyID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk4NCw3ICs5OTAsOCBAQCBzdGF0aWMg
aW50IHJjYXJfZHJpZl9lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIHY0bDJfc3ViZGV2X2NhbGwoc2RyLT5lcC5zdWJkZXYsIHR1bmVyLCBlbnVt
X2ZyZXFfYmFuZHMsIGJhbmQpOwogfQogCi1zdGF0aWMgaW50IHJjYXJfZHJpZl9nX2ZyZXF1ZW5j
eShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmNhcl9kcmlmX2df
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBy
Y2FyX2RyaWZfc2RyICpzZHIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTkyLDcgKzk5OSw4
IEBAIHN0YXRpYyBpbnQgcmNhcl9kcmlmX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKHNkci0+ZXAuc3ViZGV2LCB0dW5l
ciwgZ19mcmVxdWVuY3ksIGYpOwogfQogCi1zdGF0aWMgaW50IHJjYXJfZHJpZl9zX2ZyZXF1ZW5j
eShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmNhcl9kcmlmX3Nf
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0
cnVjdCByY2FyX2RyaWZfc2RyICpzZHIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTAwMCw3
ICsxMDA4LDggQEAgc3RhdGljIGludCByY2FyX2RyaWZfc19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHY0bDJfc3ViZGV2X2NhbGwoc2RyLT5lcC5zdWJk
ZXYsIHR1bmVyLCBzX2ZyZXF1ZW5jeSwgZik7CiB9CiAKLXN0YXRpYyBpbnQgcmNhcl9kcmlmX2df
dHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJjYXJfZHJp
Zl9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQogewogCXN0cnVj
dCByY2FyX2RyaWZfc2RyICpzZHIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTAwOCw3ICsx
MDE3LDggQEAgc3RhdGljIGludCByY2FyX2RyaWZfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gdjRsMl9zdWJkZXZfY2FsbChzZHItPmVwLnN1YmRldiwgdHVu
ZXIsIGdfdHVuZXIsIHZ0KTsKIH0KIAotc3RhdGljIGludCByY2FyX2RyaWZfc190dW5lcihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmNhcl9kcmlmX3NfdHVuZXIo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJICAgICBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCiB7CiAJc3RydWN0IHJj
YXJfZHJpZl9zZHIgKnNkciA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMvcmNhcl9mZHAxLmMgYi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL3JlbmVzYXMvcmNhcl9mZHAxLmMKaW5kZXggZTYxNWM1NjA4M2YxM2IxODNiZTViNDQ3
NjRmMjQ4OTRmNzUzOTgzOC4uZWY4MDU0ZGJkNDBjNzlmNTgzZjFkNzc5NWY5NTRkODE2ZGMzNjk2
YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3JjYXJfZmRwMS5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy9yY2FyX2ZkcDEuYwpAQCAtMTM1
OCw3ICsxMzU4LDggQEAgc3RhdGljIHZvaWQgZGV2aWNlX2ZyYW1lX2VuZChzdHJ1Y3QgZmRwMV9k
ZXYgKmZkcDEsCiAvKgogICogdmlkZW8gaW9jdGxzCiAgKi8KLXN0YXRpYyBpbnQgZmRwMV92aWRp
b2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGZk
cDFfdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQog
ewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIERSSVZFUl9OQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIp
KTsKQEAgLTEzOTIsMTkgKzEzOTMsMjIgQEAgc3RhdGljIGludCBmZHAxX2VudW1fZm10KHN0cnVj
dCB2NGwyX2ZtdGRlc2MgKmYsIHUzMiB0eXBlKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGZkcDFfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgZmRwMV9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm10ZGVz
YyAqZikKIHsKIAlyZXR1cm4gZmRwMV9lbnVtX2ZtdChmLCBGRFAxX0NBUFRVUkUpOwogfQogCi1z
dGF0aWMgaW50IGZkcDFfZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgZmRwMV9lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmKQogewogCXJldHVybiBmZHAxX2VudW1fZm10KGYsIEZEUDFfT1VUUFVU
KTsKIH0KIAotc3RhdGljIGludCBmZHAxX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IGZkcDFfZ19mbXQoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGZkcDFfY3R4ICpjdHggPSBmaWxlX3Rv
X2N0eChmaWxlKTsKIAlzdHJ1Y3QgZmRwMV9xX2RhdGEgKnFfZGF0YTsKQEAgLTE1ODIsNyArMTU4
Niw4IEBAIHN0YXRpYyB2b2lkIGZkcDFfdHJ5X2ZtdF9jYXB0dXJlKHN0cnVjdCBmZHAxX2N0eCAq
Y3R4LAogCWZkcDFfY29tcHV0ZV9zdHJpZGUocGl4LCBmbXQpOwogfQogCi1zdGF0aWMgaW50IGZk
cDFfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQorc3RhdGljIGludCBmZHAxX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCXN0cnVjdCBmZHAxX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAKQEAgLTE2NTMs
NyArMTY1OCw4IEBAIHN0YXRpYyB2b2lkIGZkcDFfc2V0X2Zvcm1hdChzdHJ1Y3QgZmRwMV9jdHgg
KmN0eCwKIAl9CiB9CiAKLXN0YXRpYyBpbnQgZmRwMV9zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBmZHAxX3NfZm10
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
ICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBmZHAxX2N0eCAqY3R4ID0g
ZmlsZV90b19jdHgoZmlsZSk7CiAJc3RydWN0IHY0bDJfbTJtX2N0eCAqbTJtX2N0eCA9IGN0eC0+
ZmgubTJtX2N0eDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy9y
Y2FyX2pwdS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3JjYXJfanB1LmMKaW5k
ZXggNDZlYTI1OWEyYmI5ZDMwODhhOTc3ZjExNDBmNDg5NTlmY2RlNDUxOC4uMjQ0NTMzYTQ4ODc4
OTc2ZmQ4NTA4MzVjNDdhZGQ5N2I1ODgyNzk3OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9w
bGF0Zm9ybS9yZW5lc2FzL3JjYXJfanB1LmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9y
ZW5lc2FzL3JjYXJfanB1LmMKQEAgLTY1Myw3ICs2NTMsOCBAQCBzdGF0aWMgdTgganB1X3BhcnNl
X2hkcih2b2lkICpidWZmZXIsIHVuc2lnbmVkIGxvbmcgc2l6ZSwgdW5zaWduZWQgaW50ICp3aWR0
aCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBqcHVfcXVlcnljYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGpwdV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJc3RydWN0IHY0
bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBqcHVfY3R4ICpjdHggPSBmaWxlX3RvX2N0
eChmaWxlKTsKQEAgLTcxMSw3ICs3MTIsOCBAQCBzdGF0aWMgaW50IGpwdV9lbnVtX2ZtdChzdHJ1
Y3QgdjRsMl9mbXRkZXNjICpmLCB1MzIgdHlwZSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBqcHVfZW51bV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBqcHVfZW51bV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYp
CiB7CiAJc3RydWN0IGpwdV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNzIwLDcg
KzcyMiw4IEBAIHN0YXRpYyBpbnQganB1X2VudW1fZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAkJCSAgICBKUFVfREVDX0NBUFRVUkUpOwogfQogCi1zdGF0aWMgaW50IGpw
dV9lbnVtX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IGpwdV9lbnVtX2ZtdF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsK
IAlzdHJ1Y3QganB1X2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC04MjEsNyArODI0
LDggQEAgc3RhdGljIGludCBfX2pwdV90cnlfZm10KHN0cnVjdCBqcHVfY3R4ICpjdHgsIHN0cnVj
dCBqcHVfZm10ICoqZm10aW5mbywKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBqcHVfdHJ5
X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQorc3RhdGljIGludCBqcHVfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IGpwdV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwogCkBAIC04MzEsNyAr
ODM1LDggQEAgc3RhdGljIGludCBqcHVfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiBfX2pwdV90cnlfZm10KGN0eCwg
TlVMTCwgJmYtPmZtdC5waXhfbXAsIGYtPnR5cGUpOwogfQogCi1zdGF0aWMgaW50IGpwdV9zX2Zt
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQor
c3RhdGljIGludCBqcHVfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3QgdmIyX3F1ZXVlICp2cTsKIAlzdHJ1Y3QganB1X2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmls
ZSk7CkBAIC04NjEsNyArODY2LDggQEAgc3RhdGljIGludCBqcHVfc19mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBqcHVfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQganB1X2dfZm10KHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGpwdV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUp
OwogCXN0cnVjdCBqcHVfcV9kYXRhICpxX2RhdGE7CkBAIC04OTUsNyArOTAxLDggQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCB2NGwyX2N0cmxfb3BzIGpwdV9jdHJsX29wcyA9IHsKIAkuc19jdHJsCQk9
IGpwdV9zX2N0cmwsCiB9OwogCi1zdGF0aWMgaW50IGpwdV9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgZW51bSB2NGwyX2J1Zl90eXBlIHR5cGUpCitzdGF0aWMgaW50IGpw
dV9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQllbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QganB1X3FfZGF0
YSAqc3JjX3FfZGF0YSwgKmRzdF9xX2RhdGEsICpvcmlnLCBhZGosICpyZWY7CiAJc3RydWN0IGpw
dV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9yZW5lc2FzL3JlbmVzYXMtY2V1LmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L3JlbmVzYXMvcmVuZXNhcy1jZXUuYwppbmRleCBkZWVkNDlkMGZiMTBlMGQ3ODM0YTMwMjkzZjZj
MWVkZTcwNTU0MDlhLi5iMjFjZGMxMThkYzcwNjU0Y2Y4Zjg3YTFhZDAwMjI4Njk3YWVmZTY5IDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMvcmVuZXNhcy1jZXUuYwor
KysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMvcmVuZXNhcy1jZXUuYwpAQCAtMTEy
MSw3ICsxMTIxLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVfb3BlcmF0aW9ucyBj
ZXVfZm9wcyA9IHsKIAogLyogLS0tIFZpZGVvIERldmljZSBJT0NUTHMgLS0tICovCiAKLXN0YXRp
YyBpbnQgY2V1X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBjZXVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQlzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlz
dHJ1Y3QgY2V1X2RldmljZSAqY2V1ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTExMzQs
NyArMTEzNSw4IEBAIHN0YXRpYyBpbnQgY2V1X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNldV9lbnVtX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjZXVfZW51bV9m
bXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWNvbnN0IHN0cnVj
dCBjZXVfZm10ICpmbXQ7CkBAIC0xMTQ4LDcgKzExNTAsOCBAQCBzdGF0aWMgaW50IGNldV9lbnVt
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IGNldV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IGNldV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAg
ICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjZXVfZGV2aWNlICpjZXVkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTE1Niw3ICsxMTU5LDggQEAgc3RhdGljIGludCBj
ZXVfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biBjZXVfdHJ5X2ZtdChjZXVkZXYsIGYpOwogfQogCi1zdGF0aWMgaW50IGNldV9zX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjZXVfc19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
Y2V1X2RldmljZSAqY2V1ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTExNjcsNyArMTE3
MSw4IEBAIHN0YXRpYyBpbnQgY2V1X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIGNldV9zZXRfZm10KGNldWRldiwgZik7CiB9CiAKLXN0YXRpYyBp
bnQgY2V1X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IGNldV9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCBjZXVfZGV2aWNlICpjZXVkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtMTE3Nyw3ICsxMTgyLDggQEAgc3RhdGljIGludCBjZXVfZ19mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBj
ZXVfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
Y2V1X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wKQogewogCXN0cnVj
dCBjZXVfZGV2aWNlICpjZXVkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTE5Miw3ICsx
MTk4LDggQEAgc3RhdGljIGludCBjZXVfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjZXVfZ19pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCBjZXVf
Z19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCSAgICAgICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IGNldV9kZXZpY2UgKmNl
dWRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTEyMDEsNyArMTIwOCw4IEBAIHN0YXRp
YyBpbnQgY2V1X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGludCAqaSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjZXVfc19pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IGNldV9z
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJICAgICAgIHVuc2lnbmVkIGludCBpKQogewogCXN0cnVjdCBjZXVfZGV2aWNlICpjZXVk
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBjZXVfc3ViZGV2ICpjZXVfc2Rfb2xk
OwpAQCAtMTI0NCwyMSArMTI1MiwyNCBAQCBzdGF0aWMgaW50IGNldV9zX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBjZXVfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgY2V1X2dfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVjdCB2
NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IGNldV9kZXZpY2UgKmNldWRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CiAKIAlyZXR1cm4gdjRsMl9nX3Bhcm1fY2FwKHZpZGVvX2RldmRhdGEo
ZmlsZSksIGNldWRldi0+c2QtPnY0bDJfc2QsIGEpOwogfQogCi1zdGF0aWMgaW50IGNldV9zX3Bh
cm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICph
KQorc3RhdGljIGludCBjZXVfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkK
IHsKIAlzdHJ1Y3QgY2V1X2RldmljZSAqY2V1ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAog
CXJldHVybiB2NGwyX3NfcGFybV9jYXAodmlkZW9fZGV2ZGF0YShmaWxlKSwgY2V1ZGV2LT5zZC0+
djRsMl9zZCwgYSk7CiB9CiAKLXN0YXRpYyBpbnQgY2V1X2VudW1fZnJhbWVzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNldV9lbnVtX2ZyYW1lc2l6ZXMoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVj
dCBjZXVfZGV2aWNlICpjZXVkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTI5MCw3ICsx
MzAxLDggQEAgc3RhdGljIGludCBjZXVfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjZXVfZW51bV9mcmFtZWlu
dGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNldV9lbnVt
X2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZybWl2YWxlbnVtICpmaXZh
bCkKIHsKIAlzdHJ1Y3QgY2V1X2RldmljZSAqY2V1ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy9yemcybC1jcnUvcnpn
MmwtdmlkZW8uYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy9yemcybC1jcnUvcnpn
MmwtdmlkZW8uYwppbmRleCAxNjJlMmFjZTY5MzE4NDBlZTA1MmUxNTY1NTg3ZDAyMWZjODczMDdm
Li40ZjJlNWE5OWM1Y2QxNDJiMjFhMmNmMjlhNzlkYmY3MzQ2MzA2MWI2IDEwMDY0NAotLS0gYS9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVzYXMvcnpnMmwtY3J1L3J6ZzJsLXZpZGVvLmMKKysr
IGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3J6ZzJsLWNydS9yemcybC12aWRlby5j
CkBAIC05NTEsNyArOTUxLDggQEAgc3RhdGljIHZvaWQgcnpnMmxfY3J1X3RyeV9mb3JtYXQoc3Ry
dWN0IHJ6ZzJsX2NydV9kZXYgKmNydSwKIAlyemcybF9jcnVfZm9ybWF0X2FsaWduKGNydSwgcGl4
KTsKIH0KIAotc3RhdGljIGludCByemcybF9jcnVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJ6ZzJsX2NydV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAg
ICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIs
IEtCVUlMRF9NT0ROQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTk2MCw3ICs5NjEsOCBA
QCBzdGF0aWMgaW50IHJ6ZzJsX2NydV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByemcybF9jcnVfdHJ5X2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByemcybF9jcnVf
dHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHJ6ZzJsX2NydV9kZXYgKmNydSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05
NzAsNyArOTcyLDggQEAgc3RhdGljIGludCByemcybF9jcnVfdHJ5X2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJ6
ZzJsX2NydV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCByemcybF9jcnVfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJc3RydWN0IHJ6ZzJsX2NydV9kZXYgKmNydSA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CkBAIC05ODUsNyArOTg4LDggQEAgc3RhdGljIGludCByemcybF9jcnVfc19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCByemcybF9jcnVfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgcnpnMmxfY3J1X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCByemcybF9jcnVfZGV2ICpjcnUgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtOTk1LDcgKzk5OSw4IEBAIHN0YXRpYyBpbnQgcnpnMmxfY3J1
X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgcnpnMmxfY3J1X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJ6ZzJsX2NydV9lbnVtX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJY29uc3Qgc3Ry
dWN0IHJ6ZzJsX2NydV9pcF9mb3JtYXQgKmZtdDsKQEAgLTEwMDksNyArMTAxNCw4IEBAIHN0YXRp
YyBpbnQgcnpnMmxfY3J1X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcnpnMmxfY3J1X2VudW1fZnJhbWVz
aXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHJ6ZzJsX2NydV9l
bnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpm
c2l6ZSkKIHsKIAlzdHJ1Y3QgcnpnMmxfY3J1X2RldiAqY3J1ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy9zaF92b3UuYyBi
L2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy9zaF92b3UuYwppbmRleCA0YWQ3YWUxODhk
NWIyNWFiMzgzZDY2NDg5OGY4NTVhNDgxOWMxYTg1Li41ZjRlZmE4NTIyNjlhNDA1NGQ4ZjBjOTFh
NDE5NDUwOWUxOTY2YTgxIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVz
YXMvc2hfdm91LmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3NoX3ZvdS5j
CkBAIC0zNjMsNyArMzYzLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIHNoX3ZvdV9x
b3BzID0gewogfTsKIAogLyogVmlkZW8gSU9DVExzICovCi1zdGF0aWMgaW50IHNoX3ZvdV9xdWVy
eWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IHNoX3ZvdV9x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVj
dCBzaF92b3VfZGV2aWNlICp2b3VfZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTM3Nyw3
ICszNzgsOCBAQCBzdGF0aWMgaW50IHNoX3ZvdV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAgKnByaXYsCiB9CiAKIC8qIEVudW1lcmF0ZSBmb3JtYXRzLCB0aGF0IHRoZSBkZXZpY2Ug
Y2FuIGFjY2VwdCBmcm9tIHRoZSB1c2VyICovCi1zdGF0aWMgaW50IHNoX3ZvdV9lbnVtX2ZtdF92
aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgc2hfdm91
X2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZm10KQog
ewogCXN0cnVjdCBzaF92b3VfZGV2aWNlICp2b3VfZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTM5Miw3ICszOTQsOCBAQCBzdGF0aWMgaW50IHNoX3ZvdV9lbnVtX2ZtdF92aWRfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBzaF92b3VfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgc2hfdm91X2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
bXQpCiB7CiAJc3RydWN0IHNoX3ZvdV9kZXZpY2UgKnZvdV9kZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtNjQ2LDcgKzY0OSw4IEBAIHN0YXRpYyB2b2lkIHZvdV9hZGp1c3Rfb3V0cHV0KHN0
cnVjdCBzaF92b3VfZ2VvbWV0cnkgKmdlbywgdjRsMl9zdGRfaWQgc3RkKQogCQkgdm91X3NjYWxl
X3ZfbnVtW2lkeF92XSwgdm91X3NjYWxlX3ZfZGVuW2lkeF92XSwgYmVzdCk7CiB9CiAKLXN0YXRp
YyBpbnQgc2hfdm91X3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgc2hfdm91X3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHNoX3ZvdV9kZXZpY2UgKnZvdV9kZXYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtNzU5LDE4ICs3NjMsMjAgQEAgc3RhdGljIGludCBzaF92b3Vf
c2V0X2ZtdF92aWRfb3V0KHN0cnVjdCBzaF92b3VfZGV2aWNlICp2b3VfZGV2LAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHNoX3ZvdV9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBzaF92b3Vfc19mbXRfdmlkX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3Qgc2hfdm91X2RldmljZSAqdm91X2RldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7Ci0JaW50IHJldCA9IHNoX3ZvdV90cnlfZm10X3ZpZF9vdXQo
ZmlsZSwgcHJpdiwgZm10KTsKKwlpbnQgcmV0ID0gc2hfdm91X3RyeV9mbXRfdmlkX291dChmaWxl
LCBzdGF0ZSwgZm10KTsKIAogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAJcmV0dXJuIHNoX3Zv
dV9zZXRfZm10X3ZpZF9vdXQodm91X2RldiwgJmZtdC0+Zm10LnBpeCk7CiB9CiAKLXN0YXRpYyBp
bnQgc2hfdm91X2VudW1fb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRp
YyBpbnQgc2hfdm91X2VudW1fb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9vdXRw
dXQgKmEpCiB7CiAJc3RydWN0IHNoX3ZvdV9kZXZpY2UgKnZvdV9kZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtNzgzLDEzICs3ODksMTUgQEAgc3RhdGljIGludCBzaF92b3VfZW51bV9vdXRw
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHNoX3ZvdV9nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVk
IGludCAqaSkKK3N0YXRpYyBpbnQgc2hfdm91X2dfb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHVuc2lnbmVkIGludCAqaSkK
IHsKIAkqaSA9IDA7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc2hfdm91X3Nfb3V0cHV0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50
IHNoX3ZvdV9zX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLCB1bnNpZ25lZCBpbnQgaSkKIHsKIAlyZXR1cm4gaSA/IC1FSU5W
QUwgOiAwOwogfQpAQCAtODEwLDcgKzgxOCw4IEBAIHN0YXRpYyB1MzIgc2hfdm91X250c2NfbW9k
ZShlbnVtIHNoX3ZvdV9idXNfZm10IGJ1c19mbXQpCiAJfQogfQogCi1zdGF0aWMgaW50IHNoX3Zv
dV9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgc3RkX2lk
KQorc3RhdGljIGludCBzaF92b3Vfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRfaWQgc3RkX2lkKQogewogCXN0cnVj
dCBzaF92b3VfZGV2aWNlICp2b3VfZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlpbnQgcmV0
OwpAQCAtODUyLDcgKzg2MSw4IEBAIHN0YXRpYyBpbnQgc2hfdm91X3Nfc3RkKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBzdGRfaWQpCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgc2hfdm91X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2
NGwyX3N0ZF9pZCAqc3RkKQorc3RhdGljIGludCBzaF92b3VfZ19zdGQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRfaWQgKnN0
ZCkKIHsKIAlzdHJ1Y3Qgc2hfdm91X2RldmljZSAqdm91X2RldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKQEAgLTg2Myw3ICs4NzMsOCBAQCBzdGF0aWMgaW50IHNoX3ZvdV9nX3N0ZChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKnN0ZCkKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBzaF92b3VfbG9nX3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdikKK3N0YXRpYyBpbnQgc2hfdm91X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlKQogewogCXN0cnVjdCBzaF92
b3VfZGV2aWNlICp2b3VfZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtODkwLDcgKzkw
MSw4IEBAIHN0YXRpYyBpbnQgc2hfdm91X2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc2hfdm91X2dfc2VsZWN0aW9u
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgc2hfdm91X2dfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsKIAlzdHJ1
Y3Qgc2hfdm91X2RldmljZSAqdm91X2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05MTgs
NyArOTMwLDggQEAgc3RhdGljIGludCBzaF92b3VfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLAogfQogCiAvKiBBc3N1bWUgYSBkdWxsIGVuY29kZXIsIGRvIGFsbCB0aGUg
d29yayBvdXJzZWx2ZXMuICovCi1zdGF0aWMgaW50IHNoX3ZvdV9zX3NlbGVjdGlvbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHNoX3ZvdV9zX3NlbGVjdGlvbihzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0IHY0bDJf
cmVjdCAqcmVjdCA9ICZzZWwtPnI7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L3JlbmVzYXMvdnNwMS92c3AxX2hpc3RvLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JlbmVz
YXMvdnNwMS92c3AxX2hpc3RvLmMKaW5kZXggMzkwZWE1MGYxNTk1YWQ3NzAyYmVjNDZlOWI5ZjNl
MjM3YzczYTYyMi4uNjkwOTFmYTVhN2NkNDZmMjNjY2I0ZjUwYTU1OTAxYjEyYjZlMTNjYiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3ZzcDEvdnNwMV9oaXN0by5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcmVuZXNhcy92c3AxL3ZzcDFfaGlzdG8uYwpA
QCAtMzg5LDcgKzM4OSw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdjRsMl9zdWJkZXZfb3BzIGhp
c3RvX29wcyA9IHsKICAqIFY0TDIgaW9jdGxzCiAgKi8KIAotc3RhdGljIGludCBoaXN0b192NGwy
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaGlzdG9f
djRsMl9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3RydWN0IHY0bDJfZmggKnZmaCA9IGZpbGVfdG9fdjRsMl9maChmaWxlKTsKQEAg
LTQwNiw3ICs0MDcsOCBAQCBzdGF0aWMgaW50IGhpc3RvX3Y0bDJfcXVlcnljYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGhpc3RvX3Y0
bDJfZW51bV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBo
aXN0b192NGwyX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQog
ewogCXN0cnVjdCB2NGwyX2ZoICp2ZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CkBAIC00MjAs
NyArNDIyLDggQEAgc3RhdGljIGludCBoaXN0b192NGwyX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBoaXN0b192NGwy
X2dldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBoaXN0
b192NGwyX2dldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIHsK
IAlzdHJ1Y3QgdjRsMl9maCAqdmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3ZzcDEvdnNwMV92aWRlby5jIGIvZHJp
dmVycy9tZWRpYS9wbGF0Zm9ybS9yZW5lc2FzL3ZzcDEvdnNwMV92aWRlby5jCmluZGV4IDc1Zjlh
MWE4NWQ1NThmZjBhZmEyZmRhZjhjNDNhMjJkZGJkNjk0YTguLjkxMzBmNDZlNDMzYTc5YzFhYzI4
NDhmYzM0NzA2N2Y2YzNmNDFjMjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
cmVuZXNhcy92c3AxL3ZzcDFfdmlkZW8uYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Jl
bmVzYXMvdnNwMS92c3AxX3ZpZGVvLmMKQEAgLTg5NCw3ICs4OTQsOCBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IHZiMl9vcHMgdnNwMV92aWRlb19xdWV1ZV9xb3BzID0gewogICovCiAKIHN0YXRpYyBp
bnQKLXZzcDFfdmlkZW9fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCit2c3AxX3ZpZGVvX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIHN0cnVjdCB2
NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgdjRsMl9maCAqdmZoID0gZmlsZV90b192
NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCB2c3AxX3ZpZGVvICp2aWRlbyA9IHRvX3ZzcDFfdmlkZW8o
dmZoLT52ZGV2KTsKQEAgLTkwOSw3ICs5MTAsOCBAQCB2c3AxX3ZpZGVvX3F1ZXJ5Y2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZzcDFfdmlkZW9fZW51bV9mb3JtYXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2c3AxX3ZpZGVvX2VudW1fZm9ybWF0KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2NGwyX2ZoICp2Zmgg
PSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CkBAIC05MzEsNyArOTMzLDggQEAgc3RhdGljIGludCB2
c3AxX3ZpZGVvX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIH0KIAog
c3RhdGljIGludAotdnNwMV92aWRlb19nZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmb3JtYXQpCit2c3AxX3ZpZGVvX2dldF9mb3JtYXQo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkg
ICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIHsKIAlzdHJ1Y3QgdjRsMl9maCAqdmZo
ID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCB2c3AxX3ZpZGVvICp2aWRlbyA9IHRv
X3ZzcDFfdmlkZW8odmZoLT52ZGV2KTsKQEAgLTk0Nyw3ICs5NTAsOCBAQCB2c3AxX3ZpZGVvX2dl
dF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmZvcm1hdCkKIH0KIAogc3RhdGljIGludAotdnNwMV92aWRlb190cnlfZm9ybWF0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmb3JtYXQpCit2c3AxX3Zp
ZGVvX3RyeV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIHsKIAlzdHJ1
Y3QgdjRsMl9maCAqdmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCB2c3AxX3Zp
ZGVvICp2aWRlbyA9IHRvX3ZzcDFfdmlkZW8odmZoLT52ZGV2KTsKQEAgLTk1OSw3ICs5NjMsOCBA
QCB2c3AxX3ZpZGVvX3RyeV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIH0KIAogc3RhdGljIGludAotdnNwMV92aWRlb19zZXRf
Zm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpm
b3JtYXQpCit2c3AxX3ZpZGVvX3NldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZv
cm1hdCkKIHsKIAlzdHJ1Y3QgdjRsMl9maCAqdmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwog
CXN0cnVjdCB2c3AxX3ZpZGVvICp2aWRlbyA9IHRvX3ZzcDFfdmlkZW8odmZoLT52ZGV2KTsKQEAg
LTk4OSw3ICs5OTQsOCBAQCB2c3AxX3ZpZGVvX3NldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIH0KIAogc3RhdGljIGludAot
dnNwMV92aWRlb19zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGVudW0gdjRs
Ml9idWZfdHlwZSB0eXBlKQordnNwMV92aWRlb19zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICBlbnVtIHY0bDJfYnVmX3R5
cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgdjRsMl9maCAqdmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUp
OwogCXN0cnVjdCB2c3AxX3ZpZGVvICp2aWRlbyA9IHRvX3ZzcDFfdmlkZW8odmZoLT52ZGV2KTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vcm9ja2NoaXAvcmdhL3JnYS5jIGIv
ZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yb2NrY2hpcC9yZ2EvcmdhLmMKaW5kZXggNzc2MDQ2ZGU5
NzlhYTBkZWQ2NzM0MjE2YmYxNzljMzJhZThmZTVhOS4uODdkMDFlZDVjM2RkY2YzZDEyYjA5MDIx
YmQ0M2MyY2ZjNjhmOGVlZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yb2Nr
Y2hpcC9yZ2EvcmdhLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yb2NrY2hpcC9yZ2Ev
cmdhLmMKQEAgLTQzNyw3ICs0MzcsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZmlsZV9v
cGVyYXRpb25zIHJnYV9mb3BzID0gewogfTsKIAogc3RhdGljIGludAotdmlkaW9jX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCit2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ry
c2NweShjYXAtPmRyaXZlciwgUkdBX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwogCXN0cnNj
cHkoY2FwLT5jYXJkLCAicm9ja2NoaXAtcmdhIiwgc2l6ZW9mKGNhcC0+Y2FyZCkpOwpAQCAtNDQ2
LDcgKzQ0Nyw5IEBAIHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBz
dHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCByZ2FfZm10ICpmbXQ7CiAKQEAgLTQ1
OSw3ICs0NjIsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZgogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2NfZ19mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBsYW5lICpwaXhfZm10ID0g
JmYtPmZtdC5waXhfbXA7CiAJc3RydWN0IHJnYV9jdHggKmN0eCA9IGZpbGVfdG9fcmdhX2N0eChm
aWxlKTsKQEAgLTQ4MSw3ICs0ODUsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBs
YW5lICpwaXhfZm10ID0gJmYtPmZtdC5waXhfbXA7CiAJc3RydWN0IHJnYV9mbXQgKmZtdDsKQEAg
LTUwMSw3ICs1MDYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeF9mbXQg
PSAmZi0+Zm10LnBpeF9tcDsKIAlzdHJ1Y3QgcmdhX2N0eCAqY3R4ID0gZmlsZV90b19yZ2FfY3R4
KGZpbGUpOwpAQCAtNTE0LDcgKzUyMCw3IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJLyogQWRq
dXN0IGFsbCB2YWx1ZXMgYWNjb3JkaW5nbHkgdG8gdGhlIGhhcmR3YXJlIGNhcGFiaWxpdGllcwog
CSAqIGFuZCBjaG9zZW4gZm9ybWF0LgogCSAqLwotCXJldCA9IHZpZGlvY190cnlfZm10KGZpbGUs
IHByaXYsIGYpOworCXJldCA9IHZpZGlvY190cnlfZm10KGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAo
cmV0KQogCQlyZXR1cm4gcmV0OwogCXZxID0gdjRsMl9tMm1fZ2V0X3ZxKGN0eC0+ZmgubTJtX2N0
eCwgZi0+dHlwZSk7CkBAIC01NTgsNyArNTY0LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlvbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCByZ2FfY3R4ICpj
dHggPSBmaWxlX3RvX3JnYV9jdHgoZmlsZSk7CkBAIC02MDYsNyArNjEzLDggQEAgc3RhdGljIGlu
dCB2aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19zZWxlY3Rpb24oc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CSAgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgcmdhX2N0eCAqY3R4
ID0gZmlsZV90b19yZ2FfY3R4KGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0
Zm9ybS9yb2NrY2hpcC9ya2lzcDEvcmtpc3AxLWNhcHR1cmUuYyBiL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vcm9ja2NoaXAvcmtpc3AxL3JraXNwMS1jYXB0dXJlLmMKaW5kZXggNmRjZWZkMTQ0ZDVh
YmUzNTgzMjNlMzdhYzYxMzNjNjEzNGFjNjM2ZS4uMzg1NDFmNDgyYjJkMGRjZjIzNTQ2YTBiOWY4
OTNmYjg1NDRiY2M0MCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yb2NrY2hp
cC9ya2lzcDEvcmtpc3AxLWNhcHR1cmUuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Jv
Y2tjaGlwL3JraXNwMS9ya2lzcDEtY2FwdHVyZS5jCkBAIC0xMzI2LDcgKzEzMjYsOCBAQCBzdGF0
aWMgdm9pZCBya2lzcDFfc2V0X2ZtdChzdHJ1Y3Qgcmtpc3AxX2NhcHR1cmUgKmNhcCwKIAljYXAt
PnN0cmlkZSA9IHBpeG0tPnBsYW5lX2ZtdFswXS5ieXRlc3BlcmxpbmUgLyBjYXAtPnBpeC5pbmZv
LT5icHBbMF07CiB9CiAKLXN0YXRpYyBpbnQgcmtpc3AxX3RyeV9mbXRfdmlkX2NhcF9tcGxhbmUo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBya2lzcDFfdHJ5X2ZtdF92
aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBya2lzcDFfY2FwdHVyZSAqY2FwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEzMzYsNyAr
MTMzNyw4IEBAIHN0YXRpYyBpbnQgcmtpc3AxX3RyeV9mbXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJraXNw
MV9lbnVtX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgcmtpc3AxX2VudW1fZm10X3ZpZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgIHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHJraXNwMV9jYXB0dXJlICpjYXAgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTM3MCw3ICsxMzcyLDggQEAgc3RhdGljIGludCBya2lz
cDFfZW51bV9mbXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgcmtpc3AxX2VudW1fZnJhbWVzaXpl
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHJraXNwMV9lbnVtX2Zy
YW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKIHsKIAlz
dGF0aWMgY29uc3QgdW5zaWduZWQgaW50IG1heF93aWR0aHNbXSA9IHsKQEAgLTE0MDAsNyArMTQw
Myw4IEBAIHN0YXRpYyBpbnQgcmtpc3AxX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiB9CiAKIHN0YXRpYyBpbnQgcmtpc3AxX3NfZm10X3ZpZF9jYXBfbXBsYW5l
KHN0cnVjdCBmaWxlICpmaWxlLAotCQkJCSAgICAgICB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHJraXNwMV9jYXB0
dXJlICpjYXAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBya2lzcDFfdmRldl9ub2Rl
ICpub2RlID0KQEAgLTE0MTQsNyArMTQxOCw4IEBAIHN0YXRpYyBpbnQgcmtpc3AxX3NfZm10X3Zp
ZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHJraXNwMV9nX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCitzdGF0aWMgaW50IHJraXNwMV9nX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgcmtpc3AxX2NhcHR1cmUg
KmNhcCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNDI1LDcgKzE0MzAsOCBAQCBzdGF0aWMg
aW50IHJraXNwMV9nX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCiB9CiAKIHN0YXRpYyBpbnQKLXJraXNwMV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQorcmtpc3AxX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
c3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIFJL
SVNQMV9EUklWRVJfTkFNRSwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7CiAJc3Ryc2NweShjYXAtPmNh
cmQsIFJLSVNQMV9EUklWRVJfTkFNRSwgc2l6ZW9mKGNhcC0+Y2FyZCkpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yb2NrY2hpcC9ya2lzcDEvcmtpc3AxLXBhcmFtcy5jIGIv
ZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yb2NrY2hpcC9ya2lzcDEvcmtpc3AxLXBhcmFtcy5jCmlu
ZGV4IGYxNTg1ZjhmYTBmNDc4MzA0Zjc0MzE3ZmQ5ZGQwOTE5OWM5NGVjODIuLjgzZGFlMjVlM2Mx
MGEwZGY0MzdiNTA1MmNjYWU2NDIyMWY0NjA4OTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEv
cGxhdGZvcm0vcm9ja2NoaXAvcmtpc3AxL3JraXNwMS1wYXJhbXMuYworKysgYi9kcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3JraXNwMS9ya2lzcDEtcGFyYW1zLmMKQEAgLTI0OTMsNyAr
MjQ5Myw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgcmtpc3AxX3BhcmFtc19vcHMgcmtpc3AxX3Yx
Ml9wYXJhbXNfb3BzID0gewogCS5hZm1fY29uZmlnID0gcmtpc3AxX2FmbV9jb25maWdfdjEyLAog
fTsKIAotc3RhdGljIGludCBya2lzcDFfcGFyYW1zX2VudW1fZm10X21ldGFfb3V0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBya2lzcDFfcGFyYW1zX2VudW1fZm10
X21ldGFfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1
Y3QgdmlkZW9fZGV2aWNlICp2aWRlbyA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CkBAIC0yNTA3LDcg
KzI1MDgsOCBAQCBzdGF0aWMgaW50IHJraXNwMV9wYXJhbXNfZW51bV9mbXRfbWV0YV9vdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
cmtpc3AxX3BhcmFtc19nX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IHJraXNwMV9wYXJhbXNfZ19mbXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmlkZW8gPSB2aWRlb19k
ZXZkYXRhKGZpbGUpOwpAQCAtMjUyMiw3ICsyNTI0LDggQEAgc3RhdGljIGludCBya2lzcDFfcGFy
YW1zX2dfZm10X21ldGFfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBya2lzcDFfcGFyYW1zX3RyeV9mbXRfbWV0YV9vdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBya2lzcDFfcGFyYW1zX3RyeV9mbXRf
bWV0YV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZpZGVvID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTI1MzYsNyArMjUz
OSw4IEBAIHN0YXRpYyBpbnQgcmtpc3AxX3BhcmFtc190cnlfZm10X21ldGFfb3V0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBya2lzcDFf
cGFyYW1zX3NfZm10X21ldGFfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRp
YyBpbnQgcmtpc3AxX3BhcmFtc19zX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2aWRlbyA9IHZpZGVvX2RldmRhdGEo
ZmlsZSk7CkBAIC0yNTU2LDcgKzI1NjAsOCBAQCBzdGF0aWMgaW50IHJraXNwMV9wYXJhbXNfc19m
bXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogfQogCiBzdGF0aWMgaW50
IHJraXNwMV9wYXJhbXNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCi0JCQkJICB2b2lkICpw
cml2LCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsK
IAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9yb2NrY2hpcC9ya2lzcDEvcmtpc3AxLXN0
YXRzLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3JraXNwMS9ya2lzcDEtc3Rh
dHMuYwppbmRleCBkNWZkYjhmODJkYzc4YjAxNDNmNzFkNzZmMzY4MTdkYjM4OTkyMWI3Li4wNDNm
MjNlZDljYmQxMjgxNmYzMzU1ZTU0ZGU4MzBhMWU3NDI5YWE5IDEwMDY0NAotLS0gYS9kcml2ZXJz
L21lZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3JraXNwMS9ya2lzcDEtc3RhdHMuYworKysgYi9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3JraXNwMS9ya2lzcDEtc3RhdHMuYwpAQCAtMTgs
NyArMTgsOCBAQAogI2RlZmluZSBSS0lTUDFfSVNQX1NUQVRTX1JFUV9CVUZTX01JTiAyCiAjZGVm
aW5lIFJLSVNQMV9JU1BfU1RBVFNfUkVRX0JVRlNfTUFYIDgKIAotc3RhdGljIGludCBya2lzcDFf
c3RhdHNfZW51bV9mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHJraXNwMV9zdGF0c19lbnVtX2ZtdF9tZXRhX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICBzdHJ1
Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZpZGVvID0gdmlk
ZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTMxLDcgKzMyLDggQEAgc3RhdGljIGludCBya2lzcDFfc3Rh
dHNfZW51bV9mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcmtpc3AxX3N0YXRzX2dfZm10X21ldGFfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBya2lzcDFfc3RhdHNfZ19mbXRf
bWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHZpZGVvX2RldmljZSAqdmlkZW8gPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtNDks
NyArNTEsOCBAQCBzdGF0aWMgaW50IHJraXNwMV9zdGF0c19nX2ZtdF9tZXRhX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIAogc3RhdGljIGludCBya2lzcDFfc3RhdHNfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCi0JCQkJIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Nh
cGFiaWxpdHkgKmNhcCkKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQkJIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNl
ICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9yb2NrY2hpcC9ya3ZkZWMvcmt2ZGVjLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRm
b3JtL3JvY2tjaGlwL3JrdmRlYy9ya3ZkZWMuYwppbmRleCA5ZmE4MGFiM2M2MmI3NzUzZTZjOTky
YWVmZDEwNmVlOTllZDM3NWU0Li5jODdlMjA2YTY1ZjBiMzNjMTBiZjcxYjNkNjRjNDZiZGI2MmVi
ZDQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3JrdmRlYy9y
a3ZkZWMuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3JvY2tjaGlwL3JrdmRlYy9ya3Zk
ZWMuYwpAQCAtMzEzLDcgKzMxMyw4IEBAIHN0YXRpYyB2b2lkIHJrdmRlY19yZXNldF9jb2RlZF9m
bXQoc3RydWN0IHJrdmRlY19jdHggKmN0eCkKIAkJY3R4LT5jb2RlZF9mbXRfZGVzYy0+b3BzLT5h
ZGp1c3RfZm10KGN0eCwgZik7CiB9CiAKLXN0YXRpYyBpbnQgcmt2ZGVjX2VudW1fZnJhbWVzaXpl
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmt2ZGVjX2VudW1f
ZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewog
CWNvbnN0IHN0cnVjdCBya3ZkZWNfY29kZWRfZm10X2Rlc2MgKmZtdDsKQEAgLTMzNiw3ICszMzcs
OCBAQCBzdGF0aWMgaW50IHJrdmRlY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcmt2ZGVjX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBya3ZkZWNfcXVlcnlj
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3Qgcmt2
ZGVjX2RldiAqcmt2ZGVjID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTM1MCw3ICszNTIsOCBA
QCBzdGF0aWMgaW50IHJrdmRlY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBya3ZkZWNfdHJ5X2NhcHR1cmVfZm10KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBya3ZkZWNfdHJ5X2NhcHR1
cmVfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHY0bDJf
cGl4X2Zvcm1hdF9tcGxhbmUgKnBpeF9tcCA9ICZmLT5mbXQucGl4X21wOwpAQCAtMzgzLDcgKzM4
Niw4IEBAIHN0YXRpYyBpbnQgcmt2ZGVjX3RyeV9jYXB0dXJlX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBya3ZkZWNfdHJ5X291
dHB1dF9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJrdmRl
Y190cnlfb3V0cHV0X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3QgdjRsMl9waXhfZm9ybWF0X21wbGFuZSAqcGl4X21wID0gJmYtPmZtdC5waXhfbXA7CkBAIC00
MTUsNyArNDE5LDggQEAgc3RhdGljIGludCBya3ZkZWNfdHJ5X291dHB1dF9mbXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcmt2ZGVj
X3NfY2FwdHVyZV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHJrdmRlY19zX2NhcHR1cmVfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3Qgcmt2ZGVjX2N0eCAqY3R4ID0gZmlsZV90b19ya3ZkZWNfY3R4KGZpbGUpOwpAQCAtNDI4
LDcgKzQzMyw3IEBAIHN0YXRpYyBpbnQgcmt2ZGVjX3NfY2FwdHVyZV9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHZiMl9pc19idXN5KHZxKSkKIAkJcmV0dXJuIC1FQlVT
WTsKIAotCXJldCA9IHJrdmRlY190cnlfY2FwdHVyZV9mbXQoZmlsZSwgcHJpdiwgZik7CisJcmV0
ID0gcmt2ZGVjX3RyeV9jYXB0dXJlX2ZtdChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJ
cmV0dXJuIHJldDsKIApAQCAtNDM2LDcgKzQ0MSw4IEBAIHN0YXRpYyBpbnQgcmt2ZGVjX3NfY2Fw
dHVyZV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgcmt2ZGVjX3Nfb3V0cHV0X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgcmt2ZGVjX3Nfb3V0cHV0X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHJrdmRlY19jdHggKmN0eCA9IGZpbGVf
dG9fcmt2ZGVjX2N0eChmaWxlKTsKQEAgLTQ2Niw3ICs0NzIsNyBAQCBzdGF0aWMgaW50IHJrdmRl
Y19zX291dHB1dF9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHZiMl9p
c19idXN5KHBlZXJfdnEpKQogCQlyZXR1cm4gLUVCVVNZOwogCi0JcmV0ID0gcmt2ZGVjX3RyeV9v
dXRwdXRfZm10KGZpbGUsIHByaXYsIGYpOworCXJldCA9IHJrdmRlY190cnlfb3V0cHV0X2ZtdChm
aWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtNTAxLDcgKzUw
Nyw4IEBAIHN0YXRpYyBpbnQgcmt2ZGVjX3Nfb3V0cHV0X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBya3ZkZWNfZ19vdXRwdXRf
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBya3ZkZWNfZ19v
dXRwdXRfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3Qgcmt2ZGVjX2N0eCAqY3R4ID0gZmlsZV90b19ya3ZkZWNfY3R4KGZpbGUpOwpAQCAtNTEw
LDcgKzUxNyw4IEBAIHN0YXRpYyBpbnQgcmt2ZGVjX2dfb3V0cHV0X2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBya3ZkZWNfZ19j
YXB0dXJlX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmt2
ZGVjX2dfY2FwdHVyZV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBya3ZkZWNfY3R4ICpjdHggPSBmaWxlX3RvX3JrdmRlY19jdHgoZmlsZSk7CkBAIC01MTksNyAr
NTI3LDggQEAgc3RhdGljIGludCBya3ZkZWNfZ19jYXB0dXJlX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBya3ZkZWNfZW51bV9v
dXRwdXRfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBya3Zk
ZWNfZW51bV9vdXRwdXRfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewog
CWlmIChmLT5pbmRleCA+PSBBUlJBWV9TSVpFKHJrdmRlY19jb2RlZF9mbXRzKSkKQEAgLTUyOSw3
ICs1MzgsOCBAQCBzdGF0aWMgaW50IHJrdmRlY19lbnVtX291dHB1dF9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcmt2ZGVjX2Vu
dW1fY2FwdHVyZV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHJrdmRlY19lbnVtX2NhcHR1cmVfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRlc2Mg
KmYpCiB7CiAJc3RydWN0IHJrdmRlY19jdHggKmN0eCA9IGZpbGVfdG9fcmt2ZGVjX2N0eChmaWxl
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9leHlub3MtZ3Nj
L2dzYy1tMm0uYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9leHlub3MtZ3NjL2dz
Yy1tMm0uYwppbmRleCA3MjJlMjUzMWUyM2YxYmMwMWY1ZTlhOWMwOGRmZTQ3NDVjYzJhYTRmLi45
NjRjMDEyMWFlZTE2MmIyZmMyYjZiNmIyZmJlOGUyMWNjYzlkYTRlIDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcvZXh5bm9zLWdzYy9nc2MtbTJtLmMKKysrIGIvZHJp
dmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL2V4eW5vcy1nc2MvZ3NjLW0ybS5jCkBAIC0yODAs
NyArMjgwLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIGdzY19tMm1fcW9wcyA9IHsK
IAkuc3RhcnRfc3RyZWFtaW5nID0gZ3NjX20ybV9zdGFydF9zdHJlYW1pbmcsCiB9OwogCi1zdGF0
aWMgaW50IGdzY19tMm1fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3Rh
dGljIGludCBnc2NfbTJtX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0
eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIEdTQ19NT0RVTEVfTkFNRSwgc2l6ZW9m
KGNhcC0+ZHJpdmVyKSk7CkBAIC0yODgsMTMgKzI4OSwxNSBAQCBzdGF0aWMgaW50IGdzY19tMm1f
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGdzY19tMm1fZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IGdzY19tMm1fZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfZm10
ZGVzYyAqZikKIHsKIAlyZXR1cm4gZ3NjX2VudW1fZm10KGYpOwogfQogCi1zdGF0aWMgaW50IGdz
Y19tMm1fZ19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBp
bnQgZ3NjX20ybV9nX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IHsKIAlzdHJ1Y3QgZ3NjX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC0zMDIsNyAr
MzA1LDggQEAgc3RhdGljIGludCBnc2NfbTJtX2dfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiAJcmV0dXJuIGdzY19nX2ZtdF9tcGxhbmUoY3R4LCBmKTsKIH0KIAotc3Rh
dGljIGludCBnc2NfbTJtX3RyeV9mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKK3N0YXRpYyBpbnQgZ3NjX20ybV90cnlfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBnc2NfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxl
KTsKQEAgLTMxMCw3ICszMTQsOCBAQCBzdGF0aWMgaW50IGdzY19tMm1fdHJ5X2ZtdF9tcGxhbmUo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiBnc2NfdHJ5X2ZtdF9tcGxhbmUo
Y3R4LCBmKTsKIH0KIAotc3RhdGljIGludCBnc2NfbTJtX3NfZm10X21wbGFuZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGdzY19tMm1fc19mbXRfbXBsYW5lKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGdzY19jdHggKmN0eCA9IGZpbGVf
dG9fY3R4KGZpbGUpOwpAQCAtMzE5LDcgKzMyNCw3IEBAIHN0YXRpYyBpbnQgZ3NjX20ybV9zX2Zt
dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXN0cnVjdCB2NGwyX3BpeF9m
b3JtYXRfbXBsYW5lICpwaXg7CiAJaW50IGksIHJldCA9IDA7CiAKLQlyZXQgPSBnc2NfbTJtX3Ry
eV9mbXRfbXBsYW5lKGZpbGUsIGZoLCBmKTsKKwlyZXQgPSBnc2NfbTJtX3RyeV9mbXRfbXBsYW5l
KGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC0zNTYsNyAr
MzYxLDggQEAgc3RhdGljIGludCBnc2NfbTJtX3NfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZ3NjX20ybV9yZXFidWZz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZ3NjX20ybV9yZXFidWZz
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgIHN0cnVjdCB2NGwyX3JlcXVlc3RidWZmZXJzICpyZXFidWZzKQogewogCXN0cnVj
dCBnc2NfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTM3MSwzNSArMzc3LDQwIEBA
IHN0YXRpYyBpbnQgZ3NjX20ybV9yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IAlyZXR1cm4gdjRsMl9tMm1fcmVxYnVmcyhmaWxlLCBjdHgtPm0ybV9jdHgsIHJlcWJ1ZnMpOwog
fQogCi1zdGF0aWMgaW50IGdzY19tMm1fZXhwYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKK3N0YXRpYyBpbnQgZ3NjX20ybV9leHBidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2V4cG9ydGJ1
ZmZlciAqZWIpCiB7CiAJc3RydWN0IGdzY19jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwog
CXJldHVybiB2NGwyX20ybV9leHBidWYoZmlsZSwgY3R4LT5tMm1fY3R4LCBlYik7CiB9CiAKLXN0
YXRpYyBpbnQgZ3NjX20ybV9xdWVyeWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitz
dGF0aWMgaW50IGdzY19tMm1fcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2J1ZmZlciAq
YnVmKQogewogCXN0cnVjdCBnc2NfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKIAlyZXR1
cm4gdjRsMl9tMm1fcXVlcnlidWYoZmlsZSwgY3R4LT5tMm1fY3R4LCBidWYpOwogfQogCi1zdGF0
aWMgaW50IGdzY19tMm1fcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMg
aW50IGdzY19tMm1fcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCXN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKIHsKIAlzdHJ1
Y3QgZ3NjX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAJcmV0dXJuIHY0bDJfbTJtX3Fi
dWYoZmlsZSwgY3R4LT5tMm1fY3R4LCBidWYpOwogfQogCi1zdGF0aWMgaW50IGdzY19tMm1fZHFi
dWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBnc2NfbTJtX2RxYnVm
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJICAgc3RydWN0IHY0bDJfYnVmZmVyICpidWYpCiB7CiAJc3RydWN0IGdzY19jdHggKmN0
eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwogCXJldHVybiB2NGwyX20ybV9kcWJ1ZihmaWxlLCBjdHgt
Pm0ybV9jdHgsIGJ1Zik7CiB9CiAKLXN0YXRpYyBpbnQgZ3NjX20ybV9zdHJlYW1vbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGdzY19tMm1fc3RyZWFtb24oc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgICBlbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgZ3NjX2N0eCAqY3R4ID0g
ZmlsZV90b19jdHgoZmlsZSk7CkBAIC00MTUsNyArNDI2LDggQEAgc3RhdGljIGludCBnc2NfbTJt
X3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gdjRsMl9tMm1f
c3RyZWFtb24oZmlsZSwgY3R4LT5tMm1fY3R4LCB0eXBlKTsKIH0KIAotc3RhdGljIGludCBnc2Nf
bTJtX3N0cmVhbW9mZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGdz
Y19tMm1fc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICBlbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsK
IAlzdHJ1Y3QgZ3NjX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC00MzcsNyArNDQ5
LDggQEAgc3RhdGljIGludCBpc19yZWN0YW5nbGVfZW5jbG9zZWQoc3RydWN0IHY0bDJfcmVjdCAq
YSwgc3RydWN0IHY0bDJfcmVjdCAqYikKIAlyZXR1cm4gMTsKIH0KIAotc3RhdGljIGludCBnc2Nf
bTJtX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
Z3NjX20ybV9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykK
IHsKIAlzdHJ1Y3QgZ3NjX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC00NzQsNyAr
NDg3LDggQEAgc3RhdGljIGludCBnc2NfbTJtX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIAlyZXR1cm4gLUVJTlZBTDsKIH0KIAotc3RhdGljIGludCBnc2NfbTJtX3Nf
c2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZ3NjX20y
bV9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJ
c3RydWN0IGdzY19mcmFtZSAqZnJhbWU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRm
b3JtL3NhbXN1bmcvZXh5bm9zNC1pcy9maW1jLWNhcHR1cmUuYyBiL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vc2Ftc3VuZy9leHlub3M0LWlzL2ZpbWMtY2FwdHVyZS5jCmluZGV4IDViNDEyYWZkN2Q2
MDUyZjc0OTFjY2Y1OTYxMjEwMjVhNGZjNDlmNDEuLjFlMDhjZTMzODU2ZDM4YWQ1MWU1NDBkNjU0
YmVlYjA2NDE5Y2I0OWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3Vu
Zy9leHlub3M0LWlzL2ZpbWMtY2FwdHVyZS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
c2Ftc3VuZy9leHlub3M0LWlzL2ZpbWMtY2FwdHVyZS5jCkBAIC03MDgsNyArNzA4LDggQEAgc3Rh
dGljIHZvaWQgZmltY19jYXB0dXJlX3RyeV9zZWxlY3Rpb24oc3RydWN0IGZpbWNfY3R4ICpjdHgs
CiAvKgogICogVGhlIHZpZGVvIG5vZGUgaW9jdGwgb3BlcmF0aW9ucwogICovCi1zdGF0aWMgaW50
IGZpbWNfY2FwX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBmaW1jX2NhcF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkg
KmNhcCkKIHsKIAlzdHJ1Y3QgZmltY19kZXYgKmZpbWMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtNzE3LDcgKzcxOCw4IEBAIHN0YXRpYyBpbnQgZmltY19jYXBfcXVlcnljYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZmltY19j
YXBfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGZp
bWNfY2FwX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsK
IAljb25zdCBzdHJ1Y3QgZmltY19mbXQgKmZtdDsKQEAgLTg4NSw3ICs4ODcsOCBAQCBzdGF0aWMg
aW50IGZpbWNfZ2V0X3NlbnNvcl9mcmFtZV9kZXNjKHN0cnVjdCB2NGwyX3N1YmRldiAqc2Vuc29y
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGZpbWNfY2FwX2dfZm10X21wbGFuZShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGZpbWNfY2FwX2dfZm10X21wbGFu
ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZmltY19kZXYgKmZp
bWMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTgwLDcgKzk4Myw4IEBAIHN0YXRpYyBpbnQg
X192aWRlb190cnlfb3Jfc2V0X2Zvcm1hdChzdHJ1Y3QgZmltY19kZXYgKmZpbWMsCiAJcmV0dXJu
IHJldDsKIH0KIAotc3RhdGljIGludCBmaW1jX2NhcF90cnlfZm10X21wbGFuZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGZpbWNfY2FwX3RyeV9mbXRfbXBsYW5lKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZmltY19kZXYgKmZp
bWMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTA0NSw3ICsxMDQ5LDggQEAgc3RhdGljIGlu
dCBfX2ZpbWNfY2FwdHVyZV9zZXRfZm9ybWF0KHN0cnVjdCBmaW1jX2RldiAqZmltYywKIAlyZXR1
cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IGZpbWNfY2FwX3NfZm10X21wbGFuZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZmltY19jYXBfc19mbXRfbXBsYW5lKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBmaW1jX2RldiAqZmltYyA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDUzLDcgKzEwNTgsOCBAQCBzdGF0aWMgaW50IGZp
bWNfY2FwX3NfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gX19maW1jX2NhcHR1cmVfc2V0X2Zvcm1hdChmaW1jLCBmKTsKIH0KIAotc3RhdGljIGludCBm
aW1jX2NhcF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBmaW1jX2NhcF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2lu
cHV0ICppKQogewogCXN0cnVjdCBmaW1jX2RldiAqZmltYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC0xMDc0LDEyICsxMDgwLDE0IEBAIHN0YXRpYyBpbnQgZmltY19jYXBfZW51bV9pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBmaW1jX2NhcF9zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25l
ZCBpbnQgaSkKK3N0YXRpYyBpbnQgZmltY19jYXBfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5zaWduZWQgaW50IGkp
CiB7CiAJcmV0dXJuIGkgPT0gMCA/IGkgOiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IGZpbWNf
Y2FwX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAq
aSkKK3N0YXRpYyBpbnQgZmltY19jYXBfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5zaWduZWQgaW50ICppKQogewog
CSppID0gMDsKIAlyZXR1cm4gMDsKQEAgLTExNzMsNyArMTE4MSw4IEBAIHN0YXRpYyBpbnQgZmlt
Y19waXBlbGluZV92YWxpZGF0ZShzdHJ1Y3QgZmltY19kZXYgKmZpbWMpCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgZmltY19jYXBfc3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IGZpbWNfY2FwX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgZW51bSB2
NGwyX2J1Zl90eXBlIHR5cGUpCiB7CiAJc3RydWN0IGZpbWNfZGV2ICpmaW1jID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTEyMTIsNyArMTIyMSw3IEBAIHN0YXRpYyBpbnQgZmltY19jYXBfc3Ry
ZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQlnb3RvIGVycl9wX3N0b3A7
CiAJfQogCi0JcmV0ID0gdmIyX2lvY3RsX3N0cmVhbW9uKGZpbGUsIHByaXYsIHR5cGUpOworCXJl
dCA9IHZiMl9pb2N0bF9zdHJlYW1vbihmaWxlLCBzdGF0ZSwgdHlwZSk7CiAJaWYgKCFyZXQpIHsK
IAkJdmMtPnN0cmVhbWluZyA9IHRydWU7CiAJCXJldHVybiByZXQ7CkBAIC0xMjIzLDE0ICsxMjMy
LDE1IEBAIHN0YXRpYyBpbnQgZmltY19jYXBfc3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBmaW1jX2NhcF9zdHJlYW1v
ZmYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGZpbWNfY2FwX3N0
cmVhbW9mZihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJICAgIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQogewogCXN0cnVj
dCBmaW1jX2RldiAqZmltYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGZpbWNfdmlk
X2NhcCAqdmMgPSAmZmltYy0+dmlkX2NhcDsKIAlpbnQgcmV0OwogCi0JcmV0ID0gdmIyX2lvY3Rs
X3N0cmVhbW9mZihmaWxlLCBwcml2LCB0eXBlKTsKKwlyZXQgPSB2YjJfaW9jdGxfc3RyZWFtb2Zm
KGZpbGUsIHN0YXRlLCB0eXBlKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAt
MTI0MiwxMyArMTI1MiwxNCBAQCBzdGF0aWMgaW50IGZpbWNfY2FwX3N0cmVhbW9mZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBmaW1j
X2NhcF9yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBm
aW1jX2NhcF9yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX3JlcXVlc3RidWZmZXJzICpy
ZXFidWZzKQogewogCXN0cnVjdCBmaW1jX2RldiAqZmltYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CiAJaW50IHJldDsKIAotCXJldCA9IHZiMl9pb2N0bF9yZXFidWZzKGZpbGUsIHByaXYsIHJlcWJ1
ZnMpOworCXJldCA9IHZiMl9pb2N0bF9yZXFidWZzKGZpbGUsIHN0YXRlLCByZXFidWZzKTsKIAog
CWlmICghcmV0KQogCQlmaW1jLT52aWRfY2FwLnJlcWJ1ZnNfY291bnQgPSByZXFidWZzLT5jb3Vu
dDsKQEAgLTEyNTYsNyArMTI2Nyw4IEBAIHN0YXRpYyBpbnQgZmltY19jYXBfcmVxYnVmcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50
IGZpbWNfY2FwX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRp
YyBpbnQgZmltY19jYXBfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfc2VsZWN0aW9uICpz
KQogewogCXN0cnVjdCBmaW1jX2RldiAqZmltYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0x
MjkzLDcgKzEzMDUsOCBAQCBzdGF0aWMgaW50IGZpbWNfY2FwX2dfc2VsZWN0aW9uKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gLUVJTlZBTDsKIH0KIAotc3RhdGljIGludCBm
aW1jX2NhcF9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMg
aW50IGZpbWNfY2FwX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykK
IHsKIAlzdHJ1Y3QgZmltY19kZXYgKmZpbWMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL2V4eW5vczQtaXMvZmltYy1pc3At
dmlkZW8uYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9leHlub3M0LWlzL2ZpbWMt
aXNwLXZpZGVvLmMKaW5kZXggYWQyMTlhYzFiOTUxMzdhNzAzZWE3MDlkMTIxMzljY2E2YjJlMjMz
Mi4uMWE5ODVhOWI2YzU2ZTRmMDM5NzdkZjI3NzMyODk2MWM2Mjg1NDcwMyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL2V4eW5vczQtaXMvZmltYy1pc3AtdmlkZW8u
YworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcvZXh5bm9zNC1pcy9maW1jLWlz
cC12aWRlby5jCkBAIC0zNDIsNyArMzQyLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2Zp
bGVfb3BlcmF0aW9ucyBpc3BfdmlkZW9fZm9wcyA9IHsKIC8qCiAgKiBWaWRlbyBub2RlIGlvY3Rs
IG9wZXJhdGlvbnMKICAqLwotc3RhdGljIGludCBpc3BfdmlkZW9fcXVlcnljYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGlzcF92aWRlb19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGZpbWNfaXNw
ICppc3AgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzUxLDcgKzM1Miw4IEBAIHN0YXRpYyBp
bnQgaXNwX3ZpZGVvX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IGlzcF92aWRlb19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXNwX3ZpZGVvX2VudW1fZm10KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWNvbnN0IHN0cnVjdCBmaW1jX2Zt
dCAqZm10OwpAQCAtMzY4LDcgKzM3MCw4IEBAIHN0YXRpYyBpbnQgaXNwX3ZpZGVvX2VudW1fZm10
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGlzcF92aWRlb19nX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAor
c3RhdGljIGludCBpc3BfdmlkZW9fZ19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgZmltY19pc3AgKmlzcCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC00MDIsNyArNDA1LDggQEAgc3RhdGljIHZvaWQgX19pc3BfdmlkZW9fdHJ5X2ZtdChzdHJ1
Y3QgZmltY19pc3AgKmlzcCwKIAkJCSAgICAgIEZJTUNfSVNQX1NPVVJDRV9IRUlHSFRfTUFYLCAw
LCAwKTsKIH0KIAotc3RhdGljIGludCBpc3BfdmlkZW9fdHJ5X2ZtdF9tcGxhbmUoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpc3BfdmlkZW9fdHJ5X2ZtdF9tcGxhbmUo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGZpbWNfaXNwICpp
c3AgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNDExLDcgKzQxNSw4IEBAIHN0YXRpYyBpbnQg
aXNwX3ZpZGVvX3RyeV9mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpc3BfdmlkZW9fc19mbXRfbXBsYW5lKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBpc3BfdmlkZW9fc19mbXRfbXBsYW5l
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZmltY19pc3AgKmlz
cCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00ODcsNyArNDkyLDggQEAgc3RhdGljIGludCBp
c3BfdmlkZW9fcGlwZWxpbmVfdmFsaWRhdGUoc3RydWN0IGZpbWNfaXNwICppc3ApCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgaXNwX3ZpZGVvX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBpc3BfdmlkZW9fc3RyZWFtb24oc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
ICAgICBlbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgZmltY19pc3AgKmlzcCA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01MDIsNyArNTA4LDcgQEAgc3RhdGljIGludCBpc3Bf
dmlkZW9fc3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHJldCA8
IDApCiAJCWdvdG8gcF9zdG9wOwogCi0JcmV0ID0gdmIyX2lvY3RsX3N0cmVhbW9uKGZpbGUsIHBy
aXYsIHR5cGUpOworCXJldCA9IHZiMl9pb2N0bF9zdHJlYW1vbihmaWxlLCBzdGF0ZSwgdHlwZSk7
CiAJaWYgKHJldCA8IDApCiAJCWdvdG8gcF9zdG9wOwogCkBAIC01MTMsMTQgKzUxOSwxNSBAQCBz
dGF0aWMgaW50IGlzcF92aWRlb19zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IGlzcF92aWRlb19zdHJlYW1vZmYoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGlzcF92aWRlb19zdHJlYW1v
ZmYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJCWVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQogewogCXN0cnVjdCBmaW1j
X2lzcCAqaXNwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgZmltY19pc192aWRlbyAq
dmlkZW8gPSAmaXNwLT52aWRlb19jYXB0dXJlOwogCWludCByZXQ7CiAKLQlyZXQgPSB2YjJfaW9j
dGxfc3RyZWFtb2ZmKGZpbGUsIHByaXYsIHR5cGUpOworCXJldCA9IHZiMl9pb2N0bF9zdHJlYW1v
ZmYoZmlsZSwgc3RhdGUsIHR5cGUpOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4gcmV0OwogCkBA
IC01MjksMTkgKzUzNiwyMCBAQCBzdGF0aWMgaW50IGlzcF92aWRlb19zdHJlYW1vZmYoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXNw
X3ZpZGVvX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IGlzcF92aWRlb19yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAq
cmIpCiB7CiAJc3RydWN0IGZpbWNfaXNwICppc3AgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWlu
dCByZXQ7CiAKLQlyZXQgPSB2YjJfaW9jdGxfcmVxYnVmcyhmaWxlLCBwcml2LCByYik7CisJcmV0
ID0gdmIyX2lvY3RsX3JlcWJ1ZnMoZmlsZSwgc3RhdGUsIHJiKTsKIAlpZiAocmV0IDwgMCkKIAkJ
cmV0dXJuIHJldDsKIAogCWlmIChyYi0+Y291bnQgJiYgcmItPmNvdW50IDwgRklNQ19JU1BfUkVR
X0JVRlNfTUlOKSB7CiAJCXJiLT5jb3VudCA9IDA7Ci0JCXZiMl9pb2N0bF9yZXFidWZzKGZpbGUs
IHByaXYsIHJiKTsKKwkJdmIyX2lvY3RsX3JlcWJ1ZnMoZmlsZSwgc3RhdGUsIHJiKTsKIAkJcmV0
ID0gLUVOT01FTTsKIAl9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ft
c3VuZy9leHlub3M0LWlzL2ZpbWMtbGl0ZS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1z
dW5nL2V4eW5vczQtaXMvZmltYy1saXRlLmMKaW5kZXggMGNlMjkzYjA3MThiNmE0OTZiMDYyNzVl
YmU3NzhmMTE4OTUxZDdiZi4uOGIyMmI2OGIwMGIwNWYzMzZjNzg4MTI3NjM2M2E1OTQxMDViNzNj
ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL2V4eW5vczQtaXMv
ZmltYy1saXRlLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL2V4eW5vczQt
aXMvZmltYy1saXRlLmMKQEAgLTYzOSw3ICs2MzksOCBAQCBzdGF0aWMgdm9pZCBmaW1jX2xpdGVf
dHJ5X2NvbXBvc2Uoc3RydWN0IGZpbWNfbGl0ZSAqZmltYywgc3RydWN0IHY0bDJfcmVjdCAqcikK
IC8qCiAgKiBWaWRlbyBub2RlIGlvY3RsIG9wZXJhdGlvbnMKICAqLwotc3RhdGljIGludCBmaW1j
X2xpdGVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IGZpbWNfbGl0ZV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgRklNQ19MSVRFX0RSVl9OQU1FLCBzaXplb2Yo
Y2FwLT5kcml2ZXIpKTsKQEAgLTY0Nyw3ICs2NDgsOCBAQCBzdGF0aWMgaW50IGZpbWNfbGl0ZV9x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBmaW1jX2xpdGVfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IGZpbWNfbGl0ZV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0
IHY0bDJfZm10ZGVzYyAqZikKIHsKIAljb25zdCBzdHJ1Y3QgZmltY19mbXQgKmZtdDsKQEAgLTY2
MSw3ICs2NjMsOCBAQCBzdGF0aWMgaW50IGZpbWNfbGl0ZV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBmaW1jX2xpdGVf
Z19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZmlt
Y19saXRlX2dfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CXN0cnVjdCBmaW1jX2xpdGUgKmZpbWMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzI2LDE0
ICs3MjksMTYgQEAgc3RhdGljIGludCBmaW1jX2xpdGVfdHJ5X2ZtdChzdHJ1Y3QgZmltY19saXRl
ICpmaW1jLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGZpbWNfbGl0ZV90cnlfZm10X21w
bGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGZpbWNfbGl0ZV90
cnlfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgZmltY19saXRlICpmaW1jID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlyZXR1cm4gZmlt
Y19saXRlX3RyeV9mbXQoZmltYywgJmYtPmZtdC5waXhfbXAsIE5VTEwpOwogfQogCi1zdGF0aWMg
aW50IGZpbWNfbGl0ZV9zX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IGZpbWNfbGl0ZV9zX2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAljb25zdCBzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0X21wbGFuZSAqcGl4
bSA9ICZmLT5mbXQucGl4X21wOwpAQCAtODA3LDcgKzgxMiw4IEBAIHN0YXRpYyBpbnQgZmltY19w
aXBlbGluZV92YWxpZGF0ZShzdHJ1Y3QgZmltY19saXRlICpmaW1jKQogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IGZpbWNfbGl0ZV9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgZmltY19saXRlX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBlbnVt
IHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgZmltY19saXRlICpmaW1jID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTgyNiw3ICs4MzIsNyBAQCBzdGF0aWMgaW50IGZpbWNfbGl0ZV9z
dHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAogCWZpbWMtPnNlbnNvciA9
IGZpbWNfZmluZF9yZW1vdGVfc2Vuc29yKCZmaW1jLT5zdWJkZXYuZW50aXR5KTsKIAotCXJldCA9
IHZiMl9pb2N0bF9zdHJlYW1vbihmaWxlLCBwcml2LCB0eXBlKTsKKwlyZXQgPSB2YjJfaW9jdGxf
c3RyZWFtb24oZmlsZSwgc3RhdGUsIHR5cGUpOwogCWlmICghcmV0KSB7CiAJCWZpbWMtPnN0cmVh
bWluZyA9IHRydWU7CiAJCXJldHVybiByZXQ7CkBAIC04MzcsMTMgKzg0MywxNCBAQCBzdGF0aWMg
aW50IGZpbWNfbGl0ZV9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBmaW1jX2xpdGVfc3RyZWFtb2ZmKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBmaW1jX2xpdGVfc3RyZWFtb2ZmKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJICAgICAgIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQogewogCXN0cnVjdCBmaW1jX2xp
dGUgKmZpbWMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWludCByZXQ7CiAKLQlyZXQgPSB2YjJf
aW9jdGxfc3RyZWFtb2ZmKGZpbGUsIHByaXYsIHR5cGUpOworCXJldCA9IHZiMl9pb2N0bF9zdHJl
YW1vZmYoZmlsZSwgc3RhdGUsIHR5cGUpOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4gcmV0Owog
CkBAIC04NTIsMjEgKzg1OSwyMyBAQCBzdGF0aWMgaW50IGZpbWNfbGl0ZV9zdHJlYW1vZmYoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
ZmltY19saXRlX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IGZpbWNfbGl0ZV9yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfcmVxdWVzdGJ1
ZmZlcnMgKnJlcWJ1ZnMpCiB7CiAJc3RydWN0IGZpbWNfbGl0ZSAqZmltYyA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAJaW50IHJldDsKIAogCXJlcWJ1ZnMtPmNvdW50ID0gbWF4X3QodTMyLCBGTElU
RV9SRVFfQlVGU19NSU4sIHJlcWJ1ZnMtPmNvdW50KTsKLQlyZXQgPSB2YjJfaW9jdGxfcmVxYnVm
cyhmaWxlLCBwcml2LCByZXFidWZzKTsKKwlyZXQgPSB2YjJfaW9jdGxfcmVxYnVmcyhmaWxlLCBz
dGF0ZSwgcmVxYnVmcyk7CiAJaWYgKCFyZXQpCiAJCWZpbWMtPnJlcWJ1ZnNfY291bnQgPSByZXFi
dWZzLT5jb3VudDsKIAogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgZmltY19saXRlX2df
c2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZmltY19s
aXRlX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJ
c3RydWN0IGZpbWNfbGl0ZSAqZmltYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04OTIsNyAr
OTAxLDggQEAgc3RhdGljIGludCBmaW1jX2xpdGVfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IGZpbWNfbGl0
ZV9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGZp
bWNfbGl0ZV9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQog
ewogCXN0cnVjdCBmaW1jX2xpdGUgKmZpbWMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL2V4eW5vczQtaXMvZmltYy1tMm0u
YyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9leHlub3M0LWlzL2ZpbWMtbTJtLmMK
aW5kZXggNTYyYzU3ZjE4NmM2MTU0NjE3NWI0ZjkwMmYxZGExOGZiYjJmMjVmZS4uNGVmYTU0ZjFl
N2E2NzE3NDFiNWMxNmM5YTk1NGFmNTcyMTUwZGZkOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9zYW1zdW5nL2V4eW5vczQtaXMvZmltYy1tMm0uYworKysgYi9kcml2ZXJzL21l
ZGlhL3BsYXRmb3JtL3NhbXN1bmcvZXh5bm9zNC1pcy9maW1jLW0ybS5jCkBAIC0yMjMsNyArMjIz
LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIGZpbWNfcW9wcyA9IHsKIC8qCiAgKiBW
NEwyIGlvY3RsIGhhbmRsZXJzCiAgKi8KLXN0YXRpYyBpbnQgZmltY19tMm1fcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBmaW1jX20ybV9xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGZp
bWNfZGV2ICpmaW1jID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTIzMiw3ICsyMzMsOCBAQCBz
dGF0aWMgaW50IGZpbWNfbTJtX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBmaW1jX20ybV9lbnVtX2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZmltY19tMm1fZW51bV9mbXQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWNvbnN0IHN0cnVjdCBmaW1jX2Zt
dCAqZm10OwpAQCAtMjQ2LDcgKzI0OCw4IEBAIHN0YXRpYyBpbnQgZmltY19tMm1fZW51bV9mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgZmltY19tMm1fZ19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0
YXRpYyBpbnQgZmltY19tMm1fZ19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCBmaW1jX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC0z
MDUsNyArMzA4LDggQEAgc3RhdGljIGludCBmaW1jX3RyeV9mbXRfbXBsYW5lKHN0cnVjdCBmaW1j
X2N0eCAqY3R4LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgZmltY19tMm1fdHJ5X2ZtdF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LAorc3RhdGljIGludCBmaW1jX20ybV90cnlfZm10X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGZpbWNfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChm
aWxlKTsKQEAgLTMzNCw3ICszMzgsOCBAQCBzdGF0aWMgdm9pZCBfX3NldF9mcmFtZV9mb3JtYXQo
c3RydWN0IGZpbWNfZnJhbWUgKmZyYW1lLAogCWZyYW1lLT5mbXQgPSBmbXQ7CiB9CiAKLXN0YXRp
YyBpbnQgZmltY19tMm1fc19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgZmltY19tMm1fc19mbXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQogewogCXN0cnVjdCBmaW1jX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBA
IC0zNzMsNyArMzc4LDggQEAgc3RhdGljIGludCBmaW1jX20ybV9zX2ZtdF9tcGxhbmUoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGZpbWNf
bTJtX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
ZmltY19tMm1fZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewog
CXN0cnVjdCBmaW1jX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC00ODEsNyArNDg3
LDggQEAgc3RhdGljIGludCBmaW1jX20ybV90cnlfc2VsZWN0aW9uKHN0cnVjdCBmaW1jX2N0eCAq
Y3R4LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGZpbWNfbTJtX3Nfc2VsZWN0aW9uKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZmltY19tMm1fc19zZWxlY3Rp
b24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBmaW1jX2N0eCAq
Y3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRm
b3JtL3NhbXN1bmcvczNjLWNhbWlmL2NhbWlmLWNhcHR1cmUuYyBiL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vc2Ftc3VuZy9zM2MtY2FtaWYvY2FtaWYtY2FwdHVyZS5jCmluZGV4IGVkMWExZDY5MzI5
M2IzM2Q4ZGEzMTkwYWM4ZWU2ZGQyMTJhNjRiODguLjczNWU5YjY0M2I0NzRkYzIwZGEwM2ZlODJk
NjczYzU5ZjQxNDkyZjIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3Vu
Zy9zM2MtY2FtaWYvY2FtaWYtY2FwdHVyZS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
c2Ftc3VuZy9zM2MtY2FtaWYvY2FtaWYtY2FwdHVyZS5jCkBAIC02MzAsNyArNjMwLDggQEAgc3Rh
dGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVfb3BlcmF0aW9ucyBzM2NfY2FtaWZfZm9wcyA9IHsK
ICAqIFZpZGVvIG5vZGUgSU9DVExzCiAgKi8KIAotc3RhdGljIGludCBzM2NfY2FtaWZfdmlkaW9j
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzM2Nf
Y2FtaWZfdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmls
aXR5ICpjYXApCiB7CiAJc3RydWN0IGNhbWlmX3ZwICp2cCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC02NDIsNyArNjQzLDggQEAgc3RhdGljIGludCBzM2NfY2FtaWZfdmlkaW9jX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHMzY19jYW1pZl92aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgczNjX2NhbWlmX3ZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkgICAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmlucHV0KQogewogCXN0cnVjdCBjYW1pZl92cCAq
dnAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNjU2LDIwICs2NTgsMjMgQEAgc3RhdGljIGlu
dCBzM2NfY2FtaWZfdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgczNjX2NhbWlmX3ZpZGlvY19zX2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzM2NfY2FtaWZfdmlk
aW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlyZXR1cm4gaSA9
PSAwID8gMCA6IC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgczNjX2NhbWlmX3ZpZGlvY19nX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzM2NfY2FtaWZf
dmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJKmkgPSAw
OwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHMzY19jYW1pZl92aWRpb2NfZW51bV9mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHMzY19jYW1pZl92aWRp
b2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJ
c3RydWN0IGNhbWlmX3ZwICp2cCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02ODMsNyArNjg4
LDggQEAgc3RhdGljIGludCBzM2NfY2FtaWZfdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHMzY19jYW1pZl92
aWRpb2NfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHMz
Y19jYW1pZl92aWRpb2NfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlzdHJ1Y3QgY2FtaWZfdnAgKnZwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc1NCwxNCAr
NzYwLDE2IEBAIHN0YXRpYyBpbnQgX19jYW1pZl92aWRlb190cnlfZm9ybWF0KHN0cnVjdCBjYW1p
Zl92cCAqdnAsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgczNjX2NhbWlmX3ZpZGlvY190
cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzM2NfY2Ft
aWZfdmlkaW9jX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IGNhbWlmX3ZwICp2cCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJcmV0dXJuIF9f
Y2FtaWZfdmlkZW9fdHJ5X2Zvcm1hdCh2cCwgJmYtPmZtdC5waXgsIE5VTEwpOwogfQogCi1zdGF0
aWMgaW50IHMzY19jYW1pZl92aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IHMzY19jYW1pZl92aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0ICpwaXggPSAmZi0+Zm10
LnBpeDsKQEAgLTgyOCw3ICs4MzYsOCBAQCBzdGF0aWMgaW50IGNhbWlmX3BpcGVsaW5lX3ZhbGlk
YXRlKHN0cnVjdCBjYW1pZl9kZXYgKmNhbWlmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHMzY19jYW1pZl9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgczNjX2NhbWlmX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBlbnVtIHY0bDJfYnVmX3R5
cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgY2FtaWZfdnAgKnZwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTg2MCw3ICs4NjksOCBAQCBzdGF0aWMgaW50IHMzY19jYW1pZl9zdHJlYW1vbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gdmIyX3N0cmVhbW9uKCZ2cC0+dmJfcXVl
dWUsIHR5cGUpOwogfQogCi1zdGF0aWMgaW50IHMzY19jYW1pZl9zdHJlYW1vZmYoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHMzY19jYW1pZl9zdHJlYW1vZmYoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgICAgZW51bSB2NGwyX2J1Zl90eXBlIHR5cGUpCiB7CiAJc3RydWN0IGNhbWlm
X3ZwICp2cCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04ODEsNyArODkxLDggQEAgc3RhdGlj
IGludCBzM2NfY2FtaWZfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgczNjX2NhbWlmX3JlcWJ1ZnMoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHMzY19jYW1pZl9yZXFidWZzKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCSAgICAgc3RydWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKnJiKQogewogCXN0cnVjdCBjYW1p
Zl92cCAqdnAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTE1LDE0ICs5MjYsMTYgQEAgc3Rh
dGljIGludCBzM2NfY2FtaWZfcmVxYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHMzY19jYW1pZl9xdWVyeWJ1ZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgczNjX2NhbWlmX3F1ZXJ5YnVmKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKIHsKIAlzdHJ1Y3QgY2FtaWZf
dnAgKnZwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlyZXR1cm4gdmIyX3F1ZXJ5YnVmKCZ2cC0+
dmJfcXVldWUsIGJ1Zik7CiB9CiAKLXN0YXRpYyBpbnQgczNjX2NhbWlmX3FidWYoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHMzY19jYW1pZl9xYnVmKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
c3RydWN0IHY0bDJfYnVmZmVyICpidWYpCiB7CiAJc3RydWN0IGNhbWlmX3ZwICp2cCA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC05MzUsNyArOTQ4LDggQEAgc3RhdGljIGludCBzM2NfY2FtaWZf
cWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gdmIyX3FidWYoJnZw
LT52Yl9xdWV1ZSwgdnAtPnZkZXYudjRsMl9kZXYtPm1kZXYsIGJ1Zik7CiB9CiAKLXN0YXRpYyBp
bnQgczNjX2NhbWlmX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBzM2NfY2FtaWZfZHFidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQog
ewogCXN0cnVjdCBjYW1pZl92cCAqdnAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTQ4LDcg
Kzk2Miw4IEBAIHN0YXRpYyBpbnQgczNjX2NhbWlmX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiB2YjJfZHFidWYoJnZwLT52Yl9xdWV1ZSwgYnVmLCBmaWxlLT5m
X2ZsYWdzICYgT19OT05CTE9DSyk7CiB9CiAKLXN0YXRpYyBpbnQgczNjX2NhbWlmX2NyZWF0ZV9i
dWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzM2NfY2FtaWZf
Y3JlYXRlX2J1ZnMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9jcmVhdGVfYnVmZmVycyAqY3JlYXRlKQog
ewogCXN0cnVjdCBjYW1pZl92cCAqdnAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTY2LDE0
ICs5ODEsMTYgQEAgc3RhdGljIGludCBzM2NfY2FtaWZfY3JlYXRlX2J1ZnMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBzM2NfY2Ft
aWZfcHJlcGFyZV9idWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHMzY19jYW1pZl9wcmVwYXJlX2J1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2J1ZmZlciAqYikKIHsK
IAlzdHJ1Y3QgY2FtaWZfdnAgKnZwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlyZXR1cm4gdmIy
X3ByZXBhcmVfYnVmKCZ2cC0+dmJfcXVldWUsIHZwLT52ZGV2LnY0bDJfZGV2LT5tZGV2LCBiKTsK
IH0KIAotc3RhdGljIGludCBzM2NfY2FtaWZfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHMzY19jYW1pZl9nX3NlbGVjdGlvbihzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0
cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQogewogCXN0cnVjdCBjYW1pZl92cCAqdnAgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtMTAxMCw3ICsxMDI3LDggQEAgc3RhdGljIHZvaWQgX19jYW1p
Zl90cnlfY29tcG9zZShzdHJ1Y3QgY2FtaWZfZGV2ICpjYW1pZiwgc3RydWN0IGNhbWlmX3ZwICp2
cCwKIAkvKiBUT0RPOiBzM2M2NHh4ICovCiB9CiAKLXN0YXRpYyBpbnQgczNjX2NhbWlmX3Nfc2Vs
ZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzM2NfY2Ft
aWZfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsKIAlz
dHJ1Y3QgY2FtaWZfdnAgKnZwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9zNXAtZzJkL2cyZC5jIGIvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS9zYW1zdW5nL3M1cC1nMmQvZzJkLmMKaW5kZXggZmZiOWJlZTZjYjlkNDc1OTY0
NzkyNWQ3OTFhMTNlMWYwY2UzZjI5OS4uZTdiZjliYzUwYzM0MzVjYTE5MGExOTRhZWY5YmVmMGQx
ZjUzNzRjMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL3M1cC1n
MmQvZzJkLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL3M1cC1nMmQvZzJk
LmMKQEAgLTI4OCw3ICsyODgsOCBAQCBzdGF0aWMgaW50IGcyZF9yZWxlYXNlKHN0cnVjdCBmaWxl
ICpmaWxlKQogfQogCiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1
Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgRzJEX05B
TUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMjk3LDcgKzI5OCw5IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1f
Zm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT5pbmRleCA+
PSBOVU1fRk9STUFUUykKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC0zMDUsNyArMzA4LDggQEAgc3Rh
dGljIGludCB2aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
Z19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgZzJkX2N0eCAqY3R4ID0gZmlsZTJjdHgoZmlsZSk7CiAJc3RydWN0IHZiMl9xdWV1ZSAq
dnE7CkBAIC0zMjcsNyArMzMxLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdChz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkg
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZzJkX2ZtdCAqZm10OwogCWVudW0g
djRsMl9maWVsZCAqZmllbGQ7CkBAIC0zNTcsNyArMzYyLDggQEAgc3RhdGljIGludCB2aWRpb2Nf
dHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2
aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBnMmRfY3R4ICpj
dHggPSBmaWxlMmN0eChmaWxlKTsKIAlzdHJ1Y3QgZzJkX2RldiAqZGV2ID0gY3R4LT5kZXY7CkBA
IC0zNjgsNyArMzc0LDcgQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAogCS8qIEFkanVzdCBhbGwg
dmFsdWVzIGFjY29yZGluZ2x5IHRvIHRoZSBoYXJkd2FyZSBjYXBhYmlsaXRpZXMKIAkgKiBhbmQg
Y2hvc2VuIGZvcm1hdC4gKi8KLQlyZXQgPSB2aWRpb2NfdHJ5X2ZtdChmaWxlLCBwcml2LCBmKTsK
KwlyZXQgPSB2aWRpb2NfdHJ5X2ZtdChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0
dXJuIHJldDsKIAl2cSA9IHY0bDJfbTJtX2dldF92cShjdHgtPmZoLm0ybV9jdHgsIGYtPnR5cGUp
OwpAQCAtMzk3LDcgKzQwMyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0
cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgZzJkX2N0eCAqY3R4ID0gZmlsZTJj
dHgoZmlsZSk7CkBAIC00NzUsMTQgKzQ4MiwxNSBAQCBzdGF0aWMgaW50IHZpZGlvY190cnlfc2Vs
ZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpZGlvY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3Qg
djRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IGcyZF9jdHggKmN0eCA9IGZpbGUyY3R4KGZp
bGUpOwogCXN0cnVjdCBnMmRfZnJhbWUgKmY7CiAJaW50IHJldDsKIAotCXJldCA9IHZpZGlvY190
cnlfc2VsZWN0aW9uKGZpbGUsIHByaXYsIHMpOworCXJldCA9IHZpZGlvY190cnlfc2VsZWN0aW9u
KGZpbGUsIHN0YXRlLCBzKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCWYgPSBnZXRfZnJh
bWUoY3R4LCBzLT50eXBlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ft
c3VuZy9zNXAtanBlZy9qcGVnLWNvcmUuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3Vu
Zy9zNXAtanBlZy9qcGVnLWNvcmUuYwppbmRleCA4MTc5MmY3ZjhiMTY3MWRiYTIwMjNmOTliMjc3
OTc4NGQ5YTE0YjhjLi41YTViMjRmZDMxMmM4Zjk2YjY4NGU1MzNiMjFjYzQ3MjRmOGYyYTBiIDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcvczVwLWpwZWcvanBlZy1j
b3JlLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL3M1cC1qcGVnL2pwZWct
Y29yZS5jCkBAIC0xMjQ1LDcgKzEyNDUsOCBAQCBzdGF0aWMgYm9vbCBzNXBfanBlZ19wYXJzZV9o
ZHIoc3RydWN0IHM1cF9qcGVnX3FfZGF0YSAqcmVzdWx0LAogCXJldHVybiB0cnVlOwogfQogCi1z
dGF0aWMgaW50IHM1cF9qcGVnX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCBzNXBfanBlZ19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9j
YXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHM1cF9qcGVnX2N0eCAqY3R4ID0gZmlsZV90b19j
dHgoZmlsZSk7CkBAIC0xMjkzLDcgKzEyOTQsOCBAQCBzdGF0aWMgaW50IGVudW1fZm10KHN0cnVj
dCBzNXBfanBlZ19jdHggKmN0eCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzNXBfanBl
Z19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBzNXBfanBlZ19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJf
Zm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgczVwX2pwZWdfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChm
aWxlKTsKQEAgLTEzMDYsNyArMTMwOCw4IEBAIHN0YXRpYyBpbnQgczVwX2pwZWdfZW51bV9mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAkJCVNKUEVHX0ZNVF9GTEFH
X0RFQ19DQVBUVVJFKTsKIH0KIAotc3RhdGljIGludCBzNXBfanBlZ19lbnVtX2ZtdF92aWRfb3V0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzNXBfanBlZ19lbnVt
X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlz
dHJ1Y3QgczVwX2pwZWdfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTEzMzAsNyAr
MTMzMyw4IEBAIHN0YXRpYyBzdHJ1Y3QgczVwX2pwZWdfcV9kYXRhICpnZXRfcV9kYXRhKHN0cnVj
dCBzNXBfanBlZ19jdHggKmN0eCwKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGljIGludCBzNXBf
anBlZ19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQorc3RhdGljIGludCBzNXBfanBlZ19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsKIAlzdHJ1Y3QgczVwX2pwZWdfcV9kYXRhICpx
X2RhdGEgPSBOVUxMOwpAQCAtMTQ3Miw3ICsxNDc2LDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5
X2ZtdChzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYsIHN0cnVjdCBzNXBfanBlZ19mbXQgKmZtdCwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzNXBfanBlZ190cnlfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHM1cF9qcGVnX3RyeV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHM1cF9q
cGVnX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC0xNTMxLDcgKzE1MzYsOCBAQCBz
dGF0aWMgaW50IHM1cF9qcGVnX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gdmlkaW9jX3RyeV9mbXQoZiwgZm10LCBjdHgsIEZNVF9UWVBFX0NB
UFRVUkUpOwogfQogCi1zdGF0aWMgaW50IHM1cF9qcGVnX3RyeV9mbXRfdmlkX291dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgczVwX2pwZWdfdHJ5X2ZtdF92aWRf
b3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgczVwX2pw
ZWdfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTE2NzIsMjQgKzE2NzgsMjYgQEAg
c3RhdGljIGludCBzNXBfanBlZ19zX2ZtdChzdHJ1Y3QgczVwX2pwZWdfY3R4ICpjdCwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHM1cF9qcGVnX3Nf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHM1
cF9qcGVnX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
aW50IHJldDsKIAotCXJldCA9IHM1cF9qcGVnX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBwcml2LCBm
KTsKKwlyZXQgPSBzNXBfanBlZ190cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogCWlm
IChyZXQpCiAJCXJldHVybiByZXQ7CiAKIAlyZXR1cm4gczVwX2pwZWdfc19mbXQoZmlsZV90b19j
dHgoZmlsZSksIGYpOwogfQogCi1zdGF0aWMgaW50IHM1cF9qcGVnX3NfZm10X3ZpZF9vdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHM1cF9qcGVnX3NfZm10X3Zp
ZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJaW50IHJldDsKIAotCXJl
dCA9IHM1cF9qcGVnX3RyeV9mbXRfdmlkX291dChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSBzNXBf
anBlZ190cnlfZm10X3ZpZF9vdXQoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVy
biByZXQ7CiAKQEAgLTE3ODcsNyArMTc5NSw4IEBAIHN0YXRpYyBpbnQgZXh5bm9zMzI1MF9qcGVn
X3RyeV9jcm9wKHN0cnVjdCBzNXBfanBlZ19jdHggKmN0eCwKICAqIFY0TDIgY29udHJvbHMKICAq
LwogCi1zdGF0aWMgaW50IHM1cF9qcGVnX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAorc3RhdGljIGludCBzNXBfanBlZ19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3Qg
djRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IHM1cF9qcGVnX2N0eCAqY3R4ID0gZmlsZV90
b19jdHgoZmlsZSk7CkBAIC0xODI0LDcgKzE4MzMsOCBAQCBzdGF0aWMgaW50IHM1cF9qcGVnX2df
c2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogLyoKICAqIFY0TDIgY29u
dHJvbHMKICAqLwotc3RhdGljIGludCBzNXBfanBlZ19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHM1cF9qcGVnX3Nfc2VsZWN0aW9uKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAg
c3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBzNXBfanBlZ19jdHggKmN0eCA9
IGZpbGVfdG9fY3R4KGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9z
YW1zdW5nL3M1cC1tZmMvczVwX21mY19kZWMuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ft
c3VuZy9zNXAtbWZjL3M1cF9tZmNfZGVjLmMKaW5kZXggYWZkMjhiZWFiZmRlZTNhNTJmZmNlYjQ2
N2Q2ZDg3NWY0ZGM0MjhhYy4uYjM4ZDQzNDk3ZTdjMjc0YzhiZDUzMTEzNzJiZmExNWFhZmExMGE1
MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL3M1cC1tZmMvczVw
X21mY19kZWMuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcvczVwLW1mYy9z
NXBfbWZjX2RlYy5jCkBAIC0yOTUsNyArMjk1LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBzNXBf
bWZjX2NvZGVjX29wcyBkZWNvZGVyX2NvZGVjX29wcyA9IHsKIH07CiAKIC8qIFF1ZXJ5IGNhcGFi
aWxpdGllcyBvZiB0aGUgZGV2aWNlICovCi1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHM1cF9tZmNf
ZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzMwLDIwICszMzEsMjMgQEAgc3Rh
dGljIGludCB2aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2NGwyX2Zt
dGRlc2MgKmYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19l
bnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJ
cmV0dXJuIHZpZGlvY19lbnVtX2ZtdChmaWxlLCBmLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwy
X2ZtdGRlc2MgKmYpCiB7CiAJcmV0dXJuIHZpZGlvY19lbnVtX2ZtdChmaWxlLCBmLCB0cnVlKTsK
IH0KIAogLyogR2V0IGZvcm1hdCAqLwotc3RhdGljIGludCB2aWRpb2NfZ19mbXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQg
dmlkaW9jX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgczVwX21mY19j
dHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBs
YW5lICpwaXhfbXA7CkBAIC00MDMsNyArNDA3LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIH0K
IAogLyogVHJ5IGZvcm1hdCAqLwotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2
aWRpb2NfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgczVwX21m
Y19kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJY29uc3Qgc3RydWN0IHM1cF9tZmNf
Zm10ICpmbXQ7CkBAIC00MzksNyArNDQ0LDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogfQog
CiAvKiBTZXQgZm9ybWF0ICovCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRp
b2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzNXBfbWZjX2RldiAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgczVwX21mY19jdHggKmN0eCA9IGZp
bGVfdG9fY3R4KGZpbGUpOwpAQCAtNDQ4LDcgKzQ1NCw3IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3Nf
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiAJY29uc3Qgc3RydWN0IHM1cF9tZmNfYnVmX3NpemUgKmJ1Zl9zaXplID0gZGV2LT52YXJpYW50
LT5idWZfc2l6ZTsKIAogCW1mY19kZWJ1Z19lbnRlcigpOwotCXJldCA9IHZpZGlvY190cnlfZm10
KGZpbGUsIHByaXYsIGYpOworCXJldCA9IHZpZGlvY190cnlfZm10KGZpbGUsIHN0YXRlLCBmKTsK
IAlwaXhfbXAgPSAmZi0+Zm10LnBpeF9tcDsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwpAQCAt
NTk0LDcgKzYwMCw4IEBAIHN0YXRpYyBpbnQgcmVxYnVmc19jYXB0dXJlKHN0cnVjdCBzNXBfbWZj
X2RldiAqZGV2LCBzdHJ1Y3QgczVwX21mY19jdHggKmN0eCwKIH0KIAogLyogUmVxdWVzdCBidWZm
ZXJzICovCi1zdGF0aWMgaW50IHZpZGlvY19yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcmVxYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJf
cmVxdWVzdGJ1ZmZlcnMgKnJlcWJ1ZnMpCiB7CiAJc3RydWN0IHM1cF9tZmNfZGV2ICpkZXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNjE2LDcgKzYyMyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIC8qIFF1ZXJ5IGJ1
ZmZlciAqLwotc3RhdGljIGludCB2aWRpb2NfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkJICAgc3RydWN0
IHY0bDJfYnVmZmVyICpidWYpCiB7CiAJc3RydWN0IHM1cF9tZmNfY3R4ICpjdHggPSBmaWxlX3Rv
X2N0eChmaWxlKTsKQEAgLTY0NSw3ICs2NTMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWJ1
ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIAogLyogUXVldWUgYSBidWZmZXIg
Ki8KLXN0YXRpYyBpbnQgdmlkaW9jX3FidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQorc3RhdGljIGludCB2aWRpb2NfcWJ1ZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBz
dHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKIHsKIAlzdHJ1Y3QgczVwX21mY19jdHggKmN0eCA9IGZp
bGVfdG9fY3R4KGZpbGUpOwogCkBAIC02NjEsNyArNjcwLDggQEAgc3RhdGljIGludCB2aWRpb2Nf
cWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYnVmZmVyICpi
dWYpCiB9CiAKIC8qIERlcXVldWUgYSBidWZmZXIgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX2RxYnVm
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikK
K3N0YXRpYyBpbnQgdmlkaW9jX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQogewogCWNv
bnN0IHN0cnVjdCB2NGwyX2V2ZW50IGV2ID0gewogCQkudHlwZSA9IFY0TDJfRVZFTlRfRU9TCkBA
IC02OTIsOCArNzAyLDggQEAgc3RhdGljIGludCB2aWRpb2NfZHFidWYoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQogfQogCiAvKiBFeHBvcnQg
RE1BIGJ1ZmZlciAqLwotc3RhdGljIGludCB2aWRpb2NfZXhwYnVmKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAotCXN0cnVjdCB2NGwyX2V4cG9ydGJ1ZmZlciAqZWIpCitzdGF0aWMgaW50
IHZpZGlvY19leHBidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2V4cG9ydGJ1ZmZlciAqZWIpCiB7CiAJc3RydWN0
IHM1cF9tZmNfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKIApAQCAtNzA1LDcgKzcxNSw4
IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2V4cGJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIH0KIAogLyogU3RyZWFtIG9uICovCi1zdGF0aWMgaW50IHZpZGlvY19zdHJlYW1vbihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3N0cmVhbW9uKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICBlbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgczVwX21mY19jdHgg
KmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNzIxLDcgKzczMiw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogCiAvKiBT
dHJlYW0gb2ZmLCB3aGljaCBlcXVhbHMgdG8gYSBwYXVzZSAqLwotc3RhdGljIGludCB2aWRpb2Nf
c3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRp
b2Nfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQogewogCXN0
cnVjdCBzNXBfbWZjX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC03OTgsNyArODEw
LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2N0cmxfb3BzIHM1cF9tZmNfZGVjX2N0cmxf
b3BzID0gewogfTsKIAogLyogR2V0IGNvbXBvc2UgaW5mb3JtYXRpb24gKi8KLXN0YXRpYyBpbnQg
dmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwyX3NlbGVj
dGlvbiAqcykKIHsKIAlzdHJ1Y3QgczVwX21mY19jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUp
OwpAQCAtODUzLDcgKzg2Niw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9kZWNvZGVy
X2NtZCAqY21kKQogewogCXN0cnVjdCBzNXBfbWZjX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmls
ZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcvczVwLW1mYy9z
NXBfbWZjX2VuYy5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zYW1zdW5nL3M1cC1tZmMvczVw
X21mY19lbmMuYwppbmRleCAzZjg3MDFlNTYxNGYyMWE4Mjg5ZGYwMmJhOGQ4YjFiODc2YWNmODFk
Li42ZDY4OWJkZjFhMTVjMWVlYTQ0YmFjMjgyMTg1ZDI5YjJlNTc2YTNiIDEwMDY0NAotLS0gYS9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL3NhbXN1bmcvczVwLW1mYy9zNXBfbWZjX2VuYy5jCisrKyBi
L2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc2Ftc3VuZy9zNXAtbWZjL3M1cF9tZmNfZW5jLmMKQEAg
LTEzNDIsNyArMTM0Miw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgczVwX21mY19jb2RlY19vcHMg
ZW5jb2Rlcl9jb2RlY19vcHMgPSB7CiB9OwogCiAvKiBRdWVyeSBjYXBhYmlsaXRpZXMgb2YgdGhl
IGRldmljZSAqLwotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0
IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBzNXBfbWZjX2RldiAqZGV2ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEzNzUsMTkgKzEzNzYsMjIgQEAgc3RhdGljIGludCB2aWRp
b2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYsCiAJ
cmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJcmV0dXJu
IHZpZGlvY19lbnVtX2ZtdChmaWxlLCBmLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRl
c2MgKmYpCiB7CiAJcmV0dXJuIHZpZGlvY19lbnVtX2ZtdChmaWxlLCBmLCB0cnVlKTsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10KHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0X21wbGFuZSAqcGl4X2ZtdF9t
cCA9ICZmLT5mbXQucGl4X21wOwogCXN0cnVjdCBzNXBfbWZjX2N0eCAqY3R4ID0gZmlsZV90b19j
dHgoZmlsZSk7CkBAIC0xNDI4LDcgKzE0MzIsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZpZGlvY190
cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzNXBfbWZjX2RldiAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAljb25zdCBzdHJ1Y3QgczVwX21mY19mbXQgKmZt
dDsKQEAgLTE0NzAsMTQgKzE0NzUsMTUgQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2Nfc19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzNXBfbWZjX2N0eCAqY3R4ID0gZmls
ZV90b19jdHgoZmlsZSk7CiAJc3RydWN0IHM1cF9tZmNfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBsYW5lICpwaXhfZm10X21wID0gJmYt
PmZtdC5waXhfbXA7CiAJaW50IHJldCA9IDA7CiAKLQlyZXQgPSB2aWRpb2NfdHJ5X2ZtdChmaWxl
LCBwcml2LCBmKTsKKwlyZXQgPSB2aWRpb2NfdHJ5X2ZtdChmaWxlLCBzdGF0ZSwgZik7CiAJaWYg
KHJldCkKIAkJcmV0dXJuIHJldDsKIAlpZiAoY3R4LT52cV9zcmMuc3RyZWFtaW5nIHx8IGN0eC0+
dnFfZHN0LnN0cmVhbWluZykgewpAQCAtMTUyNyw3ICsxNTMzLDggQEAgc3RhdGljIGludCB2aWRp
b2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19yZXFidWZzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcmVxYnVmcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJCSAgc3RydWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKnJlcWJ1ZnMpCiB7CiAJc3RydWN0IHM1
cF9tZmNfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTU5OCw3ICsxNjA1LDgg
QEAgc3RhdGljIGludCB2aWRpb2NfcmVxYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWJ1ZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5YnVmKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJCQkgICBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKIHsKIAlzdHJ1Y3QgczVwX21mY19jdHgg
KmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtMTYzNCw3ICsxNjQyLDggQEAgc3RhdGljIGlu
dCB2aWRpb2NfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIC8q
IFF1ZXVlIGEgYnVmZmVyICovCi1zdGF0aWMgaW50IHZpZGlvY19xYnVmKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKK3N0YXRpYyBpbnQgdmlk
aW9jX3FidWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfYnVmZmVyICpidWYpCiB7CiAJc3RydWN0IHM1cF9t
ZmNfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKIApAQCAtMTY1NSw3ICsxNjY0LDggQEAg
c3RhdGljIGludCB2aWRpb2NfcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfYnVmZmVyICpidWYpCiB9CiAKIC8qIERlcXVldWUgYSBidWZmZXIgKi8KLXN0YXRp
YyBpbnQgdmlkaW9jX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3Qg
djRsMl9idWZmZXIgKmJ1ZikKK3N0YXRpYyBpbnQgdmlkaW9jX2RxYnVmKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX2J1
ZmZlciAqYnVmKQogewogCXN0cnVjdCBzNXBfbWZjX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmls
ZSk7CiAJY29uc3Qgc3RydWN0IHY0bDJfZXZlbnQgZXYgPSB7CkBAIC0xNjgyLDggKzE2OTIsOCBA
QCBzdGF0aWMgaW50IHZpZGlvY19kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
c3RydWN0IHY0bDJfYnVmZmVyICpidWYpCiB9CiAKIC8qIEV4cG9ydCBETUEgYnVmZmVyICovCi1z
dGF0aWMgaW50IHZpZGlvY19leHBidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0J
c3RydWN0IHY0bDJfZXhwb3J0YnVmZmVyICplYikKK3N0YXRpYyBpbnQgdmlkaW9jX2V4cGJ1Zihz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwg
c3RydWN0IHY0bDJfZXhwb3J0YnVmZmVyICplYikKIHsKIAlzdHJ1Y3QgczVwX21mY19jdHggKmN0
eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwogCkBAIC0xNjk1LDcgKzE3MDUsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY19leHBidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIC8qIFN0
cmVhbSBvbiAqLwotc3RhdGljIGludCB2aWRpb2Nfc3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgZW51bSB2
NGwyX2J1Zl90eXBlIHR5cGUpCiB7CiAJc3RydWN0IHM1cF9tZmNfY3R4ICpjdHggPSBmaWxlX3Rv
X2N0eChmaWxlKTsKQEAgLTE3MDgsNyArMTcxOSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3N0cmVh
bW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogCiAvKiBTdHJlYW0gb2ZmLCB3
aGljaCBlcXVhbHMgdG8gYSBwYXVzZSAqLwotc3RhdGljIGludCB2aWRpb2Nfc3RyZWFtb2ZmKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc3RyZWFtb2Zm
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJICAgIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQogewogCXN0cnVjdCBzNXBfbWZj
X2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC0yMjgxLDcgKzIyOTMsOCBAQCBzdGF0
aWMgY29uc3Qgc3RydWN0IHY0bDJfY3RybF9vcHMgczVwX21mY19lbmNfY3RybF9vcHMgPSB7CiAJ
Lmdfdm9sYXRpbGVfY3RybCA9IHM1cF9tZmNfZW5jX2dfdl9jdHJsLAogfTsKIAotc3RhdGljIGlu
dCB2aWRpb2Nfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2Nfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3Ry
dWN0IHM1cF9tZmNfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTIyOTgsNyArMjMx
MSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0
cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IHM1cF9tZmNfY3R4ICpjdHggPSBm
aWxlX3RvX2N0eChmaWxlKTsKQEAgLTIzMTUsNyArMjMyOSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IHZpZGlvY19lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0
IHY0bDJfZW5jb2Rlcl9jbWQgKmNtZCkKIHsKIAlzdHJ1Y3QgczVwX21mY19jdHggKmN0eCA9IGZp
bGVfdG9fY3R4KGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdC9z
dGkvYmRpc3AvYmRpc3AtdjRsMi5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdC9zdGkvYmRp
c3AvYmRpc3AtdjRsMi5jCmluZGV4IDU2MTY5YjcwNjUyZDNhYWY3YzNjMzk1YTYzMGEyOTAyM2Ni
ZDk3MjIuLmRjODMwNWQ1ZDQ0NTYzM2RiZDAxZDBhMmQyMTRiYmQzMGU4MDQzMzQgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RpL2JkaXNwL2JkaXNwLXY0bDIuYworKysg
Yi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0L3N0aS9iZGlzcC9iZGlzcC12NGwyLmMKQEAgLTY4
MSw3ICs2ODEsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZmlsZV9vcGVyYXRpb25zIGJk
aXNwX2ZvcHMgPSB7CiAJLm1tYXAgICAgICAgICAgID0gdjRsMl9tMm1fZm9wX21tYXAsCiB9Owog
Ci1zdGF0aWMgaW50IGJkaXNwX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgYmRpc3BfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5
ICpjYXApCiB7CiAJc3RydWN0IGJkaXNwX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBA
IC02OTQsNyArNjk1LDggQEAgc3RhdGljIGludCBiZGlzcF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYmRpc3BfZW51bV9m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQor
c3RhdGljIGludCBiZGlzcF9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJ
c3RydWN0IGJkaXNwX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAJY29uc3Qgc3RydWN0
IGJkaXNwX2ZtdCAqZm10OwpAQCAtNzE0LDcgKzcxNiw4IEBAIHN0YXRpYyBpbnQgYmRpc3BfZW51
bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpm
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGJkaXNwX2dfZm10KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBiZGlzcF9n
X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGJkaXNwX2N0eCAq
Y3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdCAqcGl4OwpA
QCAtNzM4LDcgKzc0MSw4IEBAIHN0YXRpYyBpbnQgYmRpc3BfZ19mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgYmRpc3BfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgYmRpc3BfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCBiZGlzcF9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUp
OwogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKnBpeCA9ICZmLT5mbXQucGl4OwpAQCAtNzg4LDcg
Kzc5Miw4IEBAIHN0YXRpYyBpbnQgYmRpc3BfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCBiZGlzcF9zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKK3N0YXRpYyBpbnQgYmRpc3Bfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnZzdGF0ZSwKKwkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgYmRpc3BfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKIAlz
dHJ1Y3QgdmIyX3F1ZXVlICp2cTsKQEAgLTc5Nyw3ICs4MDIsNyBAQCBzdGF0aWMgaW50IGJkaXNw
X3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogCWludCByZXQ7CiAJdTMyIHN0YXRlOwogCi0JcmV0ID0gYmRpc3BfdHJ5X2ZtdChmaWxlLCBm
aCwgZik7CisJcmV0ID0gYmRpc3BfdHJ5X2ZtdChmaWxlLCB2c3RhdGUsIGYpOwogCWlmIChyZXQp
IHsKIAkJZGV2X2VycihjdHgtPmJkaXNwX2Rldi0+ZGV2LCAiQ2Fubm90IHNldCBmb3JtYXRcbiIp
OwogCQlyZXR1cm4gcmV0OwpAQCAtODQwLDcgKzg0NSw4IEBAIHN0YXRpYyBpbnQgYmRpc3Bfc19m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYmRpc3BfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBiZGlzcF9nX3NlbGVjdGlvbihzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgYmRpc3BfY3R4ICpjdHgg
PSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTkxOCw3ICs5MjQsOCBAQCBzdGF0aWMgaW50IGlzX3Jl
Y3RfZW5jbG9zZWQoc3RydWN0IHY0bDJfcmVjdCAqYSwgc3RydWN0IHY0bDJfcmVjdCAqYikKIAly
ZXR1cm4gMTsKIH0KIAotc3RhdGljIGludCBiZGlzcF9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGJkaXNwX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
ICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBiZGlzcF9jdHggKmN0eCA9
IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtOTk3LDcgKzEwMDQsOCBAQCBzdGF0aWMgaW50IGJkaXNw
X3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBiZGlzcF9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQorc3RhdGljIGludCBiZGlzcF9zdHJlYW1vbihzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIGVu
dW0gdjRsMl9idWZfdHlwZSB0eXBlKQogewogCXN0cnVjdCBiZGlzcF9jdHggKmN0eCA9IGZpbGVf
dG9fY3R4KGZpbGUpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0L3N0
aS9kZWx0YS9kZWx0YS12NGwyLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0L3N0aS9kZWx0
YS9kZWx0YS12NGwyLmMKaW5kZXggNmMxYTUzYzc3MWY3NDY4MTNhNjA2MmNiM2ZmYzEzOTI1MGZm
NzE0Ni4uY2IyNTlmNzc0MDQ4MjhjZWMyNDg4OTUxMzk1NmU3YzIxZDk2N2NjOCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdC9zdGkvZGVsdGEvZGVsdGEtdjRsMi5jCisrKyBi
L2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RpL2RlbHRhL2RlbHRhLXY0bDIuYwpAQCAtMzgz
LDcgKzM4Myw4IEBAIHN0YXRpYyBpbnQgZGVsdGFfb3Blbl9kZWNvZGVyKHN0cnVjdCBkZWx0YV9j
dHggKmN0eCwgdTMyIHN0cmVhbWZvcm1hdCwKICAqIFY0TDIgaW9jdGwgb3BlcmF0aW9ucwogICov
CiAKLXN0YXRpYyBpbnQgZGVsdGFfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IGRlbHRhX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgc3RydWN0IHY0bDJfY2FwYWJp
bGl0eSAqY2FwKQogewogCXN0cnVjdCBkZWx0YV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUp
OwpAQCAtMzk3LDcgKzM5OCw4IEBAIHN0YXRpYyBpbnQgZGVsdGFfcXVlcnljYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZGVsdGFf
ZW51bV9mbXRfc3RyZWFtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBkZWx0YV9lbnVtX2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQog
ewogCXN0cnVjdCBkZWx0YV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNDExLDcg
KzQxMyw4IEBAIHN0YXRpYyBpbnQgZGVsdGFfZW51bV9mbXRfc3RyZWFtKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRlbHRhX2VudW1f
Zm10X2ZyYW1lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBkZWx0
YV9lbnVtX2ZtdF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVj
dCBkZWx0YV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNDI1LDcgKzQyOCw4IEBA
IHN0YXRpYyBpbnQgZGVsdGFfZW51bV9mbXRfZnJhbWUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZGVsdGFfZ19mbXRfc3RyZWFtKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZGVsdGFfZ19mbXRfc3RyZWFt
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGRlbHRh
X2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC00NTQsNyArNDU4LDkgQEAgc3RhdGlj
IGludCBkZWx0YV9nX2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRlbHRhX2dfZm10X2ZyYW1lKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBkZWx0YV9n
X2ZtdF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3QgZGVsdGFfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKIAlzdHJ1Y3QgZGVsdGFfZGV2
ICpkZWx0YSA9IGN0eC0+ZGV2OwpAQCAtNDkyLDcgKzQ5OCw4IEBAIHN0YXRpYyBpbnQgZGVsdGFf
Z19mbXRfZnJhbWUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZGVsdGFfdHJ5X2ZtdF9zdHJlYW0o
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGRlbHRhX3RyeV9mbXRf
c3RyZWFtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZGVsdGFfY3R4
ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTU0Niw3ICs1NTMsOCBAQCBzdGF0aWMgaW50
IGRlbHRhX3RyeV9mbXRfc3RyZWFtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRlbHRhX3RyeV9mbXRfZnJhbWUoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGRlbHRhX3RyeV9mbXRfZnJhbWUoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBkZWx0YV9jdHgg
KmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNjA2LDcgKzYxNCw4IEBAIHN0YXRpYyBpbnQg
ZGVsdGFfdHJ5X2ZtdF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCBkZWx0YV9zX2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBkZWx0YV9zX2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
ICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZGVsdGFfY3R4ICpjdHggPSBm
aWxlX3RvX2N0eChmaWxlKTsKQEAgLTYxNSw3ICs2MjQsNyBAQCBzdGF0aWMgaW50IGRlbHRhX3Nf
Zm10X3N0cmVhbShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJc3RydWN0IHY0bDJfcGl4
X2Zvcm1hdCAqcGl4ID0gJmYtPmZtdC5waXg7CiAJaW50IHJldDsKIAotCXJldCA9IGRlbHRhX3Ry
eV9mbXRfc3RyZWFtKGZpbGUsIGZoLCBmKTsKKwlyZXQgPSBkZWx0YV90cnlfZm10X3N0cmVhbShm
aWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkgewogCQlkZXZfZGJnKGRlbHRhLT5kZXYsCiAJCQki
JXMgVjRMMiBTX0ZNVCAoT1VUUFVUKTogdW5zdXBwb3J0ZWQgZm9ybWF0ICU0LjRzXG4iLApAQCAt
NjQzLDcgKzY1Miw5IEBAIHN0YXRpYyBpbnQgZGVsdGFfc19mbXRfc3RyZWFtKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkZWx0YV9zX2Zt
dF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKK3N0YXRpYyBpbnQgZGVsdGFfc19mbXRfZnJhbWUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGRlbHRhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmls
ZSk7CiAJc3RydWN0IGRlbHRhX2RldiAqZGVsdGEgPSBjdHgtPmRldjsKQEAgLTY2OCw3ICs2Nzks
NyBAQCBzdGF0aWMgaW50IGRlbHRhX3NfZm10X2ZyYW1lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCQkgKiBwaXhlbCBmb3JtYXQgJiBuZWdvdGlh
dGUgcmVzb2x1dGlvbiBib3VuZGFyaWVzCiAJCSAqIGFuZCBhbGlnbm1lbnQuLi4KIAkJICovCi0J
CXJldCA9IGRlbHRhX3RyeV9mbXRfZnJhbWUoZmlsZSwgZmgsIGYpOworCQlyZXQgPSBkZWx0YV90
cnlfZm10X2ZyYW1lKGZpbGUsIHN0YXRlLCBmKTsKIAkJaWYgKHJldCkgewogCQkJZGV2X2RiZyhk
ZWx0YS0+ZGV2LAogCQkJCSIlcyBWNEwyIFNfRk1UIChDQVBUVVJFKTogdW5zdXBwb3J0ZWQgZm9y
bWF0ICU0LjRzXG4iLApAQCAtNzIyLDcgKzczMyw4IEBAIHN0YXRpYyBpbnQgZGVsdGFfc19mbXRf
ZnJhbWUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZGVsdGFfZ19zZWxlY3Rpb24oc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBkZWx0YV9nX3NlbGVjdGlvbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3QgZGVsdGFfY3R4ICpj
dHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTc5MSw3ICs4MDMsOCBAQCBzdGF0aWMgdm9pZCBk
ZWx0YV9jb21wbGV0ZV9lb3Moc3RydWN0IGRlbHRhX2N0eCAqY3R4LAogCWRldl9kYmcoZGVsdGEt
PmRldiwgIiVzIEVPUyBjb21wbGV0ZWRcbiIsIGN0eC0+bmFtZSk7CiB9CiAKLXN0YXRpYyBpbnQg
ZGVsdGFfdHJ5X2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRp
YyBpbnQgZGVsdGFfdHJ5X2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZGVjb2Rlcl9j
bWQgKmNtZCkKIHsKIAlpZiAoY21kLT5jbWQgIT0gVjRMMl9ERUNfQ01EX1NUT1ApCkBAIC04Njcs
MTMgKzg4MCwxNCBAQCBzdGF0aWMgaW50IGRlbHRhX2RlY29kZXJfc3RvcF9jbWQoc3RydWN0IGRl
bHRhX2N0eCAqY3R4KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRlbHRhX2RlY29kZXJf
Y21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZGVsdGFfZGVjb2Rl
cl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9kZWNvZGVyX2NtZCAqY21kKQogewogCXN0
cnVjdCBkZWx0YV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwogCWludCByZXQgPSAwOwog
Ci0JcmV0ID0gZGVsdGFfdHJ5X2RlY29kZXJfY21kKGZpbGUsIGZoLCBjbWQpOworCXJldCA9IGRl
bHRhX3RyeV9kZWNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgY21kKTsKIAlpZiAocmV0KQogCQlyZXR1
cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0L3N0aS9odmEv
aHZhLXY0bDIuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RpL2h2YS9odmEtdjRsMi5j
CmluZGV4IDM1ODFiNzNhOTliOGJhNTcwMmU1ZDRkOGQwMmNkNWM4MzJmYTE1NTUuLjI4ZTViMjJi
NzczMjljYTFhMjc3ODAyYmQyOTMyYjk3ZjRmZTE0OWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVk
aWEvcGxhdGZvcm0vc3Qvc3RpL2h2YS9odmEtdjRsMi5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxh
dGZvcm0vc3Qvc3RpL2h2YS9odmEtdjRsMi5jCkBAIC0yNTQsNyArMjU0LDggQEAgc3RhdGljIHZv
aWQgaHZhX2RiZ19zdW1tYXJ5KHN0cnVjdCBodmFfY3R4ICpjdHgpCiAgKiBWNEwyIGlvY3RsIG9w
ZXJhdGlvbnMKICAqLwogCi1zdGF0aWMgaW50IGh2YV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaHZhX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRsMl9j
YXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGh2YV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZp
bGUpOwpAQCAtMjY4LDcgKzI2OSw4IEBAIHN0YXRpYyBpbnQgaHZhX3F1ZXJ5Y2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGh2YV9l
bnVtX2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IGh2YV9lbnVtX2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfZm10ZGVz
YyAqZikKIHsKIAlzdHJ1Y3QgaHZhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CkBAIC0y
ODIsNyArMjg0LDggQEAgc3RhdGljIGludCBodmFfZW51bV9mbXRfc3RyZWFtKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGh2YV9lbnVt
X2ZtdF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaHZh
X2VudW1fZm10X2ZyYW1lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQog
ewogCXN0cnVjdCBodmFfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKQEAgLTI5Niw3ICsy
OTksOSBAQCBzdGF0aWMgaW50IGh2YV9lbnVtX2ZtdF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBodmFfZ19mbXRfc3RyZWFt
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3Rh
dGljIGludCBodmFfZ19mbXRfc3RyZWFtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgaHZhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAJc3RydWN0
IGh2YV9zdHJlYW1pbmZvICpzdHJlYW1pbmZvID0gJmN0eC0+c3RyZWFtaW5mbzsKQEAgLTMxNSw3
ICszMjAsOSBAQCBzdGF0aWMgaW50IGh2YV9nX2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgaHZhX2dfZm10X2ZyYW1lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBodmFfZ19mbXRfZnJhbWUoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaHZhX2N0eCAqY3R4ID0gZmlsZV90b19j
dHgoZmlsZSk7CiAJc3RydWN0IGh2YV9mcmFtZWluZm8gKmZyYW1laW5mbyA9ICZjdHgtPmZyYW1l
aW5mbzsKQEAgLTMzNSw3ICszNDIsOCBAQCBzdGF0aWMgaW50IGh2YV9nX2ZtdF9mcmFtZShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBodmFfdHJ5X2ZtdF9zdHJlYW0oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGh2YV90cnlfZm10X3N0cmVhbShzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAg
ICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBodmFfY3R4ICpjdHggPSBmaWxl
X3RvX2N0eChmaWxlKTsKQEAgLTM5OSw3ICs0MDcsOCBAQCBzdGF0aWMgaW50IGh2YV90cnlfZm10
X3N0cmVhbShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBodmFfdHJ5X2ZtdF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgaHZhX3RyeV9mbXRfZnJhbWUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGh2YV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUp
OwpAQCAtNDUwLDE0ICs0NTksMTYgQEAgc3RhdGljIGludCBodmFfdHJ5X2ZtdF9mcmFtZShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBo
dmFfc19mbXRfc3RyZWFtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQorc3RhdGljIGludCBodmFfc19mbXRfc3RyZWFtKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaHZhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgo
ZmlsZSk7CiAJc3RydWN0IGRldmljZSAqZGV2ID0gY3R4X3RvX2RldihjdHgpOwogCXN0cnVjdCB2
YjJfcXVldWUgKnZxOwogCWludCByZXQ7CiAKLQlyZXQgPSBodmFfdHJ5X2ZtdF9zdHJlYW0oZmls
ZSwgZmgsIGYpOworCXJldCA9IGh2YV90cnlfZm10X3N0cmVhbShmaWxlLCBzdGF0ZSwgZik7CiAJ
aWYgKHJldCkgewogCQlkZXZfZGJnKGRldiwgIiVzIFY0TDIgU19GTVQgKENBUFRVUkUpOiB1bnN1
cHBvcnRlZCBmb3JtYXQgJS40c1xuIiwKIAkJCWN0eC0+bmFtZSwgKGNoYXIgKikmZi0+Zm10LnBp
eC5waXhlbGZvcm1hdCk7CkBAIC00ODAsNyArNDkxLDkgQEAgc3RhdGljIGludCBodmFfc19mbXRf
c3RyZWFtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGh2YV9zX2ZtdF9mcmFtZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgaHZh
X3NfZm10X2ZyYW1lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0
IGh2YV9jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUpOwogCXN0cnVjdCBkZXZpY2UgKmRldiA9
IGN0eF90b19kZXYoY3R4KTsKQEAgLTQ4OCw3ICs1MDEsNyBAQCBzdGF0aWMgaW50IGh2YV9zX2Zt
dF9mcmFtZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gaHZhX3RyeV9m
bXRfZnJhbWUoZmlsZSwgZmgsIGYpOworCXJldCA9IGh2YV90cnlfZm10X2ZyYW1lKGZpbGUsIHN0
YXRlLCBmKTsKIAlpZiAocmV0KSB7CiAJCWRldl9kYmcoZGV2LCAiJXMgVjRMMiBTX0ZNVCAoT1VU
UFVUKTogdW5zdXBwb3J0ZWQgZm9ybWF0ICUuNHNcbiIsCiAJCQljdHgtPm5hbWUsIChjaGFyICop
JnBpeC0+cGl4ZWxmb3JtYXQpOwpAQCAtNTE4LDcgKzUzMSw4IEBAIHN0YXRpYyBpbnQgaHZhX3Nf
Zm10X2ZyYW1lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGh2YV9nX3Bhcm0oc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpzcCkKK3N0YXRpYyBpbnQg
aHZhX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCSAgICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnNwKQogewogCXN0cnVjdCBo
dmFfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9mcmFjdCAqdGlt
ZV9wZXJfZnJhbWUgPSAmY3R4LT5jdHJscy50aW1lX3Blcl9mcmFtZTsKQEAgLTUzNCw3ICs1NDgs
OCBAQCBzdGF0aWMgaW50IGh2YV9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpzcCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBo
dmFfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFt
cGFybSAqc3ApCitzdGF0aWMgaW50IGh2YV9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRsMl9zdHJlYW1w
YXJtICpzcCkKIHsKIAlzdHJ1Y3QgaHZhX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CiAJ
c3RydWN0IHY0bDJfZnJhY3QgKnRpbWVfcGVyX2ZyYW1lID0gJmN0eC0+Y3RybHMudGltZV9wZXJf
ZnJhbWU7CkBAIC01NDQsNyArNTU5LDcgQEAgc3RhdGljIGludCBodmFfc19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqc3ApCiAKIAlpZiAo
IXNwLT5wYXJtLm91dHB1dC50aW1lcGVyZnJhbWUubnVtZXJhdG9yIHx8CiAJICAgICFzcC0+cGFy
bS5vdXRwdXQudGltZXBlcmZyYW1lLmRlbm9taW5hdG9yKQotCQlyZXR1cm4gaHZhX2dfcGFybShm
aWxlLCBmaCwgc3ApOworCQlyZXR1cm4gaHZhX2dfcGFybShmaWxlLCBzdGF0ZSwgc3ApOwogCiAJ
c3AtPnBhcm0ub3V0cHV0LmNhcGFiaWxpdHkgPSBWNEwyX0NBUF9USU1FUEVSRlJBTUU7CiAJdGlt
ZV9wZXJfZnJhbWUtPm51bWVyYXRvciA9IHNwLT5wYXJtLm91dHB1dC50aW1lcGVyZnJhbWUubnVt
ZXJhdG9yOwpAQCAtNTU0LDcgKzU2OSw4IEBAIHN0YXRpYyBpbnQgaHZhX3NfcGFybShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnNwKQogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IGh2YV9xYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKK3N0YXRpYyBpbnQgaHZhX3FidWYoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3Ry
dWN0IHY0bDJfYnVmZmVyICpidWYpCiB7CiAJc3RydWN0IGh2YV9jdHggKmN0eCA9IGZpbGVfdG9f
Y3R4KGZpbGUpOwogCXN0cnVjdCBkZXZpY2UgKmRldiA9IGN0eF90b19kZXYoY3R4KTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RtMzIvZG1hMmQvZG1hMmQuYyBiL2Ry
aXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RtMzIvZG1hMmQvZG1hMmQuYwppbmRleCA0NjhjMjQ3
YmEzMjgyYzZmNGQwOTI5ODU0NjVjZDNkMDkwN2IxYzA3Li44YmZlNDE1ZWVjN2UwNmJiOWNlNjgw
ZDZjZDA3MzJiYTcwNDZmZDJiIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0
L3N0bTMyL2RtYTJkL2RtYTJkLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdC9zdG0z
Mi9kbWEyZC9kbWEyZC5jCkBAIC0zMzMsNyArMzMzLDggQEAgc3RhdGljIGludCBkbWEyZF9yZWxl
YXNlKHN0cnVjdCBmaWxlICpmaWxlKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlk
aW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJ
c3Ryc2NweShjYXAtPmRyaXZlciwgRE1BMkRfTkFNRSwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7CkBA
IC0zNDMsNyArMzQ0LDkgQEAgc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mbXRkZXNj
ICpmKQorc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCB2NGwyX2Zt
dGRlc2MgKmYpCiB7CiAJaWYgKGYtPmluZGV4ID49IE5VTV9GT1JNQVRTKQogCQlyZXR1cm4gLUVJ
TlZBTDsKQEAgLTM1Miw3ICszNTUsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZgogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRpb2NfZ19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBkbWEyZF9jdHggKmN0eCA9IGZpbGUy
Y3R4KGZpbGUpOwogCXN0cnVjdCB2YjJfcXVldWUgKnZxOwpAQCAtMzc3LDcgKzM4MSw4IEBAIHN0
YXRpYyBpbnQgdmlkaW9jX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3Ry
eV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IGRtYTJkX2N0eCAqY3R4ID0gZmlsZTJjdHgoZmlsZSk7CiAJc3RydWN0IGRtYTJk
X2ZtdCAqZm10OwpAQCAtNDIwLDcgKzQyNSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX3Nf
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZG1hMmRfY3R4ICpjdHggPSBm
aWxlMmN0eChmaWxlKTsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsKQEAgLTQzMSw3ICs0MzcsNyBA
QCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCS8qIEFkanVzdCBhbGwgdmFsdWVzIGFjY29yZGluZ2x5
IHRvIHRoZSBoYXJkd2FyZSBjYXBhYmlsaXRpZXMKIAkgKiBhbmQgY2hvc2VuIGZvcm1hdC4KIAkg
Ki8KLQlyZXQgPSB2aWRpb2NfdHJ5X2ZtdChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSB2aWRpb2Nf
dHJ5X2ZtdChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdC9zdG0zMi9zdG0zMi1kY21pLmMgYi9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0L3N0bTMyL3N0bTMyLWRjbWkuYwppbmRleCAxMzc2Mjg2
MWI3Njk0MjUzMGVkNWY4MjFjMzBmNzdjOTIxMDQ3ZjliLi5hMTY3Zjk2YmY1ZDBiYzZmYjE2ZDJh
NWNjZjE3Zjg1YjNmMDA1Njk2IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0
L3N0bTMyL3N0bTMyLWRjbWkuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0L3N0bTMy
L3N0bTMyLWRjbWkuYwpAQCAtOTAwLDcgKzkwMCw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIy
X29wcyBkY21pX3ZpZGVvX3FvcHMgPSB7CiAJLnN0b3Bfc3RyZWFtaW5nCQk9IGRjbWlfc3RvcF9z
dHJlYW1pbmcsCiB9OwogCi1zdGF0aWMgaW50IGRjbWlfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZGNtaV9nX2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3Qgc3RtMzJfZGNt
aSAqZGNtaSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDg2LDcgKzEwODcsOCBAQCBzdGF0
aWMgaW50IGRjbWlfc2V0X2ZtdChzdHJ1Y3Qgc3RtMzJfZGNtaSAqZGNtaSwgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRjbWlfc19mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZGNtaV9zX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0
IHN0bTMyX2RjbWkgKmRjbWkgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTA5Nyw3ICsxMDk5
LDggQEAgc3RhdGljIGludCBkY21pX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIGRjbWlfc2V0X2ZtdChkY21pLCBmKTsKIH0KIAotc3RhdGljIGlu
dCBkY21pX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgZGNtaV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCBzdG0zMl9kY21pICpkY21pID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAg
LTExMDUsNyArMTEwOCw4IEBAIHN0YXRpYyBpbnQgZGNtaV90cnlfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGRjbWlfdHJ5X2ZtdChkY21pLCBmLCBO
VUxMLCBOVUxMKTsKIH0KIAotc3RhdGljIGludCBkY21pX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCBkY21pX2VudW1fZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCBzdG0zMl9kY21p
ICpkY21pID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEyMjQsNyArMTIyOCw4IEBAIHN0YXRp
YyBpbnQgZGNtaV9nZXRfc2Vuc29yX2JvdW5kcyhzdHJ1Y3Qgc3RtMzJfZGNtaSAqZGNtaSwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkY21pX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZGNtaV9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICBz
dHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IHN0bTMyX2RjbWkgKmRjbWkgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTI1NCw3ICsxMjU5LDggQEAgc3RhdGljIGludCBkY21p
X2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBkY21pX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCBkY21pX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwy
X3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3Qgc3RtMzJfZGNtaSAqZGNtaSA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0xMzA1LDcgKzEzMTEsOCBAQCBzdGF0aWMgaW50IGRjbWlfc19zZWxlY3Rp
b24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgZGNtaV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgZGNtaV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7
CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgRFJWX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpA
QCAtMTMxNSw3ICsxMzIyLDggQEAgc3RhdGljIGludCBkY21pX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRjbWlfZW51
bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZGNtaV9l
bnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaSkKIHsKIAlpZiAoaS0+aW5k
ZXggIT0gMCkKQEAgLTEzMjYsMjAgKzEzMzQsMjMgQEAgc3RhdGljIGludCBkY21pX2VudW1faW5w
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgZGNtaV9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25l
ZCBpbnQgKmkpCitzdGF0aWMgaW50IGRjbWlfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQl1bnNpZ25lZCBpbnQgKmkpCiB7CiAJ
KmkgPSAwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRjbWlfc19pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IGRjbWlf
c19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQl1bnNpZ25lZCBpbnQgaSkKIHsKIAlpZiAoaSA+IDApCiAJCXJldHVybiAtRUlOVkFM
OwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRjbWlfZW51bV9mcmFtZXNpemVzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZGNtaV9lbnVtX2ZyYW1lc2l6ZXMo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCBzdG0zMl9k
Y21pICpkY21pID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEzNjgsNyArMTM3OSw4IEBAIHN0
YXRpYyBpbnQgZGNtaV9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRjbWlfZ19wYXJtKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBkY21pX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkgICAgICAg
c3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcCkKIHsKIAlzdHJ1Y3Qgc3RtMzJfZGNtaSAqZGNtaSA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzc2LDcgKzEzODgsOCBAQCBzdGF0aWMgaW50IGRj
bWlfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB2NGwyX2df
cGFybV9jYXAodmlkZW9fZGV2ZGF0YShmaWxlKSwgZGNtaS0+c291cmNlLCBwKTsKIH0KIAotc3Rh
dGljIGludCBkY21pX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgZGNtaV9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCSAgICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJICAgICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0g
KnApCiB7CiAJc3RydWN0IHN0bTMyX2RjbWkgKmRjbWkgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtMTM4NCw3ICsxMzk3LDggQEAgc3RhdGljIGludCBkY21pX3NfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gdjRsMl9zX3Bhcm1fY2FwKHZpZGVvX2RldmRhdGEo
ZmlsZSksIGRjbWktPnNvdXJjZSwgcCk7CiB9CiAKLXN0YXRpYyBpbnQgZGNtaV9lbnVtX2ZyYW1l
aW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgZGNtaV9l
bnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0g
KmZpdmFsKQogewogCXN0cnVjdCBzdG0zMl9kY21pICpkY21pID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RtMzIvc3RtMzItZGNt
aXBwL2RjbWlwcC1ieXRlY2FwLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N0L3N0bTMyL3N0
bTMyLWRjbWlwcC9kY21pcHAtYnl0ZWNhcC5jCmluZGV4IDFjMWI2YjQ4OTE4ZWUyNmYyNDVkNGNm
OTkwODY0NzNjNDRlNzQxMjMuLjFkNjQ3OGU5MTIzYTIxZjUzMGI5MGMzYmEzMWE2MzA3MTcwMjBl
YmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3Qvc3RtMzIvc3RtMzItZGNt
aXBwL2RjbWlwcC1ieXRlY2FwLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdC9zdG0z
Mi9zdG0zMi1kY21pcHAvZGNtaXBwLWJ5dGVjYXAuYwpAQCAtMTcyLDcgKzE3Miw4IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0IGZtdF9kZWZhdWx0ID0gewogCS54ZmVyX2Z1
bmMgPSBEQ01JUFBfWEZFUl9GVU5DX0RFRkFVTFQsCiB9OwogCi1zdGF0aWMgaW50IGRjbWlwcF9i
eXRlY2FwX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBkY21pcHBfYnl0ZWNhcF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmls
aXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgRENNSVBQX1BERVZfTkFNRSwgc2l6
ZW9mKGNhcC0+ZHJpdmVyKSk7CkBAIC0xODEsNyArMTgyLDggQEAgc3RhdGljIGludCBkY21pcHBf
Ynl0ZWNhcF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBkY21pcHBfYnl0ZWNhcF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBkY21pcHBfYnl0ZWNhcF9nX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBkY21pcHBf
Ynl0ZWNhcF9kZXZpY2UgKnZjYXAgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTkxLDcgKzE5
Myw4IEBAIHN0YXRpYyBpbnQgZGNtaXBwX2J5dGVjYXBfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkY21pcHBf
Ynl0ZWNhcF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IGRjbWlwcF9ieXRlY2FwX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGRjbWlwcF9ieXRlY2FwX2RldmljZSAqdmNh
cCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yMzEsNyArMjM0LDggQEAgc3RhdGljIGludCBk
Y21pcHBfYnl0ZWNhcF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZGNtaXBwX2J5dGVjYXBfc19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZGNtaXBwX2J5
dGVjYXBfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3QgZGNtaXBwX2J5dGVjYXBfZGV2aWNlICp2Y2FwID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTI0MSw3ICsyNDUsNyBAQCBzdGF0aWMgaW50IGRjbWlwcF9ieXRlY2FwX3NfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHZiMl9pc19idXN5KCZ2Y2Fw
LT5xdWV1ZSkpCiAJCXJldHVybiAtRUJVU1k7CiAKLQlyZXQgPSBkY21pcHBfYnl0ZWNhcF90cnlf
Zm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwgZik7CisJcmV0ID0gZGNtaXBwX2J5dGVjYXBfdHJ5X2Zt
dF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBA
IC0yNjMsNyArMjY3LDggQEAgc3RhdGljIGludCBkY21pcHBfYnl0ZWNhcF9zX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGRjbWlwcF9ieXRlY2FwX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IGRjbWlwcF9ieXRlY2FwX2VudW1fZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWNvbnN0IHN0cnVjdCBkY21p
cHBfYnl0ZWNhcF9waXhfbWFwICp2cGl4OwpAQCAtMzAxLDcgKzMwNiw4IEBAIHN0YXRpYyBpbnQg
ZGNtaXBwX2J5dGVjYXBfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkY21pcHBfYnl0ZWNhcF9lbnVtX2Zy
YW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBkY21pcHBf
Ynl0ZWNhcF9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVu
dW0gKmZzaXplKQogewogCWNvbnN0IHN0cnVjdCBkY21pcHBfYnl0ZWNhcF9waXhfbWFwICp2cGl4
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdW54aS9zdW40aS1jc2kvc3Vu
NGlfdjRsMi5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdW54aS9zdW40aS1jc2kvc3VuNGlf
djRsMi5jCmluZGV4IDc0NDE5N2IwZmNjYjAzZDdlMWFkNjM0ZjAwZmYxNTY2ZDU3ZTczNWMuLjg4
MTM0NWRkYjRjYjZkMWM4NjU2OThmNGZjMzNiMjk2OGQ4NmMyOTcgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvbWVkaWEvcGxhdGZvcm0vc3VueGkvc3VuNGktY3NpL3N1bjRpX3Y0bDIuYworKysgYi9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL3N1bnhpL3N1bjRpLWNzaS9zdW40aV92NGwyLmMKQEAgLTUwLDcg
KzUwLDggQEAgY29uc3Qgc3RydWN0IHN1bjRpX2NzaV9mb3JtYXQgKnN1bjRpX2NzaV9maW5kX2Zv
cm1hdChjb25zdCB1MzIgKmZvdXJjYywKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGljIGludCBz
dW40aV9jc2lfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHN1bjRpX2NzaV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfY2FwYWJp
bGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIEtCVUlMRF9NT0ROQU1FLCBzaXpl
b2YoY2FwLT5kcml2ZXIpKTsKQEAgLTU5LDcgKzYwLDggQEAgc3RhdGljIGludCBzdW40aV9jc2lf
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgc3VuNGlfY3NpX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHN1bjRpX2NzaV9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwy
X2lucHV0ICppbnApCiB7CiAJaWYgKGlucC0+aW5kZXggIT0gMCkKQEAgLTcxLDcgKzczLDggQEAg
c3RhdGljIGludCBzdW40aV9jc2lfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzdW40aV9jc2lfZ19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHN1bjRpX2NzaV9nX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCSAgICAgdW5zaWduZWQgaW50ICppKQogewogCSppID0gMDsKQEAgLTc5LDggKzgyLDgg
QEAgc3RhdGljIGludCBzdW40aV9jc2lfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc3VuNGlfY3NpX3NfaW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAotCQkJICAgICB1bnNpZ25lZCBpbnQgaSkKK3N0YXRpYyBp
bnQgc3VuNGlfY3NpX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCB1bnNpZ25lZCBpbnQgaSkKIHsKIAlpZiAoaSAhPSAw
KQogCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTEyOCw3ICsxMzEsOCBAQCBzdGF0aWMgdm9pZCBfc3Vu
NGlfY3NpX3RyeV9mbXQoc3RydWN0IHN1bjRpX2NzaSAqY3NpLAogCX0KIH0KIAotc3RhdGljIGlu
dCBzdW40aV9jc2lfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCBzdW40aV9jc2lfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHN1bjRpX2NzaSAqY3NpID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTEzOCw3ICsxNDIsOCBAQCBzdGF0aWMgaW50IHN1bjRpX2NzaV90
cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgc3VuNGlfY3NpX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHN1bjRpX2NzaV9zX2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgc3VuNGlfY3NpICpjc2kg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTQ5LDcgKzE1NCw4IEBAIHN0YXRpYyBpbnQgc3Vu
NGlfY3NpX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc3VuNGlfY3NpX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHN1bjRpX2NzaV9nX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgc3VuNGlfY3Np
ICpjc2kgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTU5LDcgKzE2NSw4IEBAIHN0YXRpYyBp
bnQgc3VuNGlfY3NpX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc3VuNGlfY3NpX2VudW1fZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHN1bjRpX2NzaV9lbnVt
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7
CiAJaWYgKGYtPmluZGV4ID49IEFSUkFZX1NJWkUoc3VuNGlfY3NpX2Zvcm1hdHMpKQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdW54aS9zdW42aS1jc2kvc3VuNmlfY3NpX2Nh
cHR1cmUuYyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3VueGkvc3VuNmktY3NpL3N1bjZpX2Nz
aV9jYXB0dXJlLmMKaW5kZXggNjU4NzlmNDgwMmMwMGNkMWI2NWYwMmI2YmYwMGYyN2E3MmQ2NzRj
ZS4uNGJkOWY5YWE0MzQ5Zjk4ZjFlNTY1NjFhMDY2Y2YzZmQ3ZGZmMTI5YyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdW54aS9zdW42aS1jc2kvc3VuNmlfY3NpX2NhcHR1cmUu
YworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N1bnhpL3N1bjZpLWNzaS9zdW42aV9jc2lf
Y2FwdHVyZS5jCkBAIC03MTEsNyArNzExLDggQEAgc3RhdGljIHZvaWQgc3VuNmlfY3NpX2NhcHR1
cmVfZm9ybWF0X3ByZXBhcmUoc3RydWN0IHY0bDJfZm9ybWF0ICpmb3JtYXQpCiAJcGl4X2Zvcm1h
dC0+eGZlcl9mdW5jID0gVjRMMl9YRkVSX0ZVTkNfREVGQVVMVDsKIH0KIAotc3RhdGljIGludCBz
dW42aV9jc2lfY2FwdHVyZV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgc3VuNmlfY3NpX2NhcHR1cmVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAg
c3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwYWJpbGl0eSkKIHsKIAlzdHJ1Y3Qgc3VuNmlfY3Np
X2RldmljZSAqY3NpX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC03MjUsNyArNzI2LDgg
QEAgc3RhdGljIGludCBzdW42aV9jc2lfY2FwdHVyZV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzdW42aV9jc2lfY2Fw
dHVyZV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
c3VuNmlfY3NpX2NhcHR1cmVfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJf
Zm10ZGVzYyAqZm10ZGVzYykKIHsKIAl1MzIgaW5kZXggPSBmbXRkZXNjLT5pbmRleDsKQEAgLTcz
OCw3ICs3NDAsOCBAQCBzdGF0aWMgaW50IHN1bjZpX2NzaV9jYXB0dXJlX2VudW1fZm10KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN1
bjZpX2NzaV9jYXB0dXJlX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCBzdW42aV9jc2lfY2FwdHVyZV9nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmZvcm1hdCkKIHsKIAlzdHJ1Y3Qgc3VuNmlfY3NpX2RldmljZSAqY3NpX2RldiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC03NDgsNyArNzUxLDggQEAgc3RhdGljIGludCBzdW42aV9j
c2lfY2FwdHVyZV9nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBzdW42aV9jc2lfY2FwdHVyZV9zX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlfY3NpX2NhcHR1cmVfc19mbXQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmb3JtYXQpCiB7CiAJc3RydWN0IHN1bjZpX2Nz
aV9kZXZpY2UgKmNzaV9kZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzY0LDcgKzc2OCw4
IEBAIHN0YXRpYyBpbnQgc3VuNmlfY3NpX2NhcHR1cmVfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc3VuNmlfY3NpX2NhcHR1
cmVfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3Vu
NmlfY3NpX2NhcHR1cmVfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmb3JtYXQpCiB7CiAJc3VuNmlfY3NpX2NhcHR1cmVfZm9ybWF0X3ByZXBhcmUoZm9ybWF0KTsK
QEAgLTc3Miw3ICs3NzcsOCBAQCBzdGF0aWMgaW50IHN1bjZpX2NzaV9jYXB0dXJlX3RyeV9mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgc3VuNmlfY3NpX2NhcHR1cmVfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlfY3NpX2NhcHR1cmVfZW51bV9pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0
cnVjdCB2NGwyX2lucHV0ICppbnB1dCkKIHsKIAlpZiAoaW5wdXQtPmluZGV4ICE9IDApCkBAIC03
ODQsNyArNzkwLDggQEAgc3RhdGljIGludCBzdW42aV9jc2lfY2FwdHVyZV9lbnVtX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHN1bjZpX2NzaV9jYXB0dXJlX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHN1bjZpX2NzaV9jYXB0dXJlX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHVu
c2lnbmVkIGludCAqaW5kZXgpCiB7CiAJKmluZGV4ID0gMDsKQEAgLTc5Miw3ICs3OTksOCBAQCBz
dGF0aWMgaW50IHN1bjZpX2NzaV9jYXB0dXJlX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc3VuNmlfY3NpX2NhcHR1cmVf
c19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlf
Y3NpX2NhcHR1cmVfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgdW5zaWduZWQgaW50IGluZGV4KQog
ewogCWlmIChpbmRleCAhPSAwKQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9z
dW54aS9zdW44aS1kaS9zdW44aS1kaS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdW54aS9z
dW44aS1kaS9zdW44aS1kaS5jCmluZGV4IGViNTE5YWZiMzBjYTEwYzZmNDM3MDYyNmQwZGNlOWU3
MTgzYjI4ZTUuLmZmMWNmMzczOTViOWRlNmVmMDk3M2JkMDM3MmViODE4ZWFmMTE2OTIgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3VueGkvc3VuOGktZGkvc3VuOGktZGkuYwor
KysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N1bnhpL3N1bjhpLWRpL3N1bjhpLWRpLmMKQEAg
LTM0Nyw3ICszNDcsOCBAQCBzdGF0aWMgdm9pZCBkZWludGVybGFjZV9wcmVwYXJlX2Zvcm1hdChz
dHJ1Y3QgdjRsMl9waXhfZm9ybWF0ICpwaXhfZm10KQogCXBpeF9mbXQtPnNpemVpbWFnZSA9IHNp
emVpbWFnZTsKIH0KIAotc3RhdGljIGludCBkZWludGVybGFjZV9xdWVyeWNhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZGVpbnRlcmxhY2VfcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIs
IERFSU5URVJMQUNFX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMzU4LDcgKzM1OSw4
IEBAIHN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfZW51bV9m
bXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGRlaW50ZXJsYWNl
X2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYgKGYtPmluZGV4
IDwgQVJSQVlfU0laRShkZWludGVybGFjZV9mb3JtYXRzKSkgewpAQCAtMzcwLDcgKzM3Miw4IEBA
IHN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfZW51
bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBk
ZWludGVybGFjZV9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJaWYgKGZzaXplLT5pbmRleCAhPSAwKQpAQCAtMzkw
LDcgKzM5Myw4IEBAIHN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfZW51bV9mcmFtZXNpemVzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRl
aW50ZXJsYWNlX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IGRlaW50ZXJsYWNlX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZGVpbnRlcmxhY2VfY3R4ICpjdHggPSBkZWlu
dGVybGFjZV9maWxlMmN0eChmaWxlKTsKQEAgLTQwMCw3ICs0MDQsOCBAQCBzdGF0aWMgaW50IGRl
aW50ZXJsYWNlX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfZ19mbXRfdmlkX291dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgZGVpbnRlcmxhY2VfZ19mbXRf
dmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBkZWludGVybGFjZV9jdHggKmN0eCA9IGRlaW50ZXJsYWNlX2ZpbGUyY3R4KGZpbGUpOwpAQCAt
NDEwLDcgKzQxNSw4IEBAIHN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfZ19mbXRfdmlkX291dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBk
ZWludGVybGFjZV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IGRlaW50ZXJsYWNlX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAg
ICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlpZiAoIWRlaW50ZXJsYWNlX2NoZWNrX2Zv
cm1hdChmLT5mbXQucGl4LnBpeGVsZm9ybWF0KSkKQEAgLTQyNCw3ICs0MzAsOCBAQCBzdGF0aWMg
aW50IGRlaW50ZXJsYWNlX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBkZWludGVybGFjZV90cnlfZm10X3Zp
ZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGRlaW50ZXJs
YWNlX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlpZiAoIWRlaW50ZXJsYWNlX2NoZWNrX2Zvcm1hdChmLT5mbXQucGl4LnBpeGVs
Zm9ybWF0KSkKQEAgLTQ0MCwxNCArNDQ3LDE1IEBAIHN0YXRpYyBpbnQgZGVpbnRlcmxhY2VfdHJ5
X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IGRlaW50ZXJsYWNlX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGRlaW50ZXJsYWNlX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgZGVpbnRlcmxh
Y2VfY3R4ICpjdHggPSBkZWludGVybGFjZV9maWxlMmN0eChmaWxlKTsKIAlzdHJ1Y3QgdmIyX3F1
ZXVlICp2cTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gZGVpbnRlcmxhY2VfdHJ5X2ZtdF92aWRfY2Fw
KGZpbGUsIHByaXYsIGYpOworCXJldCA9IGRlaW50ZXJsYWNlX3RyeV9mbXRfdmlkX2NhcChmaWxl
LCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtNDYwLDE0ICs0Njgs
MTUgQEAgc3RhdGljIGludCBkZWludGVybGFjZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGRlaW50ZXJsYWNl
X3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IGRlaW50ZXJsYWNlX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgZGVpbnRlcmxhY2VfY3R4ICpjdHggPSBkZWludGVybGFjZV9m
aWxlMmN0eChmaWxlKTsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsKIAlpbnQgcmV0OwogCi0JcmV0
ID0gZGVpbnRlcmxhY2VfdHJ5X2ZtdF92aWRfb3V0KGZpbGUsIHByaXYsIGYpOworCXJldCA9IGRl
aW50ZXJsYWNlX3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJ
cmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9zdW54aS9z
dW44aS1yb3RhdGUvc3VuOGlfcm90YXRlLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N1bnhp
L3N1bjhpLXJvdGF0ZS9zdW44aV9yb3RhdGUuYwppbmRleCA4OTk5MmZlYWFiNjA4MmI0MzhlZWMx
ODljMGRlOTM1NjhkMDlmOTExLi40MWNmMTMyOTkzYjlkYTljYTI0MDYxZjk5ZDVlZDhiMzhjNTQ4
YjhmIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N1bnhpL3N1bjhpLXJvdGF0
ZS9zdW44aV9yb3RhdGUuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N1bnhpL3N1bjhp
LXJvdGF0ZS9zdW44aV9yb3RhdGUuYwpAQCAtMjA5LDcgKzIwOSw4IEBAIHN0YXRpYyB2b2lkIHJv
dGF0ZV9wcmVwYXJlX2Zvcm1hdChzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0ICpwaXhfZm10KQogCXBp
eF9mbXQtPnNpemVpbWFnZSA9IHNpemVpbWFnZTsKIH0KIAotc3RhdGljIGludCByb3RhdGVfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJvdGF0ZV9x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNj
cHkoY2FwLT5kcml2ZXIsIFJPVEFURV9OQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTIy
MCwxOSArMjIxLDIyIEBAIHN0YXRpYyBpbnQgcm90YXRlX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJvdGF0ZV9lbnVt
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBy
b3RhdGVfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpm
KQogewogCXJldHVybiByb3RhdGVfZW51bV9mbXQoZiwgdHJ1ZSk7CiB9CiAKLXN0YXRpYyBpbnQg
cm90YXRlX2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHJvdGF0ZV9lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwy
X2ZtdGRlc2MgKmYpCiB7CiAJcmV0dXJuIHJvdGF0ZV9lbnVtX2ZtdChmLCBmYWxzZSk7CiB9CiAK
LXN0YXRpYyBpbnQgcm90YXRlX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgcm90YXRlX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3Ry
dWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCWNvbnN0IHN0cnVjdCByb3RhdGVfZm9y
bWF0ICpmbXQ7CkBAIC0yODUsNyArMjg5LDggQEAgc3RhdGljIGludCByb3RhdGVfc2V0X2NhcF9m
b3JtYXQoc3RydWN0IHJvdGF0ZV9jdHggKmN0eCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCByb3RhdGVfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgcm90YXRlX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCByb3RhdGVfY3R4ICpjdHggPSByb3RhdGVfZmlsZTJjdHgoZmlsZSk7CkBA
IC0yOTUsNyArMzAwLDggQEAgc3RhdGljIGludCByb3RhdGVfZ19mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByb3Rh
dGVfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgcm90YXRlX2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CXN0cnVjdCByb3RhdGVfY3R4ICpjdHggPSByb3RhdGVfZmlsZTJjdHgoZmlsZSk7CkBAIC0zMDUs
NyArMzExLDggQEAgc3RhdGljIGludCByb3RhdGVfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByb3RhdGVfdHJ5
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBy
b3RhdGVfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHJvdGF0ZV9jdHggKmN0eCA9IHJvdGF0ZV9maWxlMmN0eChmaWxlKTsKQEAgLTMx
Myw3ICszMjAsOCBAQCBzdGF0aWMgaW50IHJvdGF0ZV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJvdGF0ZV9zZXRfY2FwX2Zvcm1hdChjdHgs
ICZmLT5mbXQucGl4LCBjdHgtPnJvdGF0ZSk7CiB9CiAKLXN0YXRpYyBpbnQgcm90YXRlX3RyeV9m
bXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcm90
YXRlX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CWlmICghcm90YXRlX2ZpbmRfZm9ybWF0KGYtPmZtdC5waXgucGl4ZWxmb3JtYXQpKQpAQCAtMzM2
LDE0ICszNDQsMTUgQEAgc3RhdGljIGludCByb3RhdGVfdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJvdGF0
ZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCByb3RhdGVfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHJvdGF0ZV9jdHggKmN0eCA9IHJvdGF0ZV9maWxlMmN0eChmaWxlKTsKIAlzdHJ1Y3Qg
dmIyX3F1ZXVlICp2cTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gcm90YXRlX3RyeV9mbXRfdmlkX2Nh
cChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSByb3RhdGVfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0
YXRlLCBmKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC0zNTYsMTQgKzM2NSwxNSBA
QCBzdGF0aWMgaW50IHJvdGF0ZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHJvdGF0ZV9zX2ZtdF92aWRfb3V0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByb3RhdGVfc19mbXRf
dmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHJvdGF0ZV9j
dHggKmN0eCA9IHJvdGF0ZV9maWxlMmN0eChmaWxlKTsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICp2cTsK
IAlpbnQgcmV0OwogCi0JcmV0ID0gcm90YXRlX3RyeV9mbXRfdmlkX291dChmaWxlLCBwcml2LCBm
KTsKKwlyZXQgPSByb3RhdGVfdHJ5X2ZtdF92aWRfb3V0KGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAo
cmV0KQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L3N5bm9wc3lzL2hkbWlyeC9zbnBzX2hkbWlyeC5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS9z
eW5vcHN5cy9oZG1pcngvc25wc19oZG1pcnguYwppbmRleCBiN2QyNzhiMzg4OWYyODE3N2I2ZWZj
NjdiMDFmMzdjYzY5YWFlNjc5Li4yNGM0NzkzMGI1NTE4YjY1NzY3OTQ4NWQ0Yzk0ZmM3NTBhN2M1
OTJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3N5bm9wc3lzL2hkbWlyeC9z
bnBzX2hkbWlyeC5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vc3lub3BzeXMvaGRtaXJ4
L3NucHNfaGRtaXJ4LmMKQEAgLTQ1OSw3ICs0NTksOCBAQCBzdGF0aWMgYm9vbCBwb3J0X25vX2xp
bmsoc3RydWN0IHNucHNfaGRtaXJ4X2RldiAqaGRtaXJ4X2RldikKIAlyZXR1cm4gIXR4XzV2X3Bv
d2VyX3ByZXNlbnQoaGRtaXJ4X2Rldik7CiB9CiAKLXN0YXRpYyBpbnQgaGRtaXJ4X3F1ZXJ5X2R2
X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGhkbWly
eF9xdWVyeV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRp
bWluZ3MpCiB7CiAJc3RydWN0IGhkbWlyeF9zdHJlYW0gKnN0cmVhbSA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CkBAIC02NDYsNyArNjQ3LDkgQEAgc3RhdGljIHZvaWQgaGRtaXJ4X3BsdWdvdXQoc3Ry
dWN0IHNucHNfaGRtaXJ4X2RldiAqaGRtaXJ4X2RldikKIAloZG1pcnhfZGV2LT5wbHVnZ2VkID0g
ZmFsc2U7CiB9CiAKLXN0YXRpYyBpbnQgaGRtaXJ4X3NldF9lZGlkKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZWRpZCAqZWRpZCkKK3N0YXRpYyBpbnQgaGRtaXJ4X3Nl
dF9lZGlkKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9lZGlkICplZGlkKQogewogCXN0cnVjdCBoZG1p
cnhfc3RyZWFtICpzdHJlYW0gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBzbnBzX2hk
bWlyeF9kZXYgKmhkbWlyeF9kZXYgPSBzdHJlYW0tPmhkbWlyeF9kZXY7CkBAIC02OTUsNyArNjk4
LDkgQEAgc3RhdGljIGludCBoZG1pcnhfc2V0X2VkaWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9lZGlkICplZGlkKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGhkbWlyeF9nZXRfZWRpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2VkaWQgKmVkaWQpCitzdGF0aWMgaW50IGhkbWlyeF9nZXRfZWRpZChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgc3RydWN0
IHY0bDJfZWRpZCAqZWRpZCkKIHsKIAlzdHJ1Y3QgaGRtaXJ4X3N0cmVhbSAqc3RyZWFtID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3Qgc25wc19oZG1pcnhfZGV2ICpoZG1pcnhfZGV2ID0g
c3RyZWFtLT5oZG1pcnhfZGV2OwpAQCAtNzMwLDcgKzczNSw4IEBAIHN0YXRpYyBpbnQgaGRtaXJ4
X2dldF9lZGlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZWRpZCAq
ZWRpZCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBoZG1pcnhfZ19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBoZG1pcnhfZ19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0
cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3RydWN0IGhkbWlyeF9zdHJlYW0gKnN0
cmVhbSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC03NDQsMTQgKzc1MCwxNiBAQCBzdGF0aWMg
aW50IGhkbWlyeF9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgaGRtaXJ4X2R2X3RpbWluZ3NfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaGRtaXJ4X2R2X3RpbWluZ3NfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
c3RydWN0IHY0bDJfZHZfdGltaW5nc19jYXAgKmNhcCkKIHsKIAkqY2FwID0gaGRtaXJ4X3RpbWlu
Z3NfY2FwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGhkbWlyeF9lbnVtX2R2X3RpbWlu
Z3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGhkbWlyeF9lbnVt
X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2VudW1fZHZfdGltaW5ncyAqdGltaW5n
cykKIHsKIAlyZXR1cm4gdjRsMl9lbnVtX2R2X3RpbWluZ3NfY2FwKHRpbWluZ3MsICZoZG1pcnhf
dGltaW5nc19jYXAsIE5VTEwsIE5VTEwpOwpAQCAtMTE1NCw3ICsxMTYyLDggQEAgc3RhdGljIHZv
aWQgaGRtaXJ4X3N1Ym1vZHVsZV9pbml0KHN0cnVjdCBzbnBzX2hkbWlyeF9kZXYgKmhkbWlyeF9k
ZXYpCiAJaGRtaXJ4X2NvbnRyb2xsZXJfaW5pdChoZG1pcnhfZGV2KTsKIH0KIAotc3RhdGljIGlu
dCBoZG1pcnhfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgaGRtaXJ4X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9pbnB1dCAq
aW5wdXQpCiB7CiAJaWYgKGlucHV0LT5pbmRleCA+IDApCkBAIC0xMTY4LDEzICsxMTc3LDE1IEBA
IHN0YXRpYyBpbnQgaGRtaXJ4X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaGRtaXJ4X2dldF9pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCBoZG1p
cnhfZ2V0X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLCB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJKmkgPSAwOwogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IGhkbWlyeF9zZXRfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBoZG1pcnhfc2V0X2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LCB1bnNpZ25lZCBpbnQgaSkKIHsKIAlpZiAoaSkKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC0xMjc4
LDcgKzEyODksOCBAQCBzdGF0aWMgdm9pZCBoZG1pcnhfc2V0X2ZtdChzdHJ1Y3QgaGRtaXJ4X3N0
cmVhbSAqc3RyZWFtLAogCX0KIH0KIAotc3RhdGljIGludCBoZG1pcnhfZW51bV9mbXRfdmlkX2Nh
cF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGhkbWly
eF9lbnVtX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICBzdHJ1Y3QgdjRsMl9mbXRkZXNj
ICpmKQogewogCXN0cnVjdCBoZG1pcnhfc3RyZWFtICpzdHJlYW0gPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtMTI5Myw3ICsxMzA1LDggQEAgc3RhdGljIGludCBoZG1pcnhfZW51bV9mbXRfdmlk
X2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIHN0YXRpYyBp
bnQgaGRtaXJ4X3NfZm10X3ZpZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAotCQkJCSAg
ICAgICB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCisJCQkJICAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCiB7CiAJc3RydWN0IGhkbWlyeF9zdHJlYW0gKnN0cmVhbSA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAJc3RydWN0IHNucHNfaGRtaXJ4X2RldiAqaGRtaXJ4X2RldiA9IHN0cmVhbS0+aGRt
aXJ4X2RldjsKQEAgLTEzMDksNyArMTMyMiw4IEBAIHN0YXRpYyBpbnQgaGRtaXJ4X3NfZm10X3Zp
ZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGhkbWlyeF9nX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCitzdGF0aWMgaW50IGhkbWlyeF9nX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaGRtaXJ4X3N0cmVhbSAq
c3RyZWFtID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEzMjMsNyArMTMzNyw4IEBAIHN0YXRp
YyBpbnQgaGRtaXJ4X2dfZm10X3ZpZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBoZG1pcnhfZ19kdl90aW1pbmdzKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBoZG1pcnhfZ19kdl90aW1p
bmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCiB7
CiAJc3RydWN0IGhkbWlyeF9zdHJlYW0gKnN0cmVhbSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xMzM5LDcgKzEzNTQsOCBAQCBzdGF0aWMgaW50IGhkbWlyeF9nX2R2X3RpbWluZ3Moc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaGRt
aXJ4X3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgaGRtaXJ4X3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9kdl90
aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCBoZG1pcnhfc3RyZWFtICpzdHJlYW0gPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtMTM4MSw3ICsxMzk3LDggQEAgc3RhdGljIGludCBoZG1pcnhf
c19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IGhkbWlyeF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgaGRtaXJ4X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9j
YXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGhkbWlyeF9zdHJlYW0gKnN0cmVhbSA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3RpL2Ft
NDM3eC9hbTQzN3gtdnBmZS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9hbTQzN3gvYW00
Mzd4LXZwZmUuYwppbmRleCAxY2E1NTlkZjdlNTkwMDYzY2ExMDc1MmFlOWJlNTI0ZWRiYmIxNGE2
Li5jNTZlZDI0MzU3MzFhNDQ5OGJlOGY4N2ExOTgyZjQ4OTFmNzFhNjc5IDEwMDY0NAotLS0gYS9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL3RpL2FtNDM3eC9hbTQzN3gtdnBmZS5jCisrKyBiL2RyaXZl
cnMvbWVkaWEvcGxhdGZvcm0vdGkvYW00Mzd4L2FtNDM3eC12cGZlLmMKQEAgLTEyNjgsNyArMTI2
OCw4IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB2cGZlX2F0dGFjaF9pcnEoc3RydWN0IHZwZmVfZGV2
aWNlICp2cGZlKQogCXZwZmVfcmVnX3dyaXRlKCZ2cGZlLT5jY2RjLCBpbnRyLCBWUEZFX0lSUV9F
Tl9TRVQpOwogfQogCi1zdGF0aWMgaW50IHZwZmVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgICpwcml2LAorc3RhdGljIGludCB2cGZlX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwy
X2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBWUEZFX01PRFVMRV9O
QU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKQEAgLTEzNTAsNyArMTM1MSw4IEBAIHN0YXRpYyBp
bnQgdnBmZV9jYWxjX2Zvcm1hdF9zaXplKHN0cnVjdCB2cGZlX2RldmljZSAqdnBmZSwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2cGZlX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2cGZlX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJICAgICAgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHZwZmVfZGV2aWNlICp2cGZlID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTEzNjAsNyArMTM2Miw4IEBAIHN0YXRpYyBpbnQgdnBmZV9nX2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2
cGZlX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQg
dnBmZV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2
cGZlX2RldmljZSAqdnBmZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzg0LDcgKzEzODcs
OCBAQCBzdGF0aWMgaW50IHZwZmVfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpw
cml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZwZmVfdHJ5X2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdnBmZV90cnlfZm10KHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZwZmVfZGV2aWNlICp2cGZlID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTE0NDQsNyArMTQ0OCw4IEBAIHN0YXRpYyBpbnQgdnBmZV90cnlfZm10
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB2cGZlX2NhbGNfZm9ybWF0
X3NpemUodnBmZSwgZm10LCBmKTsKIH0KIAotc3RhdGljIGludCB2cGZlX3NfZm10KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2cGZlX3NfZm10KHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJICAg
ICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHZwZmVfZGV2aWNlICp2cGZl
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE0NTgsNyArMTQ2Myw3IEBAIHN0YXRpYyBpbnQg
dnBmZV9zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAkJcmV0dXJuIC1FQlVT
WTsKIAl9CiAKLQlyZXQgPSB2cGZlX3RyeV9mbXQoZmlsZSwgcHJpdiwgZm10KTsKKwlyZXQgPSB2
cGZlX3RyeV9mbXQoZmlsZSwgc3RhdGUsIGZtdCk7CiAJaWYgKHJldCA8IDApCiAJCXJldHVybiBy
ZXQ7CiAKQEAgLTE0OTMsNyArMTQ5OCw4IEBAIHN0YXRpYyBpbnQgdnBmZV9zX2ZtdChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gdnBmZV9jb25maWdfY2NkY19pbWFnZV9m
b3JtYXQodnBmZSk7CiB9CiAKLXN0YXRpYyBpbnQgdnBmZV9lbnVtX3NpemUoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB2cGZlX2VudW1fc2l6ZShzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0
cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKIHsKIAlzdHJ1Y3QgdnBmZV9kZXZpY2UgKnZw
ZmUgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTU4OSw3ICsxNTk1LDggQEAgc3RhdGljIGlu
dCB2cGZlX2dldF9hcHBfaW5wdXRfaW5kZXgoc3RydWN0IHZwZmVfZGV2aWNlICp2cGZlLAogCXJl
dHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IHZwZmVfZW51bV9pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdnBmZV9lbnVtX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wKQogewogCXN0cnVjdCB2cGZlX2RldmljZSAqdnBmZSA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNjA4LDcgKzE2MTUsOCBAQCBzdGF0aWMgaW50IHZw
ZmVfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2cGZlX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHVuc2lnbmVkIGludCAqaW5kZXgpCitzdGF0aWMgaW50IHZwZmVfZ19pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQl1bnNpZ25l
ZCBpbnQgKmluZGV4KQogewogCXN0cnVjdCB2cGZlX2RldmljZSAqdnBmZSA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTE2NzUsMTQgKzE2ODMsMTYgQEAgc3RhdGljIGludCB2cGZlX3NldF9p
bnB1dChzdHJ1Y3QgdnBmZV9kZXZpY2UgKnZwZmUsIHVuc2lnbmVkIGludCBpbmRleCkKIAlyZXR1
cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZwZmVfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGluZGV4KQorc3RhdGljIGludCB2cGZlX3NfaW5wdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
dW5zaWduZWQgaW50IGluZGV4KQogewogCXN0cnVjdCB2cGZlX2RldmljZSAqdnBmZSA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CiAKIAlyZXR1cm4gdnBmZV9zZXRfaW5wdXQodnBmZSwgaW5kZXgpOwog
fQogCi1zdGF0aWMgaW50IHZwZmVfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHY0bDJfc3RkX2lkICpzdGRfaWQpCitzdGF0aWMgaW50IHZwZmVfcXVlcnlzdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHY0bDJf
c3RkX2lkICpzdGRfaWQpCiB7CiAJc3RydWN0IHZwZmVfZGV2aWNlICp2cGZlID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdnBmZV9zdWJkZXZfaW5mbyAqc2RpbmZvOwpAQCAtMTY5Niw3
ICsxNzA2LDggQEAgc3RhdGljIGludCB2cGZlX3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqc3RkX2lkKQogCQkJCQkgdmlkZW8sIHF1ZXJ5c3RkLCBz
dGRfaWQpOwogfQogCi1zdGF0aWMgaW50IHZwZmVfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHY0bDJfc3RkX2lkIHN0ZF9pZCkKK3N0YXRpYyBpbnQgdnBmZV9zX3N0ZChzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAg
IHY0bDJfc3RkX2lkIHN0ZF9pZCkKIHsKIAlzdHJ1Y3QgdnBmZV9kZXZpY2UgKnZwZmUgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2cGZlX3N1YmRldl9pbmZvICpzZGluZm87CkBAIC0x
NzI4LDcgKzE3MzksOCBAQCBzdGF0aWMgaW50IHZwZmVfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIHN0ZF9pZCkKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0
aWMgaW50IHZwZmVfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3Rk
X2lkICpzdGRfaWQpCitzdGF0aWMgaW50IHZwZmVfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICB2NGwyX3N0ZF9pZCAqc3Rk
X2lkKQogewogCXN0cnVjdCB2cGZlX2RldmljZSAqdnBmZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CiAJc3RydWN0IHZwZmVfc3ViZGV2X2luZm8gKnNkaW5mbzsKQEAgLTE5NDYsOCArMTk1OCw5IEBA
IHN0YXRpYyB2b2lkIHZwZmVfc3RvcF9zdHJlYW1pbmcoc3RydWN0IHZiMl9xdWV1ZSAqdnEpCiAJ
dnBmZV9yZXR1cm5fYWxsX2J1ZmZlcnModnBmZSwgVkIyX0JVRl9TVEFURV9FUlJPUik7CiB9CiAK
LXN0YXRpYyBpbnQgdnBmZV9nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAotCQkJICAgICAgaW50IHR5cGUsIHN0cnVjdCB2NGwyX2ZyYWN0ICpmKQorc3RhdGljIGlu
dCB2cGZlX2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgaW50IHR5cGUsCisJCQkgICAgICBzdHJ1Y3QgdjRs
Ml9mcmFjdCAqZikKIHsKIAlzdHJ1Y3QgdnBmZV9kZXZpY2UgKnZwZmUgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwogCkBAIC0xOTYxLDcgKzE5NzQsOCBAQCBzdGF0aWMgaW50IHZwZmVfZ19waXhlbGFz
cGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIAogc3RhdGljIGludAotdnBm
ZV9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3Nl
bGVjdGlvbiAqcykKK3ZwZmVfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQog
ewogCXN0cnVjdCB2cGZlX2RldmljZSAqdnBmZSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAg
LTE5OTAsNyArMjAwNCw4IEBAIHZwZmVfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB9CiAKIHN0YXRpYyBpbnQKLXZwZmVf
c19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxl
Y3Rpb24gKnMpCit2cGZlX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsK
IAlzdHJ1Y3QgdnBmZV9kZXZpY2UgKnZwZmUgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVj
dCB2NGwyX3JlY3QgY3IgPSB2cGZlLT5jcm9wOwpAQCAtMjAzNiw3ICsyMDUxLDggQEAgdnBmZV9z
X3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVj
dGlvbiAqcykKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGxvbmcgdnBmZV9pb2N0bF9kZWZhdWx0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGxvbmcgdnBmZV9pb2N0bF9k
ZWZhdWx0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJICAgICAgIGJvb2wgdmFsaWRfcHJpbywgdW5zaWduZWQgaW50IGNt
ZCwgdm9pZCAqcGFyYW0pCiB7CiAJc3RydWN0IHZwZmVfZGV2aWNlICp2cGZlID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vdGkvY2FsL2Nh
bC12aWRlby5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9jYWwvY2FsLXZpZGVvLmMKaW5k
ZXggZDQwZTI0YWIxMTI3ODNmODYxY2YwN2JkYzFjZmNjYThkY2Y4NGZkZC4uYjFiYTA4OWJiZTA4
ZWUyZjY3NjIzNzYxODE5NmNhMWUwNzJjMjUwMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9w
bGF0Zm9ybS90aS9jYWwvY2FsLXZpZGVvLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90
aS9jYWwvY2FsLXZpZGVvLmMKQEAgLTMwLDcgKzMwLDggQEAKICAqIC0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICovCiAK
LXN0YXRpYyBpbnQgY2FsX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCBjYWxfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkK
IHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBDQUxfTU9EVUxFX05BTUUsIHNpemVvZihjYXAtPmRy
aXZlcikpOwpAQCAtMzksNyArNDAsOCBAQCBzdGF0aWMgaW50IGNhbF9xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjYWxf
Z19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
Y2FsX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IGNhbF9jdHggKmN0eCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04NCw3ICs4
Niw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY2FsX2Zvcm1hdF9pbmZvICpmaW5kX2Zvcm1hdF9i
eV9jb2RlKHN0cnVjdCBjYWxfY3R4ICpjdHgsCiAJcmV0dXJuIE5VTEw7CiB9CiAKLXN0YXRpYyBp
bnQgY2FsX2xlZ2FjeV9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCBjYWxfbGVnYWN5X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CSAgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCBjYWxfY3R4ICpjdHgg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTc0LDcgKzE3Nyw4IEBAIHN0YXRpYyB2b2lkIGNh
bF9jYWxjX2Zvcm1hdF9zaXplKHN0cnVjdCBjYWxfY3R4ICpjdHgsCiAJCWYtPmZtdC5waXguYnl0
ZXNwZXJsaW5lLCBmLT5mbXQucGl4LnNpemVpbWFnZSk7CiB9CiAKLXN0YXRpYyBpbnQgY2FsX2xl
Z2FjeV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IGNhbF9sZWdhY3lfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY2FsX2N0eCAqY3R4ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTIzNyw3ICsyNDEsOCBAQCBzdGF0aWMgaW50IGNhbF9sZWdhY3lfdHJ5X2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IGNhbF9sZWdhY3lfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY2FsX2xlZ2FjeV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjYWxfY3R4ICpjdHggPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjU1LDcgKzI2MCw3IEBAIHN0YXRpYyBpbnQgY2FsX2xl
Z2FjeV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCQlyZXR1
cm4gLUVCVVNZOwogCX0KIAotCXJldCA9IGNhbF9sZWdhY3lfdHJ5X2ZtdF92aWRfY2FwKGZpbGUs
IHByaXYsIGYpOworCXJldCA9IGNhbF9sZWdhY3lfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRl
LCBmKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMjg5LDcgKzI5NCw4IEBA
IHN0YXRpYyBpbnQgY2FsX2xlZ2FjeV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNhbF9sZWdhY3lfZW51bV9m
cmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY2FsX2xl
Z2FjeV9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZnJtc2l6
ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCBjYWxfY3R4ICpjdHggPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtMzI3LDcgKzMzMyw4IEBAIHN0YXRpYyBpbnQgY2FsX2xlZ2FjeV9lbnVtX2ZyYW1l
c2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IGNhbF9sZWdhY3lfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgY2FsX2xlZ2FjeV9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJf
aW5wdXQgKmlucCkKIHsKIAlpZiAoaW5wLT5pbmRleCA+IDApCkBAIC0zMzgsMTkgKzM0NSwyNCBA
QCBzdGF0aWMgaW50IGNhbF9sZWdhY3lfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjYWxfbGVnYWN5X2dfaW5wdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKK3N0YXRpYyBp
bnQgY2FsX2xlZ2FjeV9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICB1bnNpZ25lZCBpbnQgKmkpCiB7
CiAJKmkgPSAwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNhbF9sZWdhY3lfc19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMg
aW50IGNhbF9sZWdhY3lfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgdW5zaWduZWQgaW50IGkpCiB7
CiAJcmV0dXJuIGkgPiAwID8gLUVJTlZBTCA6IDA7CiB9CiAKIC8qIHRpbWVwZXJmcmFtZSBpcyBh
cmJpdHJhcnkgYW5kIGNvbnRpbnVvdXMgKi8KLXN0YXRpYyBpbnQgY2FsX2xlZ2FjeV9lbnVtX2Zy
YW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBj
YWxfbGVnYWN5X2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZnJt
aXZhbGVudW0gKmZpdmFsKQogewogCXN0cnVjdCBjYWxfY3R4ICpjdHggPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMzc5LDE0ICszOTEsMTggQEAgc3RhdGljIGludCBjYWxfbGVnYWN5X2VudW1f
ZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgY2FsX2xlZ2FjeV9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQorc3RhdGljIGludCBjYWxfbGVnYWN5
X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQkgICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3Ry
dWN0IGNhbF9jdHggKmN0eCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlyZXR1cm4gdjRsMl9n
X3Bhcm1fY2FwKHZpZGVvX2RldmRhdGEoZmlsZSksIGN0eC0+cGh5LT5zb3VyY2UsIGEpOwogfQog
Ci1zdGF0aWMgaW50IGNhbF9sZWdhY3lfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgY2FsX2xlZ2FjeV9zX3Bh
cm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQogewogCXN0cnVjdCBj
YWxfY3R4ICpjdHggPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC00MjUsNyArNDQxLDggQEAg
c3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2lvY3RsX29wcyBjYWxfaW9jdGxfbGVnYWN5X29wcyA9
IHsKICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQogICovCiAKLXN0YXRpYyBpbnQgY2FsX21jX2VudW1fZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCBjYWxfbWNfZW51
bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXVu
c2lnbmVkIGludCBpOwpAQCAtNTA5LDcgKzUyNiw4IEBAIHN0YXRpYyB2b2lkIGNhbF9tY190cnlf
Zm10KHN0cnVjdCBjYWxfY3R4ICpjdHgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZiwKIAkJZm9ybWF0
LT5ieXRlc3BlcmxpbmUsIGZvcm1hdC0+c2l6ZWltYWdlKTsKIH0KIAotc3RhdGljIGludCBjYWxf
bWNfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCBjYWxfbWNfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCiB7CiAJc3RydWN0IGNhbF9jdHggKmN0eCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01
MTgsNyArNTM2LDggQEAgc3RhdGljIGludCBjYWxfbWNfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNhbF9t
Y19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBjYWxfbWNfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IGNhbF9jdHggKmN0eCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01MzcsNyArNTU2
LDggQEAgc3RhdGljIGludCBjYWxfbWNfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjYWxfbWNfZW51bV9mcmFt
ZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY2FsX21jX2Vu
dW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQog
ewogCXN0cnVjdCBjYWxfY3R4ICpjdHggPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9kYXZpbmNpL3ZwaWZfY2FwdHVyZS5jIGIvZHJp
dmVycy9tZWRpYS9wbGF0Zm9ybS90aS9kYXZpbmNpL3ZwaWZfY2FwdHVyZS5jCmluZGV4IGQwNTM5
NzI4ODhkMWI0MzE2MWU5OWEwNGM0Y2E1ZTExNjY0YmY1YjguLjY2MDUzMmUzZjhhYzQ1MjdjMzU2
M2QyMGE4MTI1OGJkYTM1MWFlNGEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0v
dGkvZGF2aW5jaS92cGlmX2NhcHR1cmUuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Rp
L2RhdmluY2kvdnBpZl9jYXB0dXJlLmMKQEAgLTc0MSwxMiArNzQxLDEzIEBAIHN0YXRpYyBpbnQg
dnBpZl9zZXRfaW5wdXQoCiAvKioKICAqIHZwaWZfcXVlcnlzdGQoKSAtIHF1ZXJ5c3RkIGhhbmRs
ZXIKICAqIEBmaWxlOiBmaWxlIHB0cgotICogQHByaXY6IGZpbGUgaGFuZGxlCisgKiBAc3RhdGU6
IHZpZGVvIGRldmljZSBzdGF0ZQogICogQHN0ZF9pZDogcHRyIHRvIHN0ZCBpZAogICoKICAqIFRo
aXMgZnVuY3Rpb24gaXMgY2FsbGVkIHRvIGRldGVjdCBzdGFuZGFyZCBhdCB0aGUgc2VsZWN0ZWQg
aW5wdXQKICAqLwotc3RhdGljIGludCB2cGlmX3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqc3RkX2lkKQorc3RhdGljIGludCB2cGlmX3F1ZXJ5c3Rk
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CSB2NGwyX3N0ZF9pZCAqc3RkX2lkKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2
aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVjdCBjaGFubmVsX29iaiAqY2ggPSB2aWRlb19nZXRf
ZHJ2ZGF0YSh2ZGV2KTsKQEAgLTc3MCwxMCArNzcxLDExIEBAIHN0YXRpYyBpbnQgdnBpZl9xdWVy
eXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKnN0ZF9pZCkK
IC8qKgogICogdnBpZl9nX3N0ZCgpIC0gZ2V0IFNURCBoYW5kbGVyCiAgKiBAZmlsZTogZmlsZSBw
dHIKLSAqIEBwcml2OiBmaWxlIGhhbmRsZQorICogQHN0YXRlOiB2aWRlbyBkZXZpY2Ugc3RhdGUK
ICAqIEBzdGQ6IHB0ciB0byBzdGQgaWQKICAqLwotc3RhdGljIGludCB2cGlmX2dfc3RkKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqc3RkKQorc3RhdGljIGludCB2
cGlmX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgKnN0ZCkKIHsKIAlzdHJ1Y3QgdnBpZl9jYXB0dXJl
X2NvbmZpZyAqY29uZmlnID0gdnBpZl9kZXYtPnBsYXRmb3JtX2RhdGE7CiAJc3RydWN0IHZpZGVv
X2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CkBAIC03OTgsMTAgKzgwMCwxMSBA
QCBzdGF0aWMgaW50IHZwaWZfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0
bDJfc3RkX2lkICpzdGQpCiAvKioKICAqIHZwaWZfc19zdGQoKSAtIHNldCBTVEQgaGFuZGxlcgog
ICogQGZpbGU6IGZpbGUgcHRyCi0gKiBAcHJpdjogZmlsZSBoYW5kbGUKKyAqIEBzdGF0ZTogdmlk
ZW8gZGV2aWNlIHN0YXRlCiAgKiBAc3RkX2lkOiBwdHIgdG8gc3RkIGlkCiAgKi8KLXN0YXRpYyBp
bnQgdnBpZl9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQg
c3RkX2lkKQorc3RhdGljIGludCB2cGlmX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgc3RkX2lkKQog
ewogCXN0cnVjdCB2cGlmX2NhcHR1cmVfY29uZmlnICpjb25maWcgPSB2cGlmX2Rldi0+cGxhdGZv
cm1fZGF0YTsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxl
KTsKQEAgLTg0NiwxMSArODQ5LDExIEBAIHN0YXRpYyBpbnQgdnBpZl9zX3N0ZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgc3RkX2lkKQogLyoqCiAgKiB2cGlmX2Vu
dW1faW5wdXQoKSAtIEVOVU1JTlBVVCBoYW5kbGVyCiAgKiBAZmlsZTogZmlsZSBwdHIKLSAqIEBw
cml2OiBmaWxlIGhhbmRsZQorICogQHN0YXRlOiB2aWRlbyBkZXZpY2Ugc3RhdGUKICAqIEBpbnB1
dDogcHRyIHRvIGlucHV0IHN0cnVjdHVyZQogICovCi1zdGF0aWMgaW50IHZwaWZfZW51bV9pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCQlzdHJ1Y3QgdjRsMl9pbnB1dCAq
aW5wdXQpCitzdGF0aWMgaW50IHZwaWZfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9pbnB1dCAq
aW5wdXQpCiB7CiAKIAlzdHJ1Y3QgdnBpZl9jYXB0dXJlX2NvbmZpZyAqY29uZmlnID0gdnBpZl9k
ZXYtPnBsYXRmb3JtX2RhdGE7CkBAIC04NzEsMTAgKzg3NCwxMSBAQCBzdGF0aWMgaW50IHZwaWZf
ZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIC8qKgogICogdnBpZl9n
X2lucHV0KCkgLSBHZXQgSU5QVVQgaGFuZGxlcgogICogQGZpbGU6IGZpbGUgcHRyCi0gKiBAcHJp
djogZmlsZSBoYW5kbGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNlIHN0YXRlCiAgKiBAaW5kZXg6
IHB0ciB0byBpbnB1dCBpbmRleAogICovCi1zdGF0aWMgaW50IHZwaWZfZ19pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppbmRleCkKK3N0YXRpYyBpbnQg
dnBpZl9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCXVuc2lnbmVkIGludCAqaW5kZXgpCiB7CiAJc3RydWN0IHZpZGVvX2Rldmlj
ZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAJc3RydWN0IGNoYW5uZWxfb2JqICpjaCA9
IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOwpAQCAtODg2LDEwICs4OTAsMTEgQEAgc3RhdGljIGlu
dCB2cGlmX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGlu
dCAqaW5kZXgpCiAvKioKICAqIHZwaWZfc19pbnB1dCgpIC0gU2V0IElOUFVUIGhhbmRsZXIKICAq
IEBmaWxlOiBmaWxlIHB0cgotICogQHByaXY6IGZpbGUgaGFuZGxlCisgKiBAc3RhdGU6IHZpZGVv
IGRldmljZSBzdGF0ZQogICogQGluZGV4OiBpbnB1dCBpbmRleAogICovCi1zdGF0aWMgaW50IHZw
aWZfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGlu
ZGV4KQorc3RhdGljIGludCB2cGlmX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdW5zaWduZWQgaW50IGluZGV4KQogewogCXN0
cnVjdCB2cGlmX2NhcHR1cmVfY29uZmlnICpjb25maWcgPSB2cGlmX2Rldi0+cGxhdGZvcm1fZGF0
YTsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAg
LTkxMSwxMSArOTE2LDEyIEBAIHN0YXRpYyBpbnQgdnBpZl9zX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaW5kZXgpCiAvKioKICAqIHZwaWZfZW51bV9m
bXRfdmlkX2NhcCgpIC0gRU5VTV9GTVQgaGFuZGxlcgogICogQGZpbGU6IGZpbGUgcHRyCi0gKiBA
cHJpdjogZmlsZSBoYW5kbGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNlIHN0YXRlCiAgKiBAZm10
OiBwdHIgdG8gVjRMMiBmb3JtYXQgZGVzY3JpcHRvcgogICovCi1zdGF0aWMgaW50IHZwaWZfZW51
bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCi0JCQkJCXN0cnVj
dCB2NGwyX2ZtdGRlc2MgKmZtdCkKK3N0YXRpYyBpbnQgdnBpZl9lbnVtX2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCQkgc3RydWN0IHY0bDJfZm10ZGVzYyAqZm10KQogewogCXN0cnVjdCB2aWRlb19kZXZpY2Ug
KnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVjdCBjaGFubmVsX29iaiAqY2ggPSB2
aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKQEAgLTkzNiwxMCArOTQyLDExIEBAIHN0YXRpYyBpbnQg
dnBpZl9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIC8q
KgogICogdnBpZl90cnlfZm10X3ZpZF9jYXAoKSAtIFRSWV9GTVQgaGFuZGxlcgogICogQGZpbGU6
IGZpbGUgcHRyCi0gKiBAcHJpdjogZmlsZSBoYW5kbGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNl
IHN0YXRlCiAgKiBAZm10OiBwdHIgdG8gdjRsMiBmb3JtYXQgc3RydWN0dXJlCiAgKi8KLXN0YXRp
YyBpbnQgdnBpZl90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHZwaWZfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1h
dCAqZm10KQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZp
bGUpOwpAQCAtOTczLDExICs5ODAsMTIgQEAgc3RhdGljIGludCB2cGlmX3RyeV9mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIC8qKgogICogdnBpZl9nX2ZtdF92aWRf
Y2FwKCkgLSBTZXQgSU5QVVQgaGFuZGxlcgogICogQGZpbGU6IGZpbGUgcHRyCi0gKiBAcHJpdjog
ZmlsZSBoYW5kbGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNlIHN0YXRlCiAgKiBAZm10OiBwdHIg
dG8gdjRsMiBmb3JtYXQgc3RydWN0dXJlCiAgKi8KLXN0YXRpYyBpbnQgdnBpZl9nX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCXN0cnVjdCB2NGwyX2Zvcm1h
dCAqZm10KQorc3RhdGljIGludCB2cGlmX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2
aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVjdCBjaGFubmVsX29iaiAqY2ggPSB2aWRlb19nZXRf
ZHJ2ZGF0YSh2ZGV2KTsKQEAgLTEwMjksMTEgKzEwMzcsMTIgQEAgc3RhdGljIGludCB2cGlmX2df
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAvKioKICAqIHZwaWZf
c19mbXRfdmlkX2NhcCgpIC0gU2V0IEZNVCBoYW5kbGVyCiAgKiBAZmlsZTogZmlsZSBwdHIKLSAq
IEBwcml2OiBmaWxlIGhhbmRsZQorICogQHN0YXRlOiB2aWRlbyBkZXZpY2Ugc3RhdGUKICAqIEBm
bXQ6IHB0ciB0byB2NGwyIGZvcm1hdCBzdHJ1Y3R1cmUKICAqLwotc3RhdGljIGludCB2cGlmX3Nf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJc3RydWN0IHY0
bDJfZm9ybWF0ICpmbXQpCitzdGF0aWMgaW50IHZwaWZfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
ICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAq
dmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAJc3RydWN0IGNoYW5uZWxfb2JqICpjaCA9IHZp
ZGVvX2dldF9kcnZkYXRhKHZkZXYpOwpAQCAtMTA0NSw3ICsxMDU0LDcgQEAgc3RhdGljIGludCB2
cGlmX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHZi
Ml9pc19idXN5KCZjb21tb24tPmJ1ZmZlcl9xdWV1ZSkpCiAJCXJldHVybiAtRUJVU1k7CiAKLQly
ZXQgPSB2cGlmX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBwcml2LCBmbXQpOworCXJldCA9IHZwaWZf
dHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmbXQpOwogCWlmIChyZXQpCiAJCXJldHVybiBy
ZXQ7CiAKQEAgLTEwNTcsMTEgKzEwNjYsMTEgQEAgc3RhdGljIGludCB2cGlmX3NfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAvKioKICAqIHZwaWZfcXVlcnljYXAo
KSAtIFFVRVJZQ0FQIGhhbmRsZXIKICAqIEBmaWxlOiBmaWxlIHB0cgotICogQHByaXY6IGZpbGUg
aGFuZGxlCisgKiBAc3RhdGU6IHZpZGVvIGRldmljZSBzdGF0ZQogICogQGNhcDogcHRyIHRvIHY0
bDJfY2FwYWJpbGl0eSBzdHJ1Y3R1cmUKICAqLwotc3RhdGljIGludCB2cGlmX3F1ZXJ5Y2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKLQkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5
ICpjYXApCitzdGF0aWMgaW50IHZwaWZfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkg
KmNhcCkKIHsKIAlzdHJ1Y3QgdnBpZl9jYXB0dXJlX2NvbmZpZyAqY29uZmlnID0gdnBpZl9kZXYt
PnBsYXRmb3JtX2RhdGE7CiAKQEAgLTEwNzQsMTEgKzEwODMsMTIgQEAgc3RhdGljIGludCB2cGlm
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIC8qKgogICogdnBpZl9l
bnVtX2R2X3RpbWluZ3MoKSAtIEVOVU1fRFZfVElNSU5HUyBoYW5kbGVyCiAgKiBAZmlsZTogZmls
ZSBwdHIKLSAqIEBwcml2OiBmaWxlIGhhbmRsZQorICogQHN0YXRlOiB2aWRlbyBkZXZpY2Ugc3Rh
dGUKICAqIEB0aW1pbmdzOiBpbnB1dCB0aW1pbmdzCiAgKi8KIHN0YXRpYyBpbnQKLXZwaWZfZW51
bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAordnBpZl9lbnVtX2R2
X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsCisJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCSAgICAgc3RydWN0IHY0bDJfZW51bV9kdl90aW1pbmdzICp0aW1pbmdz
KQogewogCXN0cnVjdCB2cGlmX2NhcHR1cmVfY29uZmlnICpjb25maWcgPSB2cGlmX2Rldi0+cGxh
dGZvcm1fZGF0YTsKQEAgLTExMDgsMTEgKzExMTgsMTIgQEAgdnBpZl9lbnVtX2R2X3RpbWluZ3Mo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAvKioKICAqIHZwaWZfcXVlcnlfZHZfdGlt
aW5ncygpIC0gUVVFUllfRFZfVElNSU5HUyBoYW5kbGVyCiAgKiBAZmlsZTogZmlsZSBwdHIKLSAq
IEBwcml2OiBmaWxlIGhhbmRsZQorICogQHN0YXRlOiB2aWRlbyBkZXZpY2Ugc3RhdGUKICAqIEB0
aW1pbmdzOiBpbnB1dCB0aW1pbmdzCiAgKi8KIHN0YXRpYyBpbnQKLXZwaWZfcXVlcnlfZHZfdGlt
aW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3ZwaWZfcXVlcnlfZHZfdGltaW5n
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCSAgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCiB7CiAJc3Ry
dWN0IHZwaWZfY2FwdHVyZV9jb25maWcgKmNvbmZpZyA9IHZwaWZfZGV2LT5wbGF0Zm9ybV9kYXRh
OwpAQCAtMTE0MCwxMSArMTE1MSwxMiBAQCB2cGlmX3F1ZXJ5X2R2X3RpbWluZ3Moc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAvKioKICAqIHZwaWZfc19kdl90aW1pbmdzKCkgLSBTX0RW
X1RJTUlOR1MgaGFuZGxlcgogICogQGZpbGU6IGZpbGUgcHRyCi0gKiBAcHJpdjogZmlsZSBoYW5k
bGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNlIHN0YXRlCiAgKiBAdGltaW5nczogZGlnaXRhbCB2
aWRlbyB0aW1pbmdzCiAgKi8KLXN0YXRpYyBpbnQgdnBpZl9zX2R2X3RpbWluZ3Moc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3Mp
CitzdGF0aWMgaW50IHZwaWZfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJf
ZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlzdHJ1Y3QgdnBpZl9jYXB0dXJlX2NvbmZpZyAqY29u
ZmlnID0gdnBpZl9kZXYtPnBsYXRmb3JtX2RhdGE7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRl
diA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CkBAIC0xMjM5LDExICsxMjUxLDEyIEBAIHN0YXRpYyBp
bnQgdnBpZl9zX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAvKioK
ICAqIHZwaWZfZ19kdl90aW1pbmdzKCkgLSBHX0RWX1RJTUlOR1MgaGFuZGxlcgogICogQGZpbGU6
IGZpbGUgcHRyCi0gKiBAcHJpdjogZmlsZSBoYW5kbGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNl
IHN0YXRlCiAgKiBAdGltaW5nczogZGlnaXRhbCB2aWRlbyB0aW1pbmdzCiAgKi8KLXN0YXRpYyBp
bnQgdnBpZl9nX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCXN0
cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCitzdGF0aWMgaW50IHZwaWZfZ19kdl90aW1p
bmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlz
dHJ1Y3QgdnBpZl9jYXB0dXJlX2NvbmZpZyAqY29uZmlnID0gdnBpZl9kZXYtPnBsYXRmb3JtX2Rh
dGE7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CkBA
IC0xMjY4LDExICsxMjgxLDEyIEBAIHN0YXRpYyBpbnQgdnBpZl9nX2R2X3RpbWluZ3Moc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAvKgogICogdnBpZl9sb2dfc3RhdHVzKCkgLSBTdGF0
dXMgaW5mb3JtYXRpb24KICAqIEBmaWxlOiBmaWxlIHB0cgotICogQHByaXY6IGZpbGUgaGFuZGxl
CisgKiBAc3RhdGU6IHZpZGVvIGRldmljZSBzdGF0ZQogICoKICAqIFJldHVybnMgemVyby4KICAq
Lwotc3RhdGljIGludCB2cGlmX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGVwLCB2b2lkICpw
cml2KQorc3RhdGljIGludCB2cGlmX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGVwLAorCQkJ
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUpCiB7CiAJLyogc3RhdHVzIGZvciBz
dWIgZGV2aWNlcyAqLwogCXY0bDJfZGV2aWNlX2NhbGxfYWxsKCZ2cGlmX29iai52NGwyX2Rldiwg
MCwgY29yZSwgbG9nX3N0YXR1cyk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L3RpL2RhdmluY2kvdnBpZl9kaXNwbGF5LmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3RpL2Rh
dmluY2kvdnBpZl9kaXNwbGF5LmMKaW5kZXggNzBjODk1NDlmNGI2MWQ3OWJiNzIxNTdlNzIyZTE5
ODRhNGZjYTY4ZS4uZWUzM2E4ZDYwMjllZDRmYTEzMzFhY2E4YzNmOTg4OGUzZjYwM2FmMiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9kYXZpbmNpL3ZwaWZfZGlzcGxheS5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vdGkvZGF2aW5jaS92cGlmX2Rpc3BsYXkuYwpA
QCAtNTc1LDEwICs1NzUsMTEgQEAgc3RhdGljIHZvaWQgdnBpZl9jb25maWdfYWRkcihzdHJ1Y3Qg
Y2hhbm5lbF9vYmogKmNoLCBpbnQgbXV4bW9kZSkKIC8qKgogICogdnBpZl9xdWVyeWNhcCgpIC0g
UVVFUllDQVAgaGFuZGxlcgogICogQGZpbGU6IGZpbGUgcHRyCi0gKiBAcHJpdjogZmlsZSBoYW5k
bGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNlIHN0YXRlCiAgKiBAY2FwOiBwdHIgdG8gdjRsMl9j
YXBhYmlsaXR5IHN0cnVjdHVyZQogICovCi1zdGF0aWMgaW50IHZwaWZfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB2cGlmX3F1ZXJ5Y2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgdnBpZl9kaXNwbGF5X2Nv
bmZpZyAqY29uZmlnID0gdnBpZl9kZXYtPnBsYXRmb3JtX2RhdGE7CkBAIC01ODksNyArNTkwLDgg
QEAgc3RhdGljIGludCB2cGlmX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2cGlmX2VudW1fZm10X3ZpZF9vdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB2cGlmX2VudW1fZm10X3Zp
ZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmbXQpCiB7CiAJaWYgKGZtdC0+aW5k
ZXggIT0gMCkKQEAgLTYwMCw3ICs2MDIsOCBAQCBzdGF0aWMgaW50IHZwaWZfZW51bV9mbXRfdmlk
X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdnBpZl9nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB2cGlmX2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0
YShmaWxlKTsKQEAgLTYxNyw3ICs2MjAsOCBAQCBzdGF0aWMgaW50IHZwaWZfZ19mbXRfdmlkX291
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2cGlmX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdnBpZl90cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0
ICpmbXQpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmls
ZSk7CkBAIC02NDUsNyArNjQ5LDggQEAgc3RhdGljIGludCB2cGlmX3RyeV9mbXRfdmlkX291dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB2cGlmX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZwaWZfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAq
Zm10KQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUp
OwpAQCAtNjU3LDcgKzY2Miw3IEBAIHN0YXRpYyBpbnQgdnBpZl9zX2ZtdF92aWRfb3V0KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCWlmICh2YjJfaXNfYnVzeSgmY29tbW9uLT5idWZm
ZXJfcXVldWUpKQogCQlyZXR1cm4gLUVCVVNZOwogCi0JcmV0ID0gdnBpZl90cnlfZm10X3ZpZF9v
dXQoZmlsZSwgcHJpdiwgZm10KTsKKwlyZXQgPSB2cGlmX3RyeV9mbXRfdmlkX291dChmaWxlLCBz
dGF0ZSwgZm10KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC02NjksNyArNjc0LDgg
QEAgc3RhdGljIGludCB2cGlmX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdnBpZl9zX3N0ZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgc3RkX2lkKQorc3RhdGljIGludCB2cGlm
X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgc3RkX2lkKQogewogCXN0cnVjdCB2cGlmX2Rpc3BsYXlf
Y29uZmlnICpjb25maWcgPSB2cGlmX2Rldi0+cGxhdGZvcm1fZGF0YTsKIAlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTcxNyw3ICs3MjMsOCBAQCBz
dGF0aWMgaW50IHZwaWZfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJf
c3RkX2lkIHN0ZF9pZCkKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZwaWZfZ19zdGQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICpzdGQpCitzdGF0aWMg
aW50IHZwaWZfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkgICAgICB2NGwyX3N0ZF9pZCAqc3RkKQogewogCXN0cnVjdCB2cGlmX2Rp
c3BsYXlfY29uZmlnICpjb25maWcgPSB2cGlmX2Rldi0+cGxhdGZvcm1fZGF0YTsKIAlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTczNyw3ICs3NDQs
OCBAQCBzdGF0aWMgaW50IHZwaWZfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHY0bDJfc3RkX2lkICpzdGQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdnBpZl9lbnVt
X291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHZwaWZfZW51
bV9vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfb3V0cHV0ICpvdXRwdXQpCiB7CiAKQEAgLTgz
Miw3ICs4NDAsOCBAQCBzdGF0aWMgaW50IHZwaWZfc2V0X291dHB1dChzdHJ1Y3QgdnBpZl9kaXNw
bGF5X2NvbmZpZyAqdnBpZl9jZmcsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdnBpZl9z
X291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitz
dGF0aWMgaW50IHZwaWZfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHVuc2lnbmVkIGludCBpKQogewogCXN0cnVjdCB2cGlm
X2Rpc3BsYXlfY29uZmlnICpjb25maWcgPSB2cGlmX2Rldi0+cGxhdGZvcm1fZGF0YTsKIAlzdHJ1
Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTg1MSw3ICs4
NjAsOCBAQCBzdGF0aWMgaW50IHZwaWZfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHVuc2lnbmVkIGludCBpKQogCXJldHVybiB2cGlmX3NldF9vdXRwdXQoY29uZmlnLCBj
aCwgaSk7CiB9CiAKLXN0YXRpYyBpbnQgdnBpZl9nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB2cGlmX2dfb3V0cHV0KHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSB1
bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2Rl
dmRhdGEoZmlsZSk7CiAJc3RydWN0IGNoYW5uZWxfb2JqICpjaCA9IHZpZGVvX2dldF9kcnZkYXRh
KHZkZXYpOwpAQCAtODY0LDExICs4NzQsMTIgQEAgc3RhdGljIGludCB2cGlmX2dfb3V0cHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCiAvKioKICAqIHZw
aWZfZW51bV9kdl90aW1pbmdzKCkgLSBFTlVNX0RWX1RJTUlOR1MgaGFuZGxlcgogICogQGZpbGU6
IGZpbGUgcHRyCi0gKiBAcHJpdjogZmlsZSBoYW5kbGUKKyAqIEBzdGF0ZTogdmlkZW8gZGV2aWNl
IHN0YXRlCiAgKiBAdGltaW5nczogaW5wdXQgdGltaW5ncwogICovCiBzdGF0aWMgaW50Ci12cGlm
X2VudW1fZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3ZwaWZfZW51
bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkgICAgIHN0cnVjdCB2NGwyX2VudW1fZHZfdGltaW5ncyAqdGlt
aW5ncykKIHsKIAlzdHJ1Y3QgdnBpZl9kaXNwbGF5X2NvbmZpZyAqY29uZmlnID0gdnBpZl9kZXYt
PnBsYXRmb3JtX2RhdGE7CkBAIC04OTcsMTEgKzkwOCwxMiBAQCB2cGlmX2VudW1fZHZfdGltaW5n
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIC8qKgogICogdnBpZl9zX2R2X3RpbWlu
Z3MoKSAtIFNfRFZfVElNSU5HUyBoYW5kbGVyCiAgKiBAZmlsZTogZmlsZSBwdHIKLSAqIEBwcml2
OiBmaWxlIGhhbmRsZQorICogQHN0YXRlOiB2aWRlbyBkZXZpY2Ugc3RhdGUKICAqIEB0aW1pbmdz
OiBkaWdpdGFsIHZpZGVvIHRpbWluZ3MKICAqLwotc3RhdGljIGludCB2cGlmX3NfZHZfdGltaW5n
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZHZfdGltaW5n
cyAqdGltaW5ncykKK3N0YXRpYyBpbnQgdnBpZl9zX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICBz
dHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCB2cGlmX2Rpc3BsYXlf
Y29uZmlnICpjb25maWcgPSB2cGlmX2Rldi0+cGxhdGZvcm1fZGF0YTsKIAlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTk5NiwxMSArMTAwOCwxMiBA
QCBzdGF0aWMgaW50IHZwaWZfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogLyoqCiAgKiB2cGlmX2dfZHZfdGltaW5ncygpIC0gR19EVl9USU1JTkdTIGhhbmRsZXIK
ICAqIEBmaWxlOiBmaWxlIHB0cgotICogQHByaXY6IGZpbGUgaGFuZGxlCisgKiBAc3RhdGU6IHZp
ZGVvIGRldmljZSBzdGF0ZQogICogQHRpbWluZ3M6IGRpZ2l0YWwgdmlkZW8gdGltaW5ncwogICov
Ci1zdGF0aWMgaW50IHZwaWZfZ19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAotCQlzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQorc3RhdGljIGludCB2cGlm
X2dfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWlu
Z3MpCiB7CiAJc3RydWN0IHZwaWZfZGlzcGxheV9jb25maWcgKmNvbmZpZyA9IHZwaWZfZGV2LT5w
bGF0Zm9ybV9kYXRhOwogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRh
KGZpbGUpOwpAQCAtMTAyOCwxMSArMTA0MSwxMiBAQCBzdGF0aWMgaW50IHZwaWZfZ19kdl90aW1p
bmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogLyoKICAqIHZwaWZfbG9nX3N0YXR1
cygpIC0gU3RhdHVzIGluZm9ybWF0aW9uCiAgKiBAZmlsZTogZmlsZSBwdHIKLSAqIEBwcml2OiBm
aWxlIGhhbmRsZQorICogQHN0YXRlOiB2aWRlbyBkZXZpY2Ugc3RhdGUKICAqCiAgKiBSZXR1cm5z
IHplcm8uCiAgKi8KLXN0YXRpYyBpbnQgdnBpZl9sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpmaWxl
cCwgdm9pZCAqcHJpdikKK3N0YXRpYyBpbnQgdnBpZl9sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpm
aWxlcCwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlKQogewogCS8qIHN0
YXR1cyBmb3Igc3ViIGRldmljZXMgKi8KIAl2NGwyX2RldmljZV9jYWxsX2FsbCgmdnBpZl9vYmou
djRsMl9kZXYsIDAsIGNvcmUsIGxvZ19zdGF0dXMpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS90aS9qNzIxZS1jc2kycngvajcyMWUtY3NpMnJ4LmMgYi9kcml2ZXJzL21lZGlh
L3BsYXRmb3JtL3RpL2o3MjFlLWNzaTJyeC9qNzIxZS1jc2kycnguYwppbmRleCBiNzVhYTM2M2Qx
YmYyNWY4YzMxYjQwM2MzYWVkZTBiMzEzMzNjNTZiLi5hYzlhODdlZTA2YjEwOTA0NTY1MDhjODc4
OTNhYzBhMjY1YzkzYWU5IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3RpL2o3
MjFlLWNzaTJyeC9qNzIxZS1jc2kycnguYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Rp
L2o3MjFlLWNzaTJyeC9qNzIxZS1jc2kycnguYwpAQCAtMjY5LDcgKzI2OSw4IEBAIHN0YXRpYyB2
b2lkIHRpX2NzaTJyeF9maWxsX2ZtdChjb25zdCBzdHJ1Y3QgdGlfY3NpMnJ4X2ZtdCAqY3NpX2Zt
dCwKIAlwaXgtPnNpemVpbWFnZSA9IHBpeC0+Ynl0ZXNwZXJsaW5lICogcGl4LT5oZWlnaHQ7CiB9
CiAKLXN0YXRpYyBpbnQgdGlfY3NpMnJ4X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB0aV9jc2kycnhfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0
cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBUSV9D
U0kyUlhfTU9EVUxFX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMjc4LDcgKzI3OSw4
IEBAIHN0YXRpYyBpbnQgdGlfY3NpMnJ4X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRpX2NzaTJyeF9lbnVtX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0aV9jc2ky
cnhfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNj
ICpmKQogewogCWNvbnN0IHN0cnVjdCB0aV9jc2kycnhfZm10ICpmbXQgPSBOVUxMOwpAQCAtMzA2
LDcgKzMwOCw4IEBAIHN0YXRpYyBpbnQgdGlfY3NpMnJ4X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdGlf
Y3NpMnJ4X2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHRpX2NzaTJyeF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgdGlfY3NpMnJ4X2RldiAqY3NpID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKQEAgLTMxNiw3ICszMTksOCBAQCBzdGF0aWMgaW50IHRpX2NzaTJyeF9nX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IHRpX2NzaTJyeF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHRpX2NzaTJyeF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
ICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAljb25zdCBzdHJ1Y3QgdGlfY3NpMnJ4X2Zt
dCAqZm10OwpAQCAtMzM3LDcgKzM0MSw4IEBAIHN0YXRpYyBpbnQgdGlfY3NpMnJ4X3RyeV9mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB0aV9jc2kycnhfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgdGlfY3NpMnJ4X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB0aV9jc2kycnhfZGV2ICpjc2kgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzQ3LDcgKzM1Miw3IEBAIHN0YXRpYyBpbnQgdGlfY3Np
MnJ4X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHZi
Ml9pc19idXN5KHEpKQogCQlyZXR1cm4gLUVCVVNZOwogCi0JcmV0ID0gdGlfY3NpMnJ4X3RyeV9m
bXRfdmlkX2NhcChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSB0aV9jc2kycnhfdHJ5X2ZtdF92aWRf
Y2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAt
MzU2LDcgKzM2MSw4IEBAIHN0YXRpYyBpbnQgdGlfY3NpMnJ4X3NfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdGlf
Y3NpMnJ4X2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0
aWMgaW50IHRpX2NzaTJyeF9lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2
NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKIHsKIAljb25zdCBzdHJ1Y3QgdGlfY3NpMnJ4X2ZtdCAq
Zm10OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9vbWFwL29tYXBfdm91
dC5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9vbWFwL29tYXBfdm91dC5jCmluZGV4IDIy
NzgyZTlmMWY0ZTY5ZGQxMGUwMTcyZWMyNWYxYzIwM2NhZWY5M2QuLmZmZWE0OTllZmFjOGZkM2Uy
NzFhMjE5YTZlYzk4N2Y5MzRmOGVmOWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZv
cm0vdGkvb21hcC9vbWFwX3ZvdXQuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3RpL29t
YXAvb21hcF92b3V0LmMKQEAgLTU2OCw4ICs1NjgsOCBAQCBzdGF0aWMgdm9pZCBvbWFwX3ZvdXRf
aXNyKHZvaWQgKmFyZywgdW5zaWduZWQgaW50IGlycXN0YXR1cykKIC8qCiAgKiBWNEwyIGlvY3Rs
cwogICovCi1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCi0JCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKK3N0YXRpYyBpbnQgdmlkaW9j
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3Qgb21h
cF92b3V0X2RldmljZSAqdm91dCA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTU4MCw3ICs1
ODAsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9v
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2aWRpb2NfZW51bV9m
bXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmZtdCkKIHsKIAlpbnQgaW5k
ZXggPSBmbXQtPmluZGV4OwpAQCAtNTk0LDcgKzU5NSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG9tYXBfdm91dF9kZXZpY2UgKnZvdXQgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtNjA0LDcgKzYwNiw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfZm10
X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0
aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3Qgb21hcF9vdmVybGF5ICpvdmw7CkBAIC02MzAsNyArNjMzLDggQEAgc3Rh
dGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX291dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfb3V0
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCWludCByZXQsIGJwcDsKQEAgLTY5Niw3
ICs3MDAsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlf
Zm10X3ZpZF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
dmlkaW9jX3RyeV9mbXRfdmlkX292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCiB7CiAJaW50IHJldCA9IDA7CkBAIC03MTYsNyArNzIxLDggQEAgc3RhdGljIGludCB2aWRp
b2NfdHJ5X2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0
dXJuIHJldDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX292ZXJsYXkoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX292ZXJs
YXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCWludCByZXQgPSAwOwpAQCAt
NzYzLDcgKzc2OSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9vdmVybGF5KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY19nX2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0
aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCiB7CiAJc3RydWN0IG9tYXBfb3ZlcmxheSAqb3ZsOwpAQCAtNzg3LDcgKzc5NCw5IEBA
IHN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19zZWxlY3Rpb24o
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkK
K3N0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1Y3QgdjRs
Ml9zZWxlY3Rpb24gKnNlbCkKIHsKIAlzdHJ1Y3Qgb21hcF92b3V0X2RldmljZSAqdm91dCA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdCAqcGl4ID0gJnZvdXQt
PnBpeDsKQEAgLTgxMyw3ICs4MjIsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbgogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQorc3RhdGljIGludCB2aWRp
b2Nfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2Vs
KQogewogCWludCByZXQgPSAtRUlOVkFMOwogCXN0cnVjdCBvbWFwX3ZvdXRfZGV2aWNlICp2b3V0
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTExMTUsNyArMTEyNiw4IEBAIHN0YXRpYyB2b2lk
IG9tYXBfdm91dF92YjJfc3RvcF9zdHJlYW1pbmcoc3RydWN0IHZiMl9xdWV1ZSAqdnEpCiAJfQog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LAorc3RhdGljIGludCB2aWRpb2Nfc19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwyX2ZyYW1l
YnVmZmVyICphKQogewogCWludCBlbmFibGUgPSAwOwpAQCAtMTE4Nyw4ICsxMTk5LDggQEAgc3Rh
dGljIGludCB2aWRpb2Nfc19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKLQkJc3RydWN0IHY0bDJfZnJhbWVidWZmZXIgKmEpCitzdGF0aWMgaW50IHZpZGlv
Y19nX2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2ZyYW1lYnVmZmVyICphKQogewogCXN0cnVjdCBvbWFwX292
ZXJsYXkgKm92bDsKIAlzdHJ1Y3Qgb21hcHZpZGVvX2luZm8gKm92aWQ7CkBAIC0xMjM2LDcgKzEy
NDgsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX291dHB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fb3V0cHV0
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9vdXRwdXQgKm91dCkKIHsKIAlpZiAob3V0LT5p
bmRleCkKQEAgLTEyNDYsMTMgKzEyNTksMTUgQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9vdXRw
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX2dfb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNp
Z25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHZpZGlvY19nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCB1bnNpZ25lZCBpbnQg
KmkpCiB7CiAJKmkgPSAwOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX291
dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0
aWMgaW50IHZpZGlvY19zX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCB1bnNpZ25lZCBpbnQgaSkKIHsKIAlyZXR1cm4gaSA/
IC1FSU5WQUwgOiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9v
bWFwM2lzcC9pc3B2aWRlby5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS90aS9vbWFwM2lzcC9p
c3B2aWRlby5jCmluZGV4IDBlN2YwYmYyYjM0NjNiN2VmNjY3OGY3YmQ4MzZhOTUyZTBiNzA3YTcu
LjVhOGM2NDM5OTczOGNiMjlhMTkzOWNiOTk3NGQ1OGI3NWI2NGJmMWIgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvbWVkaWEvcGxhdGZvcm0vdGkvb21hcDNpc3AvaXNwdmlkZW8uYworKysgYi9kcml2ZXJz
L21lZGlhL3BsYXRmb3JtL3RpL29tYXAzaXNwL2lzcHZpZGVvLmMKQEAgLTYzOSw3ICs2MzksOCBA
QCB2b2lkIG9tYXAzaXNwX3ZpZGVvX3Jlc3VtZShzdHJ1Y3QgaXNwX3ZpZGVvICp2aWRlbywgaW50
IGNvbnRpbnVvdXMpCiAgKi8KIAogc3RhdGljIGludAotaXNwX3ZpZGVvX3F1ZXJ5Y2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQoraXNw
X3ZpZGVvX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVj
dCBpc3BfdmlkZW8gKnZpZGVvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtNjU1LDcgKzY1
Niw4IEBAIGlzcF92aWRlb19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0
cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIH0KIAogc3RhdGljIGludAotaXNwX3ZpZGVvX2dl
dF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmZvcm1hdCkKK2lzcF92aWRlb19nZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZv
cm1hdCkKIHsKIAlzdHJ1Y3QgaXNwX3ZpZGVvX2ZoICp2ZmggPSBmaWxlX3RvX2lzcF92aWRlb19m
aChmaWxlKTsKIAlzdHJ1Y3QgaXNwX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC02NzEsNyArNjczLDggQEAgaXNwX3ZpZGVvX2dldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIH0KIAogc3RhdGljIGlu
dAotaXNwX3ZpZGVvX3NldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKK2lzcF92aWRlb19zZXRfZm9ybWF0KHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmZvcm1hdCkKIHsKIAlzdHJ1Y3QgaXNwX3ZpZGVvX2ZoICp2ZmggPSBmaWxl
X3RvX2lzcF92aWRlb19maChmaWxlKTsKIAlzdHJ1Y3QgaXNwX3ZpZGVvICp2aWRlbyA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC03MjksNyArNzMyLDggQEAgaXNwX3ZpZGVvX3NldF9mb3JtYXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkK
IH0KIAogc3RhdGljIGludAotaXNwX3ZpZGVvX3RyeV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKK2lzcF92aWRlb190cnlfZm9y
bWF0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIHsKIAlzdHJ1Y3QgaXNwX3ZpZGVv
ICp2aWRlbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0bDJfc3ViZGV2X2Zvcm1h
dCBmbXQgPSB7CkBAIC03NTgsNyArNzYyLDggQEAgaXNwX3ZpZGVvX3RyeV9mb3JtYXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIH0KIAog
c3RhdGljIGludAotaXNwX3ZpZGVvX2dldF9zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKK2lzcF92aWRlb19nZXRfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCXN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQogewogCXN0cnVjdCBpc3BfdmlkZW8gKnZp
ZGVvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9zdWJkZXZfZm9ybWF0IGZv
cm1hdCA9IHsKQEAgLTgxNiw3ICs4MjEsOCBAQCBpc3BfdmlkZW9fZ2V0X3NlbGVjdGlvbihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQogfQog
CiBzdGF0aWMgaW50Ci1pc3BfdmlkZW9fc2V0X3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqc2VsKQoraXNwX3ZpZGVvX3NldF9zZWxl
Y3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0IGlzcF92aWRlbyAq
dmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2NGwyX3N1YmRldiAqc3ViZGV2
OwpAQCAtODU2LDcgKzg2Miw4IEBAIGlzcF92aWRlb19zZXRfc2VsZWN0aW9uKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB9CiAKIHN0YXRp
YyBpbnQKLWlzcF92aWRlb19nZXRfcGFyYW0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQoraXNwX3ZpZGVvX2dldF9wYXJhbShzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICBzdHJ1Y3Qg
djRsMl9zdHJlYW1wYXJtICphKQogewogCXN0cnVjdCBpc3BfdmlkZW9fZmggKnZmaCA9IGZpbGVf
dG9faXNwX3ZpZGVvX2ZoKGZpbGUpOwogCXN0cnVjdCBpc3BfdmlkZW8gKnZpZGVvID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTg3NCw3ICs4ODEsOCBAQCBpc3BfdmlkZW9fZ2V0X3BhcmFtKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIH0K
IAogc3RhdGljIGludAotaXNwX3ZpZGVvX3NldF9wYXJhbShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCitpc3BfdmlkZW9fc2V0X3BhcmFtKHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAg
IHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IGlzcF92aWRlb19maCAqdmZo
ID0gZmlsZV90b19pc3BfdmlkZW9fZmgoZmlsZSk7CiAJc3RydWN0IGlzcF92aWRlbyAqdmlkZW8g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODkyLDcgKzkwMCw4IEBAIGlzcF92aWRlb19zZXRf
cGFyYW0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJt
ICphKQogfQogCiBzdGF0aWMgaW50Ci1pc3BfdmlkZW9fcmVxYnVmcyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3JlcXVlc3RidWZmZXJzICpyYikKK2lzcF92aWRlb19y
ZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJICBzdHJ1Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAqcmIpCiB7CiAJc3RydWN0IGlzcF92
aWRlb19maCAqdmZoID0gZmlsZV90b19pc3BfdmlkZW9fZmgoZmlsZSk7CiAJc3RydWN0IGlzcF92
aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTA2LDcgKzkxNSw4IEBAIGlz
cF92aWRlb19yZXFidWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
cmVxdWVzdGJ1ZmZlcnMgKnJiKQogfQogCiBzdGF0aWMgaW50Ci1pc3BfdmlkZW9fcXVlcnlidWYo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmIpCitpc3Bf
dmlkZW9fcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkgICBzdHJ1Y3QgdjRsMl9idWZmZXIgKmIpCiB7CiAJc3RydWN0IGlzcF92
aWRlb19maCAqdmZoID0gZmlsZV90b19pc3BfdmlkZW9fZmgoZmlsZSk7CiAJc3RydWN0IGlzcF92
aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTIwLDcgKzkzMCw4IEBAIGlz
cF92aWRlb19xdWVyeWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2J1ZmZlciAqYikKIH0KIAogc3RhdGljIGludAotaXNwX3ZpZGVvX3FidWYoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmIpCitpc3BfdmlkZW9fcWJ1Zihz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJICAg
ICAgIHN0cnVjdCB2NGwyX2J1ZmZlciAqYikKIHsKIAlzdHJ1Y3QgaXNwX3ZpZGVvX2ZoICp2Zmgg
PSBmaWxlX3RvX2lzcF92aWRlb19maChmaWxlKTsKIAlzdHJ1Y3QgaXNwX3ZpZGVvICp2aWRlbyA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05MzQsNyArOTQ1LDggQEAgaXNwX3ZpZGVvX3FidWYo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmIpCiB9CiAK
IHN0YXRpYyBpbnQKLWlzcF92aWRlb19kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IHN0cnVjdCB2NGwyX2J1ZmZlciAqYikKK2lzcF92aWRlb19kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmls
ZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCXN0cnVjdCB2NGwyX2J1ZmZl
ciAqYikKIHsKIAlzdHJ1Y3QgaXNwX3ZpZGVvX2ZoICp2ZmggPSBmaWxlX3RvX2lzcF92aWRlb19m
aChmaWxlKTsKIAlzdHJ1Y3QgaXNwX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC0xMDcyLDcgKzEwODQsOCBAQCBzdGF0aWMgaW50IGlzcF92aWRlb19jaGVja19leHRlcm5h
bF9zdWJkZXZzKHN0cnVjdCBpc3BfdmlkZW8gKnZpZGVvLAogICogbm90IHNsZWVwLgogICovCiBz
dGF0aWMgaW50Ci1pc3BfdmlkZW9fc3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBlbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKK2lzcF92aWRlb19zdHJlYW1vbihzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqdnN0YXRlLAorCQkgICBlbnVtIHY0
bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgaXNwX3ZpZGVvX2ZoICp2ZmggPSBmaWxlX3Rv
X2lzcF92aWRlb19maChmaWxlKTsKIAlzdHJ1Y3QgaXNwX3ZpZGVvICp2aWRlbyA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC0xMTc4LDcgKzExOTEsOCBAQCBpc3BfdmlkZW9fc3RyZWFtb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBlbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkKIH0KIAog
c3RhdGljIGludAotaXNwX3ZpZGVvX3N0cmVhbW9mZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQoraXNwX3ZpZGVvX3N0cmVhbW9mZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqdnN0YXRlLAorCQkgICAgZW51
bSB2NGwyX2J1Zl90eXBlIHR5cGUpCiB7CiAJc3RydWN0IGlzcF92aWRlb19maCAqdmZoID0gZmls
ZV90b19pc3BfdmlkZW9fZmgoZmlsZSk7CiAJc3RydWN0IGlzcF92aWRlbyAqdmlkZW8gPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtMTIzMyw3ICsxMjQ3LDggQEAgaXNwX3ZpZGVvX3N0cmVhbW9m
ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQog
fQogCiBzdGF0aWMgaW50Ci1pc3BfdmlkZW9fZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX2lucHV0ICppbnB1dCkKK2lzcF92aWRlb19lbnVtX2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
ICAgICBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wdXQpCiB7CiAJaWYgKGlucHV0LT5pbmRleCA+IDAp
CiAJCXJldHVybiAtRUlOVkFMOwpAQCAtMTI0NSw3ICsxMjYwLDggQEAgaXNwX3ZpZGVvX2VudW1f
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5w
dXQpCiB9CiAKIHN0YXRpYyBpbnQKLWlzcF92aWRlb19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgdW5zaWduZWQgaW50ICppbnB1dCkKK2lzcF92aWRlb19nX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICB1bnNp
Z25lZCBpbnQgKmlucHV0KQogewogCSppbnB1dCA9IDA7CiAKQEAgLTEyNTMsNyArMTI2OSw4IEBA
IGlzcF92aWRlb19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQg
aW50ICppbnB1dCkKIH0KIAogc3RhdGljIGludAotaXNwX3ZpZGVvX3NfaW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgaW5wdXQpCitpc3BfdmlkZW9fc19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CSAgdW5zaWduZWQgaW50IGlucHV0KQogewogCXJldHVybiBpbnB1dCA9PSAwID8gMCA6IC1FSU5W
QUw7CiB9CkBAIC0xMzUxLDcgKzEzNjgsNyBAQCBzdGF0aWMgaW50IGlzcF92aWRlb19yZWxlYXNl
KHN0cnVjdCBmaWxlICpmaWxlKQogCXN0cnVjdCBpc3BfdmlkZW9fZmggKmhhbmRsZSA9IGZpbGVf
dG9faXNwX3ZpZGVvX2ZoKGZpbGUpOwogCiAJLyogRGlzYWJsZSBzdHJlYW1pbmcgYW5kIGZyZWUg
dGhlIGJ1ZmZlcnMgcXVldWUgcmVzb3VyY2VzLiAqLwotCWlzcF92aWRlb19zdHJlYW1vZmYoZmls
ZSwgdmZoLCB2aWRlby0+dHlwZSk7CisJaXNwX3ZpZGVvX3N0cmVhbW9mZihmaWxlLCB2ZmgtPnN0
YXRlLCB2aWRlby0+dHlwZSk7CiAKIAltdXRleF9sb2NrKCZ2aWRlby0+cXVldWVfbG9jayk7CiAJ
dmIyX3F1ZXVlX3JlbGVhc2UoJmhhbmRsZS0+cXVldWUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wbGF0Zm9ybS90aS92cGUvdnBlLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3RpL3Zw
ZS92cGUuYwppbmRleCA2MDI5ZDRlOGUwYmQzNGQ2MGYxYWRkYjkxYTUxYmY1ZmQwNzA5MzQxLi41
ZjE4NjVlY2JiMjY2ZTRiZWI0ZjBmN2JhMWE1YjQyNWMyNzAzMDEyIDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3BsYXRmb3JtL3RpL3ZwZS92cGUuYworKysgYi9kcml2ZXJzL21lZGlhL3BsYXRm
b3JtL3RpL3ZwZS92cGUuYwpAQCAtMTUyMSw3ICsxNTIxLDggQEAgc3RhdGljIGlycXJldHVybl90
IHZwZV9pcnEoaW50IGlycV92cGUsIHZvaWQgKmRhdGEpCiAvKgogICogdmlkZW8gaW9jdGxzCiAg
Ki8KLXN0YXRpYyBpbnQgdnBlX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB2cGVfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNh
cCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBWUEVfTU9EVUxFX05BTUUsIHNpemVvZihjYXAt
PmRyaXZlcikpOwpAQCAtMTU1NCw3ICsxNTU1LDggQEAgc3RhdGljIGludCBfX2VudW1fZm10KHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYsIHUzMiB0eXBlKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZwZV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdnBlX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlpZiAoVjRM
Ml9UWVBFX0lTX09VVFBVVChmLT50eXBlKSkKQEAgLTE1NjMsNyArMTU2NSw4IEBAIHN0YXRpYyBp
bnQgdnBlX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBf
X2VudW1fZm10KGYsIFZQRV9GTVRfVFlQRV9DQVBUVVJFKTsKIH0KIAotc3RhdGljIGludCB2cGVf
Z19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKK3N0YXRpYyBpbnQgdnBlX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeCA9ICZmLT5mbXQucGl4X21wOwogCXN0
cnVjdCB2cGVfY3R4ICpjdHggPSB0b192cGVfY3R4KGZpbGUpOwpAQCAtMTcyMSw3ICsxNzI0LDgg
QEAgc3RhdGljIGludCBfX3ZwZV90cnlfZm10KHN0cnVjdCB2cGVfY3R4ICpjdHgsIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2cGVfdHJ5X2ZtdChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3Rh
dGljIGludCB2cGVfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHZwZV9jdHggKmN0eCA9IHRvX3ZwZV9jdHgoZmlsZSk7CiAJc3RydWN0IHZwZV9mbXQgKmZt
dCA9IGZpbmRfZm9ybWF0KGYpOwpAQCAtMTc4NCwxMiArMTc4OCwxMyBAQCBzdGF0aWMgaW50IF9f
dnBlX3NfZm10KHN0cnVjdCB2cGVfY3R4ICpjdHgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2cGVfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdnBlX3NfZm10KHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAg
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJaW50IHJldDsKIAlzdHJ1Y3QgdnBlX2N0eCAq
Y3R4ID0gdG9fdnBlX2N0eChmaWxlKTsKIAotCXJldCA9IHZwZV90cnlfZm10KGZpbGUsIHByaXYs
IGYpOworCXJldCA9IHZwZV90cnlfZm10KGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0KQogCQly
ZXR1cm4gcmV0OwogCkBAIC0xODcyLDggKzE4NzcsOCBAQCBzdGF0aWMgaW50IF9fdnBlX3RyeV9z
ZWxlY3Rpb24oc3RydWN0IHZwZV9jdHggKmN0eCwgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZwZV9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCi0JCXN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK3N0YXRpYyBpbnQg
dnBlX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKIHsKIAlzdHJ1Y3Qg
dnBlX2N0eCAqY3R4ID0gdG9fdnBlX2N0eChmaWxlKTsKIAlzdHJ1Y3QgdnBlX3FfZGF0YSAqcV9k
YXRhOwpAQCAtMTkzNiw4ICsxOTQxLDggQEAgc3RhdGljIGludCB2cGVfZ19zZWxlY3Rpb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogfQogCiAKLXN0YXRpYyBpbnQgdnBlX3Nfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKLQkJc3RydWN0IHY0bDJfc2VsZWN0aW9u
ICpzKQorc3RhdGljIGludCB2cGVfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJfc2VsZWN0aW9u
ICpzKQogewogCXN0cnVjdCB2cGVfY3R4ICpjdHggPSB0b192cGVfY3R4KGZpbGUpOwogCXN0cnVj
dCB2cGVfcV9kYXRhICpxX2RhdGE7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BsYXRmb3Jt
L3ZlcmlzaWxpY29uL2hhbnRyb192NGwyLmMgYi9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Zlcmlz
aWxpY29uL2hhbnRyb192NGwyLmMKaW5kZXggZmNmM2JkOWJjZGEyZDAyNDgxZmE3ZTFmMjBlNmI3
Y2E1NGQ2ZDc4Ni4uYWNhYWZkNjI4YmQyMzVjMGJjMjIzOGI4MjhkNTg5Y2E5YjliMjczMSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS92ZXJpc2lsaWNvbi9oYW50cm9fdjRsMi5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vdmVyaXNpbGljb24vaGFudHJvX3Y0bDIuYwpA
QCAtMTcxLDcgKzE3MSw4IEBAIGhhbnRyb19nZXRfZGVmYXVsdF9mbXQoY29uc3Qgc3RydWN0IGhh
bnRyb19jdHggKmN0eCwgYm9vbCBiaXRzdHJlYW0sCiAJcmV0dXJuIE5VTEw7CiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkg
KmNhcCkKIHsKIAlzdHJ1Y3QgaGFudHJvX2RldiAqdnB1ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTE4Miw3ICsxODMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
ZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51
bSAqZnNpemUpCiB7CiAJc3RydWN0IGhhbnRyb19jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUp
OwpAQCAtMjgxLDE5ICsyODMsMjIgQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBp
bnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmYpCiB7Ci0JcmV0dXJuIHZpZGlvY19lbnVtX2ZtdChmaWxlLCBwcml2LCBm
LCB0cnVlKTsKKwlyZXR1cm4gdmlkaW9jX2VudW1fZm10KGZpbGUsIHN0YXRlLCBmLCB0cnVlKTsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9vdXQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKLQlyZXR1cm4gdmlkaW9jX2VudW1fZm10
KGZpbGUsIHByaXYsIGYsIGZhbHNlKTsKKwlyZXR1cm4gdmlkaW9jX2VudW1fZm10KGZpbGUsIHN0
YXRlLCBmLCBmYWxzZSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X291dF9tcGxhbmUo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF9v
dXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
djRsMl9waXhfZm9ybWF0X21wbGFuZSAqcGl4X21wID0gJmYtPmZtdC5waXhfbXA7CkBAIC0zMDYs
NyArMzExLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXRfb3V0X21wbGFuZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
Z19mbXRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX2dfZm10X2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBsYW5lICpwaXhfbXAgPSAmZi0+Zm10
LnBpeF9tcDsKQEAgLTM5NSwxMyArNDAxLDE1IEBAIHN0YXRpYyBpbnQgaGFudHJvX3RyeV9mbXQo
Y29uc3Qgc3RydWN0IGhhbnRyb19jdHggKmN0eCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2NfdHJ5X2ZtdF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJcmV0dXJuIGhhbnRyb190cnlfZm10KGZpbGVfdG9f
Y3R4KGZpbGUpLCAmZi0+Zm10LnBpeF9tcCwgZi0+dHlwZSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX3RyeV9mbXRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXJldHVybiBoYW50cm9fdHJ5X2ZtdChmaWxlX3RvX2N0eChm
aWxlKSwgJmYtPmZtdC5waXhfbXAsIGYtPnR5cGUpOwpAQCAtNjQ2LDE4ICs2NTQsMjEgQEAgc3Rh
dGljIGludCBoYW50cm9fc2V0X2ZtdF9jYXAoc3RydWN0IGhhbnRyb19jdHggKmN0eCwKIH0KIAog
c3RhdGljIGludAotdmlkaW9jX3NfZm10X291dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3ZpZGlvY19zX2ZtdF9vdXRfbXBsYW5l
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlyZXR1cm4gaGFudHJvX3NldF9mbXRfb3V0KGZp
bGVfdG9fY3R4KGZpbGUpLCAmZi0+Zm10LnBpeF9tcCwgSEFOVFJPX0FVVE9fUE9TVFBST0MpOwog
fQogCiBzdGF0aWMgaW50Ci12aWRpb2Nfc19mbXRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQordmlkaW9jX3NfZm10X2NhcF9t
cGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXJldHVybiBoYW50cm9fc2V0X2ZtdF9j
YXAoZmlsZV90b19jdHgoZmlsZSksICZmLT5mbXQucGl4X21wKTsKIH0KIAotc3RhdGljIGludCB2
aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0
aW9uICpzZWwpCiB7CiAJc3RydWN0IGhhbnRyb19jdHggKmN0eCA9IGZpbGVfdG9fY3R4KGZpbGUp
OwpAQCAtNjg3LDcgKzY5OCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rp
b24gKnNlbCkKIHsKIAlzdHJ1Y3QgaGFudHJvX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7
CkBAIC03MzMsMTMgKzc0NSwxNCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZXZlbnQgaGFu
dHJvX2Vvc19ldmVudCA9IHsKIAkudHlwZSA9IFY0TDJfRVZFTlRfRU9TCiB9OwogCi1zdGF0aWMg
aW50IHZpZGlvY19lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX2VuY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9l
bmNvZGVyX2NtZCAqZWMpCiB7CiAJc3RydWN0IGhhbnRyb19jdHggKmN0eCA9IGZpbGVfdG9fY3R4
KGZpbGUpOwogCWludCByZXQ7CiAKLQlyZXQgPSB2NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rlcl9j
bWQoZmlsZSwgcHJpdiwgZWMpOworCXJldCA9IHY0bDJfbTJtX2lvY3RsX3RyeV9lbmNvZGVyX2Nt
ZChmaWxlLCBzdGF0ZSwgZWMpOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4gcmV0OwogCkBAIC03
NDcsNyArNzYwLDcgQEAgc3RhdGljIGludCB2aWRpb2NfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJICAgICF2YjJfaXNfc3RyZWFtaW5nKHY0bDJfbTJtX2dldF9k
c3RfdnEoY3R4LT5maC5tMm1fY3R4KSkpCiAJCXJldHVybiAwOwogCi0JcmV0ID0gdjRsMl9tMm1f
aW9jdGxfZW5jb2Rlcl9jbWQoZmlsZSwgcHJpdiwgZWMpOworCXJldCA9IHY0bDJfbTJtX2lvY3Rs
X2VuY29kZXJfY21kKGZpbGUsIHN0YXRlLCBlYyk7CiAJaWYgKHJldCA8IDApCiAJCXJldHVybiBy
ZXQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vdmlhL3ZpYS1jYW1lcmEu
YyBiL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0vdmlhL3ZpYS1jYW1lcmEuYwppbmRleCA1NzAyZWZm
NjY0ZDRlZjY1MmIyMmFhZWFhYWNiYmQwZTE2YTJlMTM3Li5jY2FhMTcyNjllNjk1NmQ0MDVlYTJk
YjIzNTllNGFjOGFkZjliZDc2IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BsYXRmb3JtL3Zp
YS92aWEtY2FtZXJhLmMKKysrIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS92aWEvdmlhLWNhbWVy
YS5jCkBAIC03MzYsOCArNzM2LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVfb3Bl
cmF0aW9ucyB2aWFjYW1fZm9wcyA9IHsKIC8qCiAgKiBPbmx5IG9uZSBpbnB1dC4KICAqLwotc3Rh
dGljIGludCB2aWFjYW1fZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwK
LQkJc3RydWN0IHY0bDJfaW5wdXQgKmlucHV0KQorc3RhdGljIGludCB2aWFjYW1fZW51bV9pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsIHN0cnVjdCB2NGwyX2lucHV0ICppbnB1dCkKIHsKIAlpZiAoaW5wdXQtPmluZGV4ICE9
IDApCiAJCXJldHVybiAtRUlOVkFMOwpAQCAtNzQ3LDEzICs3NDcsMTUgQEAgc3RhdGljIGludCB2
aWFjYW1fZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWFjYW1fZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9p
ZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB2aWFjYW1fZ19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlscCwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVu
c2lnbmVkIGludCAqaSkKIHsKIAkqaSA9IDA7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlhY2FtX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGlu
dCBpKQorc3RhdGljIGludCB2aWFjYW1fc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCBpKQogewogCWlm
IChpICE9IDApCiAJCXJldHVybiAtRUlOVkFMOwpAQCAtNzc2LDggKzc3OCw4IEBAIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0IHZpYWNhbV9kZWZfcGl4X2Zvcm1hdCA9IHsKIAog
c3RhdGljIGNvbnN0IHUzMiB2aWFfZGVmX21idXNfY29kZSA9IE1FRElBX0JVU19GTVRfWVVZVjhf
Mlg4OwogCi1zdGF0aWMgaW50IHZpYWNhbV9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxwLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmbXQpCitzdGF0aWMgaW50
IHZpYWNhbV9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJCSAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmbXQpCiB7
CiAJaWYgKGZtdC0+aW5kZXggPj0gTl9WSUFfRk1UUykKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC04
NTAsOCArODUyLDggQEAgc3RhdGljIGludCB2aWFjYW1fZG9fdHJ5X2ZtdChzdHJ1Y3QgdmlhX2Nh
bWVyYSAqY2FtLAogCiAKIAotc3RhdGljIGludCB2aWFjYW1fdHJ5X2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3N0
YXRpYyBpbnQgdmlhY2FtX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCQkg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZt
dCkKIHsKIAlzdHJ1Y3QgdmlhX2NhbWVyYSAqY2FtID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKIAlz
dHJ1Y3QgdjRsMl9mb3JtYXQgc2ZtdDsKQEAgLTg2MCw4ICs4NjIsOCBAQCBzdGF0aWMgaW50IHZp
YWNhbV90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCiB9CiAK
IAotc3RhdGljIGludCB2aWFjYW1fZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9p
ZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCitzdGF0aWMgaW50IHZpYWNhbV9n
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgdmlhX2Nh
bWVyYSAqY2FtID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKIApAQCAtODY5LDggKzg3MSw4IEBAIHN0
YXRpYyBpbnQgdmlhY2FtX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlhY2FtX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQor
c3RhdGljIGludCB2aWFjYW1fc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCQlz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQp
CiB7CiAJc3RydWN0IHZpYV9jYW1lcmEgKmNhbSA9IHZpZGVvX2RydmRhdGEoZmlscCk7CiAJaW50
IHJldDsKQEAgLTkwMiw4ICs5MDQsOCBAQCBzdGF0aWMgaW50IHZpYWNhbV9zX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRp
YyBpbnQgdmlhY2FtX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAotCQlz
dHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCitzdGF0aWMgaW50IHZpYWNhbV9xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlscCwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwg
InZpYS1jYW1lcmEiLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKIAlzdHJzY3B5KGNhcC0+Y2FyZCwg
InZpYS1jYW1lcmEiLCBzaXplb2YoY2FwLT5jYXJkKSk7CkBAIC05MTMsNyArOTE1LDggQEAgc3Rh
dGljIGludCB2aWFjYW1fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCiAK
IC8qIEcvU19QQVJNICovCiAKLXN0YXRpYyBpbnQgdmlhY2FtX2dfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlscCwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlhY2FtX2dfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlscCwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJc3RydWN0IHY0
bDJfc3RyZWFtcGFybSAqcGFybSkKIHsKIAlzdHJ1Y3QgdmlhX2NhbWVyYSAqY2FtID0gdmlkZW9f
ZHJ2ZGF0YShmaWxwKTsKQEAgLTkyMSw3ICs5MjQsOCBAQCBzdGF0aWMgaW50IHZpYWNhbV9nX3Bh
cm0oc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHY0bDJfZ19wYXJtX2Nh
cCh2aWRlb19kZXZkYXRhKGZpbHApLCBjYW0tPnNlbnNvciwgcGFybSk7CiB9CiAKLXN0YXRpYyBp
bnQgdmlhY2FtX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlhY2FtX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSkKIHsKIAlz
dHJ1Y3QgdmlhX2NhbWVyYSAqY2FtID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKQEAgLTkyOSw3ICs5
MzMsOCBAQCBzdGF0aWMgaW50IHZpYWNhbV9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIHY0bDJfc19wYXJtX2NhcCh2aWRlb19kZXZkYXRhKGZpbHApLCBjYW0t
PnNlbnNvciwgcGFybSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlhY2FtX2VudW1fZnJhbWVzaXplcyhz
dHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlhY2FtX2VudW1fZnJh
bWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQlzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqc2l6ZXMpCiB7CiAJdW5zaWdu
ZWQgaW50IGk7CkBAIC05NTAsNyArOTU1LDggQEAgc3RhdGljIGludCB2aWFjYW1fZW51bV9mcmFt
ZXNpemVzKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpYWNhbV9lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxwLCB2
b2lkICpwcml2LAorc3RhdGljIGludCB2aWFjYW1fZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3Qg
ZmlsZSAqZmlscCwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKmludGVydmFsKQogewogCXN0cnVjdCB2aWFfY2Ft
ZXJhICpjYW0gPSB2aWRlb19kcnZkYXRhKGZpbHApOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRp
YS9wbGF0Zm9ybS94aWxpbngveGlsaW54LWRtYS5jIGIvZHJpdmVycy9tZWRpYS9wbGF0Zm9ybS94
aWxpbngveGlsaW54LWRtYS5jCmluZGV4IGZjZmUwODgzYWJhNWZiOGJjZjk1NGNlNGJlOTU2ZWRi
MzllNjEwY2IuLjgxMDJlMDk5OTNlNGE5Y2U1NDI4YTBhNDllZjAxYzhlNWRlMjIzZjYgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvbWVkaWEvcGxhdGZvcm0veGlsaW54L3hpbGlueC1kbWEuYworKysgYi9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL3hpbGlueC94aWxpbngtZG1hLmMKQEAgLTQ2Nyw3ICs0Njcs
OCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZiMl9vcHMgeHZpcF9kbWFfcXVldWVfcW9wcyA9IHsK
ICAqLwogCiBzdGF0aWMgaW50Ci14dmlwX2RtYV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKK3h2aXBfZG1hX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
ICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHY0bDJfZmggKnZmaCA9
IGZpbGVfdG9fdjRsMl9maChmaWxlKTsKIAlzdHJ1Y3QgeHZpcF9kbWEgKmRtYSA9IHRvX3h2aXBf
ZG1hKHZmaC0+dmRldik7CkBAIC00ODksNyArNDkwLDggQEAgeHZpcF9kbWFfcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiAg
KiBjbGFyaWZpZWQgdGhyb3VnaCB0aGUgbWFpbGluZyBsaXN0LgogICovCiBzdGF0aWMgaW50Ci14
dmlwX2RtYV9lbnVtX2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmYpCit4dmlwX2RtYV9lbnVtX2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgc3RydWN0IHY0bDJfZm10
ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgdjRsMl9maCAqdmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUp
OwogCXN0cnVjdCB4dmlwX2RtYSAqZG1hID0gdG9feHZpcF9kbWEodmZoLT52ZGV2KTsKQEAgLTUw
Myw3ICs1MDUsOCBAQCB4dmlwX2RtYV9lbnVtX2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB9CiAKIHN0YXRpYyBpbnQKLXh2aXBfZG1h
X2dldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmZvcm1hdCkKK3h2aXBfZG1hX2dldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
b3JtYXQpCiB7CiAJc3RydWN0IHY0bDJfZmggKnZmaCA9IGZpbGVfdG9fdjRsMl9maChmaWxlKTsK
IAlzdHJ1Y3QgeHZpcF9kbWEgKmRtYSA9IHRvX3h2aXBfZG1hKHZmaC0+dmRldik7CkBAIC01NjMs
NyArNTY2LDggQEAgX194dmlwX2RtYV90cnlfZm9ybWF0KHN0cnVjdCB4dmlwX2RtYSAqZG1hLCBz
dHJ1Y3QgdjRsMl9waXhfZm9ybWF0ICpwaXgsCiB9CiAKIHN0YXRpYyBpbnQKLXh2aXBfZG1hX3Ry
eV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmZvcm1hdCkKK3h2aXBfZG1hX3RyeV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmb3Jt
YXQpCiB7CiAJc3RydWN0IHY0bDJfZmggKnZmaCA9IGZpbGVfdG9fdjRsMl9maChmaWxlKTsKIAlz
dHJ1Y3QgeHZpcF9kbWEgKmRtYSA9IHRvX3h2aXBfZG1hKHZmaC0+dmRldik7CkBAIC01NzMsNyAr
NTc3LDggQEAgeHZpcF9kbWFfdHJ5X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm9ybWF0KQogfQogCiBzdGF0aWMgaW50Ci14dmlwX2RtYV9z
ZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmb3JtYXQpCit4dmlwX2RtYV9zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm9y
bWF0KQogewogCXN0cnVjdCB2NGwyX2ZoICp2ZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CiAJ
c3RydWN0IHh2aXBfZG1hICpkbWEgPSB0b194dmlwX2RtYSh2ZmgtPnZkZXYpOwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS9yYWRpby9kc2JyMTAwLmMgYi9kcml2ZXJzL21lZGlhL3JhZGlvL2Rz
YnIxMDAuYwppbmRleCA5YTQ1Y2RhMDU3Nzk5MzIwNmM3ZTI4N2NlMDM0Njc3MTNmMTZlZTQxLi45
OTc4NDU0YWY2YTMzZTg2M2UzMjBhNmMxNjQ5Nzk5OGE0NGExZGNhIDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3JhZGlvL2RzYnIxMDAuYworKysgYi9kcml2ZXJzL21lZGlhL3JhZGlvL2RzYnIx
MDAuYwpAQCAtMTYwLDcgKzE2MCw4IEBAIHN0YXRpYyB2b2lkIGRzYnIxMDBfZ2V0c3RhdChzdHJ1
Y3QgZHNicjEwMF9kZXZpY2UgKnJhZGlvKQogCX0KIH0KIAotc3RhdGljIGludCB2aWRpb2NfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICp2KQogewogCXN0cnVjdCBk
c2JyMTAwX2RldmljZSAqcmFkaW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTcxLDcgKzE3
Miw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3RydWN0IGRzYnIxMDBfZGV2aWNlICpyYWRp
byA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xOTIsMTMgKzE5NCwxNSBAQCBzdGF0aWMgaW50
IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJY29uc3Qgc3RydWN0IHY0
bDJfdHVuZXIgKnYpCiB7CiAJcmV0dXJuIHYtPmluZGV4ID8gLUVJTlZBTCA6IDA7CiB9CiAKLXN0
YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQljb25zdCBzdHJ1Y3Qg
djRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGRzYnIxMDBfZGV2aWNlICpyYWRpbyA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yMTAsNyArMjE0LDggQEAgc3RhdGljIGludCB2aWRpb2Nf
c19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQlGUkVRX01JTiAq
IEZSRVFfTVVMLCBGUkVRX01BWCAqIEZSRVFfTVVMKSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7
CiAJc3RydWN0IGRzYnIxMDBfZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRp
ZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLWNhZGV0LmMgYi9kcml2ZXJzL21l
ZGlhL3JhZGlvL3JhZGlvLWNhZGV0LmMKaW5kZXggNTExMDc1NGUxYTMxNzgyYjc0ZDRjOWRjYmZh
Nzk2NDJhNTMyNTQzYS4uODQyMDAyMDk4ZThlZWI5NjBlNzEyODMxMGY0MWU4NmVmZTVjZTk0MyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1jYWRldC5jCisrKyBiL2RyaXZl
cnMvbWVkaWEvcmFkaW8vcmFkaW8tY2FkZXQuYwpAQCAtMzUxLDcgKzM1MSw4IEBAIHN0YXRpYyBz
c2l6ZV90IGNhZGV0X3JlYWQoc3RydWN0IGZpbGUgKmZpbGUsIGNoYXIgX191c2VyICpkYXRhLCBz
aXplX3QgY291bnQsIGxvCiB9CiAKIAotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKnYpCiB7CiAJc3Ryc2NweSh2LT5kcml2ZXIsICJB
RFMgQ2FkZXQiLCBzaXplb2Yodi0+ZHJpdmVyKSk7CkBAIC0zNjAsNyArMzYxLDggQEAgc3RhdGlj
IGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRs
Ml90dW5lciAqdikKIHsKIAlzdHJ1Y3QgY2FkZXQgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC0zOTAsMTMgKzM5MiwxNSBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRp
b2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJcmV0dXJu
IHYtPmluZGV4ID8gLUVJTlZBTCA6IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJl
cV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9j
X2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2ZyZXF1ZW5jeV9iYW5kICpiYW5k
KQogewogCWlmIChiYW5kLT50dW5lcikKQEAgLTQwNyw3ICs0MTEsOCBAQCBzdGF0aWMgaW50IHZp
ZGlvY19lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGNhZGV0ICpkZXYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtNDIwLDcgKzQyNSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2df
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogCiAKLXN0YXRpYyBp
bnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQljb25zdCBzdHJ1Y3QgdjRsMl9m
cmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGNhZGV0ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1pc2EuYyBiL2RyaXZlcnMv
bWVkaWEvcmFkaW8vcmFkaW8taXNhLmMKaW5kZXggMWExNDQ1MzZmZmE3NTgwYzhlOGQ5NmMxNDlh
NjhlYjc4OGMyOTM0Ni4uMzJmNDgzZjEyY2UwNTJlYzhjY2Y4NzBlYjQyZmFlNjYxYjVmZmY2NyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1pc2EuYworKysgYi9kcml2ZXJz
L21lZGlhL3JhZGlvL3JhZGlvLWlzYS5jCkBAIC0yOSw3ICsyOSw4IEBAIE1PRFVMRV9MSUNFTlNF
KCJHUEwiKTsKICNkZWZpbmUgRlJFUV9MT1cgICg4N1UgKiAxNjAwMFUpCiAjZGVmaW5lIEZSRVFf
SElHSCAoMTA4VSAqIDE2MDAwVSkKIAotc3RhdGljIGludCByYWRpb19pc2FfcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCByYWRpb19pc2FfcXVlcnlj
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqdikKIHsKIAlzdHJ1Y3QgcmFk
aW9faXNhX2NhcmQgKmlzYSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00MCw3ICs0MSw4IEBA
IHN0YXRpYyBpbnQgcmFkaW9faXNhX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByYWRpb19pc2FfZ190dW5lcihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9faXNhX2dfdHVuZXIo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCXN0cnVjdCB2NGwyX3R1bmVyICp2KQogewogCXN0cnVjdCByYWRpb19pc2FfY2Fy
ZCAqaXNhID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTcwLDcgKzcyLDggQEAgc3RhdGljIGlu
dCByYWRpb19pc2FfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCByYWRpb19pc2Ffc190dW5lcihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9faXNhX3NfdHVuZXIoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNv
bnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2KQogewogCXN0cnVjdCByYWRpb19pc2FfY2FyZCAqaXNh
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTg1LDcgKzg4LDggQEAgc3RhdGljIGludCByYWRp
b19pc2Ffc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCByYWRpb19pc2Ffc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJhZGlvX2lzYV9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJY29u
c3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCByYWRpb19pc2FfY2FyZCAq
aXNhID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEwMSw3ICsxMDUsOCBAQCBzdGF0aWMgaW50
IHJhZGlvX2lzYV9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gcmVzOwogfQogCi1zdGF0aWMgaW50IHJhZGlvX2lzYV9nX2ZyZXF1ZW5jeShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9faXNhX2dfZnJlcXVlbmN5
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHJhZGlvX2lzYV9j
YXJkICppc2EgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTI2LDcgKzEzMSw4IEBAIHN0YXRp
YyBpbnQgcmFkaW9faXNhX3NfY3RybChzdHJ1Y3QgdjRsMl9jdHJsICpjdHJsKQogCXJldHVybiAt
RUlOVkFMOwogfQogCi1zdGF0aWMgaW50IHJhZGlvX2lzYV9sb2dfc3RhdHVzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2KQorc3RhdGljIGludCByYWRpb19pc2FfbG9nX3N0YXR1cyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsK
IAlzdHJ1Y3QgcmFkaW9faXNhX2NhcmQgKmlzYSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8ta2VlbmUuYyBiL2RyaXZlcnMvbWVk
aWEvcmFkaW8vcmFkaW8ta2VlbmUuYwppbmRleCBmM2I1N2YwY2IxZWM0MDY0YWE3ZTgxYjFjNjQy
NWY5MzdjYTgxOWRlLi4xNjhlMWZmMmEwYWU2NGE1YWY1N2NlZWZkN2U1NzQ5MWYxYjM0N2UxIDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLWtlZW5lLmMKKysrIGIvZHJpdmVy
cy9tZWRpYS9yYWRpby9yYWRpby1rZWVuZS5jCkBAIC0xNjAsNyArMTYwLDggQEAgc3RhdGljIGlu
dCB1c2Jfa2VlbmVfcmVzdW1lKHN0cnVjdCB1c2JfaW50ZXJmYWNlICppbnRmKQogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwy
X2NhcGFiaWxpdHkgKnYpCiB7CiAJc3RydWN0IGtlZW5lX2RldmljZSAqcmFkaW8gPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtMTcxLDcgKzE3Miw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IHZpZGlvY19nX21vZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX2dfbW9kdWxhdG9yKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfbW9k
dWxhdG9yICp2KQogewogCXN0cnVjdCBrZWVuZV9kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTE4Nyw3ICsxODksOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX21vZHVsYXRv
cihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2Nfc19tb2R1bGF0b3Ioc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19zX21vZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwy
X21vZHVsYXRvciAqdikKIHsKIAlzdHJ1Y3Qga2VlbmVfZGV2aWNlICpyYWRpbyA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC0xOTksNyArMjAyLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19tb2R1
bGF0b3Ioc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGtlZW5lX2NtZF9z
ZXQocmFkaW8pOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBrZWVuZV9k
ZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTIxMSw3ICsyMTUsOCBAQCBz
dGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4ga2VlbmVfY21kX21haW4ocmFkaW8sIGZyZXEsIHRydWUpOwogfQogCi1zdGF0
aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJl
cXVlbmN5ICpmKQogewogCXN0cnVjdCBrZWVuZV9kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tbWE5MDEuYyBi
L2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tbWE5MDEuYwppbmRleCA2NTdjM2RkYTY2NDhhOGZm
M2JmNjc2MzBjN2NjMzBkODU3MzY3ZmUwLi42MWI3NDVhMTNmYzI5ZTAzNTc5YTI5YmI3ZjI4OTQ1
MTNjZjVlODcyIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLW1hOTAxLmMK
KysrIGIvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1tYTkwMS5jCkBAIC0xODMsNyArMTgzLDgg
QEAgc3RhdGljIHZvaWQgdXNiX21hOTAxcmFkaW9fZGlzY29ubmVjdChzdHJ1Y3QgdXNiX2ludGVy
ZmFjZSAqaW50ZikKIH0KIAogLyogdmlkaW9jX3F1ZXJ5Y2FwIC0gcXVlcnkgZGV2aWNlIGNhcGFi
aWxpdGllcyAqLwotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICp2KQogewogCXN0cnVjdCBtYTkwMXJhZGlvX2RldmljZSAqcmFkaW8g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTk1LDcgKzE5Niw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogCiAvKiB2aWRp
b2NfZ190dW5lciAtIGdldCB0dW5lciBhdHRyaWJ1dGVzICovCi1zdGF0aWMgaW50IHZpZGlvY19n
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nf
Z190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3RydWN0IG1hOTAxcmFk
aW9fZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yMjMsNyArMjI1LDgg
QEAgc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIH0KIAogLyogdmlkaW9jX3NfdHVuZXIgLSBzZXQgdHVuZXIgYXR0cmlidXRlcyAqLwotc3Rh
dGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2
KQogewogCXN0cnVjdCBtYTkwMXJhZGlvX2RldmljZSAqcmFkaW8gPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtMjQxLDcgKzI0NCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIC8qIHZpZGlvY19zX2ZyZXF1ZW5jeSAtIHNl
dCB0dW5lciByYWRpbyBmcmVxdWVuY3kgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19mcmVx
dWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQljb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3Ry
dWN0IG1hOTAxcmFkaW9fZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0y
NTQsNyArMjU4LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIC8qIHZpZGlvY19nX2ZyZXF1ZW5jeSAtIGdldCB0dW5l
ciByYWRpbyBmcmVxdWVuY3kgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3ko
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IG1hOTAxcmFk
aW9fZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL21lZGlhL3JhZGlvL3JhZGlvLW1pcm9wY20yMC5jIGIvZHJpdmVycy9tZWRpYS9yYWRpby9y
YWRpby1taXJvcGNtMjAuYwppbmRleCA2NzcxMmFiM2Q1NjQ0MzVjOWU3YzJjNDZkMTAzZWE3Zjgx
NjZjMmVhLi5mOWQ1ZDM1YTc3NTM3OGExMThmZDRjYzg2ODM4MjczYmFmODkxMWJhIDEwMDY0NAot
LS0gYS9kcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLW1pcm9wY20yMC5jCisrKyBiL2RyaXZlcnMv
bWVkaWEvcmFkaW8vcmFkaW8tbWlyb3BjbTIwLmMKQEAgLTE5Niw3ICsxOTYsOCBAQCBzdGF0aWMg
aW50IHBjbTIwX3NldGZyZXEoc3RydWN0IHBjbTIwICpkZXYsIHVuc2lnbmVkIGxvbmcgZnJlcSkK
IAlyZXR1cm4gc25kX2FjaV9jbWQoYWNpLCBBQ0lfV1JJVEVfVFVORSwgZnJlcWwsIGZyZXFoKTsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Nh
cGFiaWxpdHkgKnYpCiB7CiAJc3Ryc2NweSh2LT5kcml2ZXIsICJNaXJvIFBDTTIwIiwgc2l6ZW9m
KHYtPmRyaXZlcikpOwpAQCAtMjE5LDcgKzIyMCw4IEBAIHN0YXRpYyBib29sIHNhbml0aXplKGNo
YXIgKnAsIGludCBzaXplKQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2df
dHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19n
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl90dW5lciAqdikKIHsKIAlzdHJ1Y3QgcGNtMjAgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yNDgsNyArMjUwLDggQEAgc3RhdGljIGludCB2
aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwy
X3R1bmVyICp2KQogewogCXN0cnVjdCBwY20yMCAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTI2NCw3ICsyNjcsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19n
X2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlk
aW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewog
CXN0cnVjdCBwY20yMCAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTI3OCw3ICsyODIs
OCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIH0KIAogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBwY20yMCAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcmFk
aW8vcmFkaW8tbXI4MDAuYyBiL2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tbXI4MDAuYwppbmRl
eCBjYjA0MzdiNGMzMzEyNTA4NjNjOWUwOGM1OGJmMGYzMmZkYWQ0MzYyLi4zNjg5OTVjZTUzYWU5
NTBjZDE0ZDU2MTZlZGU3YTM0MjljZGZiOWJkIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Jh
ZGlvL3JhZGlvLW1yODAwLmMKKysrIGIvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1tcjgwMC5j
CkBAIC0yNTIsNyArMjUyLDggQEAgc3RhdGljIHZvaWQgdXNiX2FtcmFkaW9fZGlzY29ubmVjdChz
dHJ1Y3QgdXNiX2ludGVyZmFjZSAqaW50ZikKIH0KIAogLyogdmlkaW9jX3F1ZXJ5Y2FwIC0gcXVl
cnkgZGV2aWNlIGNhcGFiaWxpdGllcyAqLwotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICp2KQogewogCXN0cnVjdCBhbXJhZGlvX2Rl
dmljZSAqcmFkaW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjY0LDcgKzI2NSw4IEBAIHN0
YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
fQogCiAvKiB2aWRpb2NfZ190dW5lciAtIGdldCB0dW5lciBhdHRyaWJ1dGVzICovCi1zdGF0aWMg
aW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3Ry
dWN0IGFtcmFkaW9fZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yOTIs
NyArMjk0LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIH0KIAogLyogdmlkaW9jX3NfdHVuZXIgLSBzZXQgdHVuZXIgYXR0cmlidXRl
cyAqLwotc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwy
X3R1bmVyICp2KQogewogCXN0cnVjdCBhbXJhZGlvX2RldmljZSAqcmFkaW8gPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtMzEwLDcgKzMxMyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIC8qIHZpZGlvY19zX2ZyZXF1ZW5j
eSAtIHNldCB0dW5lciByYWRpbyBmcmVxdWVuY3kgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX3NfZnJl
cXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nf
c19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQljb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7
CiAJc3RydWN0IGFtcmFkaW9fZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0zMjEsNyArMzI1LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIC8qIHZpZGlvY19nX2ZyZXF1ZW5jeSAtIGdldCB0
dW5lciByYWRpbyBmcmVxdWVuY3kgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVu
Y3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGFtcmFk
aW9fZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zMzQsNyArMzM5LDgg
QEAgc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfaHdfZnJlcV9zZWVr
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19od19m
cmVxX3NlZWsoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQljb25zdCBzdHJ1Y3QgdjRsMl9od19mcmVxX3NlZWsgKnNlZWspCiB7CiAJ
c3RhdGljIHU4IGJ1Zls4XSA9IHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFk
aW8tcmFyZW1vbm8uYyBiL2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tcmFyZW1vbm8uYwppbmRl
eCBmNjA3NzViMDA1ZTFkMWRjYzYzYjlkMDk1Y2ZiNTMyMGMyMDg4OGUxLi41NDQ2MGVhMTNlZDll
NzJlZjRjMDEwOWJlOWUzOGZjOGYxYmVkNjY1IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Jh
ZGlvL3JhZGlvLXJhcmVtb25vLmMKKysrIGIvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1yYXJl
bW9uby5jCkBAIC0xNzYsNyArMTc2LDggQEAgc3RhdGljIHZvaWQgdXNiX3JhcmVtb25vX2Rpc2Nv
bm5lY3Qoc3RydWN0IHVzYl9pbnRlcmZhY2UgKmludGYpCiAvKgogICogTGludXggVmlkZW8gaW50
ZXJmYWNlCiAgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0
IHY0bDJfY2FwYWJpbGl0eSAqdikKIHsKIAlzdHJ1Y3QgcmFyZW1vbm9fZGV2aWNlICpyYWRpbyA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xODcsNyArMTg4LDggQEAgc3RhdGljIGludCB2aWRp
b2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQlzdHJ1
Y3QgdjRsMl9mcmVxdWVuY3lfYmFuZCAqYmFuZCkKIHsKIAlpZiAoYmFuZC0+dHVuZXIgIT0gMCkK
QEAgLTIwMSw4ICsyMDMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyZXFfYmFuZHMoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2
NGwyX3R1bmVyICp2KQorc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX3R1
bmVyICp2KQogewogCXN0cnVjdCByYXJlbW9ub19kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIAlpbnQgcmV0OwpAQCAtMjMwLDEzICsyMzIsMTUgQEAgc3RhdGljIGludCB2aWRp
b2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQljb25zdCBzdHJ1Y3QgdjRsMl90
dW5lciAqdikKIHsKIAlyZXR1cm4gdi0+aW5kZXggPyAtRUlOVkFMIDogMDsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwy
X2ZyZXF1ZW5jeSAqZikKIHsKIAlzdHJ1Y3QgcmFyZW1vbm9fZGV2aWNlICpyYWRpbyA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC0yNTcsNyArMjYxLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19m
cmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJhcmVtb25v
X2NtZF9tYWluKHJhZGlvLCBiYW5kLCBmcmVxIC8gMTYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
dmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQog
ewogCXN0cnVjdCByYXJlbW9ub19kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tc2YxNmZtaS5jIGIvZHJpdmVy
cy9tZWRpYS9yYWRpby9yYWRpby1zZjE2Zm1pLmMKaW5kZXggMWZiODhjMmI5MTZjNDUxMGU5MTVi
MmNiNDc4MDg1MTM0YTlmMDljMy4uMDQ4Zjc5OTBhNWQ0YzMxOGIzZjc0MTZlYzA5MWY2MDQ1Yjhj
N2ExMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1zZjE2Zm1pLmMKKysr
IGIvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1zZjE2Zm1pLmMKQEAgLTEyNyw3ICsxMjcsOCBA
QCBzdGF0aWMgdm9pZCBmbWlfc2V0X2ZyZXEoc3RydWN0IGZtaSAqZm1pKQogCWxtNzAwMF9zZXRf
ZnJlcSgoZm1pLT5jdXJmcmVxIC8gODAwKSAqIDgwMCwgZm1pLCBmbWlfc2V0X3BpbnMpOwogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnBy
aXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9jYXBh
YmlsaXR5ICp2KQogewogCXN0cnNjcHkodi0+ZHJpdmVyLCAicmFkaW8tc2YxNmZtaSIsIHNpemVv
Zih2LT5kcml2ZXIpKTsKQEAgLTEzNiw3ICsxMzcsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVy
eWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7
CiAJc3RydWN0IGZtaSAqZm1pID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE1NSwxMyArMTU3
LDE1IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkJY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJcmV0dXJuIHYtPmluZGV4ID8gLUVJ
TlZBTCA6IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBmbWkgKmZt
aSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNzUsNyArMTc5LDggQEAgc3RhdGljIGludCB2
aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJ
c3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBmbWkgKmZtaSA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLXNpNDc2
eC5jIGIvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby1zaTQ3NnguYwppbmRleCA5OTgwMzQ2Y2I1
ZWEzODk3ZTUxNWEwMDQyY2RiNmM3YjI0MzM0YjAxLi45YTViYjAyNTlmMjgxMDFjZjNkMDgzOGJh
NjUxMzk2OGQ3MDY1NzYyIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLXNp
NDc2eC5jCisrKyBiL2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tc2k0NzZ4LmMKQEAgLTMyMSw3
ICszMjEsOCBAQCB2NGwyX2N0cmxfaGFuZGxlcl90b19yYWRpbyhzdHJ1Y3QgdjRsMl9jdHJsX2hh
bmRsZXIgKmQpCiAvKgogICogc2k0NzZ4X3ZpZGlvY19xdWVyeWNhcCAtIHF1ZXJ5IGRldmljZSBj
YXBhYmlsaXRpZXMKICAqLwotc3RhdGljIGludCBzaTQ3NnhfcmFkaW9fcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHNpNDc2eF9yYWRpb19xdWVyeWNh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcGFiaWxpdHkpCiB7CiAJc3RydWN0
IHNpNDc2eF9yYWRpbyAqcmFkaW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzMyLDcgKzMz
Myw4IEBAIHN0YXRpYyBpbnQgc2k0NzZ4X3JhZGlvX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHNpNDc2eF9yYWRpb19l
bnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHNpNDc2eF9yYWRpb19lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCXN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVu
Y3lfYmFuZCAqYmFuZCkKIHsKIAlpbnQgZXJyOwpAQCAtMzY5LDcgKzM3MSw4IEBAIHN0YXRpYyBp
bnQgc2k0NzZ4X3JhZGlvX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gZXJyOwogfQogCi1zdGF0aWMgaW50IHNpNDc2eF9yYWRpb19nX3R1bmVy
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzaTQ3NnhfcmFkaW9f
Z190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl90dW5lciAqdHVuZXIpCiB7CiAJaW50IGVycjsKQEAg
LTQ0Niw3ICs0NDksOCBAQCBzdGF0aWMgaW50IHNpNDc2eF9yYWRpb19nX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBlcnI7CiB9CiAKLXN0YXRpYyBpbnQgc2k0
NzZ4X3JhZGlvX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHNpNDc2eF9yYWRpb19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0
dW5lcikKIHsKIAlzdHJ1Y3Qgc2k0NzZ4X3JhZGlvICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC02MzgsNyArNjQyLDggQEAgc3RhdGljIGludCBzaTQ3NnhfcmFkaW9fY2hhbmdlX2Z1
bmMoc3RydWN0IHNpNDc2eF9yYWRpbyAqcmFkaW8sCiAJcmV0dXJuIHNpNDc2eF9yYWRpb19kb19w
b3N0X3Bvd2VydXBfaW5pdChyYWRpbywgZnVuYyk7CiB9CiAKLXN0YXRpYyBpbnQgc2k0NzZ4X3Jh
ZGlvX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBzaTQ3NnhfcmFkaW9fZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfZnJl
cXVlbmN5ICpmKQogewogCWludCBlcnI7CkBAIC02NzMsNyArNjc4LDggQEAgc3RhdGljIGludCBz
aTQ3NnhfcmFkaW9fZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIGVycjsKIH0KIAotc3RhdGljIGludCBzaTQ3NnhfcmFkaW9fc19mcmVxdWVuY3koc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHNpNDc2eF9yYWRpb19zX2Zy
ZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJICAgIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKIHsK
IAlpbnQgZXJyOwpAQCAtNzI1LDcgKzczMSw4IEBAIHN0YXRpYyBpbnQgc2k0NzZ4X3JhZGlvX3Nf
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBlcnI7CiB9
CiAKLXN0YXRpYyBpbnQgc2k0NzZ4X3JhZGlvX3NfaHdfZnJlcV9zZWVrKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzaTQ3NnhfcmFkaW9fc19od19mcmVxX3NlZWso
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCSAgICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9od19mcmVxX3NlZWsgKnNlZWsp
CiB7CiAJaW50IGVycjsKQEAgLTk5Miw3ICs5OTksOCBAQCBzdGF0aWMgaW50IHNpNDc2eF9yYWRp
b19zX2N0cmwoc3RydWN0IHY0bDJfY3RybCAqY3RybCkKIH0KIAogI2lmZGVmIENPTkZJR19WSURF
T19BRFZfREVCVUcKLXN0YXRpYyBpbnQgc2k0NzZ4X3JhZGlvX2dfcmVnaXN0ZXIoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBzaTQ3NnhfcmFkaW9fZ19yZWdpc3Rlcihz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKIHsKIAlpbnQgZXJyOwpA
QCAtMTAwOCw3ICsxMDE2LDkgQEAgc3RhdGljIGludCBzaTQ3NnhfcmFkaW9fZ19yZWdpc3Rlcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAKIAlyZXR1cm4gZXJyOwogfQotc3RhdGljIGlu
dCBzaTQ3NnhfcmFkaW9fc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCisK
K3N0YXRpYyBpbnQgc2k0NzZ4X3JhZGlvX3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgY29uc3Qgc3Ry
dWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcmFkaW8vcmFkaW8tdGVhNTc2NC5jIGIvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby10ZWE1
NzY0LmMKaW5kZXggZGQ4NWIwYjFiY2Q5NjJkNTlhY2RiZWZiOGM3NGU0Njk5MTRkYWYzZi4uYTRm
NDgzN2U4OTZmNTBiN2FhOWM4MmFhYThhODgwNjIwZjVkMzk4OCAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9tZWRpYS9yYWRpby9yYWRpby10ZWE1NzY0LmMKKysrIGIvZHJpdmVycy9tZWRpYS9yYWRpby9y
YWRpby10ZWE1NzY0LmMKQEAgLTI3Miw3ICsyNzIsOCBAQCBzdGF0aWMgdm9pZCB0ZWE1NzY0X211
dGUoc3RydWN0IHRlYTU3NjRfZGV2aWNlICpyYWRpbywgaW50IG9uKQogfQogCiAvKiBWNEwyIHZp
ZGlvYyAqLwotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0
bDJfY2FwYWJpbGl0eSAqdikKIHsKIAlzdHJ1Y3QgdGVhNTc2NF9kZXZpY2UgKnJhZGlvID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTI4NSw3ICsyODYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl90dW5lciAqdikK
IHsKIAlzdHJ1Y3QgdGVhNTc2NF9kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTMxMSw3ICszMTMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19z
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nf
c190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3RydWN0IHRl
YTU3NjRfZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zMjMsNyArMzI2
LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5j
eShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKIHsKIAlzdHJ1Y3Qg
dGVhNTc2NF9kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTM0Nyw3ICsz
NTEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVu
Y3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2Zy
ZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKIHsKIAlzdHJ1Y3Qg
dGVhNTc2NF9kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbWVkaWEvcmFkaW8vcmFkaW8tdGVhNTc3Ny5jIGIvZHJpdmVycy9tZWRpYS9yYWRp
by9yYWRpby10ZWE1Nzc3LmMKaW5kZXggZmI5ZGU3YmJjZDE5NWUxOTNkMWM5MTY2MWIwZTg5MDBi
YmVmYzlhYS4uNWQyZjBiMTgyZmM0ODkxMjMzMTY4ZDkyZGIzZWE4MDNkNDUwZTE5YSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby10ZWE1Nzc3LmMKKysrIGIvZHJpdmVycy9t
ZWRpYS9yYWRpby9yYWRpby10ZWE1Nzc3LmMKQEAgLTI1MSw3ICsyNTEsOCBAQCBzdGF0aWMgaW50
IHJhZGlvX3RlYTU3NzdfdXBkYXRlX3JlYWRfcmVnKHN0cnVjdCByYWRpb190ZWE1Nzc3ICp0ZWEs
IGludCB3YWl0KQogICogTGludXggVmlkZW8gaW50ZXJmYWNlCiAgKi8KIAotc3RhdGljIGludCB2
aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqdikKIHsK
IAlzdHJ1Y3QgcmFkaW9fdGVhNTc3NyAqdGVhID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTI2
Myw3ICsyNjQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1f
ZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlk
aW9jX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0bDJfZnJlcXVlbmN5X2JhbmQg
KmJhbmQpCiB7CiAJc3RydWN0IHJhZGlvX3RlYTU3NzcgKnRlYSA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC0yNzYsNyArMjc4LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmVxX2JhbmRz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX3R1bmVyICp2KQogewogCXN0
cnVjdCByYWRpb190ZWE1Nzc3ICp0ZWEgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzE4LDcg
KzMyMSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkJY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3RydWN0IHJhZGlvX3RlYTU3
NzcgKnRlYSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zMzcsNyArMzQxLDggQEAgc3RhdGlj
IGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHJhZGlvX3RlYTU3NzcgKnRl
YSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zNDksNyArMzU0LDggQEAgc3RhdGljIGludCB2
aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJ
Y29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCByYWRpb190ZWE1Nzc3
ICp0ZWEgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzY2LDcgKzM3Miw4IEBAIHN0YXRpYyBp
bnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiByYWRpb190ZWE1Nzc3X3NldF9mcmVxKHRlYSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X3NfaHdfZnJlcV9zZWVrKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQg
dmlkaW9jX3NfaHdfZnJlcV9zZWVrKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJY29uc3Qgc3RydWN0IHY0bDJfaHdfZnJlcV9z
ZWVrICphKQogewogCXN0cnVjdCByYWRpb190ZWE1Nzc3ICp0ZWEgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9yYWRpby9yYWRpby10aW1iLmMgYi9kcml2
ZXJzL21lZGlhL3JhZGlvL3JhZGlvLXRpbWIuYwppbmRleCBhNjA2OWIxMDZmZDMwNDhiMmM3MzBl
OWM0NWZkODJmMGI3MzAyYmZiLi44ZDVlNGViMGI5NjRiNTZlMmJhYzcxYmQ2MjY3NzlkMjI0NjM4
ZDlmIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLXRpbWIuYworKysgYi9k
cml2ZXJzL21lZGlhL3JhZGlvL3JhZGlvLXRpbWIuYwpAQCAtMjcsOSArMjcsOSBAQCBzdHJ1Y3Qg
dGltYnJhZGlvIHsKIAlzdHJ1Y3QgbXV0ZXgJCWxvY2s7CiB9OwogCi0KLXN0YXRpYyBpbnQgdGlt
YnJhZGlvX3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCi0J
c3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqdikKK3N0YXRpYyBpbnQgdGltYnJhZGlvX3ZpZGlvY19x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJCSAgICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqdikKIHsKIAlz
dHJzY3B5KHYtPmRyaXZlciwgRFJJVkVSX05BTUUsIHNpemVvZih2LT5kcml2ZXIpKTsKIAlzdHJz
Y3B5KHYtPmNhcmQsICJUaW1iZXJkYWxlIFJhZGlvIiwgc2l6ZW9mKHYtPmNhcmQpKTsKQEAgLTM3
LDI5ICszNywzMyBAQCBzdGF0aWMgaW50IHRpbWJyYWRpb192aWRpb2NfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRp
bWJyYWRpb192aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQlz
dHJ1Y3QgdjRsMl90dW5lciAqdikKK3N0YXRpYyBpbnQgdGltYnJhZGlvX3ZpZGlvY19nX3R1bmVy
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCQkgICAgc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3RydWN0IHRpbWJyYWRp
byAqdHIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKHRy
LT5zZF90dW5lciwgdHVuZXIsIGdfdHVuZXIsIHYpOwogfQogCi1zdGF0aWMgaW50IHRpbWJyYWRp
b192aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQljb25zdCBz
dHJ1Y3QgdjRsMl90dW5lciAqdikKK3N0YXRpYyBpbnQgdGltYnJhZGlvX3ZpZGlvY19zX3R1bmVy
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCQkgICAgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3RydWN0IHRp
bWJyYWRpbyAqdHIgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXJldHVybiB2NGwyX3N1YmRldl9j
YWxsKHRyLT5zZF90dW5lciwgdHVuZXIsIHNfdHVuZXIsIHYpOwogfQogCi1zdGF0aWMgaW50IHRp
bWJyYWRpb192aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
Ci0JY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQorc3RhdGljIGludCB0aW1icmFkaW9f
dmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpm
KQogewogCXN0cnVjdCB0aW1icmFkaW8gKnRyID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlyZXR1
cm4gdjRsMl9zdWJkZXZfY2FsbCh0ci0+c2RfdHVuZXIsIHR1bmVyLCBzX2ZyZXF1ZW5jeSwgZik7
CiB9CiAKLXN0YXRpYyBpbnQgdGltYnJhZGlvX3ZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCitzdGF0aWMg
aW50IHRpbWJyYWRpb192aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCQlzdHJ1Y3QgdjRsMl9mcmVx
dWVuY3kgKmYpCiB7CiAJc3RydWN0IHRpbWJyYWRpbyAqdHIgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKHRyLT5zZF90dW5lciwgdHVuZXIsIGdfZnJlcXVl
bmN5LCBmKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcmFkaW8vc2k0NzB4L3JhZGlvLXNp
NDcweC1jb21tb24uYyBiL2RyaXZlcnMvbWVkaWEvcmFkaW8vc2k0NzB4L3JhZGlvLXNpNDcweC1j
b21tb24uYwppbmRleCBhZjBhNzA5MTAwOTk0YzFjMzlhODNhYzZmY2FiZWZlYmYyNzgzNDU5Li4y
NmQ1MTU5MDNlYTU4M2ExNzQ3NjA1OTU2NzgyNGI2MGE5YmIyYjY5IDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3JhZGlvL3NpNDcweC9yYWRpby1zaTQ3MHgtY29tbW9uLmMKKysrIGIvZHJpdmVy
cy9tZWRpYS9yYWRpby9zaTQ3MHgvcmFkaW8tc2k0NzB4LWNvbW1vbi5jCkBAIC01OTcsOCArNTk3
LDggQEAgc3RhdGljIGludCBzaTQ3MHhfc19jdHJsKHN0cnVjdCB2NGwyX2N0cmwgKmN0cmwpCiAv
KgogICogc2k0NzB4X3ZpZGlvY19nX3R1bmVyIC0gZ2V0IHR1bmVyIGF0dHJpYnV0ZXMKICAqLwot
c3RhdGljIGludCBzaTQ3MHhfdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCi0JCXN0cnVjdCB2NGwyX3R1bmVyICp0dW5lcikKK3N0YXRpYyBpbnQgc2k0NzB4X3Zp
ZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJfdHVuZXIgKnR1bmVyKQogewogCXN0cnVjdCBzaTQ3
MHhfZGV2aWNlICpyYWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJaW50IHJldHZhbCA9IDA7
CkBAIC02NTcsNyArNjU3LDggQEAgc3RhdGljIGludCBzaTQ3MHhfdmlkaW9jX2dfdHVuZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAvKgogICogc2k0NzB4X3ZpZGlvY19zX3R1bmVy
IC0gc2V0IHR1bmVyIGF0dHJpYnV0ZXMKICAqLwotc3RhdGljIGludCBzaTQ3MHhfdmlkaW9jX3Nf
dHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHNpNDcweF92
aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCWNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0dW5lcikKIHsKIAlz
dHJ1Y3Qgc2k0NzB4X2RldmljZSAqcmFkaW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNjgz
LDggKzY4NCw4IEBAIHN0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogLyoKICAqIHNpNDcweF92aWRpb2NfZ19mcmVxdWVuY3kgLSBn
ZXQgdHVuZXIgb3IgbW9kdWxhdG9yIHJhZGlvIGZyZXF1ZW5jeQogICovCi1zdGF0aWMgaW50IHNp
NDcweF92aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0J
CXN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZnJlcSkKK3N0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19n
X2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmZyZXEpCiB7CiAJc3RydWN0
IHNpNDcweF9kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtNjk5LDcg
KzcwMCw4IEBAIHN0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIC8qCiAgKiBzaTQ3MHhfdmlkaW9jX3NfZnJlcXVlbmN5IC0g
c2V0IHR1bmVyIG9yIG1vZHVsYXRvciByYWRpbyBmcmVxdWVuY3kKICAqLwotc3RhdGljIGludCBz
aTQ3MHhfdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCBzaTQ3MHhfdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCWNvbnN0IHN0cnVj
dCB2NGwyX2ZyZXF1ZW5jeSAqZnJlcSkKIHsKIAlzdHJ1Y3Qgc2k0NzB4X2RldmljZSAqcmFkaW8g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzIyLDcgKzcyNCw4IEBAIHN0YXRpYyBpbnQgc2k0
NzB4X3ZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIC8q
CiAgKiBzaTQ3MHhfdmlkaW9jX3NfaHdfZnJlcV9zZWVrIC0gc2V0IGhhcmR3YXJlIGZyZXF1ZW5j
eSBzZWVrCiAgKi8KLXN0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19zX2h3X2ZyZXFfc2VlayhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19zX2h3
X2ZyZXFfc2VlayhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCWNvbnN0IHN0cnVjdCB2NGwyX2h3X2ZyZXFfc2VlayAqc2VlaykKIHsK
IAlzdHJ1Y3Qgc2k0NzB4X2RldmljZSAqcmFkaW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
NzM5LDcgKzc0Miw4IEBAIHN0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19zX2h3X2ZyZXFfc2Vlayhz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIC8qCiAgKiBzaTQ3MHhfdmlkaW9jX2VudW1f
ZnJlcV9iYW5kcyAtIGVudW1lcmF0ZSBzdXBwb3J0ZWQgYmFuZHMKICAqLwotc3RhdGljIGludCBz
aTQ3MHhfdmlkaW9jX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJIHN0
cnVjdCB2NGwyX2ZyZXF1ZW5jeV9iYW5kICpiYW5kKQogewogCWlmIChiYW5kLT50dW5lciAhPSAw
KQpAQCAtNzU1LDEyICs3NTksMTMgQEAgY29uc3Qgc3RydWN0IHY0bDJfY3RybF9vcHMgc2k0NzB4
X2N0cmxfb3BzID0gewogfTsKIEVYUE9SVF9TWU1CT0xfR1BMKHNpNDcweF9jdHJsX29wcyk7CiAK
LXN0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgc2k0NzB4X3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQlzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICpjYXBhYmlsaXR5KQogewogCXN0cnVjdCBzaTQ3MHhfZGV2aWNlICpy
YWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKLQlyZXR1cm4gcmFkaW8tPnZpZGlvY19xdWVy
eWNhcChmaWxlLCBwcml2LCBjYXBhYmlsaXR5KTsKKwlyZXR1cm4gcmFkaW8tPnZpZGlvY19xdWVy
eWNhcChmaWxlLCBzdGF0ZSwgY2FwYWJpbGl0eSk7CiB9OwogCiAvKgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9tZWRpYS9yYWRpby9zaTQ3MTMvcmFkaW8tcGxhdGZvcm0tc2k0NzEzLmMgYi9kcml2ZXJz
L21lZGlhL3JhZGlvL3NpNDcxMy9yYWRpby1wbGF0Zm9ybS1zaTQ3MTMuYwppbmRleCA0MTMyOTY4
MTEwZTNjNTRlODY2NDJiZWY0ODA3OTNlZTA2YWRiODgzLi45MDNlODkzMzZhZjQ3YzAzZGE5MjU4
ZDhhYjgyYTdhODY0N2Y1NDk0IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3JhZGlvL3NpNDcx
My9yYWRpby1wbGF0Zm9ybS1zaTQ3MTMuYworKysgYi9kcml2ZXJzL21lZGlhL3JhZGlvL3NpNDcx
My9yYWRpby1wbGF0Zm9ybS1zaTQ3MTMuYwpAQCAtNTUsNyArNTUsOCBAQCBzdGF0aWMgY29uc3Qg
c3RydWN0IHY0bDJfZmlsZV9vcGVyYXRpb25zIHJhZGlvX3NpNDcxM19mb3BzID0gewogLyogVmlk
ZW80TGludXggSW50ZXJmYWNlICovCiAKIC8qIHJhZGlvX3NpNDcxM19xdWVyeWNhcCAtIHF1ZXJ5
IGRldmljZSBjYXBhYmlsaXRpZXMgKi8KLXN0YXRpYyBpbnQgcmFkaW9fc2k0NzEzX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByYWRpb19zaTQ3MTNf
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXBhYmlsaXR5KQogewog
CXN0cnNjcHkoY2FwYWJpbGl0eS0+ZHJpdmVyLCAicmFkaW8tc2k0NzEzIiwgc2l6ZW9mKGNhcGFi
aWxpdHktPmRyaXZlcikpOwpAQCAtNzUsMzUgKzc2LDQwIEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0
IHY0bDJfZGV2aWNlICpnZXRfdjRsMl9kZXYoc3RydWN0IGZpbGUgKmZpbGUpCiAJcmV0dXJuICYo
KHN0cnVjdCByYWRpb19zaTQ3MTNfZGV2aWNlICopdmlkZW9fZHJ2ZGF0YShmaWxlKSktPnY0bDJf
ZGV2OwogfQogCi1zdGF0aWMgaW50IHJhZGlvX3NpNDcxM19nX21vZHVsYXRvcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9fc2k0NzEzX2dfbW9kdWxhdG9y
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfbW9kdWxhdG9yICp2bSkKIHsKIAlyZXR1cm4gdjRs
Ml9kZXZpY2VfY2FsbF91bnRpbF9lcnIoZ2V0X3Y0bDJfZGV2KGZpbGUpLCAwLCB0dW5lciwKIAkJ
CQkJICBnX21vZHVsYXRvciwgdm0pOwogfQogCi1zdGF0aWMgaW50IHJhZGlvX3NpNDcxM19zX21v
ZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9f
c2k0NzEzX3NfbW9kdWxhdG9yKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgY29uc3Qgc3RydWN0IHY0bDJfbW9kdWxh
dG9yICp2bSkKIHsKIAlyZXR1cm4gdjRsMl9kZXZpY2VfY2FsbF91bnRpbF9lcnIoZ2V0X3Y0bDJf
ZGV2KGZpbGUpLCAwLCB0dW5lciwKIAkJCQkJICBzX21vZHVsYXRvciwgdm0pOwogfQogCi1zdGF0
aWMgaW50IHJhZGlvX3NpNDcxM19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9fc2k0NzEzX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAg
c3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikKIHsKIAlyZXR1cm4gdjRsMl9kZXZpY2VfY2FsbF91
bnRpbF9lcnIoZ2V0X3Y0bDJfZGV2KGZpbGUpLCAwLCB0dW5lciwKIAkJCQkJICBnX2ZyZXF1ZW5j
eSwgdmYpOwogfQogCi1zdGF0aWMgaW50IHJhZGlvX3NpNDcxM19zX2ZyZXF1ZW5jeShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcmFkaW9fc2k0NzEzX3NfZnJlcXVl
bmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkgICAgY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikKIHsKIAly
ZXR1cm4gdjRsMl9kZXZpY2VfY2FsbF91bnRpbF9lcnIoZ2V0X3Y0bDJfZGV2KGZpbGUpLCAwLCB0
dW5lciwKIAkJCQkJICBzX2ZyZXF1ZW5jeSwgdmYpOwogfQogCi1zdGF0aWMgbG9uZyByYWRpb19z
aTQ3MTNfZGVmYXVsdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBsb25n
IHJhZGlvX3NpNDcxM19kZWZhdWx0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgYm9vbCB2YWxpZF9wcmlvLCB1bnNpZ25lZCBp
bnQgY21kLCB2b2lkICphcmcpCiB7CiAJcmV0dXJuIHY0bDJfZGV2aWNlX2NhbGxfdW50aWxfZXJy
KGdldF92NGwyX2RldihmaWxlKSwgMCwgY29yZSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEv
cmFkaW8vc2k0NzEzL3JhZGlvLXVzYi1zaTQ3MTMuYyBiL2RyaXZlcnMvbWVkaWEvcmFkaW8vc2k0
NzEzL3JhZGlvLXVzYi1zaTQ3MTMuYwppbmRleCAyY2YzNmM4YWJkZGVhY2RiNzBmMzVmZWFiODk5
NDI0NWNjNDNkMzJmLi5kNTY2ZDhiODQ4ZGI5N2Q4YTBlODk3ZGQyNzZlNjczNGFlM2RiZDU0IDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3JhZGlvL3NpNDcxMy9yYWRpby11c2Itc2k0NzEzLmMK
KysrIGIvZHJpdmVycy9tZWRpYS9yYWRpby9zaTQ3MTMvcmFkaW8tdXNiLXNpNDcxMy5jCkBAIC02
Miw3ICs2Miw4IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IHNpNDcxM191c2JfZGV2aWNlICp0b19z
aTQ3MTNfZGV2KHN0cnVjdCB2NGwyX2RldmljZSAqdjRsMl9kCiAJcmV0dXJuIGNvbnRhaW5lcl9v
Zih2NGwyX2Rldiwgc3RydWN0IHNpNDcxM191c2JfZGV2aWNlLCB2NGwyX2Rldik7CiB9CiAKLXN0
YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0
eSAqdikKIHsKIAlzdHJ1Y3Qgc2k0NzEzX3VzYl9kZXZpY2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTczLDcgKzc0LDggQEAgc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX2dfbW9kdWxhdG9yKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRpb2NfZ19tb2R1bGF0b3Ioc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9tb2R1bGF0b3Ig
KnZtKQogewogCXN0cnVjdCBzaTQ3MTNfdXNiX2RldmljZSAqcmFkaW8gPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtODEsNyArODMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX21vZHVsYXRvcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gdjRsMl9zdWJkZXZfY2FsbChy
YWRpby0+djRsMl9zdWJkZXYsIHR1bmVyLCBnX21vZHVsYXRvciwgdm0pOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19zX21vZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX3NfbW9kdWxhdG9yKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJY29uc3Qgc3RydWN0IHY0bDJf
bW9kdWxhdG9yICp2bSkKIHsKIAlzdHJ1Y3Qgc2k0NzEzX3VzYl9kZXZpY2UgKnJhZGlvID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTg5LDcgKzkyLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19t
b2R1bGF0b3Ioc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHY0bDJfc3Vi
ZGV2X2NhbGwocmFkaW8tPnY0bDJfc3ViZGV2LCB0dW5lciwgc19tb2R1bGF0b3IsIHZtKTsKIH0K
IAotc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0
cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqdmYpCiB7CiAJc3RydWN0IHNpNDcxM191c2JfZGV2aWNlICpy
YWRpbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05Nyw3ICsxMDEsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gdjRsMl9zdWJkZXZfY2FsbChyYWRpby0+djRsMl9zdWJkZXYsIHR1bmVyLCBzX2ZyZXF1ZW5j
eSwgdmYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikKIHsKIAlzdHJ1Y3Qgc2k0NzEzX3VzYl9kZXZp
Y2UgKnJhZGlvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvcmFkaW8vdGVhNTc1eC5jIGIvZHJpdmVycy9tZWRpYS9yYWRpby90ZWE1NzV4LmMKaW5kZXgg
YzM3MzE1MjI2YzQyN2FjM2UzODIwNTVlMGQzZjgwNTdkOGVmNjg3MC4uNjU5ZjQzYmIxZThkOWFl
OGUwOTZjOTNlNDE2NWZhOWU2YjkwMGZmYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9yYWRp
by90ZWE1NzV4LmMKKysrIGIvZHJpdmVycy9tZWRpYS9yYWRpby90ZWE1NzV4LmMKQEAgLTIxNyw3
ICsyMTcsOCBAQCBFWFBPUlRfU1lNQk9MKHNuZF90ZWE1NzV4X3NldF9mcmVxKTsKICAqIExpbnV4
IFZpZGVvIGludGVyZmFjZQogICovCiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKnYpCiB7CiAJc3RydWN0IHNuZF90ZWE1NzV4
ICp0ZWEgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjYyLDcgKzI2Myw4IEBAIGludCBzbmRf
dGVhNTc1eF9lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IHNuZF90ZWE1NzV4ICp0ZWEsCiB9CiBFWFBP
UlRfU1lNQk9MKHNuZF90ZWE1NzV4X2VudW1fZnJlcV9iYW5kcyk7CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0bDJfZnJlcXVl
bmN5X2JhbmQgKmJhbmQpCiB7CiAJc3RydWN0IHNuZF90ZWE1NzV4ICp0ZWEgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtMjk0LDcgKzI5Niw4IEBAIGludCBzbmRfdGVhNTc1eF9nX3R1bmVyKHN0
cnVjdCBzbmRfdGVhNTc1eCAqdGVhLCBzdHJ1Y3QgdjRsMl90dW5lciAqdikKIH0KIEVYUE9SVF9T
WU1CT0woc25kX3RlYTU3NXhfZ190dW5lcik7CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3R1bmVy
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkJc3RydWN0IHY0bDJfdHVuZXIgKnYpCiB7CiAJc3RydWN0IHNuZF90ZWE1NzV4ICp0
ZWEgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzAyLDcgKzMwNSw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHNu
ZF90ZWE1NzV4X2dfdHVuZXIodGVhLCB2KTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc190dW5l
cihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVu
ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCQljb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdikKIHsKIAlzdHJ1Y3Qgc25kX3Rl
YTU3NXggKnRlYSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zMjAsNyArMzI0LDggQEAgc3Rh
dGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHNuZF90ZWE1NzV4ICp0
ZWEgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMzMyLDcgKzMzNyw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
CWNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqZikKIHsKIAlzdHJ1Y3Qgc25kX3RlYTU3NXgg
KnRlYSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00NDAsNyArNDQ2LDggQEAgaW50IHNuZF90
ZWE1NzV4X3NfaHdfZnJlcV9zZWVrKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgc25kX3RlYTU3
NXggKnRlYSwKIH0KIEVYUE9SVF9TWU1CT0woc25kX3RlYTU3NXhfc19od19mcmVxX3NlZWspOwog
Ci1zdGF0aWMgaW50IHZpZGlvY19zX2h3X2ZyZXFfc2VlayhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCitzdGF0aWMgaW50IHZpZGlvY19zX2h3X2ZyZXFfc2VlayhzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCWNvbnN0IHN0
cnVjdCB2NGwyX2h3X2ZyZXFfc2VlayAqYSkKIHsKIAlzdHJ1Y3Qgc25kX3RlYTU3NXggKnRlYSA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJp
dmVycy92aWNvZGVjL3ZpY29kZWMtY29yZS5jIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMv
dmljb2RlYy92aWNvZGVjLWNvcmUuYwppbmRleCBhM2RmM2EzMzIzN2UyZjJiMjJiNzRkNWI2NTA2
NWY5NTJiOWE3OGQ4Li5kZjVkNjk2OWVhMDJlNDRjOWIwZTQ4OWEwYjE5ZTY5NzUxZjQyMWYzIDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aWNvZGVjL3ZpY29kZWMtY29y
ZS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpY29kZWMvdmljb2RlYy1jb3Jl
LmMKQEAgLTY5NCw3ICs2OTQsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZndodF9waXhm
bXRfaW5mbyAqZmluZF9mbXQodTMyIGZtdCkKIAlyZXR1cm4gaW5mbzsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2Fw
KQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIFZJQ09ERUNfTkFNRSwgc2l6ZW9mKGNhcC0+ZHJp
dmVyKSk7CkBAIC03NDIsNyArNzQzLDggQEAgc3RhdGljIGludCBlbnVtX2ZtdChzdHJ1Y3QgdjRs
Ml9mbXRkZXNjICpmLCBzdHJ1Y3Qgdmljb2RlY19jdHggKmN0eCwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAg
c3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3Qgdmljb2RlY19jdHggKmN0eCA9IGZp
bGUyY3R4KGZpbGUpOwpAQCAtNzUwLDcgKzc1Miw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1f
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGVudW1f
Zm10KGYsIGN0eCwgZmFsc2UpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRf
b3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51
bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0
cnVjdCB2aWNvZGVjX2N0eCAqY3R4ID0gZmlsZTJjdHgoZmlsZSk7CkBAIC04MTYsMTMgKzgxOSwx
NSBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdChzdHJ1Y3Qgdmljb2RlY19jdHggKmN0eCwgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19n
X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aWRpb2NfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJcmV0
dXJuIHZpZGlvY19nX2ZtdChmaWxlMmN0eChmaWxlKSwgZik7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlyZXR1cm4gdmlkaW9jX2dfZm10KGZpbGUyY3R4KGZpbGUpLCBmKTsKQEAgLTg4OSw3ICs4OTQs
OCBAQCBzdGF0aWMgaW50IHZpZGlvY190cnlfZm10KHN0cnVjdCB2aWNvZGVjX2N0eCAqY3R4LCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogewogCXN0cnVjdCB2aWNvZGVjX2N0eCAqY3R4ID0gZmlsZTJjdHgoZmlsZSk7CkBAIC05MjYs
NyArOTMyLDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB2aWRpb2NfdHJ5X2ZtdChjdHgsIGYpOwogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgdmljb2RlY19jdHggKmN0eCA9IGZpbGUy
Y3R4KGZpbGUpOwpAQCAtMTA0MiwxOSArMTA0OSwyMSBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2Zt
dChzdHJ1Y3Qgdmljb2RlY19jdHggKmN0eCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJaW50IHJldDsKIAotCXJldCA9IHZpZGlvY190cnlf
Zm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwgZik7CisJcmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX2Nh
cChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIAogCXJldHVybiB2
aWRpb2Nfc19mbXQoZmlsZTJjdHgoZmlsZSksIGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19z
X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aWRpb2Nfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHZpY29kZWNfY3R4ICpjdHggPSBmaWxlMmN0eChmaWxlKTsKQEAgLTEwNjksNyArMTA3OCw3
IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcV9kYXRhID0gZ2V0X3FfZGF0YShjdHgsIGYtPnR5cGUpOwogCXFfZGF0YV9j
YXAgPSBnZXRfcV9kYXRhKGN0eCwgVjRMMl9CVUZfVFlQRV9WSURFT19DQVBUVVJFKTsKIAotCXJl
dCA9IHZpZGlvY190cnlfZm10X3ZpZF9vdXQoZmlsZSwgcHJpdiwgZik7CisJcmV0ID0gdmlkaW9j
X3RyeV9mbXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJl
dDsKIApAQCAtMTEzMSw3ICsxMTQwLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX291
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0
aWMgaW50IHZpZGlvY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRs
Ml9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IHZpY29kZWNfY3R4ICpjdHggPSBmaWxlMmN0eChm
aWxlKTsKQEAgLTExODAsNyArMTE5MCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9u
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAtRUlOVkFMOwogfQogCi1z
dGF0aWMgaW50IHZpZGlvY19zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3Qg
djRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IHZpY29kZWNfY3R4ICpjdHggPSBmaWxlMmN0
eChmaWxlKTsKQEAgLTEyMDcsMjAgKzEyMTgsMjEgQEAgc3RhdGljIGludCB2aWRpb2Nfc19zZWxl
Y3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdmljb2RlY19lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmljb2RlY19lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3Qg
djRsMl9lbmNvZGVyX2NtZCAqZWMpCiB7CiAJc3RydWN0IHZpY29kZWNfY3R4ICpjdHggPSBmaWxl
MmN0eChmaWxlKTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gdjRsMl9tMm1faW9jdGxfdHJ5X2VuY29k
ZXJfY21kKGZpbGUsIHByaXYsIGVjKTsKKwlyZXQgPSB2NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rl
cl9jbWQoZmlsZSwgc3RhdGUsIGVjKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIAog
CWlmICghdmIyX2lzX3N0cmVhbWluZygmY3R4LT5maC5tMm1fY3R4LT5vdXRfcV9jdHgucSkpCiAJ
CXJldHVybiAwOwogCi0JcmV0ID0gdjRsMl9tMm1faW9jdGxfZW5jb2Rlcl9jbWQoZmlsZSwgcHJp
diwgZWMpOworCXJldCA9IHY0bDJfbTJtX2lvY3RsX2VuY29kZXJfY21kKGZpbGUsIHN0YXRlLCBl
Yyk7CiAJaWYgKHJldCA8IDApCiAJCXJldHVybiByZXQ7CiAKQEAgLTEyMzUsNyArMTI0Nyw4IEBA
IHN0YXRpYyBpbnQgdmljb2RlY19lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWNvZGVjX2RlY29kZXJfY21kKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWNvZGVjX2RlY29kZXJf
Y21kKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX2RlY29kZXJfY21kICpkYykKIHsKIAlzdHJ1
Y3Qgdmljb2RlY19jdHggKmN0eCA9IGZpbGUyY3R4KGZpbGUpOwpAQCAtMTI0NywxNCArMTI2MCwx
NCBAQCBzdGF0aWMgaW50IHZpY29kZWNfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJICovCiAJV0FSTl9PTihjdHgtPmlzX3N0YXRlbGVzcyk7CiAKLQlyZXQgPSB2
NGwyX20ybV9pb2N0bF90cnlfZGVjb2Rlcl9jbWQoZmlsZSwgcHJpdiwgZGMpOworCXJldCA9IHY0
bDJfbTJtX2lvY3RsX3RyeV9kZWNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgZGMpOwogCWlmIChyZXQg
PCAwKQogCQlyZXR1cm4gcmV0OwogCiAJaWYgKCF2YjJfaXNfc3RyZWFtaW5nKCZjdHgtPmZoLm0y
bV9jdHgtPm91dF9xX2N0eC5xKSkKIAkJcmV0dXJuIDA7CiAKLQlyZXQgPSB2NGwyX20ybV9pb2N0
bF9kZWNvZGVyX2NtZChmaWxlLCBwcml2LCBkYyk7CisJcmV0ID0gdjRsMl9tMm1faW9jdGxfZGVj
b2Rlcl9jbWQoZmlsZSwgc3RhdGUsIGRjKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsK
IApAQCAtMTI2OSw3ICsxMjgyLDggQEAgc3RhdGljIGludCB2aWNvZGVjX2RlY29kZXJfY21kKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpY29kZWNfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCB2aWNvZGVjX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRs
Ml9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3dpdGNoIChmc2l6ZS0+cGl4ZWxfZm9ybWF0KSB7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aW0ybS5jIGIvZHJpdmVy
cy9tZWRpYS90ZXN0LWRyaXZlcnMvdmltMm0uYwppbmRleCA4NmMzMjY5OTExMWFkYzgzOGQ0MzA0
ZWMwYzBmMDAyNmRiMTI4ZDcwLi5jODk4OTBiZmVkZTVmZTE4MThmZDJkNGIwYjQ3NDlhYWE4MTVm
MzNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aW0ybS5jCisrKyBi
L2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpbTJtLmMKQEAgLTY0OCw3ICs2NDgsOCBAQCBz
dGF0aWMgdm9pZCBkZXZpY2Vfd29yayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKncpCiAvKgogICogdmlk
ZW8gaW9jdGxzCiAgKi8KLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0
cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBNRU0y
TUVNX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtNjg5LDE5ICs2OTAsMjIgQEAgc3Rh
dGljIGludCBlbnVtX2ZtdChzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmLCB1MzIgdHlwZSkKIAlyZXR1
cm4gLUVJTlZBTDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlyZXR1cm4gZW51
bV9mbXQoZiwgTUVNMk1FTV9DQVBUVVJFKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9m
bXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlk
aW9jX2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikK
IHsKIAlyZXR1cm4gZW51bV9mbXQoZiwgTUVNMk1FTV9PVVRQVVQpOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJ
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zy
bXNpemVlbnVtICpmc2l6ZSkKIHsKIAlpZiAoZnNpemUtPmluZGV4ICE9IDApCkBAIC03NzgsNyAr
NzgyLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXRfbXBsYW5lKHN0cnVjdCB2aW0ybV9jdHgg
KmN0eCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCB2aWRpb2NfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IHZpbTJtX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc4
OSw3ICs3OTQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB2aWRpb2NfZ19mbXQoZmlsZTJjdHgoZmlsZSks
IGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpbTJtX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTgwMCw3ICs4MDYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB2aWRpb2Nf
Z19mbXQoZmlsZTJjdHgoZmlsZSksIGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92
aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
dmlkaW9jX2dfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aW0ybV9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CkBAIC04MTEsNyArODE4LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX291
dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHZpZGlvY19n
X2ZtdF9tcGxhbmUoZmlsZTJjdHgoZmlsZSksIGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19n
X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aW0ybV9kZXYgKmRldiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC04NDgsNyArODU2LDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2Zt
dChzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYsIGJvb2wgaXNfbXBsYW5lKQogCXJldHVybiByZXQ7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aW0ybV9mbXQgKmZtdDsKQEAgLTg3
Nyw3ICs4ODYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHZpZGlvY190cnlfZm10KGYsIGZhbHNlKTsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcF9t
cGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdmltMm1f
Zm10ICpmbXQ7CkBAIC05MDYsNyArOTE2LDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92
aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gdmlk
aW9jX3RyeV9mbXQoZiwgdHJ1ZSk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlk
X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3Ry
eV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCB2aW0ybV9mbXQgKmZtdDsKQEAgLTkzMyw3ICs5NDQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY190
cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHZp
ZGlvY190cnlfZm10KGYsIGZhbHNlKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92
aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
dmlkaW9jX3RyeV9mbXRfdmlkX291dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgdmltMm1fZm10ICpmbXQ7CkBAIC0xMDA3LDcgKzEwMTksOCBAQCBz
dGF0aWMgaW50IHZpZGlvY19zX2ZtdChzdHJ1Y3QgdmltMm1fY3R4ICpjdHgsIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3Nf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCWludCByZXQ7CkBA
IC0xMDE2LDE0ICsxMDI5LDE1IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKGRldi0+bXVsdGlwbGFuYXIpCiAJCXJl
dHVybiAtRU5PVFRZOwogCi0JcmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBwcml2
LCBmKTsKKwlyZXQgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlp
ZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCiAJcmV0dXJuIHZpZGlvY19zX2ZtdChmaWxlMmN0eChm
aWxlKSwgZik7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXBfbXBsYW5lKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlk
X2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJaW50IHJldDsKQEAgLTEwMzIsMTQgKzEwNDYsMTUgQEAgc3RhdGljIGludCB2aWRpb2Nfc19m
bXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKCFk
ZXYtPm11bHRpcGxhbmFyKQogCQlyZXR1cm4gLUVOT1RUWTsKIAotCXJldCA9IHZpZGlvY190cnlf
Zm10X3ZpZF9jYXBfbXBsYW5lKGZpbGUsIHByaXYsIGYpOworCXJldCA9IHZpZGlvY190cnlfZm10
X3ZpZF9jYXBfbXBsYW5lKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0
OwogCiAJcmV0dXJuIHZpZGlvY19zX2ZtdChmaWxlMmN0eChmaWxlKSwgZik7CiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgdmltMm1fY3R4ICpjdHggPSBmaWxlMmN0eChmaWxlKTsKQEAgLTEw
NDksNyArMTA2NCw3IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKGRldi0+bXVsdGlwbGFuYXIpCiAJCXJldHVybiAt
RU5PVFRZOwogCi0JcmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX291dChmaWxlLCBwcml2LCBmKTsK
KwlyZXQgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0KGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0
KQogCQlyZXR1cm4gcmV0OwogCkBAIC0xMDYzLDcgKzEwNzgsOCBAQCBzdGF0aWMgaW50IHZpZGlv
Y19zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBy
ZXQ7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX291dF9t
cGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHZpbTJtX2N0eCAqY3R4ID0gZmlsZTJjdHgoZmlsZSk7CkBAIC0xMDczLDcgKzEwODksNyBA
QCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAlpZiAoIWRldi0+bXVsdGlwbGFuYXIpCiAJCXJldHVybiAtRU5PVFRZ
OwogCi0JcmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX291dF9tcGxhbmUoZmlsZSwgcHJpdiwgZik7
CisJcmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX291dF9tcGxhbmUoZmlsZSwgc3RhdGUsIGYpOwog
CWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVz
dC1kcml2ZXJzL3ZpbWMvdmltYy1jYXB0dXJlLmMgYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVy
cy92aW1jL3ZpbWMtY2FwdHVyZS5jCmluZGV4IDdmNjEyNDAyNWZjOWRjOTcxNjI1MTU2NWM1MDRi
YzMzYWQ4MWIzNDUuLjQ0N2E3NmE1NWU2OGUwY2Y3OWEzMDg3MTY0ZDYwMmU0OTNkY2U0Y2QgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpbWMvdmltYy1jYXB0dXJlLmMK
KysrIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdmltYy92aW1jLWNhcHR1cmUuYwpAQCAt
NTIsNyArNTIsOCBAQCBzdHJ1Y3QgdmltY19jYXB0dXJlX2J1ZmZlciB7CiAJc3RydWN0IGxpc3Rf
aGVhZCBsaXN0OwogfTsKIAotc3RhdGljIGludCB2aW1jX2NhcHR1cmVfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpbWNfY2FwdHVyZV9xdWVyeWNh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJzY3B5KGNh
cC0+ZHJpdmVyLCBWSU1DX1BERVZfTkFNRSwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7CkBAIC03MCw3
ICs3MSw4IEBAIHN0YXRpYyB2b2lkIHZpbWNfY2FwdHVyZV9nZXRfZm9ybWF0KHN0cnVjdCB2aW1j
X2VudF9kZXZpY2UgKnZlZCwKIAkqZm10ID0gdmNhcHR1cmUtPmZvcm1hdDsKIH0KIAotc3RhdGlj
IGludCB2aW1jX2NhcHR1cmVfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgdmltY19jYXB0dXJlX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpbWNfY2FwdHVyZV9kZXZpY2Ug
KnZjYXB0dXJlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTgwLDcgKzgyLDggQEAgc3RhdGlj
IGludCB2aW1jX2NhcHR1cmVfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aW1jX2NhcHR1cmVfdHJ5X2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aW1jX2Nh
cHR1cmVfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCXN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKmZvcm1hdCA9ICZmLT5mbXQucGl4OwpAQCAtMTEy
LDcgKzExNSw4IEBAIHN0YXRpYyBpbnQgdmltY19jYXB0dXJlX3RyeV9mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2
aW1jX2NhcHR1cmVfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmltY19jYXB0dXJlX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpbWNfY2FwdHVyZV9kZXZpY2UgKnZjYXB0
dXJlID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEyMiw3ICsxMjYsNyBAQCBzdGF0aWMgaW50
IHZpbWNfY2FwdHVyZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogCWlmICh2YjJfaXNfYnVzeSgmdmNhcHR1cmUtPnF1ZXVlKSkKIAkJcmV0dXJuIC1FQlVTWTsK
IAotCXJldCA9IHZpbWNfY2FwdHVyZV90cnlfZm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwgZik7CisJ
cmV0ID0gdmltY19jYXB0dXJlX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7CiAJaWYg
KHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMTQ1LDcgKzE0OSw4IEBAIHN0YXRpYyBpbnQgdmlt
Y19jYXB0dXJlX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmltY19jYXB0dXJlX2VudW1fZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpbWNfY2FwdHVyZV9l
bnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewog
CWNvbnN0IHN0cnVjdCB2aW1jX3BpeF9tYXAgKnZwaXg7CkBAIC0xNjcsNyArMTcyLDggQEAgc3Rh
dGljIGludCB2aW1jX2NhcHR1cmVfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aW1jX2NhcHR1cmVfZW51
bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aW1jX2NhcHR1cmVfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQlzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZnJtc2l6
ZWVudW0gKmZzaXplKQogewogCWNvbnN0IHN0cnVjdCB2aW1jX3BpeF9tYXAgKnZwaXg7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXNsL3Zpc2wtdmlkZW8uYyBiL2Ry
aXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3Zpc2wvdmlzbC12aWRlby5jCmluZGV4IDhiZTUwNWQ4
OTA4Yzk4YmI1MDExOGRmYTJmNDkxZDVhYzY4NzcyZWMuLmJjYmE1OTU5NDMyZGYyNGQ0MDExYzNi
ZTIwYzNhY2QyMjY1NDA5OTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJz
L3Zpc2wvdmlzbC12aWRlby5jCisrKyBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3Zpc2wv
dmlzbC12aWRlby5jCkBAIC0zMzIsNyArMzMyLDggQEAgc3RhdGljIHN0cnVjdCB2aXNsX3FfZGF0
YSAqZ2V0X3FfZGF0YShzdHJ1Y3QgdmlzbF9jdHggKmN0eCwKIAlyZXR1cm4gTlVMTDsKIH0KIAot
c3RhdGljIGludCB2aXNsX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCB2aXNsX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNh
cCkKIHsKIAlzdHJzY3B5KGNhcC0+ZHJpdmVyLCBWSVNMX05BTUUsIHNpemVvZihjYXAtPmRyaXZl
cikpOwpAQCAtMzQzLDcgKzM0NCw4IEBAIHN0YXRpYyBpbnQgdmlzbF9xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aXNs
X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpc2xfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYp
CiB7CiAJc3RydWN0IHZpc2xfY3R4ICpjdHggPSB2aXNsX2ZpbGVfdG9fY3R4KGZpbGUpOwpAQCAt
MzY1LDcgKzM2Nyw4IEBAIHN0YXRpYyBpbnQgdmlzbF9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpc2xf
ZW51bV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlzbF9lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikK
IHsKIAlpZiAoZi0+aW5kZXggPj0gQVJSQVlfU0laRSh2aXNsX2NvZGVkX2ZtdHMpKQpAQCAtMzc1
LDcgKzM3OCw4IEBAIHN0YXRpYyBpbnQgdmlzbF9lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpc2xfZ19m
bXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlz
bF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHZpc2xfY3R4ICpjdHggPSB2aXNsX2ZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtMzg0
LDcgKzM4OCw4IEBAIHN0YXRpYyBpbnQgdmlzbF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpc2xfZ19mbXRf
dmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlzbF9n
X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJ
c3RydWN0IHZpc2xfY3R4ICpjdHggPSB2aXNsX2ZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtMzkzLDcg
KzM5OCw4IEBAIHN0YXRpYyBpbnQgdmlzbF9nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpc2xfdHJ5X2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aXNsX3Ry
eV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHY0
bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeF9tcCA9ICZmLT5mbXQucGl4X21wOwpAQCAtNDIzLDcg
KzQyOSw4IEBAIHN0YXRpYyBpbnQgdmlzbF90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlzbF90cnlfZm10
X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpc2xf
dHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
djRsMl9waXhfZm9ybWF0X21wbGFuZSAqcGl4X21wID0gJmYtPmZtdC5waXhfbXA7CkBAIC00NDks
NyArNDU2LDggQEAgc3RhdGljIGludCB2aXNsX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aXNsX3NfZm10
X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpc2xf
c19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CXN0cnVjdCB2aXNsX2N0eCAqY3R4ID0gdmlzbF9maWxlX3RvX2N0eChmaWxlKTsKQEAgLTQ2NSw3
ICs0NzMsNyBAQCBzdGF0aWMgaW50IHZpc2xfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKIAlkcHJpbnRrKGN0eC0+ZGV2LCAiVHJ5aW5nIHRvIHNldCB0aGUgT1VU
UFVUIGZvcm1hdCB0bzpcbiIpOwogCXZpc2xfcHJpbnRfZm10KGN0eCwgZik7CiAKLQlyZXQgPSB2
aXNsX3RyeV9mbXRfdmlkX291dChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSB2aXNsX3RyeV9mbXRf
dmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAt
NDg5LDcgKzQ5Nyw4IEBAIHN0YXRpYyBpbnQgdmlzbF9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpc2xfc19m
bXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlz
bF9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHZpc2xfY3R4ICpjdHggPSB2aXNsX2ZpbGVfdG9fY3R4KGZpbGUpOwpAQCAtNDk4
LDcgKzUwNyw3IEBAIHN0YXRpYyBpbnQgdmlzbF9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCWRwcmludGsoY3R4LT5kZXYsICJUcnlpbmcgdG8gc2V0IHRoZSBD
QVBUVVJFIGZvcm1hdCB0bzpcbiIpOwogCXZpc2xfcHJpbnRfZm10KGN0eCwgZik7CiAKLQlyZXQg
PSB2aXNsX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBwcml2LCBmKTsKKwlyZXQgPSB2aXNsX3RyeV9m
bXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApA
QCAtNTExLDcgKzUyMCw4IEBAIHN0YXRpYyBpbnQgdmlzbF9zX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpc2xf
ZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aXNsX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNp
emUpCiB7CiAJY29uc3Qgc3RydWN0IHZpc2xfY29kZWRfZm9ybWF0X2Rlc2MgKmZtdDsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLWNvcmUuYyBiL2Ry
aXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLWNvcmUuYwppbmRleCA4NjUwNmJl
MzZhY2IwY2ZhY2VkZTVmMDAwYjk1YzBiYzQ5MWFiNWE4Li5kMjRjMDZkYmFlNWVjMzhlOTI1NGEz
MDljM2QwODY5YzQ4ZjQ1ZjM0IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVy
cy92aXZpZC92aXZpZC1jb3JlLmMKKysrIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2
aWQvdml2aWQtY29yZS5jCkBAIC0yNTgsNyArMjU4LDggQEAgc3RhdGljIGNvbnN0IHU4IHZpdmlk
X2hkbWlfZWRpZFsyNTZdID0gewogCTB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAs
IDB4MDAsIDB4OTIsCiB9OwogCi1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CQlzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTI3Nyw0OSArMjc4LDU3IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19od19mcmVxX3NlZWsoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2h3X2ZyZXFfc2VlayAqYSkKK3N0YXRp
YyBpbnQgdmlkaW9jX3NfaHdfZnJlcV9zZWVrKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgY29uc3Qgc3RydWN0IHY0bDJfaHdf
ZnJlcV9zZWVrICphKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZk
YXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZmbF90eXBlID09IFZGTF9UWVBFX1JBRElPKQotCQly
ZXR1cm4gdml2aWRfcmFkaW9fcnhfc19od19mcmVxX3NlZWsoZmlsZSwgcHJpdiwgYSk7CisJCXJl
dHVybiB2aXZpZF9yYWRpb19yeF9zX2h3X2ZyZXFfc2VlayhmaWxlLCBzdGF0ZSwgYSk7CiAJcmV0
dXJuIC1FTk9UVFk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJlcV9iYW5kcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJlcXVlbmN5X2JhbmQgKmJh
bmQpCitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCB2
NGwyX2ZyZXF1ZW5jeV9iYW5kICpiYW5kKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYg
PSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZmbF90eXBlID09IFZGTF9UWVBF
X1JBRElPKQotCQlyZXR1cm4gdml2aWRfcmFkaW9fcnhfZW51bV9mcmVxX2JhbmRzKGZpbGUsIHBy
aXYsIGJhbmQpOworCQlyZXR1cm4gdml2aWRfcmFkaW9fcnhfZW51bV9mcmVxX2JhbmRzKGZpbGUs
IHN0YXRlLCBiYW5kKTsKIAlpZiAodmRldi0+dmZsX3R5cGUgPT0gVkZMX1RZUEVfU0RSKQotCQly
ZXR1cm4gdml2aWRfc2RyX2VudW1fZnJlcV9iYW5kcyhmaWxlLCBwcml2LCBiYW5kKTsKKwkJcmV0
dXJuIHZpdmlkX3Nkcl9lbnVtX2ZyZXFfYmFuZHMoZmlsZSwgc3RhdGUsIGJhbmQpOwogCXJldHVy
biAtRU5PVFRZOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCitzdGF0aWMgaW50IHZpZGlv
Y19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQogewogCXN0cnVjdCB2aWRlb19kZXZp
Y2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZmbF90eXBlID09
IFZGTF9UWVBFX1JBRElPKQotCQlyZXR1cm4gdml2aWRfcmFkaW9fcnhfZ190dW5lcihmaWxlLCBw
cml2LCB2dCk7CisJCXJldHVybiB2aXZpZF9yYWRpb19yeF9nX3R1bmVyKGZpbGUsIHN0YXRlLCB2
dCk7CiAJaWYgKHZkZXYtPnZmbF90eXBlID09IFZGTF9UWVBFX1NEUikKLQkJcmV0dXJuIHZpdmlk
X3Nkcl9nX3R1bmVyKGZpbGUsIHByaXYsIHZ0KTsKLQlyZXR1cm4gdml2aWRfdmlkZW9fZ190dW5l
cihmaWxlLCBwcml2LCB2dCk7CisJCXJldHVybiB2aXZpZF9zZHJfZ190dW5lcihmaWxlLCBzdGF0
ZSwgdnQpOworCXJldHVybiB2aXZpZF92aWRlb19nX3R1bmVyKGZpbGUsIHN0YXRlLCB2dCk7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2dCkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVu
ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJICBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCiB7CiAJc3RydWN0IHZpZGVvX2Rldmlj
ZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKIAlpZiAodmRldi0+dmZsX3R5cGUgPT0g
VkZMX1RZUEVfUkFESU8pCi0JCXJldHVybiB2aXZpZF9yYWRpb19yeF9zX3R1bmVyKGZpbGUsIHBy
aXYsIHZ0KTsKKwkJcmV0dXJuIHZpdmlkX3JhZGlvX3J4X3NfdHVuZXIoZmlsZSwgc3RhdGUsIHZ0
KTsKIAlpZiAodmRldi0+dmZsX3R5cGUgPT0gVkZMX1RZUEVfU0RSKQotCQlyZXR1cm4gdml2aWRf
c2RyX3NfdHVuZXIoZmlsZSwgcHJpdiwgdnQpOwotCXJldHVybiB2aXZpZF92aWRlb19zX3R1bmVy
KGZpbGUsIHByaXYsIHZ0KTsKKwkJcmV0dXJuIHZpdmlkX3Nkcl9zX3R1bmVyKGZpbGUsIHN0YXRl
LCB2dCk7CisJcmV0dXJuIHZpdmlkX3ZpZGVvX3NfdHVuZXIoZmlsZSwgc3RhdGUsIHZ0KTsKIH0K
IAotc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqdmYpCitzdGF0aWMgaW50IHZpZGlvY19nX2Zy
ZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJICAgICAgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikKIHsKIAlz
dHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2aWRl
b19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMzI5LDExICszMzgsMTMg
QEAgc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHN0cnVjdCB2NGwyX2ZyZXF1ZW4KIAkJCXZkZXYtPnZmbF9kaXIgPT0gVkZMX0RJUl9S
WCA/CiAJCQkmZGV2LT5yYWRpb19yeF9mcmVxIDogJmRldi0+cmFkaW9fdHhfZnJlcSwgdmYpOwog
CWlmICh2ZGV2LT52ZmxfdHlwZSA9PSBWRkxfVFlQRV9TRFIpCi0JCXJldHVybiB2aXZpZF9zZHJf
Z19mcmVxdWVuY3koZmlsZSwgcHJpdiwgdmYpOwotCXJldHVybiB2aXZpZF92aWRlb19nX2ZyZXF1
ZW5jeShmaWxlLCBwcml2LCB2Zik7CisJCXJldHVybiB2aXZpZF9zZHJfZ19mcmVxdWVuY3koZmls
ZSwgc3RhdGUsIHZmKTsKKwlyZXR1cm4gdml2aWRfdmlkZW9fZ19mcmVxdWVuY3koZmlsZSwgc3Rh
dGUsIHZmKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqdmYpCitzdGF0
aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgY29uc3Qgc3RydWN0IHY0
bDJfZnJlcXVlbmN5ICp2ZikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZp
bGUpOwpAQCAtMzQzLDExMyArMzU0LDEyNSBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1ZW5j
eShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJfZgogCQkJ
dmRldi0+dmZsX2RpciA9PSBWRkxfRElSX1JYID8KIAkJCSZkZXYtPnJhZGlvX3J4X2ZyZXEgOiAm
ZGV2LT5yYWRpb190eF9mcmVxLCB2Zik7CiAJaWYgKHZkZXYtPnZmbF90eXBlID09IFZGTF9UWVBF
X1NEUikKLQkJcmV0dXJuIHZpdmlkX3Nkcl9zX2ZyZXF1ZW5jeShmaWxlLCBwcml2LCB2Zik7Ci0J
cmV0dXJuIHZpdmlkX3ZpZGVvX3NfZnJlcXVlbmN5KGZpbGUsIHByaXYsIHZmKTsKKwkJcmV0dXJu
IHZpdmlkX3Nkcl9zX2ZyZXF1ZW5jeShmaWxlLCBzdGF0ZSwgdmYpOworCXJldHVybiB2aXZpZF92
aWRlb19zX2ZyZXF1ZW5jeShmaWxlLCBzdGF0ZSwgdmYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpKQorc3Rh
dGljIGludCB2aWRpb2Nfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2lnbmVkIGludCBpKQogewogCXN0cnVjdCB2aWRl
b19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZmbF9k
aXIgPT0gVkZMX0RJUl9SWCkKIAkJcmV0dXJuIC1FTk9UVFk7Ci0JcmV0dXJuIHZpdmlkX3ZpZF9v
dXRfb3ZlcmxheShmaWxlLCBwcml2LCBpKTsKKwlyZXR1cm4gdml2aWRfdmlkX291dF9vdmVybGF5
KGZpbGUsIHN0YXRlLCBpKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mYnVmKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mcmFtZWJ1ZmZlciAqYSkKK3N0YXRp
YyBpbnQgdmlkaW9jX2dfZmJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZnJhbWVidWZmZXIgKmEpCiB7CiAJc3Ry
dWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKIAlpZiAodmRl
di0+dmZsX2RpciA9PSBWRkxfRElSX1JYKQogCQlyZXR1cm4gLUVOT1RUWTsKLQlyZXR1cm4gdml2
aWRfdmlkX291dF9nX2ZidWYoZmlsZSwgcHJpdiwgYSk7CisJcmV0dXJuIHZpdmlkX3ZpZF9vdXRf
Z19mYnVmKGZpbGUsIHN0YXRlLCBhKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mYnVmKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBjb25zdCBzdHJ1Y3QgdjRsMl9mcmFtZWJ1ZmZl
ciAqYSkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZmJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgY29uc3Qgc3RydWN0IHY0bDJfZnJhbWVi
dWZmZXIgKmEpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEo
ZmlsZSk7CiAKIAlpZiAodmRldi0+dmZsX2RpciA9PSBWRkxfRElSX1JYKQogCQlyZXR1cm4gLUVO
T1RUWTsKLQlyZXR1cm4gdml2aWRfdmlkX291dF9zX2ZidWYoZmlsZSwgcHJpdiwgYSk7CisJcmV0
dXJuIHZpdmlkX3ZpZF9vdXRfc19mYnVmKGZpbGUsIHN0YXRlLCBhKTsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lk
IGlkKQorc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRfaWQgaWQpCiB7CiAJc3RydWN0
IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKIAlpZiAodmRldi0+
dmZsX2RpciA9PSBWRkxfRElSX1JYKQotCQlyZXR1cm4gdml2aWRfdmlkX2NhcF9zX3N0ZChmaWxl
LCBwcml2LCBpZCk7Ci0JcmV0dXJuIHZpdmlkX3ZpZF9vdXRfc19zdGQoZmlsZSwgcHJpdiwgaWQp
OworCQlyZXR1cm4gdml2aWRfdmlkX2NhcF9zX3N0ZChmaWxlLCBzdGF0ZSwgaWQpOworCXJldHVy
biB2aXZpZF92aWRfb3V0X3Nfc3RkKGZpbGUsIHN0YXRlLCBpZCk7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncykKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZHZfdGltaW5n
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgICAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewog
CXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYg
KHZkZXYtPnZmbF9kaXIgPT0gVkZMX0RJUl9SWCkKLQkJcmV0dXJuIHZpdmlkX3ZpZF9jYXBfc19k
dl90aW1pbmdzKGZpbGUsIHByaXYsIHRpbWluZ3MpOwotCXJldHVybiB2aXZpZF92aWRfb3V0X3Nf
ZHZfdGltaW5ncyhmaWxlLCBwcml2LCB0aW1pbmdzKTsKKwkJcmV0dXJuIHZpdmlkX3ZpZF9jYXBf
c19kdl90aW1pbmdzKGZpbGUsIHN0YXRlLCB0aW1pbmdzKTsKKwlyZXR1cm4gdml2aWRfdmlkX291
dF9zX2R2X3RpbWluZ3MoZmlsZSwgc3RhdGUsIHRpbWluZ3MpOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY19nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCWlu
dCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfcGl4ZWxh
c3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsIGludCB0eXBlLAorCQkJCXN0cnVjdCB2NGwyX2ZyYWN0ICpmKQogewogCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZm
bF9kaXIgPT0gVkZMX0RJUl9SWCkKLQkJcmV0dXJuIHZpdmlkX3ZpZF9jYXBfZ19waXhlbGFzcGVj
dChmaWxlLCBwcml2LCB0eXBlLCBmKTsKLQlyZXR1cm4gdml2aWRfdmlkX291dF9nX3BpeGVsYXNw
ZWN0KGZpbGUsIHByaXYsIHR5cGUsIGYpOworCQlyZXR1cm4gdml2aWRfdmlkX2NhcF9nX3BpeGVs
YXNwZWN0KGZpbGUsIHN0YXRlLCB0eXBlLCBmKTsKKwlyZXR1cm4gdml2aWRfdmlkX291dF9nX3Bp
eGVsYXNwZWN0KGZpbGUsIHN0YXRlLCB0eXBlLCBmKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
Z19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZp
ZGlvY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpz
ZWwpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7
CiAKIAlpZiAodmRldi0+dmZsX2RpciA9PSBWRkxfRElSX1JYKQotCQlyZXR1cm4gdml2aWRfdmlk
X2NhcF9nX3NlbGVjdGlvbihmaWxlLCBwcml2LCBzZWwpOwotCXJldHVybiB2aXZpZF92aWRfb3V0
X2dfc2VsZWN0aW9uKGZpbGUsIHByaXYsIHNlbCk7CisJCXJldHVybiB2aXZpZF92aWRfY2FwX2df
c2VsZWN0aW9uKGZpbGUsIHN0YXRlLCBzZWwpOworCXJldHVybiB2aXZpZF92aWRfb3V0X2dfc2Vs
ZWN0aW9uKGZpbGUsIHN0YXRlLCBzZWwpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3NlbGVj
dGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3Nf
c2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsK
IAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAogCWlm
ICh2ZGV2LT52ZmxfZGlyID09IFZGTF9ESVJfUlgpCi0JCXJldHVybiB2aXZpZF92aWRfY2FwX3Nf
c2VsZWN0aW9uKGZpbGUsIHByaXYsIHNlbCk7Ci0JcmV0dXJuIHZpdmlkX3ZpZF9vdXRfc19zZWxl
Y3Rpb24oZmlsZSwgcHJpdiwgc2VsKTsKKwkJcmV0dXJuIHZpdmlkX3ZpZF9jYXBfc19zZWxlY3Rp
b24oZmlsZSwgc3RhdGUsIHNlbCk7CisJcmV0dXJuIHZpdmlkX3ZpZF9vdXRfc19zZWxlY3Rpb24o
ZmlsZSwgc3RhdGUsIHNlbCk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfcGFybShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfcGFybShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAg
c3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2
ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAogCWlmICh2ZGV2LT52ZmxfdHlwZSA9PSBWRkxf
VFlQRV9UT1VDSCkKLQkJcmV0dXJuIHZpdmlkX2dfcGFybV90Y2goZmlsZSwgcHJpdiwgcGFybSk7
CisJCXJldHVybiB2aXZpZF9nX3Bhcm1fdGNoKGZpbGUsIHN0YXRlLCBwYXJtKTsKIAlpZiAodmRl
di0+dmZsX2RpciA9PSBWRkxfRElSX1JYKQotCQlyZXR1cm4gdml2aWRfdmlkX2NhcF9nX3Bhcm0o
ZmlsZSwgcHJpdiwgcGFybSk7Ci0JcmV0dXJuIHZpdmlkX3ZpZF9vdXRfZ19wYXJtKGZpbGUsIHBy
aXYsIHBhcm0pOworCQlyZXR1cm4gdml2aWRfdmlkX2NhcF9nX3Bhcm0oZmlsZSwgc3RhdGUsIHBh
cm0pOworCXJldHVybiB2aXZpZF92aWRfb3V0X2dfcGFybShmaWxlLCBzdGF0ZSwgcGFybSk7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgc3RydWN0IHY0bDJfc3RyZWFtcGFy
bSAqcGFybSkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShm
aWxlKTsKIAogCWlmICh2ZGV2LT52ZmxfZGlyID09IFZGTF9ESVJfUlgpCi0JCXJldHVybiB2aXZp
ZF92aWRfY2FwX3NfcGFybShmaWxlLCBwcml2LCBwYXJtKTsKKwkJcmV0dXJuIHZpdmlkX3ZpZF9j
YXBfc19wYXJtKGZpbGUsIHN0YXRlLCBwYXJtKTsKIAlyZXR1cm4gLUVOT1RUWTsKIH0KIAotc3Rh
dGljIGludCB2aWRpb2NfbG9nX3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdikK
K3N0YXRpYyBpbnQgdmlkaW9jX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlKQogewogCXN0cnVjdCB2aXZpZF9kZXYg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9
IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKLQl2NGwyX2N0cmxfbG9nX3N0YXR1cyhmaWxlLCBwcml2
KTsKKwl2NGwyX2N0cmxfbG9nX3N0YXR1cyhmaWxlLCBzdGF0ZSk7CiAJaWYgKHZkZXYtPnZmbF9k
aXIgPT0gVkZMX0RJUl9SWCAmJiB2ZGV2LT52ZmxfdHlwZSA9PSBWRkxfVFlQRV9WSURFTykKIAkJ
dHBnX2xvZ19zdGF0dXMoJmRldi0+dHBnKTsKIAlyZXR1cm4gMDsKQEAgLTQ4NCwxMDIgKzUwNywx
MTIgQEAgc3RhdGljIF9fcG9sbF90IHZpdmlkX3JhZGlvX3BvbGwoc3RydWN0IGZpbGUgKmZpbGUs
IHN0cnVjdCBwb2xsX3RhYmxlX3N0cnVjdCAqd2EKIAlyZXR1cm4gdml2aWRfcmFkaW9fdHhfcG9s
bChmaWxlLCB3YWl0KTsKIH0KIAotc3RhdGljIGludCB2aXZpZF9lbnVtX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aXZpZF9lbnVtX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgIHN0cnVjdCB2NGwyX2lucHV0ICppbnApCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAq
dmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKIAlpZiAodmRldi0+dmZsX3R5cGUgPT0gVkZM
X1RZUEVfVE9VQ0gpCi0JCXJldHVybiB2aXZpZF9lbnVtX2lucHV0X3RjaChmaWxlLCBwcml2LCBp
bnApOwotCXJldHVybiB2aWRpb2NfZW51bV9pbnB1dChmaWxlLCBwcml2LCBpbnApOworCQlyZXR1
cm4gdml2aWRfZW51bV9pbnB1dF90Y2goZmlsZSwgc3RhdGUsIGlucCk7CisJcmV0dXJuIHZpZGlv
Y19lbnVtX2lucHV0KGZpbGUsIHN0YXRlLCBpbnApOwogfQogCi1zdGF0aWMgaW50IHZpdmlkX2df
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKK3N0
YXRpYyBpbnQgdml2aWRfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgdW5zaWduZWQgaW50ICppKQogewogCXN0cnVjdCB2aWRl
b19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZmbF90
eXBlID09IFZGTF9UWVBFX1RPVUNIKQotCQlyZXR1cm4gdml2aWRfZ19pbnB1dF90Y2goZmlsZSwg
cHJpdiwgaSk7Ci0JcmV0dXJuIHZpZGlvY19nX2lucHV0KGZpbGUsIHByaXYsIGkpOworCQlyZXR1
cm4gdml2aWRfZ19pbnB1dF90Y2goZmlsZSwgc3RhdGUsIGkpOworCXJldHVybiB2aWRpb2NfZ19p
bnB1dChmaWxlLCBzdGF0ZSwgaSk7CiB9CiAKLXN0YXRpYyBpbnQgdml2aWRfc19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IHZp
dmlkX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJIHVuc2lnbmVkIGludCBpKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZk
ZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZmbF90eXBlID09IFZGTF9U
WVBFX1RPVUNIKQotCQlyZXR1cm4gdml2aWRfc19pbnB1dF90Y2goZmlsZSwgcHJpdiwgaSk7Ci0J
cmV0dXJuIHZpZGlvY19zX2lucHV0KGZpbGUsIHByaXYsIGkpOworCQlyZXR1cm4gdml2aWRfc19p
bnB1dF90Y2goZmlsZSwgc3RhdGUsIGkpOworCXJldHVybiB2aWRpb2Nfc19pbnB1dChmaWxlLCBz
dGF0ZSwgaSk7CiB9CiAKLXN0YXRpYyBpbnQgdml2aWRfZW51bV9mbXRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdml2aWRfZW51bV9mbXRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB2aWRlb19kZXZp
Y2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJaWYgKHZkZXYtPnZmbF90eXBlID09
IFZGTF9UWVBFX1RPVUNIKQotCQlyZXR1cm4gdml2aWRfZW51bV9mbXRfdGNoKGZpbGUsIHByaXYs
IGYpOwotCXJldHVybiB2aXZpZF9lbnVtX2ZtdF92aWQoZmlsZSwgcHJpdiwgZik7CisJCXJldHVy
biB2aXZpZF9lbnVtX2ZtdF90Y2goZmlsZSwgc3RhdGUsIGYpOworCXJldHVybiB2aXZpZF9lbnVt
X2ZtdF92aWQoZmlsZSwgc3RhdGUsIGYpOwogfQogCi1zdGF0aWMgaW50IHZpdmlkX2dfZm10X2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdml2aWRfZ19mbXRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpZGVvX2Rl
dmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKIAlpZiAodmRldi0+dmZsX3R5cGUg
PT0gVkZMX1RZUEVfVE9VQ0gpCi0JCXJldHVybiB2aXZpZF9nX2ZtdF90Y2goZmlsZSwgcHJpdiwg
Zik7Ci0JcmV0dXJuIHZpZGlvY19nX2ZtdF92aWRfY2FwKGZpbGUsIHByaXYsIGYpOworCQlyZXR1
cm4gdml2aWRfZ19mbXRfdGNoKGZpbGUsIHN0YXRlLCBmKTsKKwlyZXR1cm4gdmlkaW9jX2dfZm10
X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogfQogCi1zdGF0aWMgaW50IHZpdmlkX3RyeV9mbXRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aXZpZF90cnlf
Zm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAogCWlmICh2ZGV2LT52
ZmxfdHlwZSA9PSBWRkxfVFlQRV9UT1VDSCkKLQkJcmV0dXJuIHZpdmlkX2dfZm10X3RjaChmaWxl
LCBwcml2LCBmKTsKLQlyZXR1cm4gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBwcml2LCBm
KTsKKwkJcmV0dXJuIHZpdmlkX2dfZm10X3RjaChmaWxlLCBzdGF0ZSwgZik7CisJcmV0dXJuIHZp
ZGlvY190cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogfQogCi1zdGF0aWMgaW50IHZp
dmlkX3NfZm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
dml2aWRfc19mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKIAlpZiAodmRl
di0+dmZsX3R5cGUgPT0gVkZMX1RZUEVfVE9VQ0gpCi0JCXJldHVybiB2aXZpZF9nX2ZtdF90Y2go
ZmlsZSwgcHJpdiwgZik7Ci0JcmV0dXJuIHZpZGlvY19zX2ZtdF92aWRfY2FwKGZpbGUsIHByaXYs
IGYpOworCQlyZXR1cm4gdml2aWRfZ19mbXRfdGNoKGZpbGUsIHN0YXRlLCBmKTsKKwlyZXR1cm4g
dmlkaW9jX3NfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogfQogCi1zdGF0aWMgaW50IHZp
dmlkX2dfZm10X2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZpdmlkX2dfZm10X2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxl
KTsKIAogCWlmICh2ZGV2LT52ZmxfdHlwZSA9PSBWRkxfVFlQRV9UT1VDSCkKLQkJcmV0dXJuIHZp
dmlkX2dfZm10X3RjaF9tcGxhbmUoZmlsZSwgcHJpdiwgZik7Ci0JcmV0dXJuIHZpZGlvY19nX2Zt
dF92aWRfY2FwX21wbGFuZShmaWxlLCBwcml2LCBmKTsKKwkJcmV0dXJuIHZpdmlkX2dfZm10X3Rj
aF9tcGxhbmUoZmlsZSwgc3RhdGUsIGYpOworCXJldHVybiB2aWRpb2NfZ19mbXRfdmlkX2NhcF9t
cGxhbmUoZmlsZSwgc3RhdGUsIGYpOwogfQogCi1zdGF0aWMgaW50IHZpdmlkX3RyeV9mbXRfY2Fw
X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdml2aWRf
dHJ5X2ZtdF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCiAJ
aWYgKHZkZXYtPnZmbF90eXBlID09IFZGTF9UWVBFX1RPVUNIKQotCQlyZXR1cm4gdml2aWRfZ19m
bXRfdGNoX21wbGFuZShmaWxlLCBwcml2LCBmKTsKLQlyZXR1cm4gdmlkaW9jX3RyeV9mbXRfdmlk
X2NhcF9tcGxhbmUoZmlsZSwgcHJpdiwgZik7CisJCXJldHVybiB2aXZpZF9nX2ZtdF90Y2hfbXBs
YW5lKGZpbGUsIHN0YXRlLCBmKTsKKwlyZXR1cm4gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcF9tcGxh
bmUoZmlsZSwgc3RhdGUsIGYpOwogfQogCi1zdGF0aWMgaW50IHZpdmlkX3NfZm10X2NhcF9tcGxh
bmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpdmlkX3NfZm10
X2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAogCWlmICh2ZGV2LT52
ZmxfdHlwZSA9PSBWRkxfVFlQRV9UT1VDSCkKLQkJcmV0dXJuIHZpdmlkX2dfZm10X3RjaF9tcGxh
bmUoZmlsZSwgcHJpdiwgZik7Ci0JcmV0dXJuIHZpZGlvY19zX2ZtdF92aWRfY2FwX21wbGFuZShm
aWxlLCBwcml2LCBmKTsKKwkJcmV0dXJuIHZpdmlkX2dfZm10X3RjaF9tcGxhbmUoZmlsZSwgc3Rh
dGUsIGYpOworCXJldHVybiB2aWRpb2Nfc19mbXRfdmlkX2NhcF9tcGxhbmUoZmlsZSwgc3RhdGUs
IGYpOwogfQogCiBzdGF0aWMgYm9vbCB2aXZpZF9pc19pbl91c2UoYm9vbCB2YWxpZCwgc3RydWN0
IHZpZGVvX2RldmljZSAqdmRldikKQEAgLTY4OSw3ICs3MjIsOCBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IHY0bDJfZmlsZV9vcGVyYXRpb25zIHZpdmlkX3JhZGlvX2ZvcHMgPSB7CiAJLnVubG9ja2Vk
X2lvY3RsID0gdmlkZW9faW9jdGwyLAogfTsKIAotc3RhdGljIGludCB2aWRpb2NfcmVxYnVmcyhz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3JlcWJ1ZnMo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJICBzdHJ1Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAqcCkKIHsKIAlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTcwNiwxMCArNzQwLDExIEBA
IHN0YXRpYyBpbnQgdmlkaW9jX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJCQlyZXR1cm4gcjsKIAl9CiAKLQlyZXR1cm4gdmIyX2lvY3RsX3JlcWJ1ZnMoZmlsZSwgcHJp
diwgcCk7CisJcmV0dXJuIHZiMl9pb2N0bF9yZXFidWZzKGZpbGUsIHN0YXRlLCBwKTsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfY3JlYXRlX2J1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IHZpZGlvY19jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0
IHY0bDJfY3JlYXRlX2J1ZmZlcnMgKnApCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9
IHZpZGVvX2RldmRhdGEoZmlsZSk7CkBAIC03MjYsNyArNzYxLDcgQEAgc3RhdGljIGludCB2aWRp
b2NfY3JlYXRlX2J1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQlyZXR1cm4g
cjsKIAl9CiAKLQlyZXR1cm4gdmIyX2lvY3RsX2NyZWF0ZV9idWZzKGZpbGUsIHByaXYsIHApOwor
CXJldHVybiB2YjJfaW9jdGxfY3JlYXRlX2J1ZnMoZmlsZSwgc3RhdGUsIHApOwogfQogCiBzdGF0
aWMgY29uc3Qgc3RydWN0IHY0bDJfaW9jdGxfb3BzIHZpdmlkX2lvY3RsX29wcyA9IHsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLW1ldGEtY2FwLmMg
Yi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1tZXRhLWNhcC5jCmluZGV4
IGM3YWFlY2MwYjVhMjQ3MjY2MzlhMjUzYWNjZmM1MDM4M2E4NGU4NDYuLjMyMDZjY2RlYjM3N2Y1
NGI3NmQ4ZmRlMTk5YWE2ZTQwNDlmZjhhYWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVz
dC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLW1ldGEtY2FwLmMKKysrIGIvZHJpdmVycy9tZWRpYS90ZXN0
LWRyaXZlcnMvdml2aWQvdml2aWQtbWV0YS1jYXAuYwpAQCAtMTI0LDcgKzEyNCw4IEBAIGNvbnN0
IHN0cnVjdCB2YjJfb3BzIHZpdmlkX21ldGFfY2FwX3FvcHMgPSB7CiAJLmJ1Zl9yZXF1ZXN0X2Nv
bXBsZXRlCT0gbWV0YV9jYXBfYnVmX3JlcXVlc3RfY29tcGxldGUsCiB9OwogCi1pbnQgdmlkaW9j
X2VudW1fZm10X21ldGFfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK2ludCB2
aWRpb2NfZW51bV9mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNj
ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xNDAsNyArMTQxLDggQEAgaW50IHZpZGlvY19lbnVtX2ZtdF9tZXRhX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aWRpb2NfZ19mbXRf
bWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdmlkaW9jX2dfZm10
X21ldGFfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZp
ZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21l
ZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1tZXRhLWNhcC5oIGIvZHJpdmVycy9tZWRpYS90
ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtbWV0YS1jYXAuaAppbmRleCA0NjcwZDAwZDE1NzZkZjBl
NDFhOTYxYWQ1ZDUwNDBkOTI3ODdkZmExLi5jMTE3NThkZjc2YzNmODZkMDk3MmI2NTNlYmJlZWZl
NGQ4NjAxZDIyIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92
aXZpZC1tZXRhLWNhcC5oCisrKyBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3Zp
dmlkLW1ldGEtY2FwLmgKQEAgLTE4LDEwICsxOCwxMiBAQCBzdHJ1Y3Qgdml2aWRfdXZjX21ldGFf
YnVmIHsKIHZvaWQgdml2aWRfbWV0YV9jYXBfZmlsbGJ1ZmYoc3RydWN0IHZpdmlkX2RldiAqZGV2
LAogCQkJICAgICBzdHJ1Y3Qgdml2aWRfYnVmZmVyICpidWYsIHU2NCBzb2UpOwogCi1pbnQgdmlk
aW9jX2VudW1fZm10X21ldGFfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK2lu
dCB2aWRpb2NfZW51bV9mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9mbXRk
ZXNjICpmKTsKIAotaW50IHZpZGlvY19nX2ZtdF9tZXRhX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfZ19mbXRfbWV0YV9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpOwogCiBleHRlcm4gY29uc3Qgc3RydWN0IHZiMl9vcHMgdml2aWRfbWV0YV9j
YXBfcW9wczsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3Zp
dmlkLW1ldGEtb3V0LmMgYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1t
ZXRhLW91dC5jCmluZGV4IDU1ZTVlNWRlYzJmMmFiMWJkYzAxYTJkMWQ0NzlhNmYxZWI3NTgyOTku
LjliNmI1NTZjNDc1ZjcxM2UyMzA5OGQ5YjYyZGNlNzE5NDUyOTVkYWMgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLW1ldGEtb3V0LmMKKysrIGIvZHJp
dmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtbWV0YS1vdXQuYwpAQCAtMTI0LDcg
KzEyNCw4IEBAIGNvbnN0IHN0cnVjdCB2YjJfb3BzIHZpdmlkX21ldGFfb3V0X3FvcHMgPSB7CiAJ
LmJ1Zl9yZXF1ZXN0X2NvbXBsZXRlICAgPSBtZXRhX291dF9idWZfcmVxdWVzdF9jb21wbGV0ZSwK
IH07CiAKLWludCB2aWRpb2NfZW51bV9mbXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgICpwcml2LAoraW50IHZpZGlvY19lbnVtX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTE0MCw3ICsxNDEsOCBAQCBpbnQgdmlkaW9jX2VudW1fZm10X21l
dGFfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
aW50IHZpZGlvY19nX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K2ludCB2aWRpb2NfZ19mbXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLW1ldGEtb3V0Lmgg
Yi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1tZXRhLW91dC5oCmluZGV4
IDBjNjM5YjdjMjg0Mjc2ZjRjNWU1MTgwYjc2NWRiYzE3ZDg4NDkyN2YuLmRjMzU5NGRlOTk5YTA1
MjcwOGZiMzU5NDQ1NjVlOTM5MzU3YWMzNmEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVz
dC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLW1ldGEtb3V0LmgKKysrIGIvZHJpdmVycy9tZWRpYS90ZXN0
LWRyaXZlcnMvdml2aWQvdml2aWQtbWV0YS1vdXQuaApAQCAtMTMsMTEgKzEzLDE0IEBAIHN0cnVj
dCB2aXZpZF9tZXRhX291dF9idWYgewogfTsKIAogdm9pZCB2aXZpZF9tZXRhX291dF9wcm9jZXNz
KHN0cnVjdCB2aXZpZF9kZXYgKmRldiwgc3RydWN0IHZpdmlkX2J1ZmZlciAqYnVmKTsKLWludCB2
aWRpb2NfZW51bV9mbXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAor
aW50IHZpZGlvY19lbnVtX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zt
dGRlc2MgKmYpOwotaW50IHZpZGlvY19nX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfZ19mbXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpOwotaW50IHZpZGlvY19zX2ZtdF9tZXRhX291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2Nfc19mbXRfbWV0YV9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpOwogCiBleHRlcm4gY29uc3Qgc3RydWN0IHZiMl9vcHMgdml2aWRfbWV0
YV9vdXRfcW9wczsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3Zpdmlk
L3ZpdmlkLXJhZGlvLXJ4LmMgYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZp
ZC1yYWRpby1yeC5jCmluZGV4IGI1ZTMwMjZmODgzZWU2OWQ0OGRiNTUyNjIzZDc5NjE2NzdlYjkx
ZmQuLjdmZjg5ZTY0ODhmY2RlMWQ4ZmYyYTFhOTk2YTNhYzhkMmQwZGNhODMgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXJhZGlvLXJ4LmMKKysrIGIv
ZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtcmFkaW8tcnguYwpAQCAtMTMz
LDcgKzEzMyw5IEBAIF9fcG9sbF90IHZpdmlkX3JhZGlvX3J4X3BvbGwoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCBwb2xsX3RhYmxlX3N0cnVjdCAqd2FpdCkKIAlyZXR1cm4gRVBPTExJTiB8IEVQ
T0xMUkROT1JNIHwgdjRsMl9jdHJsX3BvbGwoZmlsZSwgd2FpdCk7CiB9CiAKLWludCB2aXZpZF9y
YWRpb19yeF9lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX2ZyZXF1ZW5jeV9iYW5kICpiYW5kKQoraW50IHZpdmlkX3JhZGlvX3J4X2VudW1f
ZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCQkgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3lfYmFuZCAqYmFuZCkK
IHsKIAlpZiAoYmFuZC0+dHVuZXIgIT0gMCkKIAkJcmV0dXJuIC1FSU5WQUw7CkBAIC0xNDUsNyAr
MTQ3LDkgQEAgaW50IHZpdmlkX3JhZGlvX3J4X2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnIKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZp
dmlkX3JhZGlvX3J4X3NfaHdfZnJlcV9zZWVrKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCBjb25zdCBzdHJ1Y3QgdjRsMl9od19mcmVxX3NlZWsgKmEpCitpbnQgdml2aWRfcmFkaW9fcnhf
c19od19mcmVxX3NlZWsoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgIGNvbnN0IHN0cnVjdCB2NGwyX2h3X2ZyZXFfc2VlayAq
YSkKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXVu
c2lnbmVkIGxvdywgaGlnaDsKQEAgLTIxNCw3ICsyMTgsOSBAQCBpbnQgdml2aWRfcmFkaW9fcnhf
c19od19mcmVxX3NlZWsoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVj
dCB2NAogCXJldHVybiAwOwogfQogCi1pbnQgdml2aWRfcmFkaW9fcnhfZ190dW5lcihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQoraW50IHZpdmlk
X3JhZGlvX3J4X2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCB2NGwyX3R1bmVyICp2dCkKIHsKIAlz
dHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWludCBkZWx0YSA9
IDgwMDsKQEAgLTI2Nyw3ICsyNzMsOSBAQCBpbnQgdml2aWRfcmFkaW9fcnhfZ190dW5lcihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQogCXJldHVy
biAwOwogfQogCi1pbnQgdml2aWRfcmFkaW9fcnhfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQoraW50IHZpdmlkX3JhZGlv
X3J4X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2dCkKIHsKIAlz
dHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCmRpZmYgLS1naXQg
YS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1yYWRpby1yeC5oIGIvZHJp
dmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtcmFkaW8tcnguaAppbmRleCBhMmFl
MTdjNzhlY2VlMDhkNDJjZDNhOGU4ZDMwYjAxY2FlYzFiYjk5Li4zMGRjYjUzNDg2MmI4MGQyNDQ3
ZTA4OWMzMTA0MTQwNmFlMDdlMjg0IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJp
dmVycy92aXZpZC92aXZpZC1yYWRpby1yeC5oCisrKyBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2
ZXJzL3ZpdmlkL3ZpdmlkLXJhZGlvLXJ4LmgKQEAgLTExLDkgKzExLDE3IEBACiBzc2l6ZV90IHZp
dmlkX3JhZGlvX3J4X3JlYWQoc3RydWN0IGZpbGUgKiwgY2hhciBfX3VzZXIgKiwgc2l6ZV90LCBs
b2ZmX3QgKik7CiBfX3BvbGxfdCB2aXZpZF9yYWRpb19yeF9wb2xsKHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgcG9sbF90YWJsZV9zdHJ1Y3QgKndhaXQpOwogCi1pbnQgdml2aWRfcmFkaW9fcnhf
ZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRs
Ml9mcmVxdWVuY3lfYmFuZCAqYmFuZCk7Ci1pbnQgdml2aWRfcmFkaW9fcnhfc19od19mcmVxX3Nl
ZWsoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2h3X2Zy
ZXFfc2VlayAqYSk7Ci1pbnQgdml2aWRfcmFkaW9fcnhfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KTsKLWludCB2aXZpZF9yYWRpb19y
eF9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBjb25zdCBzdHJ1Y3QgdjRs
Ml90dW5lciAqdnQpOworaW50IHZpdmlkX3JhZGlvX3J4X2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CQkgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3lfYmFuZCAqYmFuZCk7CitpbnQgdml2aWRfcmFkaW9f
cnhfc19od19mcmVxX3NlZWsoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgIGNvbnN0IHN0cnVjdCB2NGwyX2h3X2ZyZXFfc2Vl
ayAqYSk7CitpbnQgdml2aWRfcmFkaW9fcnhfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgc3RydWN0IHY0bDJf
dHVuZXIgKnZ0KTsKK2ludCB2aXZpZF9yYWRpb19yeF9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBjb25zdCBz
dHJ1Y3QgdjRsMl90dW5lciAqdnQpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXJhZGlvLXR4LmMgYi9kcml2ZXJzL21lZGlhL3Rl
c3QtZHJpdmVycy92aXZpZC92aXZpZC1yYWRpby10eC5jCmluZGV4IGFkYTYwNzIyMDY2ZWFjZWVm
MTM3MWQ3MTFlNWJjNDA4ZmYwZmE2YjMuLmE4MWI3NGI0NWE2NDQxYTQzYzA3NzMzMjZkMmEzOWQ0
ZmM1NTQ0ZjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3Zp
dmlkLXJhZGlvLXR4LmMKKysrIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2
aWQtcmFkaW8tdHguYwpAQCAtOTYsNyArOTYsOCBAQCBfX3BvbGxfdCB2aXZpZF9yYWRpb190eF9w
b2xsKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgcG9sbF90YWJsZV9zdHJ1Y3QgKndhaXQpCiAJ
cmV0dXJuIEVQT0xMT1VUIHwgRVBPTExXUk5PUk0gfCB2NGwyX2N0cmxfcG9sbChmaWxlLCB3YWl0
KTsKIH0KIAotaW50IHZpZGlvY19nX21vZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfbW9kdWxhdG9yICphKQoraW50IHZpZGlvY19nX21vZHVsYXRvcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAg
ICAgICBzdHJ1Y3QgdjRsMl9tb2R1bGF0b3IgKmEpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTE1LDcgKzExNiw4IEBAIGludCB2aWRpb2Nf
Z19tb2R1bGF0b3Ioc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX21v
ZHVsYXRvciAqYSkKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY19zX21vZHVsYXRvcihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJfbW9kdWxhdG9yICph
KQoraW50IHZpZGlvY19zX21vZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9tb2R1bGF0
b3IgKmEpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
IApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtcmFk
aW8tdHguaCBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXJhZGlvLXR4
LmgKaW5kZXggMjBjYjZmMTM2M2ZmZDA3ODA1ZDFjN2M4NmY2ZDQxMTFhYzU5NDhhNS4uZDJlNjM2
ZTIwZGFjMzczMDU4ZDA0ZTcyZjQxYzdkM2EwZjBkNmY5YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9t
ZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtcmFkaW8tdHguaAorKysgYi9kcml2ZXJzL21l
ZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1yYWRpby10eC5oCkBAIC0xMSw3ICsxMSw5IEBA
CiBzc2l6ZV90IHZpdmlkX3JhZGlvX3R4X3dyaXRlKHN0cnVjdCBmaWxlICosIGNvbnN0IGNoYXIg
X191c2VyICosIHNpemVfdCwgbG9mZl90ICopOwogX19wb2xsX3Qgdml2aWRfcmFkaW9fdHhfcG9s
bChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHBvbGxfdGFibGVfc3RydWN0ICp3YWl0KTsKIAot
aW50IHZpZGlvY19nX21vZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfbW9kdWxhdG9yICphKTsKLWludCB2aWRpb2Nfc19tb2R1bGF0b3Ioc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX21vZHVsYXRvciAqYSk7Citp
bnQgdmlkaW9jX2dfbW9kdWxhdG9yKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIHN0cnVjdCB2NGwyX21vZHVsYXRvciAqYSk7Citp
bnQgdmlkaW9jX3NfbW9kdWxhdG9yKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIGNvbnN0IHN0cnVjdCB2NGwyX21vZHVsYXRvciAq
YSk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2
aWQvdml2aWQtc2RyLWNhcC5jIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2
aWQtc2RyLWNhcC5jCmluZGV4IDI2NjRhNTkzZThlMWI1YjAzYjBhZWMwMzE2OTM1OWMyMzhjY2Ey
MDUuLjBhOGI3OGY0MjNiYTU2NDI1YjkxNzQ5MWJiMWNmYTI1NmE1NTgxMzcgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXNkci1jYXAuYworKysgYi9k
cml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1zZHItY2FwLmMKQEAgLTM0NCw3
ICszNDQsOCBAQCBjb25zdCBzdHJ1Y3QgdmIyX29wcyB2aXZpZF9zZHJfY2FwX3FvcHMgPSB7CiAJ
LmJ1Zl9yZXF1ZXN0X2NvbXBsZXRlCT0gc2RyX2NhcF9idWZfcmVxdWVzdF9jb21wbGV0ZSwKIH07
CiAKLWludCB2aXZpZF9zZHJfZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAoraW50IHZpdmlkX3Nkcl9lbnVtX2ZyZXFfYmFuZHMoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJc3RydWN0IHY0
bDJfZnJlcXVlbmN5X2JhbmQgKmJhbmQpCiB7CiAJc3dpdGNoIChiYW5kLT50dW5lcikgewpAQCAt
MzYzLDggKzM2NCw4IEBAIGludCB2aXZpZF9zZHJfZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCX0KIH0KIAotaW50IHZpdmlkX3Nkcl9nX2ZyZXF1ZW5jeShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2
ZikKK2ludCB2aXZpZF9zZHJfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKnZm
KQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAg
LTM4Miw3ICszODMsOCBAQCBpbnQgdml2aWRfc2RyX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCX0KIH0KIAotaW50IHZpdmlkX3Nkcl9zX2ZyZXF1ZW5jeShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aXZpZF9zZHJfc19mcmVxdWVuY3koc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQljb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKnZmKQogewogCXN0cnVjdCB2aXZpZF9kZXYg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00MjMsNyArNDI1LDggQEAgaW50IHZpdmlk
X3Nkcl9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAl9CiB9CiAK
LWludCB2aXZpZF9zZHJfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfdHVuZXIgKnZ0KQoraW50IHZpdmlkX3Nkcl9nX3R1bmVyKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3RydWN0IHY0
bDJfdHVuZXIgKnZ0KQogewogCXN3aXRjaCAodnQtPmluZGV4KSB7CiAJY2FzZSAwOgpAQCAtNDQ3
LDE0ICs0NTAsMTcgQEAgaW50IHZpdmlkX3Nkcl9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCiAJfQogfQogCi1pbnQgdml2aWRfc2Ry
X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwy
X3R1bmVyICp2dCkKK2ludCB2aXZpZF9zZHJfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIGNvbnN0IHN0cnVjdCB2NGwy
X3R1bmVyICp2dCkKIHsKIAlpZiAodnQtPmluZGV4ID4gMSkKIAkJcmV0dXJuIC1FSU5WQUw7CiAJ
cmV0dXJuIDA7CiB9CiAKLWludCB2aWRpb2NfZW51bV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK2ludCB2aWRpb2NfZW51
bV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlm
IChmLT5pbmRleCA+PSBBUlJBWV9TSVpFKGZvcm1hdHMpKQogCQlyZXR1cm4gLUVJTlZBTDsKQEAg
LTQ2Miw3ICs0NjgsOCBAQCBpbnQgdmlkaW9jX2VudW1fZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKgogCXJldHVybiAwOwogfQog
Ci1pbnQgdmlkaW9jX2dfZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK2ludCB2aWRpb2NfZ19mbXRfc2RyX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTQ3MSw3ICs0NzgsOCBAQCBpbnQgdmlkaW9jX2dfZm10X3Nkcl9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAly
ZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY19zX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitpbnQgdmlkaW9jX3NfZm10X3Nk
cl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2YjJfcXVldWUgKnEgPSAmZGV2LT52Yl9z
ZHJfY2FwX3E7CkBAIC00OTUsNyArNTAzLDkgQEAgaW50IHZpZGlvY19zX2ZtdF9zZHJfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0
dXJuIDA7CiB9CiAKLWludCB2aWRpb2NfdHJ5X2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitpbnQgdmlkaW9jX3RyeV9mbXRf
c2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCWludCBpOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1zZHItY2Fw
LmggYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC1zZHItY2FwLmgKaW5k
ZXggM2Q4ZWVhYmJmYzEwNzNlNmFhYjFjZTQ5MzQ0MmE0YWUxMGIzNjM2OS4uNTU0MTc2MjJjZjZj
OGJmMjE2NmFiY2I3YzY1ZTBhMzQ2ZTBlYzViYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS90
ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtc2RyLWNhcC5oCisrKyBiL2RyaXZlcnMvbWVkaWEvdGVz
dC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXNkci1jYXAuaApAQCAtOCwxNSArOCwyNyBAQAogI2lmbmRl
ZiBfVklWSURfU0RSX0NBUF9IXwogI2RlZmluZSBfVklWSURfU0RSX0NBUF9IXwogCi1pbnQgdml2
aWRfc2RyX2VudW1fZnJlcV9iYW5kcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfZnJlcXVlbmN5X2JhbmQgKmJhbmQpOwotaW50IHZpdmlkX3Nkcl9nX2ZyZXF1ZW5j
eShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2
Zik7Ci1pbnQgdml2aWRfc2RyX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKnZmKTsKLWludCB2aXZpZF9zZHJfZ190
dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnZ0
KTsKLWludCB2aXZpZF9zZHJfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
Y29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KTsKLWludCB2aWRpb2NfZW51bV9mbXRfc2RyX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZik7
Ci1pbnQgdmlkaW9jX2dfZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1pbnQgdmlkaW9jX3NfZm10X3Nkcl9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1pbnQgdmlk
aW9jX3RyeV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aXZpZF9zZHJfZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQkgICAgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3lfYmFuZCAqYmFuZCk7CitpbnQgdml2aWRfc2Ry
X2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2Zik7CitpbnQgdml2aWRfc2Ry
X3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2Zik7CitpbnQgdml2
aWRfc2RyX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkgICAgICBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpOworaW50IHZpdmlkX3Nk
cl9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJICAgICAgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KTsKK2ludCB2aWRpb2Nf
ZW51bV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKTsKK2lu
dCB2aWRpb2NfZ19mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRp
b2Nfc19mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRpb2NfdHJ5
X2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwogdm9pZCB2aXZp
ZF9zZHJfY2FwX3Byb2Nlc3Moc3RydWN0IHZpdmlkX2RldiAqZGV2LCBzdHJ1Y3Qgdml2aWRfYnVm
ZmVyICpidWYpOwogCiBleHRlcm4gY29uc3Qgc3RydWN0IHZiMl9vcHMgdml2aWRfc2RyX2NhcF9x
b3BzOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQt
dG91Y2gtY2FwLmMgYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC10b3Vj
aC1jYXAuYwppbmRleCAzNmE3ODFmYTE3YmMzZGFhZjFkOTQ5YTdmMWM5NGViYjlhZWNiN2MwLi5l
MjQ2ZDcwMDY5MTNlOTU5MDg5ZDdiZmY4NGZiZWI5ZjNlYjNjYjEzIDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC10b3VjaC1jYXAuYworKysgYi9kcml2
ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC10b3VjaC1jYXAuYwpAQCAtMTEyLDcg
KzExMiw4IEBAIGNvbnN0IHN0cnVjdCB2YjJfb3BzIHZpdmlkX3RvdWNoX2NhcF9xb3BzID0gewog
CS5idWZfcmVxdWVzdF9jb21wbGV0ZQk9IHRvdWNoX2NhcF9idWZfcmVxdWVzdF9jb21wbGV0ZSwK
IH07CiAKLWludCB2aXZpZF9lbnVtX2ZtdF90Y2goc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpw
cml2LCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQoraW50IHZpdmlkX2VudW1fZm10X3RjaChzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAg
ICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT5pbmRleCkKIAkJcmV0dXJuIC1F
SU5WQUw7CkBAIC0xMjEsNyArMTIyLDggQEAgaW50IHZpdmlkX2VudW1fZm10X3RjaChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiAJcmV0dXJu
IDA7CiB9CiAKLWludCB2aXZpZF9nX2ZtdF90Y2goc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK2ludCB2aXZpZF9nX2ZtdF90Y2goc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTEzMSw3ICsxMzMsOSBAQCBpbnQgdml2aWRfZ19mbXRfdGNoKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJu
IDA7CiB9CiAKLWludCB2aXZpZF9nX2ZtdF90Y2hfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitpbnQgdml2aWRfZ19mbXRfdGNoX21w
bGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9k
ZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0bDJfZm9ybWF0IHNwX2Zt
dDsKQEAgLTE0NCw3ICsxNDgsOCBAQCBpbnQgdml2aWRfZ19mbXRfdGNoX21wbGFuZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVybiAw
OwogfQogCi1pbnQgdml2aWRfZ19wYXJtX3RjaChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK2ludCB2aXZpZF9nX3Bhcm1fdGNoKHN0cnVjdCBmaWxlICpmaWxlLAorCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkgICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBh
cm0gKnBhcm0pCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKQEAgLTE2MCw3ICsxNjUsOCBAQCBpbnQgdml2aWRfZ19wYXJtX3RjaChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX2VudW1faW5wdXRf
dGNoKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5w
KQoraW50IHZpdmlkX2VudW1faW5wdXRfdGNoKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wKQogewog
CWlmIChpbnAtPmluZGV4KQogCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTE3MSw3ICsxNzcsOCBAQCBp
bnQgdml2aWRfZW51bV9pbnB1dF90Y2goc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX2lucHV0ICppbnApCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aXZpZF9nX2lucHV0
X3RjaChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQoraW50
IHZpdmlkX2dfaW5wdXRfdGNoKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdW5zaWduZWQgaW50ICppKQogewogCSppID0gMDsKIAly
ZXR1cm4gMDsKQEAgLTE5NCw3ICsyMDEsOCBAQCBpbnQgdml2aWRfc2V0X3RvdWNoKHN0cnVjdCB2
aXZpZF9kZXYgKmRldiwgdW5zaWduZWQgaW50IGkpCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aXZp
ZF9zX2lucHV0X3RjaChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50
IGkpCitpbnQgdml2aWRfc19pbnB1dF90Y2goc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlyZXR1
cm4gdml2aWRfc2V0X3RvdWNoKHZpZGVvX2RydmRhdGEoZmlsZSksIGkpOwogfQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdG91Y2gtY2FwLmggYi9k
cml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC10b3VjaC1jYXAuaAppbmRleCAw
N2U1MTQwNDZhZTgwZjEzNDdhZWMwMGYxZGExY2RhYTdhY2M0NzIxLi4xOWRkNWNiMzQzZmM2Nzgx
NWQzYzNiODRkMzBlZDk5YzYzNDE2N2EzIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3Qt
ZHJpdmVycy92aXZpZC92aXZpZC10b3VjaC1jYXAuaAorKysgYi9kcml2ZXJzL21lZGlhL3Rlc3Qt
ZHJpdmVycy92aXZpZC92aXZpZC10b3VjaC1jYXAuaApAQCAtMjYsMTQgKzI2LDIyIEBAIGVudW0g
dml2aWRfdGNoX3Rlc3QgewogCiBleHRlcm4gY29uc3Qgc3RydWN0IHZiMl9vcHMgdml2aWRfdG91
Y2hfY2FwX3FvcHM7CiAKLWludCB2aXZpZF9lbnVtX2ZtdF90Y2goc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgICpwcml2LCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKTsKLWludCB2aXZpZF9nX2ZtdF90
Y2goc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7
Ci1pbnQgdml2aWRfZ19mbXRfdGNoX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aXZpZF9lbnVtX2lucHV0X3RjaChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfaW5wdXQgKmlucCk7Ci1pbnQg
dml2aWRfZ19pbnB1dF90Y2goc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGludCAqaSk7Ci1pbnQgdml2aWRfc19pbnB1dF90Y2goc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHVuc2lnbmVkIGludCBpKTsKK2ludCB2aXZpZF9lbnVtX2ZtdF90Y2goc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3Ry
dWN0IHY0bDJfZm10ZGVzYyAqZik7CitpbnQgdml2aWRfZ19mbXRfdGNoKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZik7CitpbnQgdml2aWRfZ19mbXRfdGNoX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aXZpZF9lbnVtX2lucHV0X3RjaChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJf
aW5wdXQgKmlucCk7CitpbnQgdml2aWRfZ19pbnB1dF90Y2goc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICB1bnNpZ25lZCBpbnQgKmkp
OworaW50IHZpdmlkX3NfaW5wdXRfdGNoKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdW5zaWduZWQgaW50IGkpOwogdm9pZCB2aXZp
ZF9maWxsYnVmZl90Y2goc3RydWN0IHZpdmlkX2RldiAqZGV2LCBzdHJ1Y3Qgdml2aWRfYnVmZmVy
ICpidWYpOwogaW50IHZpdmlkX3NldF90b3VjaChzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYsIHVuc2ln
bmVkIGludCBpKTsKLWludCB2aXZpZF9nX3Bhcm1fdGNoKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAoraW50IHZpdmlkX2dfcGFybV90Y2goc3RydWN0IGZpbGUgKmZpbGUsCisJCSAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCSAgICAgc3RydWN0IHY0bDJfc3Ry
ZWFtcGFybSAqcGFybSk7CiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVzdC1k
cml2ZXJzL3ZpdmlkL3ZpdmlkLXZiaS1jYXAuYyBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJz
L3ZpdmlkL3ZpdmlkLXZiaS1jYXAuYwppbmRleCA3OTEzODJhNTRiNGYwYTExMWNmMzJhNGRjYTgy
ZTU3YThjMWMyZGE5Li5mYTJmYzU2MTNmZDhkZjEyODg2YTk4NWRhNzBkZGE2NTE4M2IwMTJlIDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12YmktY2Fw
LmMKKysrIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmJpLWNhcC5j
CkBAIC0yMzIsNyArMjMyLDggQEAgY29uc3Qgc3RydWN0IHZiMl9vcHMgdml2aWRfdmJpX2NhcF9x
b3BzID0gewogCS5idWZfcmVxdWVzdF9jb21wbGV0ZQk9IHZiaV9jYXBfYnVmX3JlcXVlc3RfY29t
cGxldGUsCiB9OwogCi1pbnQgdmlkaW9jX2dfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitpbnQgdmlkaW9jX2dfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtMjQ1LDExICsyNDYsMTIgQEAgaW50IHZpZGlvY19nX2ZtdF92YmlfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1pbnQgdmlkaW9jX3Nf
Zm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdmlkaW9jX3Nf
Zm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgdml2
aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwotCWludCByZXQgPSB2aWRpb2NfZ19m
bXRfdmJpX2NhcChmaWxlLCBwcml2LCBmKTsKKwlpbnQgcmV0ID0gdmlkaW9jX2dfZm10X3ZiaV9j
YXAoZmlsZSwgc3RhdGUsIGYpOwogCiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKQEAgLTI4Miw3
ICsyODQsOSBAQCB2b2lkIHZpdmlkX2ZpbGxfc2VydmljZV9saW5lcyhzdHJ1Y3QgdjRsMl9zbGlj
ZWRfdmJpX2Zvcm1hdCAqdmJpLCB1MzIgc2VydmljZV9zZQogCX0KIH0KIAotaW50IHZpZGlvY19n
X2ZtdF9zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmbXQpCitpbnQgdmlkaW9jX2dfZm10X3NsaWNlZF92YmlfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
CXN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9mb3JtYXQgKnZiaSA9
ICZmbXQtPmZtdC5zbGljZWQ7CkBAIC0yOTQsNyArMjk4LDkgQEAgaW50IHZpZGlvY19nX2ZtdF9z
bGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJf
Zm9ybWEKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY190cnlfZm10X3NsaWNlZF92YmlfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkK
K2ludCB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKIAlzdHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2Zvcm1hdCAqdmJpID0gJmZtdC0+Zm10LnNs
aWNlZDsKQEAgLTMxMCwxMSArMzE2LDEzIEBAIGludCB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJp
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9yCiAJcmV0
dXJuIDA7CiB9CiAKLWludCB2aWRpb2Nfc19mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQoraW50IHZpZGlvY19z
X2ZtdF9zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlz
dHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2NGwy
X3NsaWNlZF92YmlfZm9ybWF0ICp2YmkgPSAmZm10LT5mbXQuc2xpY2VkOwotCWludCByZXQgPSB2
aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX2NhcChmaWxlLCBwcml2LCBmbXQpOworCWludCByZXQg
PSB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX2NhcChmaWxlLCBzdGF0ZSwgZm10KTsKIAogCWlm
IChyZXQpCiAJCXJldHVybiByZXQ7CkBAIC0zMjQsNyArMzMyLDkgQEAgaW50IHZpZGlvY19zX2Zt
dF9zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0
bDJfZm9ybWEKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY19nX3NsaWNlZF92YmlfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2NhcCAq
Y2FwKQoraW50IHZpZGlvY19nX3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVjdCB2NGwy
X3NsaWNlZF92YmlfY2FwICpjYXApCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0
YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3Zp
dmlkLXZiaS1jYXAuaCBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZi
aS1jYXAuaAppbmRleCBlYzJkMjAwYzllMGQzNTA2YWJmMTJlMTk4ZmY0YzMwOGZkZjY4ZjkwLi4w
NTRhOTM5ODYzYWFkN2QzMGJlMTBlZDEzMjU2NTgzYTRmZTAyMjdlIDEwMDY0NAotLS0gYS9kcml2
ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12YmktY2FwLmgKKysrIGIvZHJpdmVy
cy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmJpLWNhcC5oCkBAIC0xMiwxNCArMTIs
MjQgQEAgdm9pZCB2aXZpZF9maWxsX3RpbWVfb2ZfZGF5X3BhY2tldCh1OCAqcGFja2V0KTsKIHZv
aWQgdml2aWRfcmF3X3ZiaV9jYXBfcHJvY2VzcyhzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYsIHN0cnVj
dCB2aXZpZF9idWZmZXIgKmJ1Zik7CiB2b2lkIHZpdmlkX3NsaWNlZF92YmlfY2FwX3Byb2Nlc3Mo
c3RydWN0IHZpdmlkX2RldiAqZGV2LCBzdHJ1Y3Qgdml2aWRfYnVmZmVyICpidWYpOwogdm9pZCB2
aXZpZF9zbGljZWRfdmJpX291dF9wcm9jZXNzKHN0cnVjdCB2aXZpZF9kZXYgKmRldiwgc3RydWN0
IHZpdmlkX2J1ZmZlciAqYnVmKTsKLWludCB2aWRpb2NfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2Nfc19mbXRfdmJpX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2Nfc19mbXRfdmJpX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2NfZ19mbXRfc2xpY2VkX3ZiaV9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KTsKLWlu
dCB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpOwotaW50IHZpZGlvY19zX2ZtdF9zbGljZWRf
dmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmbXQpOwotaW50IHZpZGlvY19nX3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2NhcCAqY2FwKTsKK2ludCB2aWRpb2Nf
Z19mbXRfc2xpY2VkX3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpOworaW50
IHZpZGlvY190cnlfZm10X3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmZtdCk7CitpbnQgdmlkaW9jX3NfZm10X3NsaWNlZF92YmlfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2
NGwyX2Zvcm1hdCAqZm10KTsKK2ludCB2aWRpb2NfZ19zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAg
ICBzdHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2NhcCAqY2FwKTsKIAogdm9pZCB2aXZpZF9maWxsX3Nl
cnZpY2VfbGluZXMoc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9mb3JtYXQgKnZiaSwgdTMyIHNlcnZp
Y2Vfc2V0KTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQv
dml2aWQtdmJpLW91dC5jIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQt
dmJpLW91dC5jCmluZGV4IDdiM2VhOTY3NDRiYjA0ZTM3NjQ0YmMyODhjNTg3OWFjMjgxMmZiYjMu
LmM3Mzk2YjdjMTk5YmRlZDc5MmZjMjBhNTc1ZGIzMGY0YTBiOGEyMzQgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZiaS1vdXQuYworKysgYi9kcml2
ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12Ymktb3V0LmMKQEAgLTEzMCw3ICsx
MzAsOCBAQCBjb25zdCBzdHJ1Y3QgdmIyX29wcyB2aXZpZF92Ymlfb3V0X3FvcHMgPSB7CiAJLmJ1
Zl9yZXF1ZXN0X2NvbXBsZXRlCT0gdmJpX291dF9idWZfcmVxdWVzdF9jb21wbGV0ZSwKIH07CiAK
LWludCB2aWRpb2NfZ19mbXRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K2ludCB2aWRpb2NfZ19mbXRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNTMs
MTEgKzE1NCwxMiBAQCBpbnQgdmlkaW9jX2dfZm10X3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aWRpb2Nfc19mbXRfdmJpX291dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2Nfc19mbXRfdmJpX291dChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7Ci0JaW50IHJldCA9IHZpZGlvY19nX2ZtdF92Ymlfb3V0KGZp
bGUsIHByaXYsIGYpOworCWludCByZXQgPSB2aWRpb2NfZ19mbXRfdmJpX291dChmaWxlLCBzdGF0
ZSwgZik7CiAKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwpAQCAtMTY4LDcgKzE3MCw5IEBAIGlu
dCB2aWRpb2Nfc19mbXRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY19nX2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCitpbnQgdmlkaW9j
X2dfZm10X3NsaWNlZF92Ymlfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewog
CXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHY0
bDJfc2xpY2VkX3ZiaV9mb3JtYXQgKnZiaSA9ICZmbXQtPmZtdC5zbGljZWQ7CkBAIC0xODAsNyAr
MTg0LDkgQEAgaW50IHZpZGlvY19nX2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWEKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZp
ZGlvY190cnlfZm10X3NsaWNlZF92Ymlfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK2ludCB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJp
X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHZpdmlk
X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9zbGljZWRfdmJp
X2Zvcm1hdCAqdmJpID0gJmZtdC0+Zm10LnNsaWNlZDsKQEAgLTE5NiwxMiArMjAyLDEyIEBAIGlu
dCB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfZm9yCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aWRpb2Nfc19mbXRf
c2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2
NGwyX2Zvcm1hdCAqZm10KQoraW50IHZpZGlvY19zX2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2Zvcm1hdCAqdmJpID0gJmZtdC0+
Zm10LnNsaWNlZDsKLQlpbnQgcmV0ID0gdmlkaW9jX3RyeV9mbXRfc2xpY2VkX3ZiaV9vdXQoZmls
ZSwgcHJpdiwgZm10KTsKKwlpbnQgcmV0ID0gdmlkaW9jX3RyeV9mbXRfc2xpY2VkX3ZiaV9vdXQo
ZmlsZSwgc3RhdGUsIGZtdCk7CiAKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmJpLW91dC5oIGIvZHJp
dmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmJpLW91dC5oCmluZGV4IGEyOGU1
NTUxOWFkZTI4NjA2NmQzODczMmNhNjgxNTc4NmUxOGZmOTAuLjk3NTk4NjBmOWJiMTYwMGM3MWIw
MjMxNGMxMmY2ZDU0ZmFmMjQyNWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2
ZXJzL3ZpdmlkL3ZpdmlkLXZiaS1vdXQuaAorKysgYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVy
cy92aXZpZC92aXZpZC12Ymktb3V0LmgKQEAgLTksMTMgKzksMjEgQEAKICNkZWZpbmUgX1ZJVklE
X1ZCSV9PVVRfSF8KIAogdm9pZCB2aXZpZF9zbGljZWRfdmJpX291dF9wcm9jZXNzKHN0cnVjdCB2
aXZpZF9kZXYgKmRldiwgc3RydWN0IHZpdmlkX2J1ZmZlciAqYnVmKTsKLWludCB2aWRpb2NfZ19m
bXRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfZ19m
bXRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2Nfc19m
bXRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2Nfc19m
bXRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2NfZ19m
bXRfc2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZm10KTsKLWludCB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX291dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpOwotaW50
IHZpZGlvY19zX2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpOworaW50IHZpZGlvY19nX2ZtdF9zbGljZWRfdmJp
X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCk7CitpbnQgdmlkaW9jX3RyeV9mbXRf
c2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KTsKK2ludCB2
aWRpb2Nfc19mbXRfc2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQp
OwogCiBleHRlcm4gY29uc3Qgc3RydWN0IHZiMl9vcHMgdml2aWRfdmJpX291dF9xb3BzOwogCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12aWQtY2Fw
LmMgYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12aWQtY2FwLmMKaW5k
ZXggOGIzMTYyZTgyMDMyNzFlNzcwOGI0YjhhNzM4OWRhOTg3M2FmZjQwYy4uMDk0Y2JkNTc5MjQ0
OGNjODlkNDU1ZmNhZThlZmQwNWE3NjljMDlmYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS90
ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlkLWNhcC5jCisrKyBiL2RyaXZlcnMvbWVkaWEvdGVz
dC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZpZC1jYXAuYwpAQCAtNTE4LDcgKzUxOCw4IEBAIHN0YXRp
YyB1bnNpZ25lZCB2aXZpZF9xdWFudGl6YXRpb25fY2FwKHN0cnVjdCB2aXZpZF9kZXYgKmRldikK
IAlyZXR1cm4gZGV2LT5xdWFudGl6YXRpb25fb3V0OwogfQogCi1pbnQgdml2aWRfZ19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aXZpZF9nX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpk
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNTQ3LDcgKzU0OCw4IEBAIGludCB2aXZpZF9n
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1pbnQgdml2aWRfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAoraW50IHZpdmlkX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCiB7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKm1wID0gJmYtPmZtdC5waXhf
bXA7CkBAIC02NjAsNyArNjYyLDggQEAgaW50IHZpdmlkX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX3NfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdml2aWRfc19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHY0bDJfcGl4
X2Zvcm1hdF9tcGxhbmUgKm1wID0gJmYtPmZtdC5waXhfbXA7CkBAIC02NjgsNyArNjcxLDcgQEAg
aW50IHZpdmlkX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
c3RydWN0IHY0bDJfcmVjdCAqY3JvcCA9ICZkZXYtPmNyb3BfY2FwOwogCXN0cnVjdCB2NGwyX3Jl
Y3QgKmNvbXBvc2UgPSAmZGV2LT5jb21wb3NlX2NhcDsKIAlzdHJ1Y3QgdmIyX3F1ZXVlICpxID0g
JmRldi0+dmJfdmlkX2NhcF9xOwotCWludCByZXQgPSB2aXZpZF90cnlfZm10X3ZpZF9jYXAoZmls
ZSwgcHJpdiwgZik7CisJaW50IHJldCA9IHZpdmlkX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0
ZSwgZik7CiAJdW5zaWduZWQgZmFjdG9yID0gMTsKIAl1bnNpZ25lZCBwOwogCXVuc2lnbmVkIGk7
CkBAIC03OTMsNjcgKzc5Niw3NCBAQCBpbnQgdml2aWRfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY19nX2ZtdF92
aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2Nf
Z19mbXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCiAJaWYgKCFkZXYt
Pm11bHRpcGxhbmFyKQogCQlyZXR1cm4gLUVOT1RUWTsKLQlyZXR1cm4gdml2aWRfZ19mbXRfdmlk
X2NhcChmaWxlLCBwcml2LCBmKTsKKwlyZXR1cm4gdml2aWRfZ19mbXRfdmlkX2NhcChmaWxlLCBz
dGF0ZSwgZik7CiB9CiAKLWludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwX21wbGFu
ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlpZiAoIWRldi0+bXVsdGlwbGFuYXIpCiAJCXJl
dHVybiAtRU5PVFRZOwotCXJldHVybiB2aXZpZF90cnlfZm10X3ZpZF9jYXAoZmlsZSwgcHJpdiwg
Zik7CisJcmV0dXJuIHZpdmlkX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7CiB9CiAK
LWludCB2aWRpb2Nfc19mbXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXBfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKIAlpZiAoIWRldi0+bXVsdGlwbGFuYXIpCiAJCXJldHVybiAtRU5PVFRZOwotCXJldHVy
biB2aXZpZF9zX2ZtdF92aWRfY2FwKGZpbGUsIHByaXYsIGYpOworCXJldHVybiB2aXZpZF9zX2Zt
dF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIH0KIAotaW50IHZpZGlvY19nX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHZpZGlvY19nX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAogCWlmIChkZXYtPm11bHRpcGxhbmFyKQogCQlyZXR1
cm4gLUVOT1RUWTsKLQlyZXR1cm4gZm10X3NwMm1wX2Z1bmMoZmlsZSwgcHJpdiwgZiwgdml2aWRf
Z19mbXRfdmlkX2NhcCk7CisJcmV0dXJuIGZtdF9zcDJtcF9mdW5jKGZpbGUsIHN0YXRlLCBmLCB2
aXZpZF9nX2ZtdF92aWRfY2FwKTsKIH0KIAotaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlpZiAoZGV2LT5tdWx0aXBsYW5hcikKIAkJcmV0dXJu
IC1FTk9UVFk7Ci0JcmV0dXJuIGZtdF9zcDJtcF9mdW5jKGZpbGUsIHByaXYsIGYsIHZpdmlkX3Ry
eV9mbXRfdmlkX2NhcCk7CisJcmV0dXJuIGZtdF9zcDJtcF9mdW5jKGZpbGUsIHN0YXRlLCBmLCB2
aXZpZF90cnlfZm10X3ZpZF9jYXApOwogfQogCi1pbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIAogCWlmIChkZXYtPm11bHRpcGxhbmFyKQogCQlyZXR1cm4gLUVO
T1RUWTsKLQlyZXR1cm4gZm10X3NwMm1wX2Z1bmMoZmlsZSwgcHJpdiwgZiwgdml2aWRfc19mbXRf
dmlkX2NhcCk7CisJcmV0dXJuIGZtdF9zcDJtcF9mdW5jKGZpbGUsIHN0YXRlLCBmLCB2aXZpZF9z
X2ZtdF92aWRfY2FwKTsKIH0KIAotaW50IHZpdmlkX3ZpZF9jYXBfZ19zZWxlY3Rpb24oc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdml2aWRfdmlkX2NhcF9nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0IHZp
dmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTg5OSw3ICs5MDksOSBAQCBp
bnQgdml2aWRfdmlkX2NhcF9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX3ZpZF9jYXBfc19zZWxlY3Rpb24oc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK2ludCB2
aXZpZF92aWRfY2FwX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxl
Y3Rpb24gKnMpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKIAlzdHJ1Y3QgdjRsMl9yZWN0ICpjcm9wID0gJmRldi0+Y3JvcF9jYXA7CkBAIC0xMDMxLDgg
KzEwNDMsOSBAQCBpbnQgdml2aWRfdmlkX2NhcF9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfc2VsZWN0aQogCXJldHVybiAwOwogfQogCi1pbnQg
dml2aWRfdmlkX2NhcF9nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAotCQkJCWludCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAqZikKK2ludCB2aXZpZF92aWRfY2Fw
X2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsIGludCB0eXBlLAorCQkJCXN0cnVjdCB2NGwyX2ZyYWN0ICpmKQogewog
CXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTEwNTks
NyArMTA3Miw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyB2aXZpZF9hdWRpb19p
bnB1dHNbXSA9IHsKIAl7IDEsICJMaW5lLUluIiwgVjRMMl9BVURDQVBfU1RFUkVPIH0sCiB9Owog
Ci1pbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitp
bnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCSAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2lucHV0ICppbnApCiB7
CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTExMjgs
NyArMTE0Miw4IEBAIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCAqaSkKK2ludCB2aWRpb2NfZ19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgIHVu
c2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwogCkBAIC0xMTM2LDcgKzExNTEsOCBAQCBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkICppKQogCXJldHVybiAwOwogfQogCi1p
bnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGkpCitpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlzdHJ1Y3Qgdml2
aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2NGwyX2J0X3RpbWlu
Z3MgKmJ0ID0gJmRldi0+ZHZfdGltaW5nc19jYXBbZGV2LT5pbnB1dF0uYnQ7CkBAIC0xMjIyLDcg
KzEyMzgsOCBAQCBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHVuc2lnbmVkIGkpCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aWRpb2NfZW51bWF1ZGlvKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9hdWRpbyAqdmluKQoraW50
IHZpZGlvY19lbnVtYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkgICAgIHN0cnVjdCB2NGwyX2F1ZGlvICp2aW4pCiB7CiAJaWYgKHZp
bi0+aW5kZXggPj0gQVJSQVlfU0laRSh2aXZpZF9hdWRpb19pbnB1dHMpKQogCQlyZXR1cm4gLUVJ
TlZBTDsKQEAgLTEyMzAsNyArMTI0Nyw4IEBAIGludCB2aWRpb2NfZW51bWF1ZGlvKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9hdWRpbyAqdmluKQogCXJldHVybiAw
OwogfQogCi1pbnQgdmlkaW9jX2dfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX2F1ZGlvICp2aW4pCitpbnQgdmlkaW9jX2dfYXVkaW8oc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICBzdHJ1Y3QgdjRs
Ml9hdWRpbyAqdmluKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAKQEAgLTEyNDAsNyArMTI1OCw4IEBAIGludCB2aWRpb2NfZ19hdWRpbyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYXVkaW8gKnZpbikKIAlyZXR1cm4g
MDsKIH0KIAotaW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyAqdmluKQoraW50IHZpZGlvY19zX2F1ZGlvKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgY29u
c3Qgc3RydWN0IHY0bDJfYXVkaW8gKnZpbikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMjUyLDcgKzEyNzEsOSBAQCBpbnQgdmlkaW9jX3Nf
YXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2F1
ZGlvICp2aW4pCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aXZpZF92aWRlb19nX2ZyZXF1ZW5jeShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikK
K2ludCB2aXZpZF92aWRlb19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9mcmVx
dWVuY3kgKnZmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKQEAgLTEyNjIsNyArMTI4Myw5IEBAIGludCB2aXZpZF92aWRlb19nX2ZyZXF1ZW5jeShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJlcXVlbmN5CiAJcmV0
dXJuIDA7CiB9CiAKLWludCB2aXZpZF92aWRlb19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikKK2ludCB2aXZp
ZF92aWRlb19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVu
Y3kgKnZmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CiAKQEAgLTEyNzQsNyArMTI5Nyw4IEBAIGludCB2aXZpZF92aWRlb19zX2ZyZXF1ZW5jeShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJfZnJlCiAJcmV0dXJu
IDA7CiB9CiAKLWludCB2aXZpZF92aWRlb19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LCBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCitpbnQgdml2aWRfdmlkZW9fc190
dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQljb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTI4Niw3ICsxMzEwLDggQEAgaW50IHZp
dmlkX3ZpZGVvX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0
cnVjdCB2NGwyX3R1bmVyICoKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX3ZpZGVvX2dfdHVu
ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3R1bmVyICp2dCkK
K2ludCB2aXZpZF92aWRlb19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX3R1bmVyICp2dCkKIHsKIAlzdHJ1
Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWVudW0gdHBnX3F1YWxp
dHkgcXVhbDsKQEAgLTEzNzcsNyArMTQwMiw4IEBAIGNvbnN0IGNoYXIgKiBjb25zdCB2aXZpZF9j
dHJsX3N0YW5kYXJkX3N0cmluZ3NbXSA9IHsKIAlOVUxMLAogfTsKIAotaW50IHZpZGlvY19xdWVy
eXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKmlkKQoraW50
IHZpZGlvY19xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCSAgICB2NGwyX3N0ZF9pZCAqaWQpCiB7CiAJc3RydWN0IHZpdmlkX2Rl
diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAl1bnNpZ25lZCBpbnQgbGFzdCA9IGRldi0+
cXVlcnlfc3RkX2xhc3RbZGV2LT5pbnB1dF07CkBAIC0xNDA0LDcgKzE0MzAsOCBAQCBpbnQgdmlk
aW9jX3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAq
aWQpCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aXZpZF92aWRfY2FwX3Nfc3RkKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBpZCkKK2ludCB2aXZpZF92aWRfY2FwX3Nf
c3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCXY0bDJfc3RkX2lkIGlkKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAKQEAgLTE0OTAsNyArMTUxNyw4IEBAIHN0YXRpYyBib29sIHZhbGlkX2N2
dF9ndGZfdGltaW5ncyhzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogCXJldHVybiBm
YWxzZTsKIH0KIAotaW50IHZpdmlkX3ZpZF9jYXBfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAoraW50IHZpdmlkX3ZpZF9jYXBfc19kdl90aW1pbmdzKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCSAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCB2aXZp
ZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNTEzLDcgKzE1NDEsOCBAQCBp
bnQgdml2aWRfdmlkX2NhcF9zX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aWRpb2NfcXVlcnlfZHZfdGltaW5ncyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfcXVlcnlfZHZfdGltaW5ncyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgICAgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlzdHJ1Y3Qgdml2
aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTYwMCw3ICsxNjI5LDggQEAg
dm9pZCB2aXZpZF91cGRhdGVfY29ubmVjdGVkX291dHB1dHMoc3RydWN0IHZpdmlkX2RldiAqZGV2
KQogCX0KIH0KIAotaW50IHZpZGlvY19zX2VkaWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitpbnQgdmlkaW9jX3NfZWRpZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3QgdjRsMl9lZGlkICplZGlkKQogewog
CXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNjM4LDcg
KzE2NjgsOCBAQCBpbnQgdmlkaW9jX3NfZWRpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CQkgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCB2aXZpZF9kZXYg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNjY3LDcgKzE2OTgsOCBAQCBpbnQgdmlk
aW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIAog
LyogdGltZXBlcmZyYW1lIGlzIGFyYml0cmFyeSBhbmQgY29udGludW91cyAqLwotaW50IHZpZGlv
Y19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50
IHZpZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgICAgIHN0cnVjdCB2NGwy
X2ZybWl2YWxlbnVtICpmaXZhbCkKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtMTcwMyw3ICsxNzM1LDggQEAgaW50IHZpZGlvY19lbnVtX2ZyYW1l
aW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQog
Ci1pbnQgdml2aWRfdmlkX2NhcF9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitpbnQgdml2aWRfdmlkX2NhcF9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0g
KnBhcm0pCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTE3MTksNyArMTc1Miw4IEBAIGludCB2aXZpZF92aWRfY2FwX2dfcGFybShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX3ZpZF9jYXBf
c19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHZpdmlkX3ZpZF9jYXBf
c19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQogewogCXN0cnVjdCB2
aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNzMyLDcgKzE3NjYsNyBA
QCBpbnQgdml2aWRfdmlkX2NhcF9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJCQkgICBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkUpKQogCQlyZXR1cm4gLUVJTlZBTDsK
IAlpZiAoIXZpdmlkX2lzX3dlYmNhbShkZXYpKQotCQlyZXR1cm4gdml2aWRfdmlkX2NhcF9nX3Bh
cm0oZmlsZSwgcHJpdiwgcGFybSk7CisJCXJldHVybiB2aXZpZF92aWRfY2FwX2dfcGFybShmaWxl
LCBzdGF0ZSwgcGFybSk7CiAKIAl0cGYgPSBwYXJtLT5wYXJtLmNhcHR1cmUudGltZXBlcmZyYW1l
OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12
aWQtY2FwLmggYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12aWQtY2Fw
LmgKaW5kZXggMzhhOTlmN2UwMzhlYWExMzQ3N2Q1Y2U4ZmY3ZDQ0OTdiNTU3ZjkwNS4uMTc1Y2Yw
ZDM4OGRjNjgyMTQxNDU5M2M5MTEyZmUxNzE5NTNmYzhkMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9t
ZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlkLWNhcC5oCisrKyBiL2RyaXZlcnMvbWVk
aWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZpZC1jYXAuaApAQCAtMTksNDAgKzE5LDg3IEBA
IGV4dGVybiBjb25zdCBjaGFyICogY29uc3Qgdml2aWRfY3RybF9zdGFuZGFyZF9zdHJpbmdzW107
CiAKIGV4dGVybiBjb25zdCBzdHJ1Y3QgdmIyX29wcyB2aXZpZF92aWRfY2FwX3FvcHM7CiAKLWlu
dCB2aXZpZF9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpOwotaW50IHZpdmlkX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aXZpZF9z
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpOwotaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2NfdHJ5
X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2Nfc19mbXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1pbnQgdmlk
aW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZik7Ci1pbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2Nfc19m
bXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKTsKLWludCB2aXZpZF92aWRfY2FwX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCk7Ci1pbnQgdml2aWRfdmlk
X2NhcF9zX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0
bDJfc2VsZWN0aW9uICpzKTsKLWludCB2aXZpZF92aWRfY2FwX2dfcGl4ZWxhc3BlY3Qoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGludCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAqZik7
Ci1pbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZik7Ci1pbnQgdmlkaW9jX2dfZm10X3ZpZF9v
dmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpOwotaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotaW50IHZpZGlvY19zX2ZtdF92aWRf
b3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKTsKLWludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgc3RydWN0IHY0bDJfaW5wdXQgKmlucCk7Ci1pbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkICppKTsKLWludCB2aWRpb2Nfc19pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaSk7Ci1pbnQgdmlkaW9jX2Vu
dW1hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYXVkaW8g
KnZpbik7Ci1pbnQgdmlkaW9jX2dfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX2F1ZGlvICp2aW4pOwotaW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyAqdmluKTsKLWludCB2
aXZpZF92aWRlb19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfZnJlcXVlbmN5ICp2Zik7Ci1pbnQgdml2aWRfdmlkZW9fc19mcmVxdWVuY3koc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAq
dmYpOwotaW50IHZpdmlkX3ZpZGVvX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2dCk7Ci1pbnQgdml2aWRfdmlkZW9fZ190dW5l
cihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KTsK
LWludCB2aWRpb2NfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJf
c3RkX2lkICppZCk7Ci1pbnQgdml2aWRfdmlkX2NhcF9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgaWQpOwotaW50IHZpdmlkX3ZpZF9jYXBfc19kdl90aW1p
bmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdz
ICp0aW1pbmdzKTsKLWludCB2aWRpb2NfcXVlcnlfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncyk7Ci1pbnQgdmlk
aW9jX3NfZWRpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZWRp
ZCAqZWRpZCk7Ci1pbnQgdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKTsKLWludCB2aWRpb2Nf
ZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFsKTsKLWludCB2aXZpZF92aWRfY2FwX2dfcGFybShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSk7
Ci1pbnQgdml2aWRfdmlkX2NhcF9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pOworaW50IHZpdmlkX2dfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
c3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aXZpZF90cnlfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IHZpdmlkX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKTsKK2ludCB2aWRpb2NfZ19mbXRfdmlkX2NhcF9tcGxhbmUoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwX21wbGFuZShzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRpb2Nfc19mbXRfdmlkX2NhcF9t
cGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRpb2NfZ19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7CitpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZik7CitpbnQgdml2aWRfdmlkX2NhcF9nX3NlbGVjdGlvbihzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpOworaW50IHZpdmlkX3ZpZF9j
YXBfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcyk7
CitpbnQgdml2aWRfdmlkX2NhcF9nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBpbnQgdHlwZSwKKwkJCQlzdHJ1Y3Qg
djRsMl9mcmFjdCAqZik7CitpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYpOworaW50IHZpZGlvY19nX2ZtdF92aWRfb3ZlcmxheShzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7CitpbnQgdmlkaW9jX3RyeV9mbXRfdmlk
X292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2
aWRpb2Nfc19mbXRfdmlkX292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpOworaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmlucCk7
CitpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgICB1bnNpZ25lZCBpbnQgKmkpOworaW50IHZpZGlvY19zX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJICAgdW5zaWduZWQgaW50IGkpOworaW50IHZpZGlvY19lbnVtYXVkaW8oc3RydWN0IGZpbGUg
KmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgIHN0cnVjdCB2
NGwyX2F1ZGlvICp2aW4pOworaW50IHZpZGlvY19nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgc3RydWN0IHY0bDJfYXVkaW8g
KnZpbik7CitpbnQgdmlkaW9jX3NfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyAqdmlu
KTsKK2ludCB2aXZpZF92aWRlb19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgc3RydWN0IHY0bDJfZnJlcXVlbmN5
ICp2Zik7CitpbnQgdml2aWRfdmlkZW9fc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgIGNvbnN0IHN0cnVjdCB2NGwy
X2ZyZXF1ZW5jeSAqdmYpOworaW50IHZpdmlkX3ZpZGVvX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJY29uc3Qgc3RydWN0IHY0
bDJfdHVuZXIgKnZ0KTsKK2ludCB2aXZpZF92aWRlb19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVjdCB2NGwyX3R1bmVy
ICp2dCk7CitpbnQgdmlkaW9jX3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIHY0bDJfc3RkX2lkICppZCk7CitpbnQgdml2
aWRfdmlkX2NhcF9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQl2NGwyX3N0ZF9pZCBpZCk7CitpbnQgdml2aWRfdmlkX2NhcF9zX2R2
X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICAgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5n
cyk7CitpbnQgdmlkaW9jX3F1ZXJ5X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVjdCB2NGwyX2R2X3RpbWlu
Z3MgKnRpbWluZ3MpOworaW50IHZpZGlvY19zX2VkaWQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgIHN0cnVjdCB2NGwyX2VkaWQgKmVkaWQp
OworaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0g
KmZzaXplKTsKK2ludCB2aWRpb2NfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAg
ICBzdHJ1Y3QgdjRsMl9mcm1pdmFsZW51bSAqZml2YWwpOworaW50IHZpdmlkX3ZpZF9jYXBfZ19w
YXJtKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKTsKK2ludCB2aXZpZF92aWRfY2FwX3Nf
cGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlkLWNvbW1vbi5jIGIv
ZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlkLWNvbW1vbi5jCmluZGV4
IDc4NmExYWEzYjI2YjcwNThhMDI1ODk1YmExYjFmNGNmMDM5NDAzNzYuLjMwYjdjOWQ0ZmY3ZDdi
MzNkMDliNWQ5OTI3NmMwY2NhNDE1OWUwNTQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVz
dC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZpZC1jb21tb24uYworKysgYi9kcml2ZXJzL21lZGlhL3Rl
c3QtZHJpdmVycy92aXZpZC92aXZpZC12aWQtY29tbW9uLmMKQEAgLTg4Niw4ICs4ODYsOCBAQCB2
b2lkIGZtdF9zcDJtcChjb25zdCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKnNwX2ZtdCwgc3RydWN0IHY0
bDJfZm9ybWF0ICptcF9mbXQpCiAJbWVtc2V0KHBwaXgtPnJlc2VydmVkLCAwLCBzaXplb2YocHBp
eC0+cmVzZXJ2ZWQpKTsKIH0KIAotaW50IGZtdF9zcDJtcF9mdW5jKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYsIGZtdGZ1bmMgZnVuYykKK2lu
dCBmbXRfc3AybXBfZnVuYyhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZiwKKwkJICAgZm10ZnVuYyBmdW5jKQog
ewogCXN0cnVjdCB2NGwyX2Zvcm1hdCBmbXQ7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxh
bmUgKm1wID0gJmZtdC5mbXQucGl4X21wOwpAQCAtODk4LDcgKzg5OCw3IEBAIGludCBmbXRfc3Ay
bXBfZnVuYyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAkvKiBDb252ZXJ0cyB0byBh
IG1wbGFuZSBmb3JtYXQgKi8KIAlmbXRfc3AybXAoZiwgJmZtdCk7CiAJLyogUGFzc2VzIGl0IHRv
IHRoZSBnZW5lcmljIG1wbGFuZSBmb3JtYXQgZnVuY3Rpb24gKi8KLQlyZXQgPSBmdW5jKGZpbGUs
IHByaXYsICZmbXQpOworCXJldCA9IGZ1bmMoZmlsZSwgc3RhdGUsICZmbXQpOwogCS8qIENvcGll
cyBiYWNrIHRoZSBtcGxhbmUgZGF0YSB0byB0aGUgc2luZ2xlIHBsYW5lIGZvcm1hdCAqLwogCXBp
eC0+d2lkdGggPSBtcC0+d2lkdGg7CiAJcGl4LT5oZWlnaHQgPSBtcC0+aGVpZ2h0OwpAQCAtOTYz
LDcgKzk2Myw4IEBAIGludCB2aXZpZF92aWRfYWRqdXN0X3NlbCh1bnNpZ25lZCBmbGFncywgc3Ry
dWN0IHY0bDJfcmVjdCAqcikKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX2VudW1fZm10X3Zp
ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitpbnQgdml2aWRfZW51bV9mbXRfdmlk
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IHZpdmlkX2Rl
diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEwMDQsNyArMTAwNSw4IEBAIGludCB2
aXZpZF9lbnVtX2ZtdF92aWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAogCXJldHVy
biAwOwogfQogCi1pbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCB2NGwyX3N0ZF9pZCAqaWQpCitpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJIHY0bDJfc3RkX2lkICppZCkKIHsK
IAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMTAyMSw3ICsxMDIz
LDggQEAgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRs
Ml9zdGRfaWQgKmlkKQogCXJldHVybiAwOwogfQogCi1pbnQgdmlkaW9jX2dfZHZfdGltaW5ncyhz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfZ19kdl90aW1pbmdzKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCiB7CiAJc3RydWN0IHZpdmlk
X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEwMzksNyArMTA0Miw4IEBAIGlu
dCB2aWRpb2NfZ19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1pbnQgdmlkaW9jX2VudW1fZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfZW51bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0
cnVjdCB2NGwyX2VudW1fZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTA1Niw3ICsxMDYwLDggQEAgaW50IHZp
ZGlvY19lbnVtX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJCQlO
VUxMLCBOVUxMKTsKIH0KIAotaW50IHZpZGlvY19kdl90aW1pbmdzX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2aWRpb2NfZHZfdGltaW5nc19jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBz
dHJ1Y3QgdjRsMl9kdl90aW1pbmdzX2NhcCAqY2FwKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDczLDcgKzEwNzgsOCBAQCBpbnQgdmlkaW9j
X2R2X3RpbWluZ3NfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAw
OwogfQogCi1pbnQgdmlkaW9jX2dfZWRpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K2ludCB2aWRpb2NfZ19lZGlkKHN0cnVjdCBmaWxlICpmaWxlLAorCQkgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX2VkaWQgKmVkaWQpCiB7CiAJc3Ry
dWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZpZC1jb21tb24uaCBiL2RyaXZl
cnMvbWVkaWEvdGVzdC1kcml2ZXJzL3ZpdmlkL3ZpdmlkLXZpZC1jb21tb24uaAppbmRleCBmYjU4
NzgxNzRkYmE0Y2MxZWQ2NTg0NmY4NWJjYTQwMjBjYWUwOWNjLi4wMGEyYWI2NmVhZTBiOTdjNGQx
YTBkYzY1NjVkNDk2ODJlNTc3YzMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Rlc3QtZHJp
dmVycy92aXZpZC92aXZpZC12aWQtY29tbW9uLmgKKysrIGIvZHJpdmVycy9tZWRpYS90ZXN0LWRy
aXZlcnMvdml2aWQvdml2aWQtdmlkLWNvbW1vbi5oCkBAIC04LDM0ICs4LDQ0IEBACiAjaWZuZGVm
IF9WSVZJRF9WSURfQ09NTU9OX0hfCiAjZGVmaW5lIF9WSVZJRF9WSURfQ09NTU9OX0hfCiAKLXR5
cGVkZWYgaW50ICgqZm10ZnVuYykoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZik7Cit0eXBlZGVmIGludCAoKmZtdGZ1bmMpKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZik7CiAKIC8qCiAgKiBDb252ZXJzaW9uIGZ1bmN0aW9uIHRoYXQgY29udmVy
dHMgYSBzaW5nbGUtcGxhbmFyIGZvcm1hdCB0byBhCiAgKiBzaW5nbGUtcGxhbmUgbXVsdGlwbGFu
YXIgZm9ybWF0LgogICovCiB2b2lkIGZtdF9zcDJtcChjb25zdCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KnNwX2ZtdCwgc3RydWN0IHY0bDJfZm9ybWF0ICptcF9mbXQpOwotaW50IGZtdF9zcDJtcF9mdW5j
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYs
IGZtdGZ1bmMgZnVuYyk7CitpbnQgZm10X3NwMm1wX2Z1bmMoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYsIGZtdGZ1bmMgZnVuYyk7CiAKIGV4dGVybiBjb25zdCBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdz
X2NhcCB2aXZpZF9kdl90aW1pbmdzX2NhcDsKIAotY29uc3Qgc3RydWN0IHZpdmlkX2ZtdCAqdml2
aWRfZ2V0X2Zvcm1hdChzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYsIHUzMiBwaXhlbGZvcm1hdCk7Citj
b25zdCBzdHJ1Y3Qgdml2aWRfZm10ICp2aXZpZF9nZXRfZm9ybWF0KHN0cnVjdCB2aXZpZF9kZXYg
KmRldiwKKwkJCQkJIHUzMiBwaXhlbGZvcm1hdCk7CiAKIHN0cnVjdCB2aXZpZF9kZXYgKnZpdmlk
X2lucHV0X2lzX2Nvbm5lY3RlZF90byhzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYpOwogc3RydWN0IHZp
dmlkX2RldiAqdml2aWRfb3V0cHV0X2lzX2Nvbm5lY3RlZF90byhzdHJ1Y3Qgdml2aWRfZGV2ICpk
ZXYpOwogYm9vbCB2aXZpZF92aWRfY2FuX2xvb3Aoc3RydWN0IHZpdmlkX2RldiAqZGV2KTsKIHZv
aWQgdml2aWRfc2VuZF9zb3VyY2VfY2hhbmdlKHN0cnVjdCB2aXZpZF9kZXYgKmRldiwgdW5zaWdu
ZWQgaW50IHR5cGUpOwotdm9pZCB2aXZpZF9zZW5kX2lucHV0X3NvdXJjZV9jaGFuZ2Uoc3RydWN0
IHZpdmlkX2RldiAqZGV2LCB1bnNpZ25lZCBpbnQgaW5wdXRfaW5kZXgpOwordm9pZCB2aXZpZF9z
ZW5kX2lucHV0X3NvdXJjZV9jaGFuZ2Uoc3RydWN0IHZpdmlkX2RldiAqZGV2LAorCQkJCSAgICB1
bnNpZ25lZCBpbnQgaW5wdXRfaW5kZXgpOwogCiBpbnQgdml2aWRfdmlkX2FkanVzdF9zZWwodW5z
aWduZWQgZmxhZ3MsIHN0cnVjdCB2NGwyX3JlY3QgKnIpOwogCi1pbnQgdml2aWRfZW51bV9mbXRf
dmlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwgc3RydWN0IHY0bDJfZm10ZGVzYyAq
Zik7Ci1pbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwy
X3N0ZF9pZCAqaWQpOwotaW50IHZpZGlvY19nX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpOwotaW50IHZpZGlv
Y19lbnVtX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2
NGwyX2VudW1fZHZfdGltaW5ncyAqdGltaW5ncyk7Ci1pbnQgdmlkaW9jX2R2X3RpbWluZ3NfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzX2Nh
cCAqY2FwKTsKLWludCB2aWRpb2NfZ19lZGlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCBzdHJ1Y3QgdjRsMl9lZGlkICplZGlkKTsKLWludCB2aWRpb2Nfc3Vic2NyaWJlX2V2ZW50KHN0
cnVjdCB2NGwyX2ZoICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfZXZlbnRfc3Vic2NyaXB0aW9uICpz
dWIpOworaW50IHZpdmlkX2VudW1fZm10X3ZpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpm
KTsKK2ludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgdjRsMl9zdGRfaWQgKmlkKTsKK2ludCB2aWRpb2NfZ19kdl90
aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJCXN0cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpOworaW50IHZpZGlvY19lbnVt
X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJICAgc3RydWN0IHY0bDJfZW51bV9kdl90aW1pbmdzICp0aW1pbmdzKTsKK2lu
dCB2aWRpb2NfZHZfdGltaW5nc19jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzX2NhcCAqY2Fw
KTsKK2ludCB2aWRpb2NfZ19lZGlkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJICBzdHJ1Y3QgdjRsMl9lZGlkICplZGlkKTsKK2ludCB2aWRp
b2Nfc3Vic2NyaWJlX2V2ZW50KHN0cnVjdCB2NGwyX2ZoICpmaCwKKwkJCSAgIGNvbnN0IHN0cnVj
dCB2NGwyX2V2ZW50X3N1YnNjcmlwdGlvbiAqc3ViKTsKIAogI2VuZGlmCmRpZmYgLS1naXQgYS9k
cml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12aWQtb3V0LmMgYi9kcml2ZXJz
L21lZGlhL3Rlc3QtZHJpdmVycy92aXZpZC92aXZpZC12aWQtb3V0LmMKaW5kZXggOGMwMzdiOTA4
MzNlNzQ1NjM2NTRhNjBmOGM4ZWNjMjkyZTIxMTUxYy4uYmI1NjQ5MGVhNGM4YTE0ZWFiZjY3N2E4
ZTE2ZDliMjIzNTAzZDQ5NyAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS90ZXN0LWRyaXZlcnMv
dml2aWQvdml2aWQtdmlkLW91dC5jCisrKyBiL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3Zp
dmlkL3ZpdmlkLXZpZC1vdXQuYwpAQCAtMzA4LDggKzMwOCw4IEBAIHN0YXRpYyBlbnVtIHRwZ19w
aXhlbF9hc3BlY3Qgdml2aWRfZ2V0X3BpeGVsX2FzcGVjdChjb25zdCBzdHJ1Y3Qgdml2aWRfZGV2
ICpkZXYpCiAJcmV0dXJuIFRQR19QSVhFTF9BU1BFQ1RfU1FVQVJFOwogfQogCi1pbnQgdml2aWRf
Z19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQoraW50IHZpdmlkX2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKm1wID0gJmYtPmZtdC5waXhfbXA7CkBA
IC0zNDAsOCArMzQwLDggQEAgaW50IHZpdmlkX2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aXZpZF90cnlfZm10X3ZpZF9v
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQlzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCitpbnQgdml2aWRfdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0
IHY0bDJfYnRfdGltaW5ncyAqYnQgPSAmZGV2LT5kdl90aW1pbmdzX291dC5idDsKQEAgLTQzOCwx
NSArNDM4LDE1IEBAIGludCB2aXZpZF90cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aXZpZF9zX2ZtdF92aWRfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CitpbnQgdml2aWRfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKm1wID0gJmYtPmZtdC5waXhfbXA7CiAJc3RydWN0
IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9yZWN0
ICpjcm9wID0gJmRldi0+Y3JvcF9vdXQ7CiAJc3RydWN0IHY0bDJfcmVjdCAqY29tcG9zZSA9ICZk
ZXYtPmNvbXBvc2Vfb3V0OwogCXN0cnVjdCB2YjJfcXVldWUgKnEgPSAmZGV2LT52Yl92aWRfb3V0
X3E7Ci0JaW50IHJldCA9IHZpdmlkX3RyeV9mbXRfdmlkX291dChmaWxlLCBwcml2LCBmKTsKKwlp
bnQgcmV0ID0gdml2aWRfdHJ5X2ZtdF92aWRfb3V0KGZpbGUsIHN0YXRlLCBmKTsKIAl1bnNpZ25l
ZCBmYWN0b3IgPSAxOwogCXVuc2lnbmVkIHA7CiAKQEAgLTU2OCw2NyArNTY4LDcwIEBAIGludCB2
aXZpZF9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1pbnQgdmlkaW9jX2dfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAotCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitpbnQgdmlkaW9j
X2dfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlz
dHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCiAJaWYgKCFkZXYt
Pm11bHRpcGxhbmFyKQogCQlyZXR1cm4gLUVOT1RUWTsKLQlyZXR1cm4gdml2aWRfZ19mbXRfdmlk
X291dChmaWxlLCBwcml2LCBmKTsKKwlyZXR1cm4gdml2aWRfZ19mbXRfdmlkX291dChmaWxlLCBz
dGF0ZSwgZik7CiB9CiAKLWludCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK2ludCB2
aWRpb2NfdHJ5X2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAK
IAlpZiAoIWRldi0+bXVsdGlwbGFuYXIpCiAJCXJldHVybiAtRU5PVFRZOwotCXJldHVybiB2aXZp
ZF90cnlfZm10X3ZpZF9vdXQoZmlsZSwgcHJpdiwgZik7CisJcmV0dXJuIHZpdmlkX3RyeV9mbXRf
dmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiB9CiAKLWludCB2aWRpb2Nfc19mbXRfdmlkX291dF9t
cGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQlzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCitpbnQgdmlkaW9jX3NfZm10X3ZpZF9vdXRfbXBsYW5lKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwogCiAJaWYgKCFkZXYtPm11bHRpcGxhbmFyKQogCQlyZXR1cm4gLUVOT1RUWTsKLQlyZXR1
cm4gdml2aWRfc19mbXRfdmlkX291dChmaWxlLCBwcml2LCBmKTsKKwlyZXR1cm4gdml2aWRfc19m
bXRfdmlkX291dChmaWxlLCBzdGF0ZSwgZik7CiB9CiAKLWludCB2aWRpb2NfZ19mbXRfdmlkX291
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCQkJc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQoraW50IHZpZGlvY19nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7
CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAogCWlmIChk
ZXYtPm11bHRpcGxhbmFyKQogCQlyZXR1cm4gLUVOT1RUWTsKLQlyZXR1cm4gZm10X3NwMm1wX2Z1
bmMoZmlsZSwgcHJpdiwgZiwgdml2aWRfZ19mbXRfdmlkX291dCk7CisJcmV0dXJuIGZtdF9zcDJt
cF9mdW5jKGZpbGUsIHN0YXRlLCBmLCB2aXZpZF9nX2ZtdF92aWRfb3V0KTsKIH0KIAotaW50IHZp
ZGlvY190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX291dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIAogCWlmIChkZXYtPm11bHRpcGxhbmFyKQogCQlyZXR1cm4gLUVOT1RUWTsK
LQlyZXR1cm4gZm10X3NwMm1wX2Z1bmMoZmlsZSwgcHJpdiwgZiwgdml2aWRfdHJ5X2ZtdF92aWRf
b3V0KTsKKwlyZXR1cm4gZm10X3NwMm1wX2Z1bmMoZmlsZSwgc3RhdGUsIGYsIHZpdmlkX3RyeV9m
bXRfdmlkX291dCk7CiB9CiAKLWludCB2aWRpb2Nfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKLQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK2ludCB2aWRpb2Nf
c19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aXZpZF9k
ZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlpZiAoZGV2LT5tdWx0aXBsYW5hcikK
IAkJcmV0dXJuIC1FTk9UVFk7Ci0JcmV0dXJuIGZtdF9zcDJtcF9mdW5jKGZpbGUsIHByaXYsIGYs
IHZpdmlkX3NfZm10X3ZpZF9vdXQpOworCXJldHVybiBmbXRfc3AybXBfZnVuYyhmaWxlLCBzdGF0
ZSwgZiwgdml2aWRfc19mbXRfdmlkX291dCk7CiB9CiAKLWludCB2aXZpZF92aWRfb3V0X2dfc2Vs
ZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHZpdmlkX3ZpZF9vdXRf
Z19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0
IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTY3Miw3ICs2NzUsOSBA
QCBpbnQgdml2aWRfdmlkX291dF9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX3ZpZF9vdXRfc19zZWxlY3Rpb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcykKK2lu
dCB2aXZpZF92aWRfb3V0X3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICBzdHJ1Y3QgdjRsMl9z
ZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKIAlzdHJ1Y3QgdjRsMl9yZWN0ICpjcm9wID0gJmRldi0+Y3JvcF9vdXQ7CkBAIC03OTgs
NyArODAzLDcgQEAgaW50IHZpdmlkX3ZpZF9vdXRfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3NlbGVjdGkKIAlyZXR1cm4gMDsKIH0KIAotaW50
IHZpdmlkX3ZpZF9vdXRfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK2ludCB2aXZpZF92aWRfb3V0X2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWludCB0eXBlLCBzdHJ1Y3QgdjRs
Ml9mcmFjdCAqZikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtODIxLDggKzgyNiw5IEBAIGludCB2aXZpZF92aWRfb3V0X2dfcGl4ZWxhc3BlY3Qo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aWRp
b2NfZ19mbXRfdmlkX291dF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAot
CQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitpbnQgdmlkaW9jX2dfZm10X3ZpZF9vdXRfb3Zl
cmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWNvbnN0IHN0cnVjdCB2NGwyX3JlY3QgKmNv
bXBvc2UgPSAmZGV2LT5jb21wb3NlX291dDsKQEAgLTg0MCw4ICs4NDYsOSBAQCBpbnQgdmlkaW9j
X2dfZm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQoraW50
IHZpZGlvY190cnlfZm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKIAljb25zdCBzdHJ1Y3QgdjRsMl9yZWN0ICpjb21wb3NlID0gJmRldi0+Y29tcG9zZV9vdXQ7
CkBAIC04NjMsMTIgKzg3MCwxMyBAQCBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX291dF9vdmVybGF5
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1pbnQgdmlk
aW9jX3NfZm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
LQkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQoraW50IHZpZGlvY19zX2ZtdF92aWRfb3V0X292
ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHZpdmlkX2Rl
diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdjRsMl93aW5kb3cgKndpbiA9
ICZmLT5mbXQud2luOwotCWludCByZXQgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0X292ZXJsYXko
ZmlsZSwgcHJpdiwgZik7CisJaW50IHJldCA9IHZpZGlvY190cnlfZm10X3ZpZF9vdXRfb3Zlcmxh
eShmaWxlLCBzdGF0ZSwgZik7CiAKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwpAQCAtODgwLDcg
Kzg4OCw4IEBAIGludCB2aWRpb2Nfc19mbXRfdmlkX291dF9vdmVybGF5KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiByZXQ7CiB9CiAKLWludCB2aXZpZF92aWRfb3V0X292
ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGkpCitpbnQgdml2
aWRfdmlkX291dF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50IGkpCiB7CiAJc3RydWN0IHZpdmlkX2Rl
diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtODkzLDggKzkwMiw4IEBAIGludCB2
aXZpZF92aWRfb3V0X292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2ln
bmVkIGkpCiAJcmV0dXJuIDA7CiB9CiAKLWludCB2aXZpZF92aWRfb3V0X2dfZmJ1ZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCQlzdHJ1Y3QgdjRsMl9mcmFtZWJ1ZmZlciAqYSkK
K2ludCB2aXZpZF92aWRfb3V0X2dfZmJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZnJhbWVidWZmZXIgKmEpCiB7
CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtOTIw
LDggKzkyOSw4IEBAIGludCB2aXZpZF92aWRfb3V0X2dfZmJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlkX3ZpZF9vdXRfc19mYnVmKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCWNvbnN0IHN0cnVjdCB2NGwyX2ZyYW1l
YnVmZmVyICphKQoraW50IHZpdmlkX3ZpZF9vdXRfc19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBjb25zdCBzdHJ1Y3QgdjRsMl9m
cmFtZWJ1ZmZlciAqYSkKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwogCWNvbnN0IHVuc2lnbmVkIGNocm9tYV9mbGFncyA9IFY0TDJfRkJVRl9GTEFHX0NI
Uk9NQUtFWSB8CkBAIC05NTIsOCArOTYxLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2F1
ZGlvb3V0IHZpdmlkX2F1ZGlvX291dHB1dHNbXSA9IHsKIAl7IDEsICJMaW5lLU91dCAyIiB9LAog
fTsKIAotaW50IHZpZGlvY19lbnVtX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKLQkJCQlzdHJ1Y3QgdjRsMl9vdXRwdXQgKm91dCkKK2ludCB2aWRpb2NfZW51bV9vdXRwdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkg
ICAgICAgc3RydWN0IHY0bDJfb3V0cHV0ICpvdXQpCiB7CiAJc3RydWN0IHZpdmlkX2RldiAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtOTc5LDcgKzk4OCw4IEBAIGludCB2aWRpb2Nf
ZW51bV9vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLWludCB2aWRpb2NfZ19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVu
c2lnbmVkICpvKQoraW50IHZpZGlvY19nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICB1bnNpZ25lZCBpbnQgKm8pCiB7CiAJ
c3RydWN0IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtOTg3LDcg
Kzk5Nyw4IEBAIGludCB2aWRpb2NfZ19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHVuc2lnbmVkICpvKQogCXJldHVybiAwOwogfQogCi1pbnQgdmlkaW9jX3Nfb3V0cHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBvKQoraW50IHZpZGlvY19zX291
dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCSAgICB1bnNpZ25lZCBpbnQgbykKIHsKIAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMDE2LDcgKzEwMjcsOCBAQCBpbnQgdmlkaW9jX3Nfb3V0
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBvKQogCXJldHVybiAw
OwogfQogCi1pbnQgdmlkaW9jX2VudW1hdWRvdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHN0cnVjdCB2NGwyX2F1ZGlvb3V0ICp2b3V0KQoraW50IHZpZGlvY19lbnVtYXVkb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAg
ICAgc3RydWN0IHY0bDJfYXVkaW9vdXQgKnZvdXQpCiB7CiAJaWYgKHZvdXQtPmluZGV4ID49IEFS
UkFZX1NJWkUodml2aWRfYXVkaW9fb3V0cHV0cykpCiAJCXJldHVybiAtRUlOVkFMOwpAQCAtMTAy
NCw3ICsxMDM2LDggQEAgaW50IHZpZGlvY19lbnVtYXVkb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9hdWRpb291dCAqdm91dCkKIAlyZXR1cm4gMDsKIH0KIAot
aW50IHZpZGlvY19nX2F1ZG91dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfYXVkaW9vdXQgKnZvdXQpCitpbnQgdmlkaW9jX2dfYXVkb3V0KHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIHN0cnVjdCB2NGwy
X2F1ZGlvb3V0ICp2b3V0KQogewogCXN0cnVjdCB2aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTEwMzQsNyArMTA0Nyw4IEBAIGludCB2aWRpb2NfZ19hdWRvdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2F1ZGlvb3V0ICp2b3V0KQog
CXJldHVybiAwOwogfQogCi1pbnQgdmlkaW9jX3NfYXVkb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LCBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpb291dCAqdm91dCkKK2ludCB2aWRpb2Nf
c19hdWRvdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkgICAgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW9vdXQgKnZvdXQpCiB7CiAJc3RydWN0
IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTA0Niw3ICsxMDYw
LDggQEAgaW50IHZpZGlvY19zX2F1ZG91dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
Y29uc3Qgc3RydWN0IHY0bDJfYXVkaW9vdXQgKnYKIAlyZXR1cm4gMDsKIH0KIAotaW50IHZpdmlk
X3ZpZF9vdXRfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lk
IGlkKQoraW50IHZpdmlkX3ZpZF9vdXRfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRfaWQgaWQpCiB7CiAJc3RydWN0
IHZpdmlkX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTA3Miw4ICsxMDg3
LDkgQEAgc3RhdGljIGJvb2wgdmFsaWRfY3Z0X2d0Zl90aW1pbmdzKHN0cnVjdCB2NGwyX2R2X3Rp
bWluZ3MgKnRpbWluZ3MpCiAJcmV0dXJuIGZhbHNlOwogfQogCi1pbnQgdml2aWRfdmlkX291dF9z
X2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJICAgIHN0cnVj
dCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpCitpbnQgdml2aWRfdmlkX291dF9zX2R2X3RpbWlu
Z3Moc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgICAgICAgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncykKIHsK
IAlzdHJ1Y3Qgdml2aWRfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWlmICghdml2
aWRfaXNfaGRtaV9vdXQoZGV2KSkKQEAgLTEwOTEsOCArMTEwNyw4IEBAIGludCB2aXZpZF92aWRf
b3V0X3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotaW50IHZpdmlkX3ZpZF9vdXRfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAotCQkJICBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQoraW50IHZpdmlkX3Zp
ZF9vdXRfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQogewogCXN0cnVjdCB2
aXZpZF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTExMDksNyArMTEyNSw3
IEBAIGludCB2aXZpZF92aWRfb3V0X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIH0KIAogaW50IHZpZGlvY19zdWJzY3JpYmVfZXZlbnQoc3RydWN0IHY0bDJfZmggKmZoLAot
CQkJY29uc3Qgc3RydWN0IHY0bDJfZXZlbnRfc3Vic2NyaXB0aW9uICpzdWIpCisJCQkgICBjb25z
dCBzdHJ1Y3QgdjRsMl9ldmVudF9zdWJzY3JpcHRpb24gKnN1YikKIHsKIAlzd2l0Y2ggKHN1Yi0+
dHlwZSkgewogCWNhc2UgVjRMMl9FVkVOVF9TT1VSQ0VfQ0hBTkdFOgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9tZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlkLW91dC5oIGIvZHJpdmVycy9t
ZWRpYS90ZXN0LWRyaXZlcnMvdml2aWQvdml2aWQtdmlkLW91dC5oCmluZGV4IDFkMDM4OTFhNWRl
NTc2YTU5NDQxYzBiMmQ3N2UwYzM4MTVlM2MwNWMuLjU4YTllNzczNjk4N2EyYTRkMDVmN2FjZDRl
MThjNWYzNzI5Mjg3ZjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdGVzdC1kcml2ZXJzL3Zp
dmlkL3ZpdmlkLXZpZC1vdXQuaAorKysgYi9kcml2ZXJzL21lZGlhL3Rlc3QtZHJpdmVycy92aXZp
ZC92aXZpZC12aWQtb3V0LmgKQEAgLTEyLDMzICsxMiw3MiBAQCBleHRlcm4gY29uc3Qgc3RydWN0
IHZiMl9vcHMgdml2aWRfdmlkX291dF9xb3BzOwogCiB2b2lkIHZpdmlkX3VwZGF0ZV9mb3JtYXRf
b3V0KHN0cnVjdCB2aXZpZF9kZXYgKmRldik7CiAKLWludCB2aXZpZF9nX2ZtdF92aWRfb3V0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotaW50
IHZpdmlkX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aXZpZF9zX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotaW50IHZpZGlvY19n
X2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2
aWRpb2Nfc19mbXRfdmlkX291dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1pbnQgdmlkaW9jX2dfZm10X3ZpZF9vdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1pbnQgdmlk
aW9jX3RyeV9mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aWRpb2Nfc19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLWludCB2aXZpZF92aWRf
b3V0X2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRs
Ml9zZWxlY3Rpb24gKnNlbCk7Ci1pbnQgdml2aWRfdmlkX291dF9zX3NlbGVjdGlvbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKTsKLWludCB2
aXZpZF92aWRfb3V0X2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IGludCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAqZik7Ci1pbnQgdmlkaW9jX2VudW1fZm10X3Zp
ZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsIHN0cnVjdCB2NGwy
X2ZtdGRlc2MgKmYpOwotaW50IHZpZGlvY19nX2ZtdF92aWRfb3V0X292ZXJsYXkoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1pbnQgdmlkaW9j
X3RyeV9mbXRfdmlkX291dF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotaW50IHZpZGlvY19zX2ZtdF92aWRfb3V0X292ZXJsYXko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci1p
bnQgdml2aWRfdmlkX291dF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1
bnNpZ25lZCBpKTsKLWludCB2aXZpZF92aWRfb3V0X2dfZmJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJhbWVidWZmZXIgKmEpOwotaW50IHZpdmlkX3ZpZF9v
dXRfc19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBjb25zdCBzdHJ1Y3QgdjRs
Ml9mcmFtZWJ1ZmZlciAqYSk7Ci1pbnQgdmlkaW9jX2VudW1fb3V0cHV0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9vdXRwdXQgKm91dCk7Ci1pbnQgdmlkaW9jX2df
b3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCAqaSk7Ci1pbnQg
dmlkaW9jX3Nfb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBp
KTsKLWludCB2aWRpb2NfZW51bWF1ZG91dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
c3RydWN0IHY0bDJfYXVkaW9vdXQgKnZvdXQpOwotaW50IHZpZGlvY19nX2F1ZG91dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYXVkaW9vdXQgKnZvdXQpOwotaW50
IHZpZGlvY19zX2F1ZG91dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3Ry
dWN0IHY0bDJfYXVkaW9vdXQgKnZvdXQpOwotaW50IHZpdmlkX3ZpZF9vdXRfc19zdGQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIGlkKTsKLWludCB2aXZpZF92aWRf
b3V0X3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0
bDJfZHZfdGltaW5ncyAqdGltaW5ncyk7Ci1pbnQgdml2aWRfdmlkX291dF9nX3Bhcm0oc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pOwor
aW50IHZpdmlkX2dfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aXZp
ZF90cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IHZpdmlkX3Nf
Zm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRpb2NfZ19mbXRfdmlk
X291dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2ludCB2aWRpb2NfdHJ5
X2ZtdF92aWRfb3V0X21wbGFuZShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2lu
dCB2aWRpb2Nfc19mbXRfdmlkX291dF9tcGxhbmUoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
KTsKK2ludCB2aWRpb2NfZ19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKK2lu
dCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7CitpbnQg
dmlkaW9jX3NfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkJIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7CitpbnQgdml2aWRf
dmlkX291dF9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9u
ICpzZWwpOworaW50IHZpdmlkX3ZpZF9vdXRfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgIHN0
cnVjdCB2NGwyX3NlbGVjdGlvbiAqcyk7CitpbnQgdml2aWRfdmlkX291dF9nX3BpeGVsYXNwZWN0
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LCBpbnQgdHlwZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mcmFjdCAqZik7CitpbnQgdmlkaW9jX2VudW1f
Zm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYp
OworaW50IHZpZGlvY19nX2ZtdF92aWRfb3V0X292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpOworaW50IHZpZGlvY190cnlfZm10X3ZpZF9vdXRfb3ZlcmxheShzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkg
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IHZpZGlvY19zX2ZtdF92aWRfb3V0X292ZXJs
YXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOworaW50IHZpdmlkX3ZpZF9vdXRfb3Zl
cmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgIHVuc2lnbmVkIGludCBpKTsKK2ludCB2aXZpZF92aWRfb3V0X2dfZmJ1ZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0
IHY0bDJfZnJhbWVidWZmZXIgKmEpOworaW50IHZpdmlkX3ZpZF9vdXRfc19mYnVmKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBjb25zdCBz
dHJ1Y3QgdjRsMl9mcmFtZWJ1ZmZlciAqYSk7CitpbnQgdmlkaW9jX2VudW1fb3V0cHV0KHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAg
IHN0cnVjdCB2NGwyX291dHB1dCAqb3V0KTsKK2ludCB2aWRpb2NfZ19vdXRwdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgdW5zaWdu
ZWQgaW50ICppKTsKK2ludCB2aWRpb2Nfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgdW5zaWduZWQgaW50IGkpOworaW50
IHZpZGlvY19lbnVtYXVkb3V0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3RydWN0IHY0bDJfYXVkaW9vdXQgKnZvdXQpOworaW50
IHZpZGlvY19nX2F1ZG91dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCSAgICBzdHJ1Y3QgdjRsMl9hdWRpb291dCAqdm91dCk7CitpbnQgdmlk
aW9jX3NfYXVkb3V0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJICAgIGNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlvb3V0ICp2b3V0KTsKK2ludCB2
aXZpZF92aWRfb3V0X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3RkX2lkIGlkKTsKK2ludCB2aXZpZF92aWRfb3V0X3Nf
ZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1p
bmdzKTsKK2ludCB2aXZpZF92aWRfb3V0X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAq
cGFybSk7CiAKICNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS91c2IvYWlyc3B5L2Fp
cnNweS5jIGIvZHJpdmVycy9tZWRpYS91c2IvYWlyc3B5L2FpcnNweS5jCmluZGV4IDA4ZjA5MjBj
ZjZjYTJmMmYwZmNjOGU5YTdiMTYzMjQ4OGQ5YWY1ZjUuLmM5MWRiNjI5NmMyMzI3ZmRkNmUxNjg3
NGM5OWM1NjQ3MDU3ODUxMWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL2FpcnNweS9h
aXJzcHkuYworKysgYi9kcml2ZXJzL21lZGlhL3VzYi9haXJzcHkvYWlyc3B5LmMKQEAgLTYwNSw4
ICs2MDUsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZiMl9vcHMgYWlyc3B5X3ZiMl9vcHMgPSB7
CiAJLnN0b3Bfc3RyZWFtaW5nICAgICAgICAgPSBhaXJzcHlfc3RvcF9zdHJlYW1pbmcsCiB9Owog
Ci1zdGF0aWMgaW50IGFpcnNweV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
Ci0JCXN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKK3N0YXRpYyBpbnQgYWlyc3B5X3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgYWlyc3B5ICpz
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtNjE2LDggKzYxNiw4IEBAIHN0YXRpYyBpbnQg
YWlyc3B5X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBhaXJzcHlfZW51bV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBpbnQgYWly
c3B5X2VudW1fZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYg
KGYtPmluZGV4ID49IE5VTV9GT1JNQVRTKQogCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTYyNyw4ICs2
MjcsOCBAQCBzdGF0aWMgaW50IGFpcnNweV9lbnVtX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFpcnNweV9nX2Zt
dF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCitzdGF0aWMgaW50IGFpcnNweV9nX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJc3RydWN0IGFpcnNweSAqcyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAK
QEAgLTYzOCw4ICs2MzgsOCBAQCBzdGF0aWMgaW50IGFpcnNweV9nX2ZtdF9zZHJfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFp
cnNweV9zX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQlzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IGFpcnNweV9zX2ZtdF9zZHJfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGFpcnNweSAqcyA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAJc3RydWN0IHZiMl9xdWV1ZSAqcSA9ICZzLT52Yl9xdWV1ZTsKQEAgLTY2NSw4ICs2
NjUsOCBAQCBzdGF0aWMgaW50IGFpcnNweV9zX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGFpcnNweV90cnlfZm10
X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCXN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKK3N0YXRpYyBpbnQgYWlyc3B5X3RyeV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKmYpCiB7CiAJaW50IGk7CiAKQEAgLTY4Myw4ICs2ODMsOCBAQCBzdGF0aWMgaW50
IGFpcnNweV90cnlfZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYWlyc3B5X3NfdHVuZXIoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCi0JCWNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2KQorc3RhdGljIGlu
dCBhaXJzcHlfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp2KQogewogCWludCBy
ZXQ7CiAKQEAgLTY5OCw3ICs2OTgsOCBAQCBzdGF0aWMgaW50IGFpcnNweV9zX3R1bmVyKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQg
YWlyc3B5X2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwy
X3R1bmVyICp2KQorc3RhdGljIGludCBhaXJzcHlfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHN0cnVjdCB2NGwyX3R1bmVy
ICp2KQogewogCWludCByZXQ7CiAKQEAgLTcyMyw4ICs3MjQsOCBAQCBzdGF0aWMgaW50IGFpcnNw
eV9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5l
ciAqdikKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IGFpcnNweV9nX2ZyZXF1ZW5jeShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpm
KQorc3RhdGljIGludCBhaXJzcHlfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJfZnJlcXVl
bmN5ICpmKQogewogCXN0cnVjdCBhaXJzcHkgKnMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWlu
dCByZXQ7CkBAIC03NDYsNyArNzQ3LDggQEAgc3RhdGljIGludCBhaXJzcHlfZ19mcmVxdWVuY3ko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGlj
IGludCBhaXJzcHlfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IGFpcnNweV9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQljb25zdCBzdHJ1Y3QgdjRsMl9m
cmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGFpcnNweSAqcyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC03NzYsNyArNzc4LDggQEAgc3RhdGljIGludCBhaXJzcHlfc19mcmVxdWVuY3koc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBh
aXJzcHlfZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCBhaXJzcHlfZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCXN0cnVjdCB2NGwyX2ZyZXF1ZW5j
eV9iYW5kICpiYW5kKQogewogCWludCByZXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Vz
Yi9hdTA4MjgvYXUwODI4LXZpZGVvLmMgYi9kcml2ZXJzL21lZGlhL3VzYi9hdTA4MjgvYXUwODI4
LXZpZGVvLmMKaW5kZXggZmJhYTU0MmM4MjU5YWMwMDdlZDQ0MTI4MGQwNmEyNzcwZTQxMzRmNC4u
ZWMyYTljMmI1MzkwYjYzMmIwYmExMWExYmU3NmZiYTE0NWZkOWE4OCAxMDA2NDQKLS0tIGEvZHJp
dmVycy9tZWRpYS91c2IvYXUwODI4L2F1MDgyOC12aWRlby5jCisrKyBiL2RyaXZlcnMvbWVkaWEv
dXNiL2F1MDgyOC9hdTA4MjgtdmlkZW8uYwpAQCAtMTE3Myw3ICsxMTczLDggQEAgc3RhdGljIGlu
dCBhdTA4Mjhfc2V0X2Zvcm1hdChzdHJ1Y3QgYXUwODI4X2RldiAqZGV2LCB1bnNpZ25lZCBpbnQg
Y21kLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBhdTA4MjhfZGV2
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTE5Myw3ICsxMTk0LDggQEAgc3RhdGlj
IGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYgKGYtPmluZGV4KQpA
QCAtMTIwNiw3ICsxMjA4LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCiB7CiAJc3RydWN0IGF1MDgyOF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xMjI0LDcgKzEyMjcsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgYXUwODI4X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTEyMzUsNyArMTIzOSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gYXUwODI4X3NldF9mb3JtYXQo
ZGV2LCBWSURJT0NfVFJZX0ZNVCwgZik7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19z
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgYXUw
ODI4X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEyNTksNyArMTI2NCw4IEBA
IHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIHJjOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgbm9ybSkKK3N0YXRpYyBpbnQgdmlk
aW9jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCXY0bDJfc3RkX2lkIG5vcm0pCiB7CiAJc3RydWN0IGF1MDgyOF9kZXYgKmRldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTEyOTEsNyArMTI5Nyw4IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBu
b3JtKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKm5vcm0pCitzdGF0aWMgaW50IHZpZGlv
Y19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQl2NGwyX3N0ZF9pZCAqbm9ybSkKIHsKIAlzdHJ1Y3QgYXUwODI4X2RldiAqZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTMwMiw3ICsxMzA5LDggQEAgc3RhdGljIGludCB2
aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICpu
b3JtKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJc3RydWN0IHY0bDJfaW5wdXQgKmlucHV0KQogewogCXN0cnVjdCBhdTA4MjhfZGV2
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTM0Myw3ICsxMzUxLDggQEAgc3RhdGlj
IGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB2aWRpb2NfZ19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQkgIHVuc2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1Y3QgYXUwODI4X2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKIApAQCAtMTQxMCw3ICsxNDE5LDggQEAgc3RhdGljIHZvaWQgYXUwODI4
X3NfaW5wdXQoc3RydWN0IGF1MDgyOF9kZXYgKmRldiwgaW50IGluZGV4KQogCQkJQVVWSV9JTlBV
VChpbmRleCkuYW11eCwgMCwgMCk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpbmRleCkKK3N0YXRpYyBp
bnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaW5kZXgpCiB7CiAJc3RydWN0IGF1MDgy
OF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IHZpZGVvX2RldmljZSAq
dmZkID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTE0MzYsNyArMTQ0Niw5IEBAIHN0YXRpYyBp
bnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGludCBpbmRleCkKIAlyZXR1cm4gdjRsX2VuYWJsZV9tZWRpYV9zb3VyY2UodmZkKTsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW51bWF1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1hdWRpbyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSAgICBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIHsKIAlpZiAoYS0+aW5kZXggPiAxKQogCQly
ZXR1cm4gLUVJTlZBTDsKQEAgLTE0NTIsNyArMTQ2NCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYXVkaW8g
KmEpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfYXVkaW8oc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2F1ZGlvICphKQorc3RhdGljIGludCB2
aWRpb2NfZ19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgIHN0cnVjdCB2NGwyX2F1ZGlvICphKQogewogCXN0cnVjdCBhdTA4Mjhf
ZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xNDY5LDcgKzE0ODIsOCBAQCBz
dGF0aWMgaW50IHZpZGlvY19nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
c19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJf
YXVkaW8gKmEpCitzdGF0aWMgaW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgY29uc3Qgc3RydWN0IHY0bDJf
YXVkaW8gKmEpCiB7CiAJc3RydWN0IGF1MDgyOF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKQEAgLTE0ODEsNyArMTQ5NSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfYXVkaW8oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2F1ZGlvCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX3R1bmVyICp0KQorc3RhdGljIGludCB2aWRpb2NfZ190
dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgIHN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBhdTA4MjhfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZmZCA9IHZpZGVv
X2RldmRhdGEoZmlsZSk7CkBAIC0xNTA2LDcgKzE1MjEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19n
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5lciAq
dCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNv
bnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBhdTA4MjhfZGV2ICpkZXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTUyOSw3ICsxNTQ1LDggQEAgc3RhdGljIGludCB2aWRp
b2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZnJlcXVl
bmN5ICpmcmVxKQogewogCXN0cnVjdCBhdTA4MjhfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtMTU0Miw3ICsxNTU5LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3ko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQljb25zdCBzdHJ1Y3QgdjRsMl9m
cmVxdWVuY3kgKmZyZXEpCiB7CiAJc3RydWN0IGF1MDgyOF9kZXYgKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0xNTcyLDcgKzE1OTAsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1
ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAogLyogUkFXIFZCSSBpb2N0bHMg
Ki8KIAotc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmb3JtYXQpCiB7CiAJc3RydWN0IGF1MDgyOF9kZXYgKmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC0xNTk1LDggKzE2MTQsOSBAQCBzdGF0aWMgaW50IHZpZGlvY19n
X2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAotCQkJCWludCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAqZikKK3N0YXRpYyBp
bnQgdmlkaW9jX2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIGludCB0eXBlLAorCQkJCXN0cnVjdCB2NGwyX2ZyYWN0
ICpmKQogewogCXN0cnVjdCBhdTA4MjhfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwog
CkBAIC0xNjEyLDcgKzE2MzIsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3BpeGVsYXNwZWN0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxl
Y3Rpb24gKnMpCiB7CiAJc3RydWN0IGF1MDgyOF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC0xNjM1LDcgKzE2NTYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIAogI2lmZGVmIENPTkZJR19WSURFT19B
RFZfREVCVUcKLXN0YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAg
c3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IGF1MDgyOF9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNjQ4LDcgKzE2NzAsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAg
IGNvbnN0IHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVnKQogewogCXN0cnVjdCBhdTA4Mjhf
ZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTY2MCwxMyArMTY4MywxNCBAQCBz
dGF0aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogfQogI2VuZGlmCiAKLXN0YXRpYyBpbnQgdmlkaW9jX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoKQorc3RhdGljIGludCB2aWRpb2NfbG9nX3N0YXR1cyhzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUpCiB7CiAJ
c3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAKIAlkcHJp
bnRrKDEsICIlcyBjYWxsZWRcbiIsIF9fZnVuY19fKTsKIAotCXY0bDJfY3RybF9sb2dfc3RhdHVz
KGZpbGUsIGZoKTsKKwl2NGwyX2N0cmxfbG9nX3N0YXR1cyhmaWxlLCBzdGF0ZSk7CiAJdjRsMl9k
ZXZpY2VfY2FsbF9hbGwodmRldi0+djRsMl9kZXYsIDAsIGNvcmUsIGxvZ19zdGF0dXMpOwogCXJl
dHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS91c2IvY3gyMzF4eC9jeDIzMXh4
LTQxNy5jIGIvZHJpdmVycy9tZWRpYS91c2IvY3gyMzF4eC9jeDIzMXh4LTQxNy5jCmluZGV4IGM2
OTVhOTdlMjAyYjcxMzRmNjZkOWIxNDM4ZWJhYmZjZjU2MjhkZWYuLjE4M2E0NmE0NmJhNDkxOTU2
ODA3MDI0ZDNkNjExYzhiMTVkNGY3ZGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL2N4
MjMxeHgvY3gyMzF4eC00MTcuYworKysgYi9kcml2ZXJzL21lZGlhL3VzYi9jeDIzMXh4L2N4MjMx
eHgtNDE3LmMKQEAgLTE0NjIsOCArMTQ2Miw5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29w
cyBjeDIzMXh4X3ZpZGVvX3FvcHMgPSB7CiAKIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwogCi1zdGF0aWMgaW50
IHZpZGlvY19nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJ
CWludCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfcGl4
ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsIGludCB0eXBlLAorCQkJCXN0cnVjdCB2NGwyX2ZyYWN0ICpmKQogewogCXN0cnVj
dCBjeDIzMXh4ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWJvb2wgaXNfNTBoeiA9IGRl
di0+ZW5jb2Rlcm5vcm0uaWQgJiBWNEwyX1NURF82MjVfNTA7CkBAIC0xNDc3LDcgKzE0NzgsOCBA
QCBzdGF0aWMgaW50IHZpZGlvY19nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlvbihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfc2VsZWN0
aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0
IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNDk5LDcgKzE1MDEsOCBA
QCBzdGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICpub3JtKQorc3RhdGljIGludCB2aWRp
b2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJdjRsMl9zdGRfaWQgKm5vcm0pCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTE1MDcsNyArMTUxMCw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqbm9y
bSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkIGlkKQorc3RhdGljIGludCB2aWRpb2Nfc19z
dGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJdjRsMl9zdGRfaWQgaWQpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAJdW5zaWduZWQgaW50IGk7CkBAIC0xNTM4LDcgKzE1NDIsOCBAQCBzdGF0aWMg
aW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRf
aWQgaWQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51
bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlpZiAo
Zi0+aW5kZXggIT0gMCkKQEAgLTE1NDksNyArMTU1NCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0xNTY4LDcgKzE1NzQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CkBAIC0xNTg1LDEyICsxNTkyLDEzIEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfbG9nX3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
dikKK3N0YXRpYyBpbnQgdmlkaW9jX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlKQogewogCXN0cnVjdCBjeDIzMXh4
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCiAJY2FsbF9hbGwoZGV2LCBjb3JlLCBsb2df
c3RhdHVzKTsKLQlyZXR1cm4gdjRsMl9jdHJsX2xvZ19zdGF0dXMoZmlsZSwgcHJpdik7CisJcmV0
dXJuIHY0bDJfY3RybF9sb2dfc3RhdHVzKGZpbGUsIHN0YXRlKTsKIH0KIAogc3RhdGljIGNvbnN0
IHN0cnVjdCB2NGwyX2ZpbGVfb3BlcmF0aW9ucyBtcGVnX2ZvcHMgPSB7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL21lZGlhL3VzYi9jeDIzMXh4L2N4MjMxeHgtdmlkZW8uYyBiL2RyaXZlcnMvbWVkaWEv
dXNiL2N4MjMxeHgvY3gyMzF4eC12aWRlby5jCmluZGV4IDJjZDRlMzMzYmM0YjAxMmY5N2RmOThm
ODc3MWYyNTA4ZDgxYzNiM2MuLmE3NTFiNTVmYzYwZTNkZjY5ZTAzYTg5ZmM0ODE1NGI2M2JjOTEz
OGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL2N4MjMxeHgvY3gyMzF4eC12aWRlby5j
CisrKyBiL2RyaXZlcnMvbWVkaWEvdXNiL2N4MjMxeHgvY3gyMzF4eC12aWRlby5jCkBAIC04MjUs
NyArODI1LDggQEAgdm9pZCB2aWRlb19tdXgoc3RydWN0IGN4MjMxeHggKmRldiwgaW50IGluZGV4
KQogCUlPQ1RMIHZpZGlvYyBoYW5kbGluZwogICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KIAotc3RhdGljIGludCB2
aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQog
ewogCXN0cnVjdCBjeDIzMXh4ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODUzLDcg
Kzg1NCw4IEBAIHN0YXRpYyBzdHJ1Y3QgY3gyMzF4eF9mbXQgKmZvcm1hdF9ieV9mb3VyY2ModW5z
aWduZWQgaW50IGZvdXJjYykKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
dHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04ODUs
NyArODg3LDggQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19z
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3Ry
dWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04OTQsNyArODk3LDcg
QEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAl9OwogCWludCByYzsKIAotCXJjID0gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChm
aWxlLCBwcml2LCBmKTsKKwlyYyA9IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUs
IGYpOwogCWlmIChyYykKIAkJcmV0dXJuIHJjOwogCkBAIC05MTUsNyArOTE4LDggQEAgc3RhdGlj
IGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gcmM7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqaWQpCitzdGF0aWMgaW50IHZpZGlvY19nX3N0
ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQl2NGwyX3N0ZF9pZCAqaWQpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CiAKQEAgLTkyMyw3ICs5MjcsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3N0ZChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKmlkKQogCXJldHVybiAw
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgdjRsMl9zdGRfaWQgbm9ybSkKK3N0YXRpYyBpbnQgdmlkaW9jX3Nfc3RkKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3Rk
X2lkIG5vcm0pCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CiAJc3RydWN0IHY0bDJfc3ViZGV2X2Zvcm1hdCBmb3JtYXQgPSB7CkBAIC0xMDEyLDcgKzEwMTcs
OCBAQCB2b2lkIGN4MjMxeHhfdjRsMl9jcmVhdGVfZW50aXRpZXMoc3RydWN0IGN4MjMxeHggKmRl
dikKICNlbmRpZgogfQogCi1pbnQgY3gyMzF4eF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAoraW50IGN4MjMxeHhfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1
Y3QgdjRsMl9pbnB1dCAqaSkKIHsKIAlzdHJ1Y3QgY3gyMzF4eCAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTEwNTIsNyArMTA1OCw4IEBAIGludCBjeDIzMXh4X2VudW1faW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCBjeDIzMXh4
X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkK
K2ludCBjeDIzMXh4X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgdW5zaWduZWQgaW50ICppKQogewogCXN0cnVjdCBjeDIz
MXh4ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMDYxLDcgKzEwNjgsOCBAQCBp
bnQgY3gyMzF4eF9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25l
ZCBpbnQgKmkpCiAJcmV0dXJuIDA7CiB9CiAKLWludCBjeDIzMXh4X3NfaW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQoraW50IGN4MjMxeHhfc19pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CSAgICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlzdHJ1Y3QgY3gyMzF4eCAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIApAQCAtMTA4NSw3ICsxMDkzLDggQEAgaW50IGN4MjMxeHhfc19pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCiAJcmV0dXJuIDA7
CiB9CiAKLWludCBjeDIzMXh4X2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
IHN0cnVjdCB2NGwyX3R1bmVyICp0KQoraW50IGN4MjMxeHhfZ190dW5lcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICBzdHJ1Y3QgdjRs
Ml90dW5lciAqdCkKIHsKIAlzdHJ1Y3QgY3gyMzF4eCAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKIApAQCAtMTEwMywxNCArMTExMiwxNiBAQCBpbnQgY3gyMzF4eF9nX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5lciAqdCkKIAlyZXR1cm4gMDsK
IH0KIAotaW50IGN4MjMxeHhfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwg
Y29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQpCitpbnQgY3gyMzF4eF9zX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgIGNvbnN0
IHN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCWlmICgwICE9IHQtPmluZGV4KQogCQlyZXR1cm4g
LUVJTlZBTDsKIAlyZXR1cm4gMDsKIH0KIAotaW50IGN4MjMxeHhfZ19mcmVxdWVuY3koc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgY3gyMzF4eF9nX2ZyZXF1ZW5jeShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAg
ICAgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBjeDIzMXh4ICpkZXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTEyMyw3ICsxMTM0LDggQEAgaW50IGN4MjMxeHhfZ19m
cmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAK
LWludCBjeDIzMXh4X3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
aW50IGN4MjMxeHhfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1
ZW5jeSAqZikKIHsKIAlzdHJ1Y3QgY3gyMzF4eCAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTExOTQsNyArMTIwNiw4IEBAIGludCBjeDIzMXh4X3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCiAjaWZkZWYgQ09ORklHX1ZJREVPX0FEVl9ERUJVRwogCi1p
bnQgY3gyMzF4eF9nX2NoaXBfaW5mbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitpbnQg
Y3gyMzF4eF9nX2NoaXBfaW5mbyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCXN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJc3RydWN0IHY0bDJfZGJnX2NoaXBfaW5mbyAqY2hpcCkK
IHsKIAlzd2l0Y2ggKGNoaXAtPm1hdGNoLmFkZHIpIHsKQEAgLTEyMjIsNyArMTIzNSw4IEBAIGlu
dCBjeDIzMXh4X2dfY2hpcF9pbmZvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1
cm4gLUVJTlZBTDsKIH0KIAotaW50IGN4MjMxeHhfZ19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK2ludCBjeDIzMXh4X2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUs
CisJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3Ry
dWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMjgwLDcgKzEyOTQsOCBAQCBpbnQgY3gyMzF4eF9nX3Jl
Z2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiByZXQgPCAwID8g
cmV0IDogMDsKIH0KIAotaW50IGN4MjMxeHhfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK2ludCBjeDIzMXh4X3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgY29uc3Qg
c3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzI3LDggKzEzNDIsOSBAQCBpbnQgY3gyMzF4eF9z
X3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogI2VuZGlmCiAKLXN0
YXRpYyBpbnQgdmlkaW9jX2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCi0JCQkJaW50IHR5cGUsIHN0cnVjdCB2NGwyX2ZyYWN0ICpmKQorc3RhdGljIGludCB2aWRp
b2NfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwgaW50IHR5cGUsCisJCQkJc3RydWN0IHY0bDJfZnJhY3QgKmYpCiB7
CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJYm9vbCBpc181
MGh6ID0gZGV2LT5ub3JtICYgVjRMMl9TVERfNjI1XzUwOwpAQCAtMTM0Miw3ICsxMzU4LDggQEAg
c3RhdGljIGludCB2aWRpb2NfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19zZWxlY3Rpb24oc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3NlbGVjdGlv
bihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfc2VsZWN0aW9uICpzKQogewogCXN0cnVjdCBj
eDIzMXh4ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTM2NCw3ICsxMzgxLDggQEAg
c3RhdGljIGludCB2aWRpb2NfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLWludCBjeDIzMXh4X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAoraW50IGN4MjMxeHhfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
CisJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC0xMzk0LDcgKzE0MTIsOCBAQCBpbnQgY3gyMzF4eF9xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0
bDJfZm10ZGVzYyAqZikKIHsKIAlpZiAodW5saWtlbHkoZi0+aW5kZXggPj0gQVJSQVlfU0laRShm
b3JtYXQpKSkKQEAgLTE0MDcsNyArMTQyNiw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAKIC8qIFJBVyBWQkkgaW9j
dGxzICovCiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92YmlfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0
cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgY3gyMzF4eCAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTE0MjksNyArMTQ0OSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfZm10
X3ZiaV9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2NfdHJ5X2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC0xNDUyLDE3ICsxNDczLDE5IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmJpX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19zX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2Nfc19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
LQlyZXR1cm4gdmlkaW9jX3RyeV9mbXRfdmJpX2NhcChmaWxlLCBwcml2LCBmKTsKKwlyZXR1cm4g
dmlkaW9jX3RyeV9mbXRfdmJpX2NhcChmaWxlLCBzdGF0ZSwgZik7CiB9CiAKIC8qIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCiAv
KiBSQURJTyBFU1BFQ0lGSUMgSU9DVExTICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAqLwogLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0gKi8KIAotc3RhdGljIGludCByYWRpb19nX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5lciAqdCkKK3N0YXRpYyBpbnQgcmFk
aW9fZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCQkgc3RydWN0IHY0bDJfdHVuZXIgKnQpCiB7CiAJc3RydWN0IGN4MjMxeHggKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTE0NzUsNyArMTQ5OCw5IEBAIHN0YXRpYyBp
bnQgcmFkaW9fZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0
bDJfdHVuZXIgKnQpCiAKIAlyZXR1cm4gMDsKIH0KLXN0YXRpYyBpbnQgcmFkaW9fc190dW5lcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQp
CisKK3N0YXRpYyBpbnQgcmFkaW9fc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQp
CiB7CiAJc3RydWN0IGN4MjMxeHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWVkaWEvdXNiL2N4MjMxeHgvY3gyMzF4eC5oIGIvZHJpdmVycy9tZWRp
YS91c2IvY3gyMzF4eC9jeDIzMXh4LmgKaW5kZXggMTlmNTAzNmE3OGQ3ZjQyYWViZGZlMTY0MDI1
NDc3YTY4ZWFkZjFiNy4uMGU5MmRiMGIwNDU1MzMzZDgzMTA5NTk0NmQwZDc5MWIyYTAxN2JhZSAx
MDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS91c2IvY3gyMzF4eC9jeDIzMXh4LmgKKysrIGIvZHJp
dmVycy9tZWRpYS91c2IvY3gyMzF4eC9jeDIzMXh4LmgKQEAgLTkyNCwyMyArOTI0LDI4IEBAIHZv
aWQgY3gyMzF4eF91bnJlZ2lzdGVyX2V4dGVuc2lvbihzdHJ1Y3QgY3gyMzF4eF9vcHMgKmRldik7
CiB2b2lkIGN4MjMxeHhfaW5pdF9leHRlbnNpb24oc3RydWN0IGN4MjMxeHggKmRldik7CiB2b2lk
IGN4MjMxeHhfY2xvc2VfZXh0ZW5zaW9uKHN0cnVjdCBjeDIzMXh4ICpkZXYpOwogdm9pZCBjeDIz
MXh4X3Y0bDJfY3JlYXRlX2VudGl0aWVzKHN0cnVjdCBjeDIzMXh4ICpkZXYpOwotaW50IGN4MjMx
eHhfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkgICBzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICpjYXApOwotaW50IGN4MjMxeHhfZ190dW5lcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnQpOwotaW50IGN4MjMxeHhfc190
dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJfdHVu
ZXIgKnQpOwotaW50IGN4MjMxeHhfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCi0JCQkgICAgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpOwotaW50IGN4MjMxeHhf
c19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkgICAgICBjb25z
dCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpOwotaW50IGN4MjMxeHhfZW51bV9pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCSAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmkp
OwotaW50IGN4MjMxeHhfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5z
aWduZWQgaW50ICppKTsKLWludCBjeDIzMXh4X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHVuc2lnbmVkIGludCBpKTsKLWludCBjeDIzMXh4X2dfY2hpcF9pbmZvKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZGJnX2NoaXBfaW5mbyAqY2hpcCk7
Ci1pbnQgY3gyMzF4eF9nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAot
CQkJICAgICBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZyk7Ci1pbnQgY3gyMzF4eF9zX3Jl
Z2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJICAgICBjb25zdCBzdHJ1
Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZyk7CitpbnQgY3gyMzF4eF9xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgc3Ry
dWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKTsKK2ludCBjeDIzMXh4X2dfdHVuZXIoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgc3RydWN0
IHY0bDJfdHVuZXIgKnQpOworaW50IGN4MjMxeHhfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICBjb25zdCBzdHJ1Y3QgdjRs
Ml90dW5lciAqdCk7CitpbnQgY3gyMzF4eF9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVu
Y3kgKmYpOworaW50IGN4MjMxeHhfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJY29uc3Qgc3RydWN0IHY0bDJfZnJlcXVl
bmN5ICpmKTsKK2ludCBjeDIzMXh4X2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfaW5wdXQg
KmkpOworaW50IGN4MjMxeHhfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICB1bnNpZ25lZCBpbnQgKmkpOworaW50IGN4MjMx
eHhfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCSAgICB1bnNpZ25lZCBpbnQgaSk7CitpbnQgY3gyMzF4eF9nX2NoaXBfaW5mbyhz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQlz
dHJ1Y3QgdjRsMl9kYmdfY2hpcF9pbmZvICpjaGlwKTsKK2ludCBjeDIzMXh4X2dfcmVnaXN0ZXIo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkg
ICAgICAgc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpOworaW50IGN4MjMxeHhfc19yZWdp
c3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCSAgICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZyk7CiAKIC8qIFBy
b3ZpZGVkIGJ5IGN4MjMxeHgtY2FyZHMuYyAqLwogZXh0ZXJuIHZvaWQgY3gyMzF4eF9wcmVfY2Fy
ZF9zZXR1cChzdHJ1Y3QgY3gyMzF4eCAqZGV2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEv
dXNiL2R2Yi11c2IvY3h1c2ItYW5hbG9nLmMgYi9kcml2ZXJzL21lZGlhL3VzYi9kdmItdXNiL2N4
dXNiLWFuYWxvZy5jCmluZGV4IDNiYmVlMWZjYmM4ZGMzZDdlZjdiNDA4MzMzZDRhZjFmMTZiYjFk
NmQuLmE3ZTIwOWU4MTczYmIyZDI3OTUyMDJmODU2ODg3ZTBhNmFkNDZiN2QgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvbWVkaWEvdXNiL2R2Yi11c2IvY3h1c2ItYW5hbG9nLmMKKysrIGIvZHJpdmVycy9t
ZWRpYS91c2IvZHZiLXVzYi9jeHVzYi1hbmFsb2cuYwpAQCAtOTYyLDcgKzk2Miw4IEBAIHN0YXRp
YyBjb25zdCBfX3UzMiB2aWRlb2NhcHMgPSBWNEwyX0NBUF9WSURFT19DQVBUVVJFIHwgVjRMMl9D
QVBfVFVORVIgfAogCVY0TDJfQ0FQX1JFQURXUklURSB8IFY0TDJfQ0FQX1NUUkVBTUlORzsKIHN0
YXRpYyBjb25zdCBfX3UzMiByYWRpb2NhcHMgPSBWNEwyX0NBUF9UVU5FUiB8IFY0TDJfQ0FQX1JB
RElPOwogCi1zdGF0aWMgaW50IGN4dXNiX21lZGlvbl92X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3h1c2JfbWVkaW9uX3ZfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBkdmJfdXNiX2Rl
dmljZSAqZHZiZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk3Nyw3ICs5NzgsOCBAQCBz
dGF0aWMgaW50IGN4dXNiX21lZGlvbl92X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjeHVzYl9tZWRpb25fdl9lbnVtX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3h1c2Jf
bWVkaW9uX3ZfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRl
c2MgKmYpCiB7CiAJaWYgKGYtPmluZGV4ICE9IDApCkBAIC05ODgsNyArOTkwLDggQEAgc3RhdGlj
IGludCBjeHVzYl9tZWRpb25fdl9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjeHVzYl9tZWRpb25fZ19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGN4dXNiX21l
ZGlvbl9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmR2YmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC0xMDUxLDEzICsxMDU0LDE1IEBAIHN0YXRpYyBpbnQgY3h1c2JfbWVkaW9uX3RyeV9z
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGN4dXNiX21lZGlvbl90cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAorc3RhdGljIGludCBjeHVzYl9tZWRpb25fdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXJldHVybiBjeHVzYl9tZWRpb25fdHJ5X3NfZm10X3Zp
ZF9jYXAoZmlsZSwgZiwgZmFsc2UpOwogfQogCi1zdGF0aWMgaW50IGN4dXNiX21lZGlvbl9zX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3h1c2Jf
bWVkaW9uX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXJldHVybiBjeHVzYl9tZWRpb25fdHJ5X3NfZm10X3ZpZF9jYXAoZmlsZSwgZiwg
dHJ1ZSk7CkBAIC0xMDgyLDcgKzEwODcsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHsKIAogI2Rl
ZmluZSBDWFVTQl9JTlBVVF9DTlQgQVJSQVlfU0laRShjeHVzYl9tZWRpb25faW5wdXRzKQogCi1z
dGF0aWMgaW50IGN4dXNiX21lZGlvbl9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgY3h1c2JfbWVkaW9uX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3Ry
dWN0IHY0bDJfaW5wdXQgKmlucCkKIHsKIAlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmR2YmRldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTEzLDcgKzExMTksOCBAQCBzdGF0aWMgaW50IGN4
dXNiX21lZGlvbl9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCBjeHVzYl9tZWRpb25fZ19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGN4dXNiX21lZGlvbl9nX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXVu
c2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmR2YmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC0xMTgyLDcgKzExODksOCBAQCBzdGF0aWMgaW50IGN4dXNiX21l
ZGlvbl9zZXRfbm9ybShzdHJ1Y3QgY3h1c2JfbWVkaW9uX2RldiAqY3hkZXYsCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgY3h1c2JfbWVkaW9uX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAorc3RhdGljIGludCBjeHVzYl9tZWRpb25fc19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQl1bnNpZ25l
ZCBpbnQgaSkKIHsKIAlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmR2YmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0xMjEwLDcgKzEyMTgsOCBAQCBzdGF0aWMgaW50IGN4dXNiX21lZGlvbl9z
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBjeHVzYl9tZWRpb25fZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IGN4dXNiX21lZGlvbl9nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX3R1bmVy
ICp0dW5lcikKIHsKIAlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmR2YmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0xMjY3LDcgKzEyNzYsOCBAQCBzdGF0aWMgaW50IGN4dXNiX21lZGlvbl9n
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBjeHVzYl9tZWRpb25fc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IGN4dXNiX21lZGlvbl9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwy
X3R1bmVyICp0dW5lcikKIHsKIAlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmR2YmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CkBAIC0xMjk4LDcgKzEzMDgsOCBAQCBzdGF0aWMgaW50IGN4dXNiX21l
ZGlvbl9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gdjRsMl9z
dWJkZXZfY2FsbChjeGRldi0+Y3gyNTg0MCwgdHVuZXIsIHNfdHVuZXIsIHR1bmVyKTsKIH0KIAot
c3RhdGljIGludCBjeHVzYl9tZWRpb25fZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorc3RhdGljIGludCBjeHVzYl9tZWRpb25fZ19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAg
ICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmZyZXEpCiB7CiAJc3RydWN0IGR2Yl91c2JfZGV2aWNl
ICpkdmJkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTMxMCw3ICsxMzIxLDggQEAgc3Rh
dGljIGludCBjeHVzYl9tZWRpb25fZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKGN4ZGV2LT50dW5lciwgdHVuZXIsIGdfZnJl
cXVlbmN5LCBmcmVxKTsKIH0KIAotc3RhdGljIGludCBjeHVzYl9tZWRpb25fc19mcmVxdWVuY3ko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBjeHVzYl9tZWRpb25fc19m
cmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmZyZXEp
CiB7CiAJc3RydWN0IGR2Yl91c2JfZGV2aWNlICpkdmJkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtMTM0MSw3ICsxMzUzLDggQEAgc3RhdGljIGludCBjeHVzYl9tZWRpb25fc19mcmVxdWVu
Y3koc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiB2NGwyX3N1YmRldl9jYWxs
KGN4ZGV2LT5jeDI1ODQwLCB0dW5lciwgc19mcmVxdWVuY3ksIGZyZXEpOwogfQogCi1zdGF0aWMg
aW50IGN4dXNiX21lZGlvbl9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0
aWMgaW50IGN4dXNiX21lZGlvbl9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgdjRsMl9zdGRfaWQgKm5v
cm0pCiB7CiAJc3RydWN0IGR2Yl91c2JfZGV2aWNlICpkdmJkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtMTM1NSw3ICsxMzY4LDggQEAgc3RhdGljIGludCBjeHVzYl9tZWRpb25fZ19zdGQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGN4dXNiX21lZGlvbl9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMg
aW50IGN4dXNiX21lZGlvbl9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgdjRsMl9zdGRfaWQgbm9ybSkK
IHsKIAlzdHJ1Y3QgZHZiX3VzYl9kZXZpY2UgKmR2YmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7
CkBAIC0xMzY0LDcgKzEzNzgsOCBAQCBzdGF0aWMgaW50IGN4dXNiX21lZGlvbl9zX3N0ZChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIGN4dXNiX21lZGlvbl9zZXRfbm9ybShj
eGRldiwgbm9ybSk7CiB9CiAKLXN0YXRpYyBpbnQgY3h1c2JfbWVkaW9uX3F1ZXJ5c3RkKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY3h1c2JfbWVkaW9uX3F1ZXJ5c3Rk
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkgdjRsMl9zdGRfaWQgKm5vcm0pCiB7CiAJc3RydWN0IGR2Yl91c2JfZGV2aWNlICpk
dmJkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTM5Niw3ICsxNDExLDggQEAgc3RhdGlj
IGludCBjeHVzYl9tZWRpb25fcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGN4dXNiX21lZGlvbl9sb2dfc3RhdHVzKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCkKK3N0YXRpYyBpbnQgY3h1c2JfbWVkaW9uX2xvZ19zdGF0
dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUpCiB7CiAJc3RydWN0IGR2Yl91c2JfZGV2aWNlICpkdmJkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwogCXN0cnVjdCBjeHVzYl9tZWRpb25fZGV2ICpjeGRldiA9IGR2YmRldi0+cHJpdjsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdXNiL2VtMjh4eC9lbTI4eHgtdmlkZW8uYyBiL2Ry
aXZlcnMvbWVkaWEvdXNiL2VtMjh4eC9lbTI4eHgtdmlkZW8uYwppbmRleCAyZGZhMzI0MmE3YWI1
MmI3ZGNhZjI3OWVmZTU0YmJjZjAwNjU4ZmRmLi43OTYxOThlM2FhNGY4ZTY0ZmNjNDVlMTY2OGVi
YzRkNzQzNTA4OTgzIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3VzYi9lbTI4eHgvZW0yOHh4
LXZpZGVvLmMKKysrIGIvZHJpdmVycy9tZWRpYS91c2IvZW0yOHh4L2VtMjh4eC12aWRlby5jCkBA
IC0xNDA3LDcgKzE0MDcsOCBAQCBzdGF0aWMgdm9pZCBzY2FsZV90b19zaXplKHN0cnVjdCBlbTI4
eHggKmRldiwKICAqIElPQ1RMIHZpZGlvYyBoYW5kbGluZwogICovCiAKLXN0YXRpYyBpbnQgdmlk
aW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlzdHJ1Y3QgZW0yOHh4ICAgICAgICAgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0x
NDQwLDcgKzE0NDEsOCBAQCBzdGF0aWMgc3RydWN0IGVtMjh4eF9mbXQgKmZvcm1hdF9ieV9mb3Vy
Y2ModW5zaWduZWQgaW50IGZvdXJjYykKIAlyZXR1cm4gTlVMTDsKIH0KIAotc3RhdGljIGludCB2
aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKmYpCiB7CiAJc3RydWN0IGVtMjh4eCAgICAgICAgICpkZXYgICA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CkBAIC0xNTI1LDcgKzE1MjcsOCBAQCBzdGF0aWMgaW50IGVtMjh4eF9zZXRfdmlkZW9f
Zm9ybWF0KHN0cnVjdCBlbTI4eHggKmRldiwgdW5zaWduZWQgaW50IGZvdXJjYywKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBlbTI4eHggKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0xNTM0LDEzICsxNTM3LDE0IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHZiMl9pc19idXN5
KCZ2NGwyLT52Yl92aWRxKSkKIAkJcmV0dXJuIC1FQlVTWTsKIAotCXZpZGlvY190cnlfZm10X3Zp
ZF9jYXAoZmlsZSwgcHJpdiwgZik7CisJdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBzdGF0
ZSwgZik7CiAKIAlyZXR1cm4gZW0yOHh4X3NldF92aWRlb19mb3JtYXQoZGV2LCBmLT5mbXQucGl4
LnBpeGVsZm9ybWF0LAogCQkJCWYtPmZtdC5waXgud2lkdGgsIGYtPmZtdC5waXguaGVpZ2h0KTsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHY0bDJfc3RkX2lkICpub3JtKQorc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdjRsMl9zdGRf
aWQgKm5vcm0pCiB7CiAJc3RydWN0IGVtMjh4eCAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
IApAQCAtMTU0OSw3ICsxNTUzLDkgQEAgc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICpub3JtKQogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHZpZGlvY19xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgdjRsMl9zdGRfaWQgKm5vcm0pCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeXN0ZChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJ
ICAgdjRsMl9zdGRfaWQgKm5vcm0pCiB7CiAJc3RydWN0IGVtMjh4eCAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIApAQCAtMTU1OCw3ICsxNTY0LDggQEAgc3RhdGljIGludCB2aWRpb2NfcXVl
cnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICpub3JtKQog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgbm9ybSkKK3N0YXRpYyBpbnQgdmlkaW9jX3Nfc3Rk
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
CXY0bDJfc3RkX2lkIG5vcm0pCiB7CiAJc3RydWN0IGVtMjh4eCAgICAgICpkZXYgID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgZW0yOHh4X3Y0bDIgKnY0bDIgPSBkZXYtPnY0bDI7CkBA
IC0xNTc1LDcgKzE1ODIsNyBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgbm9ybSkKIAkvKiBBZGp1c3RzIHdpZHRoL2hl
aWdodCwgaWYgbmVlZGVkICovCiAJZi5mbXQucGl4LndpZHRoID0gNzIwOwogCWYuZm10LnBpeC5o
ZWlnaHQgPSAobm9ybSAmIFY0TDJfU1REXzUyNV82MCkgPyA0ODAgOiA1NzY7Ci0JdmlkaW9jX3Ry
eV9mbXRfdmlkX2NhcChmaWxlLCBwcml2LCAmZik7CisJdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChm
aWxlLCBzdGF0ZSwgJmYpOwogCiAJLyogc2V0IG5ldyBpbWFnZSBzaXplICovCiAJdjRsMi0+d2lk
dGggPSBmLmZtdC5waXgud2lkdGg7CkBAIC0xNTg5LDcgKzE1OTYsOCBAQCBzdGF0aWMgaW50IHZp
ZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgbm9y
bSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVj
dCB2NGwyX3N0cmVhbXBhcm0gKnApCiB7CiAJc3RydWN0IHY0bDJfc3ViZGV2X2ZyYW1lX2ludGVy
dmFsIGl2YWwgPSB7IDAgfTsKQEAgLTE2MTcsNyArMTYyNSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmM7CiB9CiAK
LXN0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpw
KQogewogCXN0cnVjdCBlbTI4eHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNjQ1
LDcgKzE2NTQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiAJcmV0dXJuIHJjOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51
bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2lucHV0ICppKQogewogCXN0cnVjdCBl
bTI4eHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xNjc5LDcgKzE2ODksOCBAQCBz
dGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHZpZGlvY19n
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJCSAgdW5zaWduZWQgaW50ICppKQogewogCXN0cnVjdCBlbTI4eHggKmRldiA9IHZpZGVv
X2RydmRhdGEoZmlsZSk7CiAKQEAgLTE2ODgsNyArMTY5OSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IHZpZGlvY19zX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSAgdW5zaWduZWQgaW50IGkpCiB7CiAJc3RydWN0IGVtMjh4eCAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKIApAQCAtMTc1Niw3ICsxNzY4LDkgQEAgc3RhdGljIGludCBlbTI4eHhfZmls
bF9hdWRpb19pbnB1dChzdHJ1Y3QgZW0yOHh4ICpkZXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX2VudW1hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2F1ZGlvICphKQorc3RhdGljIGludCB2aWRpb2NfZW51bWF1ZGlvKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAg
IHN0cnVjdCB2NGwyX2F1ZGlvICphKQogewogCXN0cnVjdCBlbTI4eHggKmRldiA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAKQEAgLTE3NjYsNyArMTc4MCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2F1ZGlvICph
KQogCXJldHVybiBlbTI4eHhfZmlsbF9hdWRpb19pbnB1dChkZXYsIF9fZnVuY19fLCBhLCBhLT5p
bmRleCk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2F1ZGlvICphKQorc3RhdGljIGludCB2aWRpb2NfZ19h
dWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgIHN0cnVjdCB2NGwyX2F1ZGlvICphKQogewogCXN0cnVjdCBlbTI4eHggKmRldiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CiAJaW50IGk7CkBAIC0xNzc5LDcgKzE3OTQsOCBAQCBzdGF0aWMg
aW50IHZpZGlvY19nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3Qg
djRsMl9hdWRpbyAqYSkKIAlyZXR1cm4gLUVJTlZBTDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nf
c19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9j
X3NfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIHsKIAlzdHJ1Y3Qg
ZW0yOHh4ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTgxOSw3ICsxODM1LDggQEAg
c3RhdGljIGludCB2aWRpb2Nfc19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1
Y3QgdjRsMl90dW5lciAqdCkKIHsKIAlzdHJ1Y3QgZW0yOHh4ICpkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMTgzMyw3ICsxODUwLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdCkKIHsK
IAlzdHJ1Y3QgZW0yOHh4ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTg0NSw3ICsx
ODYzLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3ko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZyZXF1
ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICAgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQogewogCXN0cnVj
dCBlbTI4eHggICAgICAgICAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE4NTgsNyAr
MTg3Nyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZyZXF1
ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3Nf
ZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYp
CiB7CiAJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICBuZXdfZnJlcSA9ICpmOwpAQCAtMTg3Niw3ICsx
ODk2LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCiB9CiAKICNpZmRlZiBDT05GSUdfVklERU9fQURWX0RFQlVHCi1zdGF0aWMg
aW50IHZpZGlvY19nX2NoaXBfaW5mbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX2dfY2hpcF9pbmZvKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9k
YmdfY2hpcF9pbmZvICpjaGlwKQogewogCXN0cnVjdCBlbTI4eHggKmRldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC0xOTAzLDcgKzE5MjQsOCBAQCBzdGF0aWMgaW50IGVtMjh4eF9yZWdfbGVu
KGludCByZWcpCiAJfQogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19yZWdpc3RlcihzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgICAgIHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVnKQogewogCXN0cnVjdCBlbTI4
eHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xOTQ0LDcgKzE5NjYsOCBAQCBzdGF0
aWMgaW50IHZpZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19yZWdpc3RlcihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgICAgIGNvbnN0IHN0cnVjdCB2NGwyX2RiZ19yZWdpc3RlciAqcmVnKQogewogCXN0cnVjdCBl
bTI4eHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xOTYzLDcgKzE5ODYsOCBAQCBz
dGF0aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogfQogI2VuZGlmCiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBz
dHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGVtMjh4eCAgICAgICAgICpk
ZXYgID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTE5ODcsNyArMjAxMSw4IEBAIHN0YXRpYyBp
bnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYgKHVubGlrZWx5KGYt
PmluZGV4ID49IEFSUkFZX1NJWkUoZm9ybWF0KSkpCkBAIC0xOTk4LDcgKzIwMjMsOCBAQCBzdGF0
aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZXNpemVz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9m
cmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJ
c3RydWN0IGVtMjh4eCAgICAgICAgICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjA0
Miw3ICsyMDY4LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCiAvKiBSQVcgVkJJIGlvY3RscyAqLwogCi1zdGF0aWMg
aW50IHZpZGlvY19nX2ZtdF92YmlfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
c3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmZvcm1hdCkKIHsKIAlzdHJ1Y3QgZW0yOHh4ICAgICAgICAgKmRldiAgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMjA3NSw3ICsyMTAyLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmJp
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKICAqIFJBRElPIEVTUEVDSUZJQyBJ
T0NUTFMKICAqLwogCi1zdGF0aWMgaW50IHJhZGlvX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHJhZGlvX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgc3RydWN0IHY0bDJf
dHVuZXIgKnQpCiB7CiAJc3RydWN0IGVtMjh4eCAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTIwOTAsNyArMjExOCw4IEBAIHN0YXRpYyBpbnQgcmFkaW9fZ190dW5lcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCByYWRpb19z
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCByYWRpb19z
X3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBlbTI4
eHggKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlh
L3VzYi9nbzcwMDcvZ283MDA3LXY0bDIuYyBiL2RyaXZlcnMvbWVkaWEvdXNiL2dvNzAwNy9nbzcw
MDctdjRsMi5jCmluZGV4IDIwODdmZmNiODVhNWE2ZDFmODliNjZhODFkNjVmMDE3NzI3NThjOWYu
LjIyYjA5NDI5YmVlZGMyNTljOTRiNGQxOGJhOGZiYjY4Y2YwNTRiMGEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvbWVkaWEvdXNiL2dvNzAwNy9nbzcwMDctdjRsMi5jCisrKyBiL2RyaXZlcnMvbWVkaWEv
dXNiL2dvNzAwNy9nbzcwMDctdjRsMi5jCkBAIC0yNzEsNyArMjcxLDggQEAgc3RhdGljIGludCBz
ZXRfY2FwdHVyZV9zaXplKHN0cnVjdCBnbzcwMDcgKmdvLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZt
dCwgaW50IHRyeSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfcXVlcnlj
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBnbzcw
MDcgKmdvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTI4Miw3ICsyODMsOCBAQCBzdGF0aWMg
aW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAgKnByaXYsCiAJcmV0
dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZm10KQogewogCXN3aXRjaCAoZm10LT5p
bmRleCkgewpAQCAtMzA0LDcgKzMwNiw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJf
Zm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtMzIxLDcgKzMyNCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJc3RydWN0IHY0bDJfZm9ybWF0
ICpmbXQpCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
MzI5LDcgKzMzMyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gc2V0X2NhcHR1cmVfc2l6ZShnbywgZm10
LCAxKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgZ283MDA3ICpnbyA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CkBAIC00NTQsNyArNDU5LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJf
b3BzIGdvNzAwN192aWRlb19xb3BzID0gewogCS5zdG9wX3N0cmVhbWluZyA9IGdvNzAwN19zdG9w
X3N0cmVhbWluZywKIH07CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlscCwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlscCwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJc3RydWN0IHY0
bDJfc3RyZWFtcGFybSAqcGFybSkKIHsKIAlzdHJ1Y3QgZ283MDA3ICpnbyA9IHZpZGVvX2RydmRh
dGEoZmlscCk7CkBAIC00NzMsNyArNDc5LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0
cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbHAsCisJCQkgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCXN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3Ry
dWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbHApOwpAQCAtNDkwLDcgKzQ5Nyw3IEBA
IHN0YXRpYyBpbnQgdmlkaW9jX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwK
IAllbHNlCiAJCWdvLT5mcHNfc2NhbGUgPSAxOwogCi0JcmV0dXJuIHZpZGlvY19nX3Bhcm0oZmls
cCwgcHJpdiwgcGFybSk7CisJcmV0dXJuIHZpZGlvY19nX3Bhcm0oZmlscCwgc3RhdGUsIHBhcm0p
OwogfQogCiAvKiBWSURJT0NfRU5VTVNURCBvbiBnbzcwMDcgd2VyZSB1c2VkIGZvciBlbnVtZXJh
dGluZyB0aGUgc3VwcG9ydGVkIGZwcyBhbmQKQEAgLTUwMyw3ICs1MTAsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCiAKICAgIFRoZSB0
d28gZnVuY3Rpb25zIGJlbG93IGltcGxlbWVudCB0aGUgbmV3ZXIgaW9jdGxzCiAqLwotc3RhdGlj
IGludCB2aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxwLAor
CQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRs
Ml9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZk
YXRhKGZpbHApOwpAQCAtNTIyLDcgKzUzMCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJh
bWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlscCwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0
IGZpbGUgKmZpbHAsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJICAgICAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFsKQogewogCXN0cnVjdCBn
bzcwMDcgKmdvID0gdmlkZW9fZHJ2ZGF0YShmaWxwKTsKQEAgLTU1MCw3ICs1NTksOCBAQCBzdGF0
aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lk
ICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKnN0ZCkKK3N0YXRpYyBpbnQgdmlk
aW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCXY0bDJfc3RkX2lkICpzdGQpCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCkBAIC01NzMsNyArNTgzLDggQEAgc3RhdGljIGludCBnbzcwMDdf
c19zdGQoc3RydWN0IGdvNzAwNyAqZ28pCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBzdGQp
CitzdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQl2NGwyX3N0ZF9pZCBzdGQpCiB7CiAJc3RydWN0IGdv
NzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC01ODUsMTQgKzU5NiwxNiBAQCBz
dGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRs
Ml9zdGRfaWQgc3RkKQogCXJldHVybiBnbzcwMDdfc19zdGQoZ28pOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRf
aWQgKnN0ZCkKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHY0bDJfc3RkX2lkICpzdGQp
CiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCiAJcmV0dXJu
IGNhbGxfYWxsKCZnby0+djRsMl9kZXYsIHZpZGVvLCBxdWVyeXN0ZCwgc3RkKTsKIH0KIAotc3Rh
dGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2lucHV0
ICppbnApCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
NjI0LDcgKzYzNyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiB9CiAKIAotc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppbnB1dCkKK3N0YXRpYyBp
bnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgKmlucHV0KQogewogCXN0cnVjdCBnbzcw
MDcgKmdvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtNjMzLDcgKzY0Nyw5IEBAIHN0YXRp
YyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2ln
bmVkIGludCAqaW5wdXQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1h
dWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2F1ZGlvICphKQor
c3RhdGljIGludCB2aWRpb2NfZW51bWF1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgIHN0cnVjdCB2NGwyX2F1ZGlv
ICphKQogewogCXN0cnVjdCBnbzcwMDcgKmdvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAt
NjQ1LDcgKzY2MSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1hdWRpbyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2F1ZGlvICphKQogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpZGlvY19nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3Ry
dWN0IHY0bDJfYXVkaW8gKmEpCitzdGF0aWMgaW50IHZpZGlvY19nX2F1ZGlvKHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0
bDJfYXVkaW8gKmEpCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwogCkBAIC02NTYsOCArNjczLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19hdWRpbyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2F1ZGlvICphKQogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKLQljb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfYXVk
aW8oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLCBjb25zdCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIHsKIAlzdHJ1Y3QgZ283MDA3ICpnbyA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTY4NSw3ICs3MDIsOCBAQCBzdGF0aWMgdm9pZCBn
bzcwMDdfc19pbnB1dChzdHJ1Y3QgZ283MDA3ICpnbykKIAl9CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBp
bnB1dCkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaW5wdXQpCiB7
CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC03MDAsNyAr
NzE4LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgdW5zaWduZWQgaW50IGlucHV0KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19nX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfdHVuZXIgKnQpCiB7CiAJc3RydWN0
IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzEyLDcgKzczMSw4IEBAIHN0
YXRpYyBpbnQgdmlkaW9jX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIGNhbGxfYWxsKCZnby0+djRsMl9kZXYsIHR1bmVyLCBnX3R1bmVyLCB0KTsKIH0KIAot
c3RhdGljIGludCB2aWRpb2Nfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgdmlkaW9jX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCWNvbnN0IHN0cnVjdCB2NGwyX3R1bmVy
ICp0KQogewogCXN0cnVjdCBnbzcwMDcgKmdvID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTcy
Myw3ICs3NDMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiBjYWxsX2FsbCgmZ28tPnY0bDJfZGV2LCB0dW5lciwgc190
dW5lciwgdCk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19mcmVxdWVuY3koc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQlzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzM0LDcgKzc1NSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X2dfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBjYWxs
X2FsbCgmZ28tPnY0bDJfZGV2LCB0dW5lciwgZ19mcmVxdWVuY3ksIGYpOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJY29uc3Qgc3RydWN0IHY0bDJf
ZnJlcXVlbmN5ICpmKQogewogCXN0cnVjdCBnbzcwMDcgKmdvID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKQEAgLTc0NSwxMSArNzY3LDEyIEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBjYWxsX2FsbCgmZ28tPnY0bDJf
ZGV2LCB0dW5lciwgc19mcmVxdWVuY3ksIGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19sb2df
c3RhdHVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2KQorc3RhdGljIGludCB2aWRpb2Nf
bG9nX3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUpCiB7CiAJc3RydWN0IGdvNzAwNyAqZ28gPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwogCi0JdjRsMl9jdHJsX2xvZ19zdGF0dXMoZmlsZSwgcHJpdik7CisJdjRsMl9jdHJsX2xv
Z19zdGF0dXMoZmlsZSwgc3RhdGUpOwogCXJldHVybiBjYWxsX2FsbCgmZ28tPnY0bDJfZGV2LCBj
b3JlLCBsb2dfc3RhdHVzKTsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS91c2IvZ3Nw
Y2EvZ3NwY2EuYyBiL2RyaXZlcnMvbWVkaWEvdXNiL2dzcGNhL2dzcGNhLmMKaW5kZXggM2ZjMTVk
MTZkZjhlMTBkNDc2MmMxZjBhNmM3ZGQyZjdjNTdjMjY3NS4uNGQwY2IyYjkzYzBmZGVhNmE5Zjky
MjFiMGU5ZWMyNDYwZjUwMTllZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS91c2IvZ3NwY2Ev
Z3NwY2EuYworKysgYi9kcml2ZXJzL21lZGlhL3VzYi9nc3BjYS9nc3BjYS5jCkBAIC05NjcsNyAr
OTY3LDggQEAgc3RhdGljIGludCBnc3BjYV9nZXRfbW9kZShzdHJ1Y3QgZ3NwY2FfZGV2ICpnc3Bj
YV9kZXYsCiB9CiAKICNpZmRlZiBDT05GSUdfVklERU9fQURWX0RFQlVHCi1zdGF0aWMgaW50IHZp
ZGlvY19nX2NoaXBfaW5mbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgdmlkaW9jX2dfY2hpcF9pbmZvKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZGJnX2NoaXBfaW5m
byAqY2hpcCkKIHsKIAlzdHJ1Y3QgZ3NwY2FfZGV2ICpnc3BjYV9kZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtOTc4LDcgKzk3OSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfY2hpcF9pbmZv
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBjaGlwLT5tYXRjaC5hZGRy
ID8gLUVJTlZBTCA6IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX3JlZ2lzdGVyKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJc3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IGdzcGNhX2Rl
diAqZ3NwY2FfZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk4Nyw3ICs5ODksOCBAQCBz
dGF0aWMgaW50IHZpZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogCXJldHVybiBnc3BjYV9kZXYtPnNkX2Rlc2MtPmdldF9yZWdpc3Rlcihnc3BjYV9kZXYsIHJl
Zyk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19zX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJY29uc3Qg
c3RydWN0IHY0bDJfZGJnX3JlZ2lzdGVyICpyZWcpCiB7CiAJc3RydWN0IGdzcGNhX2RldiAqZ3Nw
Y2FfZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk5Nyw3ICsxMDAwLDggQEAgc3RhdGlj
IGludCB2aWRpb2Nfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0K
ICNlbmRpZgogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZm10ZGVzYykKIHsKIAlzdHJ1Y3QgZ3NwY2Ff
ZGV2ICpnc3BjYV9kZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTAyOSw3ICsxMDMzLDgg
QEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19n
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCBn
c3BjYV9kZXYgKmdzcGNhX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDc1LDcgKzEw
ODAsOCBAQCBzdGF0aWMgaW50IHRyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZ3NwY2FfZGV2ICpnc3Bj
YV9kZXYsCiAJcmV0dXJuIG1vZGU7CQkJLyogdXNlZCB3aGVuIHNfZm10ICovCiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IGdzcGNhX2RldiAqZ3NwY2FfZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTEwODgsNyArMTA5NCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3Ry
eV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmbXQpCiB7CiAJc3RydWN0IGdzcGNhX2RldiAqZ3NwY2FfZGV2ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTExMTMsNyArMTEyMCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9j
X3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCBnc3BjYV9kZXYg
KmdzcGNhX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTQyLDcgKzExNTAsOCBAQCBz
dGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZnJh
bWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZp
ZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJCSAgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2Zy
bWl2YWxlbnVtICpmaXZhbCkKIHsKIAlzdHJ1Y3QgZ3NwY2FfZGV2ICpnc3BjYV9kZXYgPSB2aWRl
b19kcnZkYXRhKGZpbHApOwpAQCAtMTE4Niw3ICsxMTk1LDggQEAgc3RhdGljIHZvaWQgZ3NwY2Ff
cmVsZWFzZShzdHJ1Y3QgdjRsMl9kZXZpY2UgKnY0bDJfZGV2aWNlKQogCWtmcmVlKGdzcGNhX2Rl
dik7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGdzcGNhX2RldiAqZ3NwY2FfZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEyMDcsNyArMTIxNyw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2
NGwyX2lucHV0ICppbnB1dCkKIHsKIAlzdHJ1Y3QgZ3NwY2FfZGV2ICpnc3BjYV9kZXYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwpAQCAtMTIyMSwyMCArMTIzMiwyMyBAQCBzdGF0aWMgaW50IHZpZGlv
Y19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCB1bnNpZ25lZCBpbnQgKmkpCitzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWdu
ZWQgaW50ICppKQogewogCSppID0gMDsKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRp
b2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkp
CitzdGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50IGkpCiB7CiAJaWYgKGkg
PiAwKQogCQlyZXR1cm4gLUVJTlZBTDsKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRp
b2NfZ19qcGVnY29tcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
dmlkaW9jX2dfanBlZ2NvbXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJc3RydWN0IHY0bDJfanBlZ2NvbXByZXNzaW9uICpq
cGVnY29tcCkKIHsKIAlzdHJ1Y3QgZ3NwY2FfZGV2ICpnc3BjYV9kZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMTI0Myw3ICsxMjU3LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19qcGVnY29t
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gZ3NwY2FfZGV2LT5zZF9k
ZXNjLT5nZXRfamNvbXAoZ3NwY2FfZGV2LCBqcGVnY29tcCk7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX3NfanBlZ2NvbXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHZpZGlvY19zX2pwZWdjb21wKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCWNvbnN0IHN0cnVjdCB2NGwyX2pwZWdjb21wcmVz
c2lvbiAqanBlZ2NvbXApCiB7CiAJc3RydWN0IGdzcGNhX2RldiAqZ3NwY2FfZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTEyNTIsNyArMTI2Nyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3Nf
anBlZ2NvbXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGdzcGNhX2Rl
di0+c2RfZGVzYy0+c2V0X2pjb21wKGdzcGNhX2RldiwganBlZ2NvbXApOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbHAsCisJCQkgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQlzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQogewog
CXN0cnVjdCBnc3BjYV9kZXYgKmdzcGNhX2RldiA9IHZpZGVvX2RydmRhdGEoZmlscCk7CkBAIC0x
MjY4LDcgKzEyODQsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZp
bHAsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGdzcGNhX2Rldi0+dXNiX2VycjsKIH0KIAotc3RhdGlj
IGludCB2aWRpb2Nfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRpb2Nfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxwLAorCQkJIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSkKIHsK
IAlzdHJ1Y3QgZ3NwY2FfZGV2ICpnc3BjYV9kZXYgPSB2aWRlb19kcnZkYXRhKGZpbHApOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS91c2IvaGFja3JmL2hhY2tyZi5jIGIvZHJpdmVycy9tZWRp
YS91c2IvaGFja3JmL2hhY2tyZi5jCmluZGV4IDBiNTBkZTg3NzVhMzhkZWIxMWM1MGRhNzk5Yzk4
YjFhMWVmMTRkMGEuLjRiNWEyZjVmMzExYzEwN2FiNmM2N2Q5NDZmZDBjODliNDNlYWQ1ZmEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL2hhY2tyZi9oYWNrcmYuYworKysgYi9kcml2ZXJz
L21lZGlhL3VzYi9oYWNrcmYvaGFja3JmLmMKQEAgLTg5MCw4ICs4OTAsOCBAQCBzdGF0aWMgY29u
c3Qgc3RydWN0IHZiMl9vcHMgaGFja3JmX3ZiMl9vcHMgPSB7CiAJLnN0b3Bfc3RyZWFtaW5nICAg
ICAgICAgPSBoYWNrcmZfc3RvcF9zdHJlYW1pbmcsCiB9OwogCi1zdGF0aWMgaW50IGhhY2tyZl9x
dWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCi0JCXN0cnVjdCB2NGwyX2NhcGFi
aWxpdHkgKmNhcCkKK3N0YXRpYyBpbnQgaGFja3JmX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHN0cnVjdCB2NGwyX2Nh
cGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgaGFja3JmX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIAlzdHJ1Y3QgdXNiX2ludGVyZmFjZSAqaW50ZiA9IGRldi0+aW50ZjsKQEAgLTkw
OSw3ICs5MDksOCBAQCBzdGF0aWMgaW50IGhhY2tyZl9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaGFja3JmX3NfZm10X3Nk
cihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaGFja3JmX3NfZm10
X3NkcihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGhhY2ty
Zl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05NDUsNyArOTQ2LDggQEAgc3Rh
dGljIGludCBoYWNrcmZfc19mbXRfc2RyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGhhY2tyZl9nX2ZtdF9zZHIoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGhhY2tyZl9nX2ZtdF9zZHIoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBoYWNrcmZfZGV2ICpkZXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTU5LDcgKzk2MSw4IEBAIHN0YXRpYyBpbnQgaGFja3Jm
X2dfZm10X3NkcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBoYWNrcmZfdHJ5X2ZtdF9zZHIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IGhhY2tyZl90cnlfZm10X3NkcihzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBoYWNrcmZfZGV2ICpkZXYgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtOTgxLDcgKzk4NCw4IEBAIHN0YXRpYyBpbnQgaGFja3JmX3RyeV9m
bXRfc2RyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGhhY2tyZl9lbnVtX2ZtdF9zZHIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IGhhY2tyZl9lbnVtX2ZtdF9zZHIoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAgc3Ry
dWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgaGFja3JmX2RldiAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTk5Niw4ICsxMDAwLDggQEAgc3RhdGljIGludCBoYWNrcmZfZW51
bV9mbXRfc2RyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IGhhY2tyZl9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAotCQljb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdikKK3N0YXRpYyBpbnQgaGFja3JmX3NfdHVu
ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLCBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdikKIHsKIAlzdHJ1Y3QgaGFja3JmX2RldiAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlpbnQgcmV0OwpAQCAtMTAxNCw3ICsxMDE4LDgg
QEAgc3RhdGljIGludCBoYWNrcmZfc190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IGhhY2tyZl9nX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5lciAqdikKK3N0YXRpYyBpbnQg
aGFja3JmX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl90dW5lciAqdikKIHsKIAlzdHJ1Y3QgaGFja3Jm
X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlpbnQgcmV0OwpAQCAtMTA0Miw3ICsx
MDQ3LDggQEAgc3RhdGljIGludCBoYWNrcmZfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnYpCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGlj
IGludCBoYWNrcmZfc19tb2R1bGF0b3Ioc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3Rh
dGljIGludCBoYWNrcmZfc19tb2R1bGF0b3Ioc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCB2
NGwyX21vZHVsYXRvciAqYSkKIHsKIAlzdHJ1Y3QgaGFja3JmX2RldiAqZGV2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTEwNTIsNyArMTA1OCw4IEBAIHN0YXRpYyBpbnQgaGFja3JmX3NfbW9k
dWxhdG9yKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gYS0+aW5kZXggPiAx
ID8gLUVJTlZBTCA6IDA7CiB9CiAKLXN0YXRpYyBpbnQgaGFja3JmX2dfbW9kdWxhdG9yKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaGFja3JmX2dfbW9kdWxhdG9yKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9tb2R1bGF0b3IgKmEpCiB7CiAJc3RydWN0IGhhY2ty
Zl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDgxLDcgKzEwODgsOCBAQCBz
dGF0aWMgaW50IGhhY2tyZl9nX21vZHVsYXRvcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBoYWNrcmZfc19mcmVxdWVuY3koc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGhhY2tyZl9zX2ZyZXF1ZW5jeShz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQljb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IGhhY2ty
Zl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMTI4LDggKzExMzYsOCBAQCBz
dGF0aWMgaW50IGhhY2tyZl9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IGhhY2tyZl9nX2ZyZXF1ZW5jeShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJc3RydWN0IHY0bDJfZnJlcXVlbmN5ICpmKQor
c3RhdGljIGludCBoYWNrcmZfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgc3RydWN0IHY0bDJfZnJlcXVlbmN5
ICpmKQogewogCXN0cnVjdCBoYWNrcmZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwog
CXN0cnVjdCB1c2JfaW50ZXJmYWNlICppbnRmID0gZGV2LT5pbnRmOwpAQCAtMTE2MSw3ICsxMTY5
LDggQEAgc3RhdGljIGludCBoYWNrcmZfZ19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBoYWNrcmZfZW51bV9mcmVx
X2JhbmRzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBoYWNrcmZf
ZW51bV9mcmVxX2JhbmRzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCXN0cnVjdCB2NGwyX2ZyZXF1ZW5jeV9iYW5kICpiYW5kKQog
ewogCXN0cnVjdCBoYWNrcmZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS91c2IvaGRwdnIvaGRwdnItdmlkZW8uYyBiL2RyaXZlcnMvbWVk
aWEvdXNiL2hkcHZyL2hkcHZyLXZpZGVvLmMKaW5kZXggOGM3YWUzNjJkOTkyYWI2MDM4Mjc0MjRl
OTE1OWQ5OGM3OTg4NmZiOC4uMTY3NzBiMTgyNTliMTFmY2UwNGY4NWM5OTliOTc1OWRiZTA2Yzlj
NiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS91c2IvaGRwdnIvaGRwdnItdmlkZW8uYworKysg
Yi9kcml2ZXJzL21lZGlhL3VzYi9oZHB2ci9oZHB2ci12aWRlby5jCkBAIC01NzksNyArNTc5LDgg
QEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVfb3BlcmF0aW9ucyBoZHB2cl9mb3BzID0g
ewogICogVjRMMiBpb2N0bCBoYW5kbGluZwogICovCiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3F1
ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0
IGhkcHZyX2RldmljZSAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTU5MCw4ICs1OTEs
OCBAQCBzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3Nfc3RkKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJdjRsMl9zdGRfaWQgc3RkKQorc3RhdGljIGludCB2
aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwgdjRsMl9zdGRfaWQgc3RkKQogewogCXN0cnVjdCBoZHB2cl9kZXZpY2UgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGhkcHZyX2ZoICpmaCA9IGZpbGVfdG9f
aGRwdnJfZmgoZmlsZSk7CkBAIC02MTAsOCArNjExLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19z
dGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGhkcHZyX2NvbmZpZ19j
YWxsKGRldiwgQ1RSTF9WSURFT19TVERfVFlQRSwgc3RkX3R5cGUpOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCXY0bDJfc3Rk
X2lkICpzdGQpCitzdGF0aWMgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCB2NGwyX3N0ZF9pZCAqc3RkKQogewog
CXN0cnVjdCBoZHB2cl9kZXZpY2UgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0
IGhkcHZyX2ZoICpmaCA9IGZpbGVfdG9faGRwdnJfZmgoZmlsZSk7CkBAIC02MjMsNyArNjI0LDgg
QEAgc3RhdGljIGludCB2aWRpb2NfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5c3RkKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqYSkKK3N0YXRpYyBpbnQgdmlkaW9jX3F1
ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsIHY0bDJfc3RkX2lkICphKQogewogCXN0cnVjdCBoZHB2cl9kZXZpY2UgKmRldiA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGhkcHZyX2ZoICpmaCA9IGZpbGVfdG9faGRw
dnJfZmgoZmlsZSk7CkBAIC02NDIsNyArNjQ0LDggQEAgc3RhdGljIGludCB2aWRpb2NfcXVlcnlz
dGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICphKQogCXJldHVy
biByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZHZfdGltaW5ncyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgICAgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlzdHJ1Y3QgaGRw
dnJfZGV2aWNlICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNjY1LDcgKzY2OCw4IEBA
IHN0YXRpYyBpbnQgdmlkaW9jX3NfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19kdl90aW1pbmdzKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZ19kdl90aW1p
bmdzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewog
CXN0cnVjdCBoZHB2cl9kZXZpY2UgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02Nzgs
NyArNjgyLDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19xdWVy
eV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aWRpb2NfcXVlcnlfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZHZfdGltaW5n
cyAqdGltaW5ncykKIHsKIAlzdHJ1Y3QgaGRwdnJfZGV2aWNlICpkZXYgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtNzIwLDcgKzcyNSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5X2R2X3Rp
bWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW51bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0
cnVjdCB2NGwyX2VudW1fZHZfdGltaW5ncyAqdGltaW5ncykKIHsKIAlzdHJ1Y3QgaGRwdnJfZGV2
aWNlICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzM2LDcgKzc0Miw4IEBAIHN0YXRp
YyBpbnQgdmlkaW9jX2VudW1fZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZHZfdGltaW5nc19jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19kdl90aW1pbmdz
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3NfY2FwICpjYXApCiB7CiAJc3Ry
dWN0IGhkcHZyX2RldmljZSAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc2Myw3ICs3
NzAsOSBAQCBzdGF0aWMgY29uc3QgY2hhciAqaW5hbWVbXSA9IHsKIAlbSERQVlJfQ09NUE9TSVRF
XSA9ICJDb21wb3NpdGUiLAogfTsKIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfaW5wdXQgKmkpCitzdGF0aWMg
aW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmkp
CiB7CiAJdW5zaWduZWQgaW50IG47CiAKQEAgLTc4Myw3ICs3OTIsOCBAQCBzdGF0aWMgaW50IHZp
ZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRs
Ml9pbnB1dCAqaQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkgIHVuc2lnbmVkIGludCBpbmRleCkKIHsKIAlzdHJ1Y3QgaGRwdnJfZGV2aWNlICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODE3LDcgKzgyNyw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldHZh
bDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICB1bnNpZ25lZCBpbnQg
KmluZGV4KQogewogCXN0cnVjdCBoZHB2cl9kZXZpY2UgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC04MzMsNyArODQ0LDggQEAgc3RhdGljIGNvbnN0IGNoYXIgKmF1ZGlvX2luYW1lW10g
PSB7CiAJW0hEUFZSX1NQRElGXSAgICAgPSAiU1BESUYiLAogfTsKIAotc3RhdGljIGludCB2aWRp
b2NfZW51bWF1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2
aWRpb2NfZW51bWF1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2F1ZGlvICphdWRpbykKIHsKIAl1
bnNpZ25lZCBpbnQgbjsKQEAgLTg0OSw3ICs4NjEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVt
YXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdmlkaW9jX3NfYXVkaW8oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitz
dGF0aWMgaW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW8g
KmF1ZGlvKQogewogCXN0cnVjdCBoZHB2cl9kZXZpY2UgKmRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC04NjgsNyArODgxLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19hdWRpbyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0dmFsOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB2aWRpb2NfZ19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0cnVjdCB2NGwyX2F1ZGlvICphdWRpbykKIHsKIAlz
dHJ1Y3QgaGRwdnJfZGV2aWNlICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTg1LDcg
Kzk5OSw4IEBAIHN0YXRpYyBpbnQgaGRwdnJfc19jdHJsKHN0cnVjdCB2NGwyX2N0cmwgKmN0cmwp
CiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJaWYgKGYt
PmluZGV4ICE9IDApCkBAIC05OTYsNyArMTAxMSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1f
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaGRwdnJfZGV2aWNlICpkZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtMTA0Miw3ICsxMDU4LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19mbXRf
dmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbHAsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IHZpZGlvY19lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlscCwKKwkJ
CSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVj
dCB2NGwyX2VuY29kZXJfY21kICphKQogewogCXN0cnVjdCBoZHB2cl9kZXZpY2UgKmRldiA9IHZp
ZGVvX2RydmRhdGEoZmlscCk7CkBAIC0xMDg3LDcgKzExMDQsOCBAQCBzdGF0aWMgaW50IHZpZGlv
Y19lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmVz
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZp
bHAsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlfZW5jb2Rlcl9jbWQoc3RydWN0
IGZpbGUgKmZpbHAsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkJc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQgKmEpCiB7CiAJYS0+ZmxhZ3MgPSAwOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9tZWRpYS91c2IvbXNpMjUwMC9tc2kyNTAwLmMgYi9kcml2ZXJzL21lZGlh
L3VzYi9tc2kyNTAwL21zaTI1MDAuYwppbmRleCAzMzA5OWYzOTE0NmFmZDZmNTllMGJkNmIzMTZk
OGY5ZTFlYWE2YTY0Li42Y2FlNzgyNzZkYTEwYmU3NTE0NWYzNzcyNzg0ZjViYmNjMjJiZTM2IDEw
MDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3VzYi9tc2kyNTAwL21zaTI1MDAuYworKysgYi9kcml2
ZXJzL21lZGlhL3VzYi9tc2kyNTAwL21zaTI1MDAuYwpAQCAtNTgxLDcgKzU4MSw4IEBAIHN0YXRp
YyB2b2lkIG1zaTI1MDBfZGlzY29ubmVjdChzdHJ1Y3QgdXNiX2ludGVyZmFjZSAqaW50ZikKIAl2
NGwyX2RldmljZV9wdXQoJmRldi0+djRsMl9kZXYpOwogfQogCi1zdGF0aWMgaW50IG1zaTI1MDBf
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBtc2kyNTAw
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlz
dHJ1Y3QgbXNpMjUwMF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC04ODUsNyAr
ODg2LDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIG1zaTI1MDBfdmIyX29wcyA9IHsK
IAkuc3RvcF9zdHJlYW1pbmcgICAgICAgICA9IG1zaTI1MDBfc3RvcF9zdHJlYW1pbmcsCiB9Owog
Ci1zdGF0aWMgaW50IG1zaTI1MDBfZW51bV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXNpMjUwMF9lbnVtX2ZtdF9zZHJfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgbXNpMjUwMF9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05MDAsNyArOTAyLDggQEAgc3RhdGljIGludCBt
c2kyNTAwX2VudW1fZm10X3Nkcl9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJ
cmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgbXNpMjUwMF9nX2ZtdF9zZHJfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBtc2kyNTAwX2dfZm10X3Nkcl9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IG1zaTI1MDBfZGV2ICpk
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtOTE0LDcgKzkxNyw4IEBAIHN0YXRpYyBpbnQg
bXNpMjUwMF9nX2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1zaTI1MDBfc19mbXRfc2RyX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXNpMjUwMF9zX2ZtdF9zZHJfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBtc2kyNTAwX2RldiAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk0NCw3ICs5NDgsOCBAQCBzdGF0aWMgaW50IG1z
aTI1MDBfc19mbXRfc2RyX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCBtc2kyNTAwX3RyeV9mbXRfc2RyX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXNpMjUwMF90cnlfZm10X3Nkcl9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBtc2kyNTAwX2Rl
diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTk2Niw3ICs5NzEsOCBAQCBzdGF0aWMg
aW50IG1zaTI1MDBfdHJ5X2ZtdF9zZHJfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IG1zaTI1MDBfc190dW5lcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgbXNpMjUwMF9zX3R1bmVyKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICBjb25zdCBzdHJ1Y3QgdjRsMl90dW5lciAqdikKIHsKIAlzdHJ1Y3QgbXNpMjUwMF9kZXYgKmRl
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05ODQsNyArOTkwLDkgQEAgc3RhdGljIGludCBt
c2kyNTAwX3NfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJl
dDsKIH0KIAotc3RhdGljIGludCBtc2kyNTAwX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX3R1bmVyICp2KQorc3RhdGljIGludCBtc2kyNTAwX2dfdHVu
ZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCSAgIHN0cnVjdCB2NGwyX3R1bmVyICp2KQogewogCXN0cnVjdCBtc2kyNTAwX2Rl
diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlpbnQgcmV0OwpAQCAtMTAwNyw3ICsxMDE1
LDggQEAgc3RhdGljIGludCBtc2kyNTAwX2dfdHVuZXIoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHN0cnVjdCB2NGwyX3R1bmVyICp2KQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBp
bnQgbXNpMjUwMF9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0
YXRpYyBpbnQgbXNpMjUwMF9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IG1zaTI1MDBfZGV2ICpkZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtMTAyOCw3ICsxMDM3LDggQEAgc3RhdGljIGludCBtc2kyNTAwX2dfZnJl
cXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiByZXQ7CiB9CiAK
LXN0YXRpYyBpbnQgbXNpMjUwMF9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgbXNpMjUwMF9zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBj
b25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IG1zaTI1MDBfZGV2ICpk
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTA1Miw3ICsxMDYyLDggQEAgc3RhdGljIGlu
dCBtc2kyNTAwX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgbXNpMjUwMF9lbnVtX2ZyZXFfYmFuZHMoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IG1zaTI1MDBfZW51bV9mcmVxX2Jh
bmRzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeV9iYW5kICpiYW5kKQogewogCXN0
cnVjdCBtc2kyNTAwX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbWVkaWEvdXNiL3B2cnVzYjIvcHZydXNiMi12NGwyLmMgYi9kcml2ZXJzL21lZGlh
L3VzYi9wdnJ1c2IyL3B2cnVzYjItdjRsMi5jCmluZGV4IGY5NTM1YTQ4NDczOGE5ZWYyNTc5NWRh
YTExYTc0Y2NiMGI5MTRiZTkuLjg3OTMzZGVjMTNjYjEwZjM1Y2ZjMDE4NWM1NTIzMjI0YmEwMjA3
OTEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL3B2cnVzYjIvcHZydXNiMi12NGwyLmMK
KysrIGIvZHJpdmVycy9tZWRpYS91c2IvcHZydXNiMi9wdnJ1c2IyLXY0bDIuYwpAQCAtMTA5LDcg
KzEwOSw4IEBAIHN0YXRpYyBzdHJ1Y3QgdjRsMl9mb3JtYXQgcHZyX2Zvcm1hdCBbXSA9IHsKIC8q
CiAgKiBUaGlzIGlzIHBhcnQgb2YgVmlkZW8gNCBMaW51eCBBUEkuIFRoZXNlIHByb2NlZHVyZXMg
aGFuZGxlIGlvY3RsKCkgY2FsbHMuCiAgKi8KLXN0YXRpYyBpbnQgcHZyMl9xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQor
c3RhdGljIGludCBwdnIyX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7
CiAJc3RydWN0IHB2cjJfdjRsMl9maCAqZmggPSB0b19wdnIyX3Y0bDJfZmgoZmlsZSk7CiAJc3Ry
dWN0IHB2cjJfaGR3ICpoZHcgPSBmaC0+Y2hhbm5lbC5tY19oZWFkLT5oZHc7CkBAIC0xMjQsNyAr
MTI1LDggQEAgc3RhdGljIGludCBwdnIyX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICoKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBwdnIyX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9p
ZCAqc3RkKQorc3RhdGljIGludCBwdnIyX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgdjRsMl9zdGRfaWQgKnN0ZCkKIHsK
IAlzdHJ1Y3QgcHZyMl92NGwyX2ZoICpmaCA9IHRvX3B2cjJfdjRsMl9maChmaWxlKTsKIAlzdHJ1
Y3QgcHZyMl9oZHcgKmhkdyA9IGZoLT5jaGFubmVsLm1jX2hlYWQtPmhkdzsKQEAgLTEzNyw3ICsx
MzksOCBAQCBzdGF0aWMgaW50IHB2cjJfZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHY0bDJfc3RkX2lkICpzdGQpCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBwdnIy
X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBzdGQpCitz
dGF0aWMgaW50IHB2cjJfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICB2NGwyX3N0ZF9pZCBzdGQpCiB7CiAJc3RydWN0IHB2
cjJfdjRsMl9maCAqZmggPSB0b19wdnIyX3Y0bDJfZmgoZmlsZSk7CiAJc3RydWN0IHB2cjJfaGR3
ICpoZHcgPSBmaC0+Y2hhbm5lbC5tY19oZWFkLT5oZHc7CkBAIC0xNDksNyArMTUyLDggQEAgc3Rh
dGljIGludCBwdnIyX3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0
ZF9pZCBzdGQpCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBwdnIyX3F1ZXJ5c3RkKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqc3RkKQorc3RhdGljIGlu
dCBwdnIyX3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCSB2NGwyX3N0ZF9pZCAqc3RkKQogewogCXN0cnVjdCBwdnIyX3Y0bDJf
ZmggKmZoID0gdG9fcHZyMl92NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCBwdnIyX2hkdyAqaGR3ID0g
ZmgtPmNoYW5uZWwubWNfaGVhZC0+aGR3OwpAQCAtMTYyLDcgKzE2Niw5IEBAIHN0YXRpYyBpbnQg
cHZyMl9xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQg
KnN0ZCkKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHB2cjJfZW51bV9pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfaW5wdXQgKnZpKQorc3RhdGlj
IGludCBwdnIyX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgIHN0cnVjdCB2NGwyX2lucHV0ICp2aSkKIHsK
IAlzdHJ1Y3QgcHZyMl92NGwyX2ZoICpmaCA9IHRvX3B2cjJfdjRsMl9maChmaWxlKTsKIAlzdHJ1
Y3QgcHZyMl9oZHcgKmhkdyA9IGZoLT5jaGFubmVsLm1jX2hlYWQtPmhkdzsKQEAgLTIxMCw3ICsy
MTYsOCBAQCBzdGF0aWMgaW50IHB2cjJfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwgc3RydWN0IHY0bDJfaW5wdXQgKnZpKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHB2cjJfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQg
aW50ICppKQorc3RhdGljIGludCBwdnIyX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJdW5zaWduZWQgaW50ICppKQogewogCXN0
cnVjdCBwdnIyX3Y0bDJfZmggKmZoID0gdG9fcHZyMl92NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCBw
dnIyX2hkdyAqaGR3ID0gZmgtPmNoYW5uZWwubWNfaGVhZC0+aGR3OwpAQCAtMjMyLDcgKzIzOSw4
IEBAIHN0YXRpYyBpbnQgcHZyMl9nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCB1bnNpZ25lZCBpbnQgKmkpCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCBwdnIyX3Nf
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpbnApCitz
dGF0aWMgaW50IHB2cjJfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCisJCQl1bnNpZ25lZCBpbnQgaW5wKQogewogCXN0cnVjdCBwdnIy
X3Y0bDJfZmggKmZoID0gdG9fcHZyMl92NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCBwdnIyX2hkdyAq
aGR3ID0gZmgtPmNoYW5uZWwubWNfaGVhZC0+aGR3OwpAQCAtMjQ3LDcgKzI1NSw4IEBAIHN0YXRp
YyBpbnQgcHZyMl9zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25l
ZCBpbnQgaW5wKQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgcHZyMl9lbnVtYXVkaW8o
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2F1ZGlvICp2aW4pCitz
dGF0aWMgaW50IHB2cjJfZW51bWF1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3RydWN0IHY0bDJfYXVkaW8gKnZpbikKIHsKIAkv
KiBwa3Q6IEZJWE1FOiBXZSBhcmUgcmV0dXJuaW5nIG9uZSAiZmFrZSIgaW5wdXQgaGVyZQogCSAg
IHdoaWNoIGNvdWxkIHZlcnkgd2VsbCBiZSBjYWxsZWQgIndoYXRldmVyX3dlX2xpa2UiLgpAQCAt
MjcxLDcgKzI4MCw4IEBAIHN0YXRpYyBpbnQgcHZyMl9lbnVtYXVkaW8oc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2F1ZGlvICp2aW4pCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgcHZyMl9nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9hdWRpbyAqdmluKQorc3RhdGljIGludCBwdnIyX2dfYXVkaW8oc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0
bDJfYXVkaW8gKnZpbikKIHsKIAkvKiBwa3Q6IEZJWE1FOiBzZWUgYWJvdmUgY29tbWVudCAoVklE
SU9DX0VOVU1BVURJTykgKi8KIAl2aW4tPmluZGV4ID0gMDsKQEAgLTI4MCwxNCArMjkwLDE2IEBA
IHN0YXRpYyBpbnQgcHZyMl9nX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9hdWRpbyAqdmluKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB2cjJf
c19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgY29uc3Qgc3RydWN0IHY0bDJf
YXVkaW8gKnZvdXQpCitzdGF0aWMgaW50IHB2cjJfc19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQljb25zdCBzdHJ1Y3QgdjRsMl9h
dWRpbyAqdm91dCkKIHsKIAlpZiAodm91dC0+aW5kZXgpCiAJCXJldHVybiAtRUlOVkFMOwogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB2cjJfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQorc3RhdGljIGludCBwdnIyX2dfdHVu
ZXIoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAor
CQkJc3RydWN0IHY0bDJfdHVuZXIgKnZ0KQogewogCXN0cnVjdCBwdnIyX3Y0bDJfZmggKmZoID0g
dG9fcHZyMl92NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCBwdnIyX2hkdyAqaGR3ID0gZmgtPmNoYW5u
ZWwubWNfaGVhZC0+aGR3OwpAQCAtMjk5LDcgKzMxMSw4IEBAIHN0YXRpYyBpbnQgcHZyMl9nX3R1
bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl90dW5lciAqdnQp
CiAJcmV0dXJuIHB2cjJfaGR3X2dldF90dW5lcl9zdGF0dXMoaGR3LCB2dCk7CiB9CiAKLXN0YXRp
YyBpbnQgcHZyMl9zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBjb25zdCBz
dHJ1Y3QgdjRsMl90dW5lciAqdnQpCitzdGF0aWMgaW50IHB2cjJfc190dW5lcihzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQljb25zdCBzdHJ1
Y3QgdjRsMl90dW5lciAqdnQpCiB7CiAJc3RydWN0IHB2cjJfdjRsMl9maCAqZmggPSB0b19wdnIy
X3Y0bDJfZmgoZmlsZSk7CiAJc3RydWN0IHB2cjJfaGR3ICpoZHcgPSBmaC0+Y2hhbm5lbC5tY19o
ZWFkLT5oZHc7CkBAIC0zMTUsNyArMzI4LDkgQEAgc3RhdGljIGludCBwdnIyX3NfdHVuZXIoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX3R1bmVyICoKIAly
ZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHB2cjJfc19mcmVxdWVuY3koc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZXF1ZW5jeSAqdmYpCitzdGF0
aWMgaW50IHB2cjJfc19mcmVxdWVuY3koc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgY29uc3Qgc3RydWN0IHY0bDJfZnJl
cXVlbmN5ICp2ZikKIHsKIAlzdHJ1Y3QgcHZyMl92NGwyX2ZoICpmaCA9IHRvX3B2cjJfdjRsMl9m
aChmaWxlKTsKIAlzdHJ1Y3QgcHZyMl9oZHcgKmhkdyA9IGZoLT5jaGFubmVsLm1jX2hlYWQtPmhk
dzsKQEAgLTM1MCw3ICszNjUsOSBAQCBzdGF0aWMgaW50IHB2cjJfc19mcmVxdWVuY3koc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGNvbnN0IHN0cnVjdCB2NGwyX2ZyZQogCXJldHVybiBy
ZXQ7CiB9CiAKLXN0YXRpYyBpbnQgcHZyMl9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZnJlcXVlbmN5ICp2ZikKK3N0YXRpYyBpbnQgcHZyMl9n
X2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKnZmKQogewogCXN0
cnVjdCBwdnIyX3Y0bDJfZmggKmZoID0gdG9fcHZyMl92NGwyX2ZoKGZpbGUpOwogCXN0cnVjdCBw
dnIyX2hkdyAqaGR3ID0gZmgtPmNoYW5uZWwubWNfaGVhZC0+aGR3OwpAQCAtMzgyLDcgKzM5OSw5
IEBAIHN0YXRpYyBpbnQgcHZyMl9nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgc3RydWN0IHY0bDJfZnJlcXVlbmN5CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
cHZyMl9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1
Y3QgdjRsMl9mbXRkZXNjICpmZCkKK3N0YXRpYyBpbnQgcHZyMl9lbnVtX2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCQkgc3RydWN0IHY0bDJfZm10ZGVzYyAqZmQpCiB7CiAJLyogT25seSBvbmUgZm9ybWF0IGlz
IHN1cHBvcnRlZDogTVBFRy4gKi8KIAlpZiAoZmQtPmluZGV4KQpAQCAtMzkyLDcgKzQxMSw5IEBA
IHN0YXRpYyBpbnQgcHZyMl9lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LCBzdHJ1Y3QgdjRsMl9mbXRkCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcHZy
Ml9nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRs
Ml9mb3JtYXQgKnZmKQorc3RhdGljIGludCBwdnIyX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAg
ICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqdmYpCiB7CiAJc3RydWN0IHB2cjJfdjRsMl9maCAqZmgg
PSB0b19wdnIyX3Y0bDJfZmgoZmlsZSk7CiAJc3RydWN0IHB2cjJfaGR3ICpoZHcgPSBmaC0+Y2hh
bm5lbC5tY19oZWFkLT5oZHc7CkBAIC00MTIsNyArNDMzLDkgQEAgc3RhdGljIGludCBwdnIyX2df
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zv
cm1hdAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB2cjJfdHJ5X2ZtdF92aWRfY2FwKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKnZmKQorc3Rh
dGljIGludCBwdnIyX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKnZm
KQogewogCXN0cnVjdCBwdnIyX3Y0bDJfZmggKmZoID0gdG9fcHZyMl92NGwyX2ZoKGZpbGUpOwog
CXN0cnVjdCBwdnIyX2hkdyAqaGR3ID0gZmgtPmNoYW5uZWwubWNfaGVhZC0+aGR3OwpAQCAtNDUw
LDEyICs0NzMsMTQgQEAgc3RhdGljIGludCBwdnIyX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWEKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBwdnIyX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqdmYpCitzdGF0aWMgaW50IHB2cjJfc19mbXRfdmlkX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICp2ZikKIHsKIAlzdHJ1Y3QgcHZy
Ml92NGwyX2ZoICpmaCA9IHRvX3B2cjJfdjRsMl9maChmaWxlKTsKIAlzdHJ1Y3QgcHZyMl9oZHcg
KmhkdyA9IGZoLT5jaGFubmVsLm1jX2hlYWQtPmhkdzsKIAlzdHJ1Y3QgcHZyMl9jdHJsICpoY3As
ICp2Y3A7Ci0JaW50IHJldCA9IHB2cjJfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIGZoLCB2Zik7CisJ
aW50IHJldCA9IHB2cjJfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCB2Zik7CiAKIAlpZiAo
cmV0KQogCQlyZXR1cm4gcmV0OwpAQCAtNDY3LDcgKzQ5Miw4IEBAIHN0YXRpYyBpbnQgcHZyMl9z
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9m
b3JtYXQKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwdnIyX3N0cmVhbW9uKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LCBlbnVtIHY0bDJfYnVmX3R5cGUgaSkKK3N0YXRpYyBpbnQg
cHZyMl9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgZW51bSB2NGwyX2J1Zl90eXBlIGkpCiB7CiAJc3RydWN0IHB2cjJfdjRs
Ml9maCAqZmggPSB0b19wdnIyX3Y0bDJfZmgoZmlsZSk7CiAJc3RydWN0IHB2cjJfaGR3ICpoZHcg
PSBmaC0+Y2hhbm5lbC5tY19oZWFkLT5oZHc7CkBAIC00ODYsNyArNTEyLDggQEAgc3RhdGljIGlu
dCBwdnIyX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBlbnVtIHY0bDJf
YnVmX3R5cGUgaSkKIAlyZXR1cm4gcHZyMl9oZHdfc2V0X3N0cmVhbWluZyhoZHcsICEwKTsKIH0K
IAotc3RhdGljIGludCBwdnIyX3N0cmVhbW9mZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwgZW51bSB2NGwyX2J1Zl90eXBlIGkpCitzdGF0aWMgaW50IHB2cjJfc3RyZWFtb2ZmKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgZW51
bSB2NGwyX2J1Zl90eXBlIGkpCiB7CiAJc3RydWN0IHB2cjJfdjRsMl9maCAqZmggPSB0b19wdnIy
X3Y0bDJfZmgoZmlsZSk7CiAJc3RydWN0IHB2cjJfaGR3ICpoZHcgPSBmaC0+Y2hhbm5lbC5tY19o
ZWFkLT5oZHc7CkBAIC01MDAsNyArNTI3LDggQEAgc3RhdGljIGludCBwdnIyX3N0cmVhbW9mZihz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgZW51bSB2NGwyX2J1Zl90eXBlIGkpCiAJcmV0
dXJuIHB2cjJfaGR3X3NldF9zdHJlYW1pbmcoaGR3LCAwKTsKIH0KIAotc3RhdGljIGludCBwdnIy
X3F1ZXJ5X2V4dF9jdHJsKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCBwdnIyX3F1ZXJ5X2V4dF9jdHJsKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX3F1ZXJ5
X2V4dF9jdHJsICp2YykKIHsKIAlzdHJ1Y3QgcHZyMl92NGwyX2ZoICpmaCA9IHRvX3B2cjJfdjRs
Ml9maChmaWxlKTsKQEAgLTU2Miw3ICs1OTAsOCBAQCBzdGF0aWMgaW50IHB2cjJfcXVlcnlfZXh0
X2N0cmwoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgcHZyMl9xdWVyeW1lbnUoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0
cnVjdCB2NGwyX3F1ZXJ5bWVudSAqdm0pCitzdGF0aWMgaW50IHB2cjJfcXVlcnltZW51KHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgc3Ry
dWN0IHY0bDJfcXVlcnltZW51ICp2bSkKIHsKIAlzdHJ1Y3QgcHZyMl92NGwyX2ZoICpmaCA9IHRv
X3B2cjJfdjRsMl9maChmaWxlKTsKIAlzdHJ1Y3QgcHZyMl9oZHcgKmhkdyA9IGZoLT5jaGFubmVs
Lm1jX2hlYWQtPmhkdzsKQEAgLTU3Nyw3ICs2MDYsOCBAQCBzdGF0aWMgaW50IHB2cjJfcXVlcnlt
ZW51KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9xdWVyeW1lbnUg
KgogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgcHZyMl9nX2V4dF9jdHJscyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgcHZyMl9nX2V4dF9jdHJscyhzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkJc3RydWN0IHY0bDJfZXh0X2NvbnRyb2xzICpjdGxzKQogewogCXN0cnVjdCBwdnIyX3Y0
bDJfZmggKmZoID0gdG9fcHZyMl92NGwyX2ZoKGZpbGUpOwpAQCAtNjEyLDcgKzY0Miw4IEBAIHN0
YXRpYyBpbnQgcHZyMl9nX2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwdnIyX3NfZXh0X2N0cmxzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBwdnIyX3NfZXh0X2N0cmxzKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQlz
dHJ1Y3QgdjRsMl9leHRfY29udHJvbHMgKmN0bHMpCiB7CiAJc3RydWN0IHB2cjJfdjRsMl9maCAq
ZmggPSB0b19wdnIyX3Y0bDJfZmgoZmlsZSk7CkBAIC02MzcsNyArNjY4LDggQEAgc3RhdGljIGlu
dCBwdnIyX3NfZXh0X2N0cmxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgcHZyMl90cnlfZXh0X2N0cmxzKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBwdnIyX3RyeV9leHRfY3RybHMoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
c3RydWN0IHY0bDJfZXh0X2NvbnRyb2xzICpjdGxzKQogewogCXN0cnVjdCBwdnIyX3Y0bDJfZmgg
KmZoID0gdG9fcHZyMl92NGwyX2ZoKGZpbGUpOwpAQCAtNjU5LDggKzY5MSw5IEBAIHN0YXRpYyBp
bnQgcHZyMl90cnlfZXh0X2N0cmxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB2cjJfZ19waXhlbGFzcGVjdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKLQkJCSAgICAgIGludCB0eXBlLCBzdHJ1Y3QgdjRsMl9mcmFjdCAq
ZikKK3N0YXRpYyBpbnQgcHZyMl9nX3BpeGVsYXNwZWN0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIGludCB0eXBlLAorCQkJICAg
ICAgc3RydWN0IHY0bDJfZnJhY3QgKmYpCiB7CiAJc3RydWN0IHB2cjJfdjRsMl9maCAqZmggPSB0
b19wdnIyX3Y0bDJfZmgoZmlsZSk7CiAJc3RydWN0IHB2cjJfaGR3ICpoZHcgPSBmaC0+Y2hhbm5l
bC5tY19oZWFkLT5oZHc7CkBAIC02NzUsNyArNzA4LDggQEAgc3RhdGljIGludCBwdnIyX2dfcGl4
ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIHJldDsKIH0K
IAotc3RhdGljIGludCBwdnIyX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCBwdnIyX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwy
X3NlbGVjdGlvbiAqc2VsKQogewogCXN0cnVjdCBwdnIyX3Y0bDJfZmggKmZoID0gdG9fcHZyMl92
NGwyX2ZoKGZpbGUpOwpAQCAtNzI2LDcgKzc2MCw4IEBAIHN0YXRpYyBpbnQgcHZyMl9nX3NlbGVj
dGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1z
dGF0aWMgaW50IHB2cjJfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHB2cjJfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfc2Vs
ZWN0aW9uICpzZWwpCiB7CiAJc3RydWN0IHB2cjJfdjRsMl9maCAqZmggPSB0b19wdnIyX3Y0bDJf
ZmgoZmlsZSk7CkBAIC03NTksNyArNzk0LDggQEAgc3RhdGljIGludCBwdnIyX3Nfc2VsZWN0aW9u
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRp
YyBpbnQgcHZyMl9sb2dfc3RhdHVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2KQorc3Rh
dGljIGludCBwdnIyX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIHsKIAlzdHJ1Y3QgcHZyMl92NGwyX2ZoICpmaCA9
IHRvX3B2cjJfdjRsMl9maChmaWxlKTsKIAlzdHJ1Y3QgcHZyMl9oZHcgKmhkdyA9IGZoLT5jaGFu
bmVsLm1jX2hlYWQtPmhkdzsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdXNiL3B3Yy9wd2Mt
djRsLmMgYi9kcml2ZXJzL21lZGlhL3VzYi9wd2MvcHdjLXY0bC5jCmluZGV4IDcxYjcxOWQzNjNh
NWRmNzFhNjViMzRiMTAzYjk2OGE1YjNiOGNiNjguLjk4NjU1MmU4YTExZmU0ZTlmZTBiNmIzMTZj
N2IzNDg0MGJlMzAwYjYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL3B3Yy9wd2MtdjRs
LmMKKysrIGIvZHJpdmVycy9tZWRpYS91c2IvcHdjL3B3Yy12NGwuYwpAQCAtNDQ2LDcgKzQ0Niw5
IEBAIHN0YXRpYyBpbnQgcHdjX3ZpZGlvY190cnlfZm10KHN0cnVjdCBwd2NfZGV2aWNlICpwZGV2
LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAKIC8qIGlvY3RsKFZJRElPQ19TRVRfRk1UKSAqLwog
Ci1zdGF0aWMgaW50IHB3Y19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBwd2Nfc19mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCisJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgcHdjX2Rldmlj
ZSAqcGRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJaW50IHJldCwgcGl4ZWxmb3JtYXQsIGNv
bXByZXNzaW9uID0gMDsKQEAgLTQ3Niw3ICs0NzgsOCBAQCBzdGF0aWMgaW50IHB3Y19zX2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgcHdjX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQorc3RhdGljIGlu
dCBwd2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBw
d2NfZGV2aWNlICpwZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtNDg2LDcgKzQ4OSw4
IEBAIHN0YXRpYyBpbnQgcHdjX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
c3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
cHdjX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9p
bnB1dCAqaSkKK3N0YXRpYyBpbnQgcHdjX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9pbnB1dCAq
aSkKIHsKIAlpZiAoaS0+aW5kZXgpCS8qIE9ubHkgb25lIElOUFVUIGlzIHN1cHBvcnRlZCAqLwog
CQlyZXR1cm4gLUVJTlZBTDsKQEAgLTQ5NiwxMyArNTAwLDE1IEBAIHN0YXRpYyBpbnQgcHdjX2Vu
dW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9pbnB1dCAq
aSkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwd2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCAqaSkKK3N0YXRpYyBpbnQgcHdjX2dfaW5wdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkg
ICAgICAgdW5zaWduZWQgaW50ICppKQogewogCSppID0gMDsKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCBwd2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVk
IGludCBpKQorc3RhdGljIGludCBwd2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICB1bnNpZ25lZCBpbnQgaSkKIHsK
IAlyZXR1cm4gaSA/IC1FSU5WQUwgOiAwOwogfQpAQCAtODY0LDcgKzg3MCw5IEBAIHN0YXRpYyBp
bnQgcHdjX3NfY3RybChzdHJ1Y3QgdjRsMl9jdHJsICpjdHJsKQogCXJldHVybiByZXQ7CiB9CiAK
LXN0YXRpYyBpbnQgcHdjX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQorc3RhdGljIGludCBwd2NfZW51bV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCBwd2NfZGV2aWNl
ICpwZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAtODgzLDcgKzg5MSw5IEBAIHN0YXRp
YyBpbnQgcHdjX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBz
dHJ1Y3QgdjRsMl9mbXRkZXNjCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcHdjX2dfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQg
KmYpCitzdGF0aWMgaW50IHB3Y19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBwd2NfZGV2aWNlICpwZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKIApAQCAtODk2LDE0ICs5MDYsMTcgQEAgc3RhdGljIGludCBwd2NfZ19mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBwd2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCBw
d2NfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIHsKIAlzdHJ1Y3QgcHdjX2RldmljZSAqcGRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAK
IAlyZXR1cm4gcHdjX3ZpZGlvY190cnlfZm10KHBkZXYsIGYpOwogfQogCi1zdGF0aWMgaW50IHB3
Y19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGlu
dCBwd2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0bDJfZnJtc2l6ZWVu
dW0gKmZzaXplKQogewogCXN0cnVjdCBwd2NfZGV2aWNlICpwZGV2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKQEAgLTkyOCw4ICs5NDEsOSBAQCBzdGF0aWMgaW50IHB3Y19lbnVtX2ZyYW1lc2l6ZXMo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0
aWMgaW50IHB3Y19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKLQkJCQkJICAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFsKQorc3RhdGljIGludCBw
d2NfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgICBzdHJ1Y3QgdjRsMl9mcm1pdmFsZW51
bSAqZml2YWwpCiB7CiAJc3RydWN0IHB3Y19kZXZpY2UgKnBkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwogCWludCBzaXplID0gLTE7CkBAIC05NTgsNyArOTcyLDggQEAgc3RhdGljIGludCBwd2Nf
ZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgcHdjX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsCitzdGF0aWMgaW50IHB3Y19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCSAgICAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkgICAgICBzdHJ1Y3QgdjRsMl9zdHJl
YW1wYXJtICpwYXJtKQogewogCXN0cnVjdCBwd2NfZGV2aWNlICpwZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKQEAgLTk3Nyw3ICs5OTIsOCBAQCBzdGF0aWMgaW50IHB3Y19nX3Bhcm0oc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHB3Y19z
X3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBwd2Nfc19wYXJt
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJICAgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSkKIHsKIAlzdHJ1Y3Qg
cHdjX2RldmljZSAqcGRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDAzLDcgKzEwMTks
NyBAQCBzdGF0aWMgaW50IHB3Y19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAog
CXJldCA9IHB3Y19zZXRfdmlkZW9fbW9kZShwZGV2LCBwZGV2LT53aWR0aCwgcGRldi0+aGVpZ2h0
LCBwZGV2LT5waXhmbXQsCiAJCQkJIGZwcywgJmNvbXByZXNzaW9uLCAwKTsKIAotCXB3Y19nX3Bh
cm0oZmlsZSwgZmgsIHBhcm0pOworCXB3Y19nX3Bhcm0oZmlsZSwgc3RhdGUsIHBhcm0pOwogCiAJ
cmV0dXJuIHJldDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdXNiL3MyMjU1L3MyMjU1
ZHJ2LmMgYi9kcml2ZXJzL21lZGlhL3VzYi9zMjI1NS9zMjI1NWRydi5jCmluZGV4IDgzMzJmMmM1
YWVkNzA2NzAzNWVmNjQ3NWUwYjNkNTI4ZTdmYzgwNGYuLmVmYzk1MjYxMzVhNTIxMmM2YzNkMTA0
YTRjYWU5NDA5MjIzNTdhY2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdXNiL3MyMjU1L3My
MjU1ZHJ2LmMKKysrIGIvZHJpdmVycy9tZWRpYS91c2IvczIyNTUvczIyNTVkcnYuYwpAQCAtNzA2
LDcgKzcwNiw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBzMjI1NV92aWRlb19xb3Bz
ID0gewogCS5zdG9wX3N0cmVhbWluZyA9IHN0b3Bfc3RyZWFtaW5nLAogfTsKIAotc3RhdGljIGlu
dCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2Fw
KQogewogCXN0cnVjdCBzMjI1NV92YyAqdmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzE4
LDcgKzcxOSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRp
b2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpm
KQogewogCWludCBpbmRleCA9IGYtPmluZGV4OwpAQCAtNzMyLDcgKzczNCw4IEBAIHN0YXRpYyBp
bnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgczIyNTVfdmMgKnZj
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTc1Miw4ICs3NTUsOSBAQCBzdGF0aWMgaW50IHZp
ZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCi0JCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0
aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAljb25zdCBzdHJ1Y3QgczIyNTVfZm10ICpmbXQ7CiAJZW51bSB2NGwyX2ZpZWxk
IGZpZWxkOwpAQCAtODAzLDggKzgwNyw5IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKLQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZpZGlvY19zX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgczIyNTVf
dmMgKnZjID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAljb25zdCBzdHJ1Y3QgczIyNTVfZm10ICpm
bXQ7CkBAIC04MTIsNyArODE3LDcgQEAgc3RhdGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlzdHJ1Y3QgczIyNTVfbW9kZSBtb2RlOwog
CWludCByZXQ7CiAKLQlyZXQgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHZjLCBmKTsK
KwlyZXQgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAogCWlmIChy
ZXQgPCAwKQogCQlyZXR1cm4gcmV0OwpAQCAtMTA4OSw3ICsxMDk0LDggQEAgc3RhdGljIHZvaWQg
c3RvcF9zdHJlYW1pbmcoc3RydWN0IHZiMl9xdWV1ZSAqdnEpCiAJc3Bpbl91bmxvY2tfaXJxcmVz
dG9yZSgmdmMtPnFsb2NrLCBmbGFncyk7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3Nfc3RkKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBpKQorc3RhdGljIGludCB2
aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAorCQkJdjRsMl9zdGRfaWQgaSkKIHsKIAlzdHJ1Y3QgczIyNTVfdmMgKnZjID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgczIyNTVfbW9kZSBtb2RlOwpAQCAtMTEzMCw3ICsx
MTM2LDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHY0bDJfc3RkX2lkIGkpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9j
X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqaSkKK3N0
YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXY0bDJfc3RkX2lkICppKQogewogCXN0cnVjdCBzMjI1NV92
YyAqdmMgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC0xMTQ1LDcgKzExNTIsOCBAQCBzdGF0
aWMgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9z
dGRfaWQgKmkpCiAgICBGb3IgaW5zdGFuY2UsIHlvdSBjYW5ub3QgZG8gZnVsbCBGUFMgb24gbW9y
ZSB0aGFuIDIgY2hhbm5lbHMoMiB2aWRlb2RldnMpCiAgICBhdCBvbmNlIGluIGNvbG9yKHlvdSBj
YW4gZG8gZnVsbCBmcHMgb24gNCBjaGFubmVscyB3aXRoIGdyZXlzY2FsZS4KICovCi1zdGF0aWMg
aW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2lucHV0
ICppbnApCiB7CiAJc3RydWN0IHMyMjU1X3ZjICp2YyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xMTc5LDEyICsxMTg3LDE1IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlk
aW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAq
aSkKK3N0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJKmkg
PSAwOwogCXJldHVybiAwOwogfQotc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCisKK3N0YXRpYyBpbnQgdmlkaW9j
X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlpZiAoaSA+IDApCiAJCXJldHVybiAtRUlO
VkFMOwpAQCAtMTIzMCw3ICsxMjQxLDggQEAgc3RhdGljIGludCBzMjI1NV9zX2N0cmwoc3RydWN0
IHY0bDJfY3RybCAqY3RybCkKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19q
cGVnY29tcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9j
X2dfanBlZ2NvbXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX2pwZWdjb21wcmVzc2lvbiAqamMpCiB7
CiAJc3RydWN0IHMyMjU1X3ZjICp2YyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMjQxLDcg
KzEyNTMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2pwZWdjb21wKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2pwZWdj
b21wKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19q
cGVnY29tcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgY29uc3Qgc3RydWN0IHY0bDJfanBlZ2NvbXByZXNzaW9uICpqYykK
IHsKIAlzdHJ1Y3QgczIyNTVfdmMgKnZjID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTEyNTMs
NyArMTI2Niw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfanBlZ2NvbXAoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfcGFy
bShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfcGFy
bShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCSBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpzcCkKIHsKIAlfX3UzMiBkZWZfbnVtLCBk
ZWZfZGVtOwpAQCAtMTI5MCw3ICsxMzA0LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19wYXJtKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHZpZGlvY19zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqc3ApCiB7CiAJc3Ry
dWN0IHMyMjU1X3ZjICp2YyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzQ0LDcgKzEzNTks
OCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfZnJtc2l6ZV9kaXNjcmV0ZSBwYWxfc2l6ZXNb
XSA9IHsKIAl7IDM1MiwgMjg4IH0sCiB9OwogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1l
c2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19l
bnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZmUpCiB7
CiAJc3RydWN0IHMyMjU1X3ZjICp2YyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzYyLDcg
KzEzNzgsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAg
ICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIHN0cnVjdCB2NGwy
X2ZybWl2YWxlbnVtICpmZSkKIHsKIAlzdHJ1Y3QgczIyNTVfdmMgKnZjID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdXNiL3N0azExNjAvc3RrMTE2MC12
NGwuYyBiL2RyaXZlcnMvbWVkaWEvdXNiL3N0azExNjAvc3RrMTE2MC12NGwuYwppbmRleCA3MTVj
ZTFkY2IzMDQxMjlkNzZkNzNiYTMyNzg1OGRhNGU4OTM5NmE0Li40YTllZmM3MmI0N2UxMWE3Yzk5
YmE3YjE2YWQ2ZmFmZWMwZWZkM2U4IDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3VzYi9zdGsx
MTYwL3N0azExNjAtdjRsLmMKKysrIGIvZHJpdmVycy9tZWRpYS91c2Ivc3RrMTE2MC9zdGsxMTYw
LXY0bC5jCkBAIC0zMjksNyArMzI5LDcgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVf
b3BlcmF0aW9ucyBzdGsxMTYwX2ZvcHMgPSB7CiAgKiB2aWRpb2MgaW9jdGxzCiAgKi8KIHN0YXRp
YyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAotCQl2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCisJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IHN0azExNjAg
KmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTMzOSw4ICszMzksOCBAQCBzdGF0aWMg
aW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAgKnByaXYsCi0JCXN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMgaW50IHZpZGlvY19l
bnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT5p
bmRleCAhPSAwKQogCQlyZXR1cm4gLUVJTlZBTDsKQEAgLTM0OSw3ICszNDksOCBAQCBzdGF0aWMg
aW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICAqcHJp
diwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3Qgc3RrMTE2MCAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQ2OCw3ICs0NjksOCBAQCBzdGF0aWMgaW50IHN0
azExNjBfdHJ5X2ZtdChzdHJ1Y3Qgc3RrMTE2MCAqZGV2LCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzdGsxMTYw
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNDc2LDcgKzQ3OCw4IEBAIHN0YXRpYyBp
bnQgdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gc3RrMTE2MF90cnlfZm10KGRldiwgZiwgTlVMTCk7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
CiB7CiAJc3RydWN0IHN0azExNjAgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00OTcs
MTQgKzUwMCwxNyBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19x
dWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKm5vcm0p
CitzdGF0aWMgaW50IHZpZGlvY19xdWVyeXN0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgdjRsMl9zdGRfaWQgKm5vcm0p
CiB7CiAJc3RydWN0IHN0azExNjAgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJdjRsMl9k
ZXZpY2VfY2FsbF9hbGwoJmRldi0+djRsMl9kZXYsIDAsIHZpZGVvLCBxdWVyeXN0ZCwgbm9ybSk7
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfc3RkKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAqbm9ybSkKK3N0YXRpYyBpbnQgdmlkaW9jX2df
c3RkKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCXY0bDJfc3RkX2lkICpub3JtKQogewogCXN0cnVjdCBzdGsxMTYwICpkZXYgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwogCkBAIC01MTIsNyArNTE4LDggQEAgc3RhdGljIGludCB2aWRpb2NfZ19z
dGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0bDJfc3RkX2lkICpub3JtKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgbm9ybSkKK3N0YXRpYyBpbnQgdmlkaW9jX3Nfc3RkKHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXY0
bDJfc3RkX2lkIG5vcm0pCiB7CiAJc3RydWN0IHN0azExNjAgKmRldiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CiAJc3RydWN0IHZiMl9xdWV1ZSAqcSA9ICZkZXYtPnZiX3ZpZHE7CkBAIC01NDQsNyAr
NTUxLDggQEAgc3RhdGljIGludCB2aWRpb2Nfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsIHY0bDJfc3RkX2lkIG5vcm0pCiB9CiAKIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2Vu
dW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2lucHV0ICppKQogewogCXN0cnVjdCBzdGsx
MTYwICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNTYzLDE0ICs1NzEsMTYgQEAgc3Rh
dGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB2aWRpb2NfZ19p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CisJCQkgIHVuc2lnbmVkIGludCAqaSkKIHsKIAlzdHJ1Y3Qgc3RrMTE2MCAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKIAkqaSA9IGRldi0+Y3RsX2lucHV0OwogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IHZpZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1
bnNpZ25lZCBpbnQgaSkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQg
aSkKIHsKIAlzdHJ1Y3Qgc3RrMTE2MCAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIApAQCAt
NTg1LDcgKzU5NSw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQogfQogCiAjaWZkZWYgQ09ORklHX1ZJREVP
X0FEVl9ERUJVRwotc3RhdGljIGludCB2aWRpb2NfZ19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfcmVnaXN0ZXIoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAg
ICBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKIHsKIAlzdHJ1Y3Qgc3RrMTE2MCAqZGV2
ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTYwMCw3ICs2MTEsOCBAQCBzdGF0aWMgaW50IHZp
ZGlvY19nX3JlZ2lzdGVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiBy
YzsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19yZWdpc3RlcihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfcmVnaXN0ZXIoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBj
b25zdCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZykKIHsKIAlzdHJ1Y3Qgc3RrMTE2MCAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvdXNi
L3VzYnR2L3VzYnR2LXZpZGVvLmMgYi9kcml2ZXJzL21lZGlhL3VzYi91c2J0di91c2J0di12aWRl
by5jCmluZGV4IGRlMDMyODEwMGE2MGRkN2I0MzM1ZTIwOGZlZTRjZDI4NjRkNWI5OWQuLmRhMjU2
YTRjZjI0ODE2NjJjOWRmNWYxMDVmODY0OWVkNjU4NTU4ZDEgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
bWVkaWEvdXNiL3VzYnR2L3VzYnR2LXZpZGVvLmMKKysrIGIvZHJpdmVycy9tZWRpYS91c2IvdXNi
dHYvdXNidHYtdmlkZW8uYwpAQCAtNjAyLDcgKzYwMiw4IEBAIHN0YXRpYyBpbnQgdXNidHZfc3Rh
cnQoc3RydWN0IHVzYnR2ICp1c2J0dikKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHVz
YnR2X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB1
c2J0dl9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0
cnVjdCB1c2J0diAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTYxMyw3ICs2MTQsOCBA
QCBzdGF0aWMgaW50IHVzYnR2X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHVzYnR2X2VudW1faW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHVzYnR2X2VudW1faW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJCXN0cnVjdCB2NGwyX2lucHV0ICppKQogewogCXN0cnVjdCB1c2J0diAqZGV2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTYzNCw3ICs2MzYsOCBAQCBzdGF0aWMgaW50IHVzYnR2X2VudW1f
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgdXNidHZfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAg
KnByaXYsCitzdGF0aWMgaW50IHVzYnR2X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0
IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlpZiAoZi0+aW5kZXggPiAwKQpAQCAtNjQ0LDcgKzY0Nyw4
IEBAIHN0YXRpYyBpbnQgdXNidHZfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdXNidHZfZm10X3ZpZF9j
YXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHVzYnR2X2ZtdF92
aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB1c2J0
diAqdXNidHYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNjYwLDE0ICs2NjQsMTYgQEAgc3Rh
dGljIGludCB1c2J0dl9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB1c2J0dl9nX3N0ZChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKm5vcm0pCitzdGF0aWMgaW50IHVzYnR2X2dfc3Rk
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
ICAgICAgIHY0bDJfc3RkX2lkICpub3JtKQogewogCXN0cnVjdCB1c2J0diAqdXNidHYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCSpub3JtID0gdXNidHYtPm5vcm07CiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgdXNidHZfc19zdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHY0
bDJfc3RkX2lkIG5vcm0pCitzdGF0aWMgaW50IHVzYnR2X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIHY0bDJfc3RkX2lk
IG5vcm0pCiB7CiAJaW50IHJldCA9IC1FSU5WQUw7CiAJc3RydWN0IHVzYnR2ICp1c2J0diA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02NzgsMTQgKzY4NCwxNiBAQCBzdGF0aWMgaW50IHVzYnR2
X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBub3JtKQog
CXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgdXNidHZfZ19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50ICppKQorc3RhdGljIGludCB1c2J0dl9nX2lu
cHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
KwkJCSB1bnNpZ25lZCBpbnQgKmkpCiB7CiAJc3RydWN0IHVzYnR2ICp1c2J0diA9IHZpZGVvX2Ry
dmRhdGEoZmlsZSk7CiAJKmkgPSB1c2J0di0+aW5wdXQ7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdXNidHZfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWdu
ZWQgaW50IGkpCitzdGF0aWMgaW50IHVzYnR2X3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJIHVuc2lnbmVkIGludCBpKQogewog
CXN0cnVjdCB1c2J0diAqdXNidHYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCmRpZmYgLS1naXQg
YS9kcml2ZXJzL21lZGlhL3VzYi91dmMvdXZjX21ldGFkYXRhLmMgYi9kcml2ZXJzL21lZGlhL3Vz
Yi91dmMvdXZjX21ldGFkYXRhLmMKaW5kZXggYzIzYjE3NDk2NWMzNzlhMWFiYmM1MWQ0MmFjYWNh
ZGU4MGZmN2UxMC4uNWM0ZjYxMDU0ZTgwMTNhMTNjOTA2MmNmYTlmZTg0MzE5YjA1MTk4MCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9tZWRpYS91c2IvdXZjL3V2Y19tZXRhZGF0YS5jCisrKyBiL2RyaXZl
cnMvbWVkaWEvdXNiL3V2Yy91dmNfbWV0YWRhdGEuYwpAQCAtMjMsNyArMjMsOCBAQAogICogVjRM
MiBpb2N0bHMKICAqLwogCi1zdGF0aWMgaW50IHV2Y19tZXRhX3Y0bDJfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHV2Y19tZXRhX3Y0bDJfcXVlcnlj
YXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgdjRs
Ml9maCAqdmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwpAQCAtMzksNyArNDAsOCBAQCBzdGF0
aWMgaW50IHV2Y19tZXRhX3Y0bDJfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdXZjX21ldGFfdjRsMl9nZXRfZm9ybWF0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB1dmNfbWV0YV92NGwy
X2dldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIHsK
IAlzdHJ1Y3QgdjRsMl9maCAqdmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwpAQCAtNTUsNyAr
NTcsOCBAQCBzdGF0aWMgaW50IHV2Y19tZXRhX3Y0bDJfZ2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB1dmNfbWV0YV92
NGwyX3RyeV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50
IHV2Y19tZXRhX3Y0bDJfdHJ5X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZm9ybWF0KQogewogCXN0cnVjdCB2NGwyX2ZoICp2ZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmls
ZSk7CkBAIC04Miw3ICs4NSw4IEBAIHN0YXRpYyBpbnQgdXZjX21ldGFfdjRsMl90cnlfZm9ybWF0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHV2Y19tZXRhX3Y0bDJfc2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdXZjX21ldGFfdjRsMl9zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3Ry
dWN0IHY0bDJfZm9ybWF0ICpmb3JtYXQpCiB7CiAJc3RydWN0IHY0bDJfZmggKnZmaCA9IGZpbGVf
dG9fdjRsMl9maChmaWxlKTsKQEAgLTkwLDcgKzk0LDcgQEAgc3RhdGljIGludCB1dmNfbWV0YV92
NGwyX3NldF9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJc3RydWN0IHY0
bDJfbWV0YV9mb3JtYXQgKmZtdCA9ICZmb3JtYXQtPmZtdC5tZXRhOwogCWludCByZXQ7CiAKLQly
ZXQgPSB1dmNfbWV0YV92NGwyX3RyeV9mb3JtYXQoZmlsZSwgcHJpdiwgZm9ybWF0KTsKKwlyZXQg
PSB1dmNfbWV0YV92NGwyX3RyeV9mb3JtYXQoZmlsZSwgc3RhdGUsIGZvcm1hdCk7CiAJaWYgKHJl
dCA8IDApCiAJCXJldHVybiByZXQ7CiAKQEAgLTEwNyw3ICsxMTEsOCBAQCBzdGF0aWMgaW50IHV2
Y19tZXRhX3Y0bDJfc2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB1dmNfbWV0YV92NGwyX2VudW1fZm9ybWF0cyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX21ldGFfdjRsMl9lbnVt
X2Zvcm1hdHMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZmRlc2MpCiB7
CiAJc3RydWN0IHY0bDJfZmggKnZmaCA9IGZpbGVfdG9fdjRsMl9maChmaWxlKTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvbWVkaWEvdXNiL3V2Yy91dmNfdjRsMi5jIGIvZHJpdmVycy9tZWRpYS91c2Iv
dXZjL3V2Y192NGwyLmMKaW5kZXggOWU0YTI1MWVjYTg4MDg1YTFiNGUwZTg1NDM3MDAxNTg1NWJl
OTJlZS4uY2U2Yjk0MDM2MzhlNzE2NzZiMTVjYjNlMThjNDFiOGFhNGU5YzE1ZCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9tZWRpYS91c2IvdXZjL3V2Y192NGwyLmMKKysrIGIvZHJpdmVycy9tZWRpYS91
c2IvdXZjL3V2Y192NGwyLmMKQEAgLTM4Niw3ICszODYsOCBAQCBzdGF0aWMgaW50IHV2Y192NGwy
X3RyeV9mb3JtYXQoc3RydWN0IHV2Y19zdHJlYW1pbmcgKnN0cmVhbSwKIAlyZXR1cm4gcmV0Owog
fQogCi1zdGF0aWMgaW50IHV2Y19pb2N0bF9nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3RsX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3QgdXZjX2ZoICpoYW5kbGUgPSB0b191dmNfZmgoZmlsZSk7
CkBAIC00MTYsNyArNDE3LDggQEAgc3RhdGljIGludCB1dmNfaW9jdGxfZ19mbXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdXZjX2lv
Y3RsX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB1dmNf
aW9jdGxfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVj
dCB1dmNfZmggKmhhbmRsZSA9IHRvX3V2Y19maChmaWxlKTsKQEAgLTQ0Myw3ICs0NDUsOCBAQCBz
dGF0aWMgaW50IHV2Y19pb2N0bF9zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB1dmNfaW9jdGxfZ19wYXJtKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB1dmNfaW9jdGxfZ19wYXJtKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
ICAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJdTMyIG51bWVyYXRvciwgZGVu
b21pbmF0b3I7CkBAIC00NzcsNyArNDgwLDggQEAgc3RhdGljIGludCB1dmNfaW9jdGxfZ19wYXJt
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHV2Y19pb2N0bF9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHV2Y19pb2N0bF9zX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJfc3RyZWFtcGFy
bSAqcGFybSkKIHsKIAlzdHJ1Y3QgdXZjX2ZoICpoYW5kbGUgPSB0b191dmNfZmgoZmlsZSk7CkBA
IC01OTksNyArNjAzLDggQEAgc3RhdGljIGludCB1dmNfdjRsMl9yZWxlYXNlKHN0cnVjdCBmaWxl
ICpmaWxlKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHV2Y19pb2N0bF9xdWVyeWNhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3RsX3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ry
dWN0IHV2Y19maCAqaGFuZGxlID0gdG9fdXZjX2ZoKGZpbGUpOwpAQCAtNjE1LDcgKzYyMCw4IEBA
IHN0YXRpYyBpbnQgdXZjX2lvY3RsX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHV2Y19pb2N0bF9lbnVtX2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3RsX2VudW1fZm10
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmbXQpCiB7CiAJc3RydWN0IHV2
Y19maCAqaGFuZGxlID0gdG9fdXZjX2ZoKGZpbGUpOwpAQCAtNjM5LDcgKzY0NSw4IEBAIHN0YXRp
YyBpbnQgdXZjX2lvY3RsX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHV2Y19pb2N0bF90cnlfZm10KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB1dmNfaW9jdGxfdHJ5X2ZtdChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCB1dmNfZmggKmhhbmRs
ZSA9IHRvX3V2Y19maChmaWxlKTsKQEAgLTY0OSw3ICs2NTYsOCBAQCBzdGF0aWMgaW50IHV2Y19p
b2N0bF90cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiB1dmNf
djRsMl90cnlfZm9ybWF0KHN0cmVhbSwgZm10LCAmcHJvYmUsIE5VTEwsIE5VTEwpOwogfQogCi1z
dGF0aWMgaW50IHV2Y19pb2N0bF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorc3RhdGljIGludCB1dmNfaW9jdGxfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9p
bnB1dCAqaW5wdXQpCiB7CiAJc3RydWN0IHV2Y19maCAqaGFuZGxlID0gdG9fdXZjX2ZoKGZpbGUp
OwpAQCAtNjkyLDcgKzcwMCw5IEBAIHN0YXRpYyBpbnQgdXZjX2lvY3RsX2VudW1faW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dXZjX2lvY3RsX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGludCAqaW5wdXQpCitzdGF0aWMgaW50IHV2Y19pb2N0bF9nX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAg
dW5zaWduZWQgaW50ICppbnB1dCkKIHsKIAlzdHJ1Y3QgdXZjX2ZoICpoYW5kbGUgPSB0b191dmNf
ZmgoZmlsZSk7CiAJc3RydWN0IHV2Y192aWRlb19jaGFpbiAqY2hhaW4gPSBoYW5kbGUtPmNoYWlu
OwpAQCAtNzIwLDcgKzczMCw5IEBAIHN0YXRpYyBpbnQgdXZjX2lvY3RsX2dfaW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaW5wdXQpCiAJcmV0dXJuIHJl
dDsKIH0KIAotc3RhdGljIGludCB1dmNfaW9jdGxfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGlucHV0KQorc3RhdGljIGludCB1dmNfaW9jdGxfc19p
bnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgICAgIHVuc2lnbmVkIGludCBpbnB1dCkKIHsKIAlzdHJ1Y3QgdXZjX2Zo
ICpoYW5kbGUgPSB0b191dmNfZmgoZmlsZSk7CiAJc3RydWN0IHV2Y19zdHJlYW1pbmcgKnN0cmVh
bSA9IGhhbmRsZS0+c3RyZWFtOwpAQCAtNzU0LDcgKzc2Niw4IEBAIHN0YXRpYyBpbnQgdXZjX2lv
Y3RsX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBp
bnB1dCkKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHV2Y19pb2N0bF9xdWVyeV9leHRf
Y3RybChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3Rs
X3F1ZXJ5X2V4dF9jdHJsKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfcXVlcnlfZXh0X2N0cmwg
KnFlYykKIHsKIAlzdHJ1Y3QgdXZjX2ZoICpoYW5kbGUgPSB0b191dmNfZmgoZmlsZSk7CkBAIC03
ODIsNyArNzk1LDggQEAgc3RhdGljIGludCB1dmNfY3RybF9jaGVja19hY2Nlc3Moc3RydWN0IHV2
Y192aWRlb19jaGFpbiAqY2hhaW4sCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCB1dmNf
aW9jdGxfZ19leHRfY3RybHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHV2Y19pb2N0bF9nX2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX2V4dF9jb250cm9s
cyAqY3RybHMpCiB7CiAJc3RydWN0IHV2Y19maCAqaGFuZGxlID0gdG9fdXZjX2ZoKGZpbGUpOwpA
QCAtODY2LDcgKzg4MCw4IEBAIHN0YXRpYyBpbnQgdXZjX2lvY3RsX3NfdHJ5X2V4dF9jdHJscyhz
dHJ1Y3QgdXZjX2ZoICpoYW5kbGUsCiAJCXJldHVybiB1dmNfY3RybF9yb2xsYmFjayhoYW5kbGUp
OwogfQogCi1zdGF0aWMgaW50IHV2Y19pb2N0bF9zX2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3RsX3NfZXh0X2N0cmxzKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
c3RydWN0IHY0bDJfZXh0X2NvbnRyb2xzICpjdHJscykKIHsKIAlzdHJ1Y3QgdXZjX2ZoICpoYW5k
bGUgPSB0b191dmNfZmgoZmlsZSk7CkBAIC04NzQsNyArODg5LDggQEAgc3RhdGljIGludCB1dmNf
aW9jdGxfc19leHRfY3RybHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IHV2Y19pb2N0bF9zX3RyeV9leHRfY3RybHMoaGFuZGxlLCBjdHJscywgVklESU9DX1NfRVhUX0NU
UkxTKTsKIH0KIAotc3RhdGljIGludCB1dmNfaW9jdGxfdHJ5X2V4dF9jdHJscyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3RsX3RyeV9leHRfY3RybHMo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZXh0X2NvbnRyb2xzICpjdHJscykKIHsKIAlzdHJ1Y3Qg
dXZjX2ZoICpoYW5kbGUgPSB0b191dmNfZmgoZmlsZSk7CkBAIC04ODIsNyArODk4LDggQEAgc3Rh
dGljIGludCB1dmNfaW9jdGxfdHJ5X2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIAlyZXR1cm4gdXZjX2lvY3RsX3NfdHJ5X2V4dF9jdHJscyhoYW5kbGUsIGN0cmxzLCBW
SURJT0NfVFJZX0VYVF9DVFJMUyk7CiB9CiAKLXN0YXRpYyBpbnQgdXZjX2lvY3RsX3F1ZXJ5bWVu
dShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3RsX3F1
ZXJ5bWVudShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9xdWVyeW1lbnUgKnFtKQogewog
CXN0cnVjdCB1dmNfZmggKmhhbmRsZSA9IHRvX3V2Y19maChmaWxlKTsKQEAgLTg5MSw3ICs5MDgs
OCBAQCBzdGF0aWMgaW50IHV2Y19pb2N0bF9xdWVyeW1lbnUoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIHV2Y19xdWVyeV92NGwyX21lbnUoY2hhaW4sIHFtKTsKIH0KIAot
c3RhdGljIGludCB1dmNfaW9jdGxfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IHV2Y19pb2N0bF9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2
NGwyX3NlbGVjdGlvbiAqc2VsKQogewogCXN0cnVjdCB1dmNfZmggKmhhbmRsZSA9IHRvX3V2Y19m
aChmaWxlKTsKQEAgLTkyMyw3ICs5NDEsOCBAQCBzdGF0aWMgaW50IHV2Y19pb2N0bF9nX3NlbGVj
dGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCB1dmNfaW9jdGxfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorc3RhdGljIGludCB1dmNfaW9jdGxfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxl
ICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IHV2Y19maCAq
aGFuZGxlID0gdG9fdXZjX2ZoKGZpbGUpOwpAQCAtOTYzLDcgKzk4Miw4IEBAIHN0YXRpYyBpbnQg
dXZjX2lvY3RsX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB1dmNfaW9jdGxfZW51bV9mcmFtZWludGVydmFs
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdXZjX2lvY3RsX2Vu
dW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJIHN0cnVjdCB2NGwyX2ZybWl2YWxlbnVtICpmaXZh
bCkKIHsKIAlzdHJ1Y3QgdXZjX2ZoICpoYW5kbGUgPSB0b191dmNfZmgoZmlsZSk7CkBAIC0xMDM1
LDcgKzEwNTUsOCBAQCBzdGF0aWMgaW50IHV2Y19pb2N0bF9zdWJzY3JpYmVfZXZlbnQoc3RydWN0
IHY0bDJfZmggKmZoLAogCX0KIH0KIAotc3RhdGljIGxvbmcgdXZjX2lvY3RsX2RlZmF1bHQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGJvb2wgdmFsaWRfcHJpbywKK3N0YXRpYyBsb25n
IHV2Y19pb2N0bF9kZWZhdWx0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIGJvb2wgdmFsaWRfcHJpbywKIAkJCSAgICAgIHVuc2ln
bmVkIGludCBjbWQsIHZvaWQgKmFyZykKIHsKIAlzdHJ1Y3QgdXZjX2ZoICpoYW5kbGUgPSB0b191
dmNfZmgoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Y0bDItY29yZS92NGwyLWN0
cmxzLWFwaS5jIGIvZHJpdmVycy9tZWRpYS92NGwyLWNvcmUvdjRsMi1jdHJscy1hcGkuYwppbmRl
eCAwMDc4YTA0YzU0NDU5MGNjMDI5ODhjN2QwNDFlNjY1MTk0MzJhOGNmLi45ZmU4NjUyNmUzOGZm
ZDEzMWYyYzVmYjQ4YmI2MTg0M2EyNTQzZjhhIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3Y0
bDItY29yZS92NGwyLWN0cmxzLWFwaS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0
bDItY3RybHMtYXBpLmMKQEAgLTEyNTAsNyArMTI1MCw3IEBAIEVYUE9SVF9TWU1CT0wodjRsMl9x
dWVyeW1lbnUpOwogICogVklESU9DX0xPR19TVEFUVVMgaGVscGVycwogICovCiAKLWludCB2NGwy
X2N0cmxfbG9nX3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdikKK2ludCB2NGwy
X2N0cmxfbG9nX3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmZkID0gdmlkZW9fZGV2ZGF0
YShmaWxlKTsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS92NGwyLWNvcmUvdjRsMi1kZXYu
YyBiL2RyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0bDItZGV2LmMKaW5kZXggMjYwNjA3NzUzOGJl
MGU4MzAzMmM2YWU4OTU2YzFkNjdkYTBkMGM1ZC4uOTNiZjgwNjdlYWY3OWI1YjMzMzYzOTIyNDM0
YmQ4MjU5MWYxOWY4MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS92NGwyLWNvcmUvdjRsMi1k
ZXYuYworKysgYi9kcml2ZXJzL21lZGlhL3Y0bDItY29yZS92NGwyLWRldi5jCkBAIC0yMDgsOSAr
MjA4LDkgQEAgc3RydWN0IHY0bDJfZm9ybWF0ICp2aWRlb19kZXZpY2Vfc3RhdGVfZ2V0X2ZtdChz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSkKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHZp
ZGVvX2RldmljZV9zdGF0ZV9nZXRfZm10KTsKIAotaW50IHZpZGVvX2RldmljZV9nX2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCitpbnQg
dmlkZW9fZGV2aWNlX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewotCXN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlID0gcHJpdjsKIAlzdHJ1Y3QgdjRsMl9mb3Jt
YXQgKnZmbXQgPSB2aWRlb19kZXZpY2Vfc3RhdGVfZ2V0X2ZtdChzdGF0ZSk7CiAKIAlpZiAoIXZm
bXQpCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Y0bDItY29yZS92NGwyLW1lbTJtZW0uYyBi
L2RyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0bDItbWVtMm1lbS5jCmluZGV4IDIxYWNkOWJjODYw
NzE4Y2NiZTU5OTI1ODY1ZDNhNmRkOWVjOTQ4NGIuLmY2YjMxMGU3MDA4MmE0ZDVkOThmYmExOTIw
YTY3YjE1MTUyYzVhMWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0bDIt
bWVtMm1lbS5jCisrKyBiL2RyaXZlcnMvbWVkaWEvdjRsMi1jb3JlL3Y0bDItbWVtMm1lbS5jCkBA
IC0xMzY0LDggKzEzNjQsOCBAQCBFWFBPUlRfU1lNQk9MX0dQTCh2NGwyX20ybV9yZXF1ZXN0X3F1
ZXVlKTsKIAogLyogVmlkZW9idWYyIGlvY3RsIGhlbHBlcnMgKi8KIAotaW50IHY0bDJfbTJtX2lv
Y3RsX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCi0JCQkJc3RydWN0IHY0
bDJfcmVxdWVzdGJ1ZmZlcnMgKnJiKQoraW50IHY0bDJfbTJtX2lvY3RsX3JlcWJ1ZnMoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgc3Ry
dWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKnJiKQogewogCXN0cnVjdCB2NGwyX2ZoICpmaCA9IGZp
bGVfdG9fdjRsMl9maChmaWxlKTsKIApAQCAtMTM3Myw4ICsxMzczLDkgQEAgaW50IHY0bDJfbTJt
X2lvY3RsX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiBFWFBPUlRf
U1lNQk9MX0dQTCh2NGwyX20ybV9pb2N0bF9yZXFidWZzKTsKIAotaW50IHY0bDJfbTJtX2lvY3Rs
X2NyZWF0ZV9idWZzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCXN0cnVjdCB2
NGwyX2NyZWF0ZV9idWZmZXJzICpjcmVhdGUpCitpbnQgdjRsMl9tMm1faW9jdGxfY3JlYXRlX2J1
ZnMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgICAgICAgc3RydWN0IHY0bDJfY3JlYXRlX2J1ZmZlcnMgKmNyZWF0ZSkK
IHsKIAlzdHJ1Y3QgdjRsMl9maCAqZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CiAKQEAgLTEz
ODIsNyArMTM4Myw4IEBAIGludCB2NGwyX20ybV9pb2N0bF9jcmVhdGVfYnVmcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHY0bDJfbTJtX2lvY3Rs
X2NyZWF0ZV9idWZzKTsKIAotaW50IHY0bDJfbTJtX2lvY3RsX3JlbW92ZV9idWZzKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHY0bDJfbTJtX2lvY3RsX3JlbW92ZV9idWZzKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX3JlbW92ZV9idWZmZXJzICpyZW1vdmUpCiB7CiAJ
c3RydWN0IHY0bDJfZmggKmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwpAQCAtMTM5Nyw4ICsx
Mzk5LDggQEAgaW50IHY0bDJfbTJtX2lvY3RsX3JlbW92ZV9idWZzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAogfQogRVhQT1JUX1NZTUJPTF9HUEwodjRsMl9tMm1faW9jdGxfcmVtb3Zl
X2J1ZnMpOwogCi1pbnQgdjRsMl9tMm1faW9jdGxfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCi0JCQkJc3RydWN0IHY0bDJfYnVmZmVyICpidWYpCitpbnQgdjRsMl9tMm1f
aW9jdGxfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAorCQkJICAgIHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQogewogCXN0cnVjdCB2
NGwyX2ZoICpmaCA9IGZpbGVfdG9fdjRsMl9maChmaWxlKTsKIApAQCAtMTQwNiw4ICsxNDA4LDgg
QEAgaW50IHY0bDJfbTJtX2lvY3RsX3F1ZXJ5YnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAogfQogRVhQT1JUX1NZTUJPTF9HUEwodjRsMl9tMm1faW9jdGxfcXVlcnlidWYpOwogCi1p
bnQgdjRsMl9tMm1faW9jdGxfcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJ
CQlzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKK2ludCB2NGwyX20ybV9pb2N0bF9xYnVmKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCXN0cnVj
dCB2NGwyX2J1ZmZlciAqYnVmKQogewogCXN0cnVjdCB2NGwyX2ZoICpmaCA9IGZpbGVfdG9fdjRs
Ml9maChmaWxlKTsKIApAQCAtMTQxNSw4ICsxNDE3LDggQEAgaW50IHY0bDJfbTJtX2lvY3RsX3Fi
dWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiB9CiBFWFBPUlRfU1lNQk9MX0dQTCh2
NGwyX20ybV9pb2N0bF9xYnVmKTsKIAotaW50IHY0bDJfbTJtX2lvY3RsX2RxYnVmKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAotCQkJCXN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQoraW50
IHY0bDJfbTJtX2lvY3RsX2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKIHsKIAlzdHJ1
Y3QgdjRsMl9maCAqZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CiAKQEAgLTE0MjQsNyArMTQy
Niw4IEBAIGludCB2NGwyX20ybV9pb2N0bF9kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHY0bDJfbTJtX2lvY3RsX2RxYnVmKTsKIAotaW50
IHY0bDJfbTJtX2lvY3RsX3ByZXBhcmVfYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAoraW50IHY0bDJfbTJtX2lvY3RsX3ByZXBhcmVfYnVmKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
ICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIHN0cnVj
dCB2NGwyX2J1ZmZlciAqYnVmKQogewogCXN0cnVjdCB2NGwyX2ZoICpmaCA9IGZpbGVfdG9fdjRs
Ml9maChmaWxlKTsKQEAgLTE0MzMsNyArMTQzNiw4IEBAIGludCB2NGwyX20ybV9pb2N0bF9wcmVw
YXJlX2J1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xf
R1BMKHY0bDJfbTJtX2lvY3RsX3ByZXBhcmVfYnVmKTsKIAotaW50IHY0bDJfbTJtX2lvY3RsX2V4
cGJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2NGwyX20ybV9pb2N0bF9l
eHBidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2V4cG9ydGJ1ZmZlciAqZWIpCiB7CiAJc3RydWN0IHY0
bDJfZmggKmZoID0gZmlsZV90b192NGwyX2ZoKGZpbGUpOwpAQCAtMTQ0Miw3ICsxNDQ2LDggQEAg
aW50IHY0bDJfbTJtX2lvY3RsX2V4cGJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IH0KIEVYUE9SVF9TWU1CT0xfR1BMKHY0bDJfbTJtX2lvY3RsX2V4cGJ1Zik7CiAKLWludCB2NGwy
X20ybV9pb2N0bF9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2
NGwyX20ybV9pb2N0bF9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQllbnVtIHY0bDJfYnVmX3R5cGUgdHlwZSkK
IHsKIAlzdHJ1Y3QgdjRsMl9maCAqZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CkBAIC0xNDUx
LDcgKzE0NTYsOCBAQCBpbnQgdjRsMl9tMm1faW9jdGxfc3RyZWFtb24oc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCiB9CiBFWFBPUlRfU1lNQk9MX0dQTCh2NGwyX20ybV9pb2N0bF9zdHJl
YW1vbik7CiAKLWludCB2NGwyX20ybV9pb2N0bF9zdHJlYW1vZmYoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitpbnQgdjRsMl9tMm1faW9jdGxfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQllbnVt
IHY0bDJfYnVmX3R5cGUgdHlwZSkKIHsKIAlzdHJ1Y3QgdjRsMl9maCAqZmggPSBmaWxlX3RvX3Y0
bDJfZmgoZmlsZSk7CkBAIC0xNDYwLDcgKzE0NjYsOCBAQCBpbnQgdjRsMl9tMm1faW9jdGxfc3Ry
ZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogRVhQT1JUX1NZTUJPTF9H
UEwodjRsMl9tMm1faW9jdGxfc3RyZWFtb2ZmKTsKIAotaW50IHY0bDJfbTJtX2lvY3RsX3RyeV9l
bmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2NGwyX20ybV9p
b2N0bF90cnlfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZW5jb2Rlcl9jbWQg
KmVjKQogewogCWlmIChlYy0+Y21kICE9IFY0TDJfRU5DX0NNRF9TVE9QICYmIGVjLT5jbWQgIT0g
VjRMMl9FTkNfQ01EX1NUQVJUKQpAQCAtMTQ3MSw3ICsxNDc4LDggQEAgaW50IHY0bDJfbTJtX2lv
Y3RsX3RyeV9lbmNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIEVY
UE9SVF9TWU1CT0xfR1BMKHY0bDJfbTJtX2lvY3RsX3RyeV9lbmNvZGVyX2NtZCk7CiAKLWludCB2
NGwyX20ybV9pb2N0bF90cnlfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitpbnQgdjRsMl9tMm1faW9jdGxfdHJ5X2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVj
dCB2NGwyX2RlY29kZXJfY21kICpkYykKIHsKIAlpZiAoZGMtPmNtZCAhPSBWNEwyX0RFQ19DTURf
U1RPUCAmJiBkYy0+Y21kICE9IFY0TDJfREVDX0NNRF9TVEFSVCkKQEAgLTE1MzUsNyArMTU0Myw4
IEBAIGludCB2NGwyX20ybV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHY0
bDJfbTJtX2N0eCAqbTJtX2N0eCwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHY0bDJfbTJtX2RlY29k
ZXJfY21kKTsKIAotaW50IHY0bDJfbTJtX2lvY3RsX2VuY29kZXJfY21kKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAoraW50IHY0bDJfbTJtX2lvY3RsX2VuY29kZXJfY21kKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgICAgIHN0cnVjdCB2NGwyX2VuY29kZXJfY21kICplYykKIHsKIAlzdHJ1Y3QgdjRsMl9m
aCAqZmggPSBmaWxlX3RvX3Y0bDJfZmgoZmlsZSk7CkBAIC0xNTQ0LDcgKzE1NTMsOCBAQCBpbnQg
djRsMl9tMm1faW9jdGxfZW5jb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiB9CiBFWFBPUlRfU1lNQk9MX0dQTCh2NGwyX20ybV9pb2N0bF9lbmNvZGVyX2NtZCk7CiAKLWlu
dCB2NGwyX20ybV9pb2N0bF9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK2ludCB2NGwyX20ybV9pb2N0bF9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1
Y3QgdjRsMl9kZWNvZGVyX2NtZCAqZGMpCiB7CiAJc3RydWN0IHY0bDJfZmggKmZoID0gZmlsZV90
b192NGwyX2ZoKGZpbGUpOwpAQCAtMTU1Myw3ICsxNTYzLDggQEAgaW50IHY0bDJfbTJtX2lvY3Rs
X2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogfQogRVhQT1JUX1NZ
TUJPTF9HUEwodjRsMl9tMm1faW9jdGxfZGVjb2Rlcl9jbWQpOwogCi1pbnQgdjRsMl9tMm1faW9j
dGxfc3RhdGVsZXNzX3RyeV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK2ludCB2NGwyX20ybV9pb2N0bF9zdGF0ZWxlc3NfdHJ5X2RlY29kZXJfY21kKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCQkgICAgIHN0cnVjdCB2NGwyX2RlY29kZXJfY21kICpkYykKIHsKIAlpZiAoZGMtPmNtZCAh
PSBWNEwyX0RFQ19DTURfRkxVU0gpCkBAIC0xNTY1LDcgKzE1NzYsOCBAQCBpbnQgdjRsMl9tMm1f
aW9jdGxfc3RhdGVsZXNzX3RyeV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKIH0KIEVYUE9SVF9TWU1CT0xfR1BMKHY0bDJfbTJtX2lvY3RsX3N0YXRlbGVzc190cnlf
ZGVjb2Rlcl9jbWQpOwogCi1pbnQgdjRsMl9tMm1faW9jdGxfc3RhdGVsZXNzX2RlY29kZXJfY21k
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHY0bDJfbTJtX2lvY3RsX3N0YXRl
bGVzc19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0bDJfZGVjb2Rlcl9jbWQgKmRjKQog
ewogCXN0cnVjdCB2NGwyX2ZoICpmaCA9IGZpbGVfdG9fdjRsMl9maChmaWxlKTsKQEAgLTE1NzQs
NyArMTU4Niw3IEBAIGludCB2NGwyX20ybV9pb2N0bF9zdGF0ZWxlc3NfZGVjb2Rlcl9jbWQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJdW5zaWduZWQgbG9uZyBmbGFnczsKIAlpbnQg
cmV0OwogCi0JcmV0ID0gdjRsMl9tMm1faW9jdGxfc3RhdGVsZXNzX3RyeV9kZWNvZGVyX2NtZChm
aWxlLCBwcml2LCBkYyk7CisJcmV0ID0gdjRsMl9tMm1faW9jdGxfc3RhdGVsZXNzX3RyeV9kZWNv
ZGVyX2NtZChmaWxlLCBzdGF0ZSwgZGMpOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4gcmV0Owog
CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvYXRvbWlzcC9wY2kvYXRvbWlzcF9p
b2N0bC5jIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL2F0b21pc3AvcGNpL2F0b21pc3BfaW9jdGwu
YwppbmRleCBiYjhiMmYyMjEzYjA4ZjAzMjkzMjZlNzBkNzA0ZTYwOWJiZmZiMzIxLi5kNDY1ODk3
ODhmZTIwZjNlMTdiYmRhY2EzZjI4NjQ5MzQ2ZTM0YmNlIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0
YWdpbmcvbWVkaWEvYXRvbWlzcC9wY2kvYXRvbWlzcF9pb2N0bC5jCisrKyBiL2RyaXZlcnMvc3Rh
Z2luZy9tZWRpYS9hdG9taXNwL3BjaS9hdG9taXNwX2lvY3RsLmMKQEAgLTM2MCw3ICszNjAsOCBA
QCBpbnQgYXRvbWlzcF9waXBlX2NoZWNrKHN0cnVjdCBhdG9taXNwX3ZpZGVvX3BpcGUgKnBpcGUs
IGJvb2wgc2V0dGluZ3NfY2hhbmdlKQogICogdjRsMiBpb2N0bHMKICAqIHJldHVybiBJU1AgY2Fw
YWJpbGl0aWVzCiAgKi8KLXN0YXRpYyBpbnQgYXRvbWlzcF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGF0b21pc3BfcXVlcnljYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAg
c3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZk
ZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMzc2LDcgKzM3Nyw4IEBAIHN0YXRpYyBpbnQg
YXRvbWlzcF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAvKgogICogZW51
bSBpbnB1dCBhcmUgdXNlZCB0byBjaGVjayBwcmltYXJ5L3NlY29uZGFyeSBjYW1lcmEKICAqLwot
c3RhdGljIGludCBhdG9taXNwX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LAorc3RhdGljIGludCBhdG9taXNwX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2
NGwyX2lucHV0ICppbnB1dCkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9f
ZGV2ZGF0YShmaWxlKTsKQEAgLTQwMyw3ICs0MDUsOSBAQCBzdGF0aWMgaW50IGF0b21pc3BfZW51
bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAvKgogICogZ2V0IGlucHV0IGFy
ZSB1c2VkIHRvIGdldCBjdXJyZW50IHByaW1hcnkvc2Vjb25kYXJ5IGNhbWVyYQogICovCi1zdGF0
aWMgaW50IGF0b21pc3BfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2ln
bmVkIGludCAqaW5wdXQpCitzdGF0aWMgaW50IGF0b21pc3BfZ19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICAgdW5z
aWduZWQgaW50ICppbnB1dCkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9f
ZGV2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgYXRvbWlzcF9zdWJfZGV2aWNlICphc2QgPSBhdG9taXNw
X3RvX3ZpZGVvX3BpcGUodmRldiktPmFzZDsKQEAgLTQxMiw3ICs0MTYsOCBAQCBzdGF0aWMgaW50
IGF0b21pc3BfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGlu
dCAqaW5wdXQpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYXRvbWlzcF9zX2ZtdF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBhdG9taXNwX3NfZm10X2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTQyMyw3ICs0MjgsOSBAQCBz
dGF0aWMgaW50IGF0b21pc3Bfc19mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IC8qCiAgKiBzZXQgaW5wdXQgYXJlIHVzZWQgdG8gc2V0IGN1cnJlbnQgcHJpbWFyeS9zZWNvbmRh
cnkgY2FtZXJhCiAgKi8KLXN0YXRpYyBpbnQgYXRvbWlzcF9zX2lucHV0KHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGlucHV0KQorc3RhdGljIGludCBhdG9taXNwX3Nf
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgIHVuc2lnbmVkIGludCBpbnB1dCkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2
aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgYXRvbWlzcF9kZXZpY2Ug
KmlzcCA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOwpAQCAtNTI0LDcgKzUzMSw4IEBAIHN0YXRp
YyBpbnQgYXRvbWlzcF9lbnVtX2ZyYW1lc2l6ZXNfY3JvcChzdHJ1Y3QgYXRvbWlzcF9kZXZpY2Ug
KmlzcCwKIAlyZXR1cm4gYXRvbWlzcF9lbnVtX2ZyYW1lc2l6ZXNfY3JvcF9pbm5lcihpc3AsIGZz
aXplLCAmYWN0aXZlLCAmbmF0aXZlLCAmdmFsaWRfc2l6ZXMpOwogfQogCi1zdGF0aWMgaW50IGF0
b21pc3BfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3Rh
dGljIGludCBhdG9taXNwX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9m
cm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVv
X2RldmRhdGEoZmlsZSk7CkBAIC01NjAsNyArNTY4LDggQEAgc3RhdGljIGludCBhdG9taXNwX2Vu
dW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBhdG9taXNwX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGF0b21pc3BfZW51bV9mcmFtZWludGVydmFs
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJICAgICAgIHN0cnVjdCB2NGwyX2ZybWl2YWxlbnVtICpmaXZhbCkKIHsK
IAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTU5
NCw3ICs2MDMsOCBAQCBzdGF0aWMgaW50IGF0b21pc3BfZW51bV9mcmFtZWludGVydmFscyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50
IGF0b21pc3BfZW51bV9mbXRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRp
YyBpbnQgYXRvbWlzcF9lbnVtX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm10ZGVzYyAqZikK
IHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAg
LTY0OCw3ICs2NTgsOCBAQCBzdGF0aWMgaW50IGF0b21pc3BfZW51bV9mbXRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKIH0KIAogLyogVGhpcyBmdW5jdGlvbiBsb29rcyB1cCB0aGUg
Y2xvc2VzdCBhdmFpbGFibGUgcmVzb2x1dGlvbi4gKi8KLXN0YXRpYyBpbnQgYXRvbWlzcF90cnlf
Zm10X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGF0b21pc3Bf
dHJ5X2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtNjU3
LDcgKzY2OCw4IEBAIHN0YXRpYyBpbnQgYXRvbWlzcF90cnlfZm10X2NhcChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIGF0b21pc3BfdHJ5X2ZtdChpc3AsICZmLT5mbXQucGl4
LCBOVUxMLCBOVUxMKTsKIH0KIAotc3RhdGljIGludCBhdG9taXNwX2dfZm10X2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGF0b21pc3BfZ19mbXRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2Ug
KnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtNjc1LDcgKzY4Nyw3IEBAIHN0YXRpYyBp
bnQgYXRvbWlzcF9nX2ZtdF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCWYtPmZt
dC5waXgud2lkdGggPSAxMDAwMDsKIAlmLT5mbXQucGl4LmhlaWdodCA9IDEwMDAwOwogCi0JcmV0
dXJuIGF0b21pc3BfdHJ5X2ZtdF9jYXAoZmlsZSwgZmgsIGYpOworCXJldHVybiBhdG9taXNwX3Ry
eV9mbXRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIH0KIAogaW50IGF0b21pc3BfYWxsb2NfY3NzX3N0
YXRfYnVmcyhzdHJ1Y3QgYXRvbWlzcF9zdWJfZGV2aWNlICphc2QsCkBAIC03ODcsNyArNzk5LDkg
QEAgaW50IGF0b21pc3BfYWxsb2NfY3NzX3N0YXRfYnVmcyhzdHJ1Y3QgYXRvbWlzcF9zdWJfZGV2
aWNlICphc2QsCiAgKiBPbmNlIHRoaXMgaXMgZml4ZWQgdGhlc2Ugd3JhcHBlcnMgY2FuIGJlIHJl
bW92ZWQsIHJlcGxhY2luZyB0aGVtIHdpdGggZGlyZWN0CiAgKiBjYWxscyB0byB2YjJfaW9jdGxf
W2RdcWJ1ZigpLgogICovCi1zdGF0aWMgaW50IGF0b21pc3BfcWJ1Zl93cmFwcGVyKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfYnVmZmVyICpidWYpCitzdGF0aWMgaW50
IGF0b21pc3BfcWJ1Zl93cmFwcGVyKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCXN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQogewog
CXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVj
dCBhdG9taXNwX2RldmljZSAqaXNwID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CkBAIC04MDcs
MTAgKzgyMSwxMiBAQCBzdGF0aWMgaW50IGF0b21pc3BfcWJ1Zl93cmFwcGVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfYnVmZmVyCiAJCXBpcGUtPmZyYW1lX3JlcXVl
c3RfY29uZmlnX2lkW2J1Zi0+aW5kZXhdID0gMDsKIAl9CiAKLQlyZXR1cm4gdmIyX2lvY3RsX3Fi
dWYoZmlsZSwgZmgsIGJ1Zik7CisJcmV0dXJuIHZiMl9pb2N0bF9xYnVmKGZpbGUsIHN0YXRlLCBi
dWYpOwogfQogCi1zdGF0aWMgaW50IGF0b21pc3BfZHFidWZfd3JhcHBlcihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2J1ZmZlciAqYnVmKQorc3RhdGljIGludCBhdG9t
aXNwX2RxYnVmX3dyYXBwZXIoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJCSBzdHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZikKIHsKIAlz
dHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAlzdHJ1Y3Qg
YXRvbWlzcF92aWRlb19waXBlICpwaXBlID0gYXRvbWlzcF90b192aWRlb19waXBlKHZkZXYpOwpA
QCAtODE5LDcgKzgzNSw3IEBAIHN0YXRpYyBpbnQgYXRvbWlzcF9kcWJ1Zl93cmFwcGVyKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfYnVmZmVyCiAJc3RydWN0IHZiMl9i
dWZmZXIgKnZiOwogCWludCByZXQ7CiAKLQlyZXQgPSB2YjJfaW9jdGxfZHFidWYoZmlsZSwgZmgs
IGJ1Zik7CisJcmV0ID0gdmIyX2lvY3RsX2RxYnVmKGZpbGUsIHN0YXRlLCBidWYpOwogCWlmIChy
ZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTExMzUsNyArMTE1MSw4IEBAIHN0YXRpYyBpbnQgYXRv
bWlzcF9zX2N0cmwoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogICogdGhpcyBpb2N0bCB3
aXRoIGEgcG9pbnRlciB0byB0aGlzIHN0cnVjdHVyZS4gVGhlIGRyaXZlciBmaWxscwogICogdGhl
IHJlc3Qgb2YgdGhlIHN0cnVjdHVyZS4KICAqLwotc3RhdGljIGludCBhdG9taXNwX3F1ZXJ5X2V4
dF9jdHJsKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgYXRvbWlzcF9x
dWVyeV9leHRfY3RybChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfcXVlcnlfZXh0X2N0cmwgKnFjKQog
ewogCWludCBpOwpAQCAtMTE5MSw3ICsxMjA4LDggQEAgc3RhdGljIGludCBhdG9taXNwX2NhbWVy
YV9nX2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiB9CiAKIC8qIFRoaXMg
aW9jdGwgYWxsb3dzIHRoZSBhcHBsaWNhdGlvbiB0byBnZXQgbXVsdGlwbGUgY29udHJvbHMgYnkg
Y2xhc3MgKi8KLXN0YXRpYyBpbnQgYXRvbWlzcF9nX2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGF0b21pc3BfZ19leHRfY3RybHMoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
ICAgICAgc3RydWN0IHY0bDJfZXh0X2NvbnRyb2xzICpjKQogewogCXN0cnVjdCB2NGwyX2NvbnRy
b2wgY3RybDsKQEAgLTEyMDEsMTQgKzEyMTksMTQgQEAgc3RhdGljIGludCBhdG9taXNwX2dfZXh0
X2N0cmxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAkgKiBpbnB1dF9sb2NrIGlzIG5v
dCBuZWVkIGZvciB0aGUgQ2FtZXJhIHJlbGF0ZWQgSU9DVExzCiAJICogVGhlIGlucHV0X2xvY2sg
ZG93bmdyYWRlIHRoZSBGUFMgb2YgM0EKIAkgKi8KLQlyZXQgPSBhdG9taXNwX2NhbWVyYV9nX2V4
dF9jdHJscyhmaWxlLCBmaCwgYyk7CisJcmV0ID0gYXRvbWlzcF9jYW1lcmFfZ19leHRfY3RybHMo
ZmlsZSwgc3RhdGUsIGMpOwogCWlmIChyZXQgIT0gLUVJTlZBTCkKIAkJcmV0dXJuIHJldDsKIAog
CWZvciAoaSA9IDA7IGkgPCBjLT5jb3VudDsgaSsrKSB7CiAJCWN0cmwuaWQgPSBjLT5jb250cm9s
c1tpXS5pZDsKIAkJY3RybC52YWx1ZSA9IGMtPmNvbnRyb2xzW2ldLnZhbHVlOwotCQlyZXQgPSBh
dG9taXNwX2dfY3RybChmaWxlLCBmaCwgJmN0cmwpOworCQlyZXQgPSBhdG9taXNwX2dfY3RybChm
aWxlLCBzdGF0ZSwgJmN0cmwpOwogCQljLT5jb250cm9sc1tpXS52YWx1ZSA9IGN0cmwudmFsdWU7
CiAJCWlmIChyZXQpIHsKIAkJCWMtPmVycm9yX2lkeCA9IGk7CkBAIC0xMjU0LDcgKzEyNzIsOCBA
QCBzdGF0aWMgaW50IGF0b21pc3BfY2FtZXJhX3NfZXh0X2N0cmxzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIH0KIAogLyogVGhpcyBpb2N0bCBhbGxvd3MgdGhlIGFwcGxpY2F0aW9uIHRv
IHNldCBtdWx0aXBsZSBjb250cm9scyBieSBjbGFzcyAqLwotc3RhdGljIGludCBhdG9taXNwX3Nf
ZXh0X2N0cmxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgYXRvbWlz
cF9zX2V4dF9jdHJscyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9leHRfY29udHJvbHMg
KmMpCiB7CiAJc3RydWN0IHY0bDJfY29udHJvbCBjdHJsOwpAQCAtMTI2NCwxNCArMTI4MywxNCBA
QCBzdGF0aWMgaW50IGF0b21pc3Bfc19leHRfY3RybHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCSAqIGlucHV0X2xvY2sgaXMgbm90IG5lZWQgZm9yIHRoZSBDYW1lcmEgcmVsYXRlZCBJ
T0NUTHMKIAkgKiBUaGUgaW5wdXRfbG9jayBkb3duZ3JhZGUgdGhlIEZQUyBvZiAzQQogCSAqLwot
CXJldCA9IGF0b21pc3BfY2FtZXJhX3NfZXh0X2N0cmxzKGZpbGUsIGZoLCBjKTsKKwlyZXQgPSBh
dG9taXNwX2NhbWVyYV9zX2V4dF9jdHJscyhmaWxlLCBzdGF0ZSwgYyk7CiAJaWYgKHJldCAhPSAt
RUlOVkFMKQogCQlyZXR1cm4gcmV0OwogCiAJZm9yIChpID0gMDsgaSA8IGMtPmNvdW50OyBpKysp
IHsKIAkJY3RybC5pZCA9IGMtPmNvbnRyb2xzW2ldLmlkOwogCQljdHJsLnZhbHVlID0gYy0+Y29u
dHJvbHNbaV0udmFsdWU7Ci0JCXJldCA9IGF0b21pc3Bfc19jdHJsKGZpbGUsIGZoLCAmY3RybCk7
CisJCXJldCA9IGF0b21pc3Bfc19jdHJsKGZpbGUsIHN0YXRlLCAmY3RybCk7CiAJCWMtPmNvbnRy
b2xzW2ldLnZhbHVlID0gY3RybC52YWx1ZTsKIAkJaWYgKHJldCkgewogCQkJYy0+ZXJyb3JfaWR4
ID0gaTsKQEAgLTEyODQsNyArMTMwMyw4IEBAIHN0YXRpYyBpbnQgYXRvbWlzcF9zX2V4dF9jdHJs
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAvKgogICogdmlkaW9jX2cvc19wYXJhbSBh
cmUgdXNlZCB0byBzd2l0Y2ggaXNwIHJ1bm5pbmcgbW9kZQogICovCi1zdGF0aWMgaW50IGF0b21p
c3BfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgYXRvbWlz
cF9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICBzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICpwYXJtKQogewogCXN0cnVj
dCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwpAQCAtMTMwMSw3ICsx
MzIxLDggQEAgc3RhdGljIGludCBhdG9taXNwX2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgYXRvbWlzcF9zX3Bhcm0oc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBhdG9taXNwX3NfcGFybShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkg
IHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3RydWN0IHZpZGVvX2RldmljZSAq
dmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CkBAIC0xMzU0LDcgKzEzNzUsOCBAQCBzdGF0aWMg
aW50IGF0b21pc3Bfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4g
cnZhbCA9PSAtRU5PSU9DVExDTUQgPyAwIDogcnZhbDsKIH0KIAotc3RhdGljIGxvbmcgYXRvbWlz
cF92aWRpb2NfZGVmYXVsdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgbG9u
ZyBhdG9taXNwX3ZpZGlvY19kZWZhdWx0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIGJvb2wgdmFsaWRfcHJpbywgdW5z
aWduZWQgaW50IGNtZCwgdm9pZCAqYXJnKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYg
PSB2aWRlb19kZXZkYXRhKGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL21lZGlh
L2F2NzExMC9hdjcxMTBfdjRsLmMgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvYXY3MTEwL2F2NzEx
MF92NGwuYwppbmRleCAwNGU2NTkyNDNmMDJiYzU4OGI4MTQwZDU1YTNkZTQ0ZTY2NGZmMjg2Li4x
NzM4OTI1ZDEzNTk0YzY4YWQxNGY3MGNiOTU4NTNmZDViOTFlMDdhIDEwMDY0NAotLS0gYS9kcml2
ZXJzL3N0YWdpbmcvbWVkaWEvYXY3MTEwL2F2NzExMF92NGwuYworKysgYi9kcml2ZXJzL3N0YWdp
bmcvbWVkaWEvYXY3MTEwL2F2NzExMF92NGwuYwpAQCAtMjkwLDcgKzI5MCw4IEBAIHN0YXRpYyBp
bnQgYXY3MTEwX2R2Yl9jX3N3aXRjaChzdHJ1Y3Qgc2FhNzE0Nl9kZXYgKmRldikKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsIHN0cnVjdCB2NGwyX3R1bmVyICp0KQorc3RhdGljIGludCB2aWRpb2NfZ190dW5lcihz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkg
IHN0cnVjdCB2NGwyX3R1bmVyICp0KQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgYXY3MTEwICphdjcxMTAgPSAoc3RydWN0IGF2NzEx
MCAqKWRldi0+ZXh0X3ByaXY7CkBAIC0zMzYsNyArMzM3LDggQEAgc3RhdGljIGludCB2aWRpb2Nf
Z190dW5lcihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX3R1bmVyICp0
KQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQpCitzdGF0aWMgaW50
IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCSAgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKnQpCiB7CiAJc3RydWN0
IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBhdjcxMTAg
KmF2NzExMCA9IChzdHJ1Y3QgYXY3MTEwICopZGV2LT5leHRfcHJpdjsKQEAgLTM4MSw3ICszODMs
OSBAQCBzdGF0aWMgaW50IHZpZGlvY19zX3R1bmVyKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgY29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKgogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2ZyZXF1ZW5jeSAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX2dfZnJlcXVlbmN5KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQkgICAgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBhdjcxMTAgKmF2NzExMCA9IChz
dHJ1Y3QgYXY3MTEwICopZGV2LT5leHRfcHJpdjsKQEAgLTM5Nyw3ICs0MDEsOSBAQCBzdGF0aWMg
aW50IHZpZGlvY19nX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVj
dCB2NGwyX2ZyZXF1ZW5jeQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2Zy
ZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0IHN0cnVjdCB2NGwyX2Zy
ZXF1ZW5jeSAqZikKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZnJlcXVlbmN5KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAg
ICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmYpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2
ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBhdjcxMTAgKmF2NzExMCA9IChz
dHJ1Y3QgYXY3MTEwICopZGV2LT5leHRfcHJpdjsKQEAgLTQyNyw3ICs0MzMsOSBAQCBzdGF0aWMg
aW50IHZpZGlvY19zX2ZyZXF1ZW5jeShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGNvbnN0
IHN0cnVjdCB2NGwyX2ZyZQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVt
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfaW5wdXQgKmkp
CitzdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJf
aW5wdXQgKmkpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwogCXN0cnVjdCBhdjcxMTAgKmF2NzExMCA9IChzdHJ1Y3QgYXY3MTEwICopZGV2LT5leHRf
cHJpdjsKQEAgLTQ0Nyw3ICs0NTUsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfaW5wdXQgKmkpCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCB1bnNpZ25lZCBpbnQgKmlucHV0KQorc3RhdGljIGludCB2aWRpb2NfZ19pbnB1dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkg
IHVuc2lnbmVkIGludCAqaW5wdXQpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRl
b19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBhdjcxMTAgKmF2NzExMCA9IChzdHJ1Y3QgYXY3MTEw
ICopZGV2LT5leHRfcHJpdjsKQEAgLTQ1Nyw3ICs0NjYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19n
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50ICppbnB1dCkK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHVuc2lnbmVkIGludCBpbnB1dCkKK3N0YXRpYyBpbnQgdmlkaW9jX3Nf
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAorCQkJICB1bnNpZ25lZCBpbnQgaW5wdXQpCiB7CiAJc3RydWN0IHNhYTcxNDZfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBhdjcxMTAgKmF2NzExMCA9IChzdHJ1Y3Qg
YXY3MTEwICopZGV2LT5leHRfcHJpdjsKQEAgLTQ3NCw3ICs0ODQsOSBAQCBzdGF0aWMgaW50IHZp
ZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdW5zaWduZWQgaW50IGlu
cHV0KQogCXJldHVybiBhdjcxMTBfZHZiX2Nfc3dpdGNoKGRldik7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX2VudW1fb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0
bDJfb3V0cHV0ICpvKQorc3RhdGljIGludCB2aWRpb2NfZW51bV9vdXRwdXQoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAg
ICAgIHN0cnVjdCB2NGwyX291dHB1dCAqbykKIHsKIAlpZiAoby0+aW5kZXgpCiAJCXJldHVybiAt
RUlOVkFMOwpAQCAtNDg1LDE4ICs0OTcsMjQgQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9vdXRw
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9vdXRwdXQgKm8KIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19vdXRwdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgKm91dHB1dCkKK3N0YXRpYyBpbnQgdmlkaW9jX2df
b3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCQkgICB1bnNpZ25lZCBpbnQgKm91dHB1dCkKIHsKIAkqb3V0cHV0ID0gMDsK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19vdXRwdXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCB1bnNpZ25lZCBpbnQgb3V0cHV0KQorc3RhdGljIGludCB2aWRpb2Nf
c19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJCSAgIHVuc2lnbmVkIGludCBvdXRwdXQpCiB7CiAJcmV0dXJuIG91dHB1
dCA/IC1FSU5WQUwgOiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtYXVkaW8oc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKK3N0YXRpYyBpbnQg
dmlkaW9jX2VudW1hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIHsKIAlk
cHJpbnRrKDIsICJWSURJT0NfR19BVURJTzogJWRcbiIsIGEtPmluZGV4KTsKIAlpZiAoYS0+aW5k
ZXggIT0gMCkKQEAgLTUwNSw3ICs1MjMsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtYXVkaW8o
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9hdWRpbyAqYSkKIAlyZXR1
cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZ19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX2F1ZGlvICphKQorc3RhdGljIGludCB2aWRpb2NfZ19hdWRp
byhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJ
CQkgIHN0cnVjdCB2NGwyX2F1ZGlvICphKQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgYXY3MTEwICphdjcxMTAgPSAoc3RydWN0IGF2
NzExMCAqKWRldi0+ZXh0X3ByaXY7CkBAIC01MTksNyArNTM4LDggQEAgc3RhdGljIGludCB2aWRp
b2NfZ19hdWRpbyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2F1ZGlv
ICphKQogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW8gKmEpCitzdGF0aWMg
aW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW8gKmEpCiB7CiAJc3Ry
dWN0IHNhYTcxNDZfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCXN0cnVjdCBhdjcx
MTAgKmF2NzExMCA9IChzdHJ1Y3QgYXY3MTEwICopZGV2LT5leHRfcHJpdjsKQEAgLTUzMCw3ICs1
NTAsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19zX2F1ZGlvKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW8gKgogCXJldHVybiBhLT5pbmRleCA/IC1FSU5W
QUwgOiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3NsaWNlZF92YmlfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9jX2dfc2xpY2VkX3ZiaV9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgc3RydWN0IHY0bDJfc2xpY2VkX3ZiaV9jYXAgKmNhcCkKIHsKIAlzdHJ1Y3Qg
c2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01NDYsNyArNTY3LDgg
QEAgc3RhdGljIGludCB2aWRpb2NfZ19zbGljZWRfdmJpX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3NsaWNl
ZF92Ymlfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkaW9j
X2dfZm10X3NsaWNlZF92Ymlfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgICBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICAgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKQEAgLTU2NCw3ICs1ODYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF9zbGljZWRfdmJp
X291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgdmlkaW9jX3RyeV9mbXRfc2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX291dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBzYWE3MTQ2X2RldiAqZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTU4NSwxNCArNjA4LDE1IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3RyeV9mbXRfc2xpY2VkX3ZiaV9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19zX2ZtdF9zbGljZWRfdmJpX291dChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF9zbGlj
ZWRfdmJpX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlzdHJ1Y3Qgc2FhNzE0Nl9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0
IGF2NzExMCAqYXY3MTEwID0gKHN0cnVjdCBhdjcxMTAgKilkZXYtPmV4dF9wcml2OwogCiAJZHBy
aW50aygyLCAiVklESU9DX1NfRk1UXG4iKTsKLQlpZiAodmlkaW9jX3RyeV9mbXRfc2xpY2VkX3Zi
aV9vdXQoZmlsZSwgZmgsIGYpKQorCWlmICh2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX291dChm
aWxlLCBzdGF0ZSwgZikpCiAJCXJldHVybiAtRUlOVkFMOwogCWlmIChmLT5mbXQuc2xpY2VkLnNl
cnZpY2Vfc2V0ICYgVjRMMl9TTElDRURfV1NTXzYyNSkgewogCQkvKiBXU1MgY29udHJvbGxlZCBi
eSB1c2Vyc3BhY2UgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9kZXByZWNh
dGVkL2F0bWVsL2F0bWVsLWlzYy1iYXNlLmMgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvZGVwcmVj
YXRlZC9hdG1lbC9hdG1lbC1pc2MtYmFzZS5jCmluZGV4IGZiOWVlODU0NzM5MmI0ZWU3NjhiMzlj
ZTA4ZjUyNDg4MzIzYmI2ZjkuLjVmNzU3MmNiOGUwZTI1ODVjOTVkZjZmN2VhZjg4ZjM1ZGEzMjE1
M2UgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9kZXByZWNhdGVkL2F0bWVsL2F0
bWVsLWlzYy1iYXNlLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL2RlcHJlY2F0ZWQvYXRt
ZWwvYXRtZWwtaXNjLWJhc2UuYwpAQCAtNDgzLDcgKzQ4Myw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1
Y3QgdmIyX29wcyBpc2NfdmIyX29wcyA9IHsKIAkuYnVmX3F1ZXVlCQk9IGlzY19idWZmZXJfcXVl
dWUsCiB9OwogCi1zdGF0aWMgaW50IGlzY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXNjX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgc3RydWN0IHY0bDJfY2FwYWJp
bGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsICJtaWNyb2NoaXAtaXNjIiwgc2l6
ZW9mKGNhcC0+ZHJpdmVyKSk7CkBAIC00OTIsNyArNDkzLDggQEAgc3RhdGljIGludCBpc2NfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgaXNjX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IGlzY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBzdHJ1Y3QgdjRsMl9m
bXRkZXNjICpmKQogewogCXN0cnVjdCBpc2NfZGV2aWNlICppc2MgPSB2aWRlb19kcnZkYXRhKGZp
bGUpOwpAQCAtNTIyLDcgKzUyNCw4IEBAIHN0YXRpYyBpbnQgaXNjX2VudW1fZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0
YXRpYyBpbnQgaXNjX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IGlzY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCBpc2NfZGV2aWNlICppc2MgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtMTAzMCw3ICsxMDMzLDggQEAgc3RhdGljIGludCBpc2Nfc2V0X2ZtdChzdHJ1
Y3QgaXNjX2RldmljZSAqaXNjLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgaXNjX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitzdGF0aWMgaW50IGlzY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaXNjX2RldmljZSAqaXNjID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTEwNDEsNyArMTA0NSw4IEBAIHN0YXRpYyBpbnQgaXNjX3NfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIGlzY19zZXRfZm10
KGlzYywgZik7CiB9CiAKLXN0YXRpYyBpbnQgaXNjX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgaXNjX3RyeV9mbXRfdmlkX2NhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGlzY19kZXZpY2UgKmlz
YyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMDQ5LDcgKzEwNTQsOCBAQCBzdGF0aWMgaW50
IGlzY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0
dXJuIGlzY190cnlfZm10KGlzYywgZiwgTlVMTCk7CiB9CiAKLXN0YXRpYyBpbnQgaXNjX2VudW1f
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGlzY19lbnVt
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX2lucHV0ICppbnApCiB7CiAJaWYgKGlucC0+aW5k
ZXggIT0gMCkKQEAgLTEwNjIsMTQgKzEwNjgsMTYgQEAgc3RhdGljIGludCBpc2NfZW51bV9pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBpc2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQg
aW50ICppKQorc3RhdGljIGludCBpc2NfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgICB1bnNpZ25lZCBpbnQgKmkpCiB7
CiAJKmkgPSAwOwogCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXNjX3NfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQorc3RhdGljIGludCBp
c2Nfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCisJCSAgICAgICB1bnNpZ25lZCBpbnQgaSkKIHsKIAlpZiAoaSA+IDApCiAJCXJldHVy
biAtRUlOVkFMOwpAQCAtMTA3NywyMSArMTA4NSwyNCBAQCBzdGF0aWMgaW50IGlzY19zX2lucHV0
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSkKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCBpc2NfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgaXNjX2dfcGFybShzdHJ1
Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAg
IHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7CiAJc3RydWN0IGlzY19kZXZpY2UgKmlzYyA9
IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKIAlyZXR1cm4gdjRsMl9nX3Bhcm1fY2FwKHZpZGVvX2Rl
dmRhdGEoZmlsZSksIGlzYy0+Y3VycmVudF9zdWJkZXYtPnNkLCBhKTsKIH0KIAotc3RhdGljIGlu
dCBpc2Nfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfc3Ry
ZWFtcGFybSAqYSkKK3N0YXRpYyBpbnQgaXNjX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVjdCB2NGwyX3N0cmVh
bXBhcm0gKmEpCiB7CiAJc3RydWN0IGlzY19kZXZpY2UgKmlzYyA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CiAKIAlyZXR1cm4gdjRsMl9zX3Bhcm1fY2FwKHZpZGVvX2RldmRhdGEoZmlsZSksIGlzYy0+
Y3VycmVudF9zdWJkZXYtPnNkLCBhKTsKIH0KIAotc3RhdGljIGludCBpc2NfZW51bV9mcmFtZXNp
emVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaXNjX2VudW1fZnJh
bWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUp
CiB7CiAJc3RydWN0IGlzY19kZXZpY2UgKmlzYyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvaW14L2lteC1tZWRpYS1jYXB0dXJlLmMgYi9k
cml2ZXJzL3N0YWdpbmcvbWVkaWEvaW14L2lteC1tZWRpYS1jYXB0dXJlLmMKaW5kZXggZTljZWY3
YWYwMDBhOTE2NzRhYTJjZmU3NTBhMzk5Y2FlNDBmZjlkNi4uZmNlNzgxNDdlNTQxNWMxMjVlOGZh
M2NiNzE3NzNlMzI2ODNhM2NhOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL2lt
eC9pbXgtbWVkaWEtY2FwdHVyZS5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9pbXgvaW14
LW1lZGlhLWNhcHR1cmUuYwpAQCAtNzgsNyArNzgsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IGlt
eF9tZWRpYV9waXhmbXQgKmNhcHR1cmVfZmluZF9mb3JtYXQodTMyIGNvZGUsIHUzMiBmb3VyY2Mp
CiAJcmV0dXJuIGlteF9tZWRpYV9maW5kX21idXNfZm9ybWF0KGNvZGUsIFBJWEZNVF9TRUxfQU5Z
KTsKIH0KIAotc3RhdGljIGludCBjYXB0dXJlX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKK3N0YXRpYyBpbnQgY2FwdHVyZV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3Qg
djRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3RydWN0IGNhcHR1cmVfcHJpdiAqcHJpdiA9IHZp
ZGVvX2RydmRhdGEoZmlsZSk7CkBAIC05MSwxNCArOTIsMTYgQEAgc3RhdGljIGludCBjYXB0dXJl
X3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCBjYXB0dXJlX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorc3RhdGljIGludCBjYXB0dXJlX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAg
ICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXJldHVybiBpbXhfbWVkaWFfZW51bV9waXhl
bF9mb3JtYXRzKCZmLT5waXhlbGZvcm1hdCwgZi0+aW5kZXgsCiAJCQkJCSAgICBQSVhGTVRfU0VM
X0FOWSwgZi0+bWJ1c19jb2RlKTsKIH0KIAotc3RhdGljIGludCBjYXB0dXJlX2VudW1fZnJhbWVz
aXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNhcHR1cmVfZW51
bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkK
IHsKIAljb25zdCBzdHJ1Y3QgaW14X21lZGlhX3BpeGZtdCAqY2M7CkBAIC0xMjYsNyArMTI5LDgg
QEAgc3RhdGljIGludCBjYXB0dXJlX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY2FwdHVyZV9nX2ZtdF92aWRf
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY2FwdHVyZV9nX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjYXB0
dXJlX3ByaXYgKnByaXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMTc5LDE0ICsxODMsMTYg
QEAgX19jYXB0dXJlX3RyeV9mbXQoc3RydWN0IHY0bDJfcGl4X2Zvcm1hdCAqcGl4Zm10LCBzdHJ1
Y3QgdjRsMl9yZWN0ICpjb21wb3NlKQogCXJldHVybiBjYzsKIH0KIAotc3RhdGljIGludCBjYXB0
dXJlX3RyeV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMg
aW50IGNhcHR1cmVfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlfX2NhcHR1cmVfdHJ5X2ZtdCgmZi0+Zm10LnBpeCwgTlVMTCk7CiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgY2FwdHVyZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgY2FwdHVyZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
c3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBjYXB0dXJlX3ByaXYgKnByaXYgPSB2
aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtMjA1LDcgKzIxMSw4IEBAIHN0YXRpYyBpbnQgY2FwdHVy
ZV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBjYXB0dXJlX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKK3N0YXRpYyBpbnQgY2FwdHVyZV9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAg
ICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IGNhcHR1cmVfcHJpdiAqcHJp
diA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0yNzYsNyArMjgzLDggQEAgc3RhdGljIGNvbnN0
IHN0cnVjdCB2NGwyX2lvY3RsX29wcyBjYXB0dXJlX2lvY3RsX29wcyA9IHsKICAqIExlZ2FjeSBW
aWRlbyBJT0NUTHMKICAqLwogCi1zdGF0aWMgaW50IGNhcHR1cmVfbGVnYWN5X2VudW1fZnJhbWVz
aXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNhcHR1cmVfbGVn
YWN5X2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAq
ZnNpemUpCiB7CiAJc3RydWN0IGNhcHR1cmVfcHJpdiAqcHJpdiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CkBAIC0zMTYsNyArMzI0LDggQEAgc3RhdGljIGludCBjYXB0dXJlX2xlZ2FjeV9lbnVtX2Zy
YW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGNhcHR1cmVfbGVnYWN5X2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBjYXB0dXJlX2xlZ2FjeV9lbnVtX2ZyYW1laW50
ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkJICAgICAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFs
KQogewogCXN0cnVjdCBjYXB0dXJlX3ByaXYgKnByaXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpA
QCAtMzQ3LDcgKzM1Niw4IEBAIHN0YXRpYyBpbnQgY2FwdHVyZV9sZWdhY3lfZW51bV9mcmFtZWlu
dGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgY2FwdHVyZV9sZWdhY3lfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNhcHR1cmVfbGVnYWN5X2VudW1fZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCBjYXB0dXJl
X3ByaXYgKnByaXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNDIyLDcgKzQzMiw4IEBAIF9f
Y2FwdHVyZV9sZWdhY3lfdHJ5X2ZtdChzdHJ1Y3QgY2FwdHVyZV9wcml2ICpwcml2LAogCXJldHVy
biBjYzsKIH0KIAotc3RhdGljIGludCBjYXB0dXJlX2xlZ2FjeV90cnlfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBjYXB0dXJlX2xlZ2FjeV90cnlf
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBjYXB0dXJlX3ByaXYgKnByaXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNDQyLDcgKzQ1
Myw4IEBAIHN0YXRpYyBpbnQgY2FwdHVyZV9sZWdhY3lfdHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBjYXB0dXJl
X2xlZ2FjeV9zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRp
YyBpbnQgY2FwdHVyZV9sZWdhY3lfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgY2FwdHVyZV9wcml2ICpwcml2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKQEAgLTQ3NCw3ICs0ODYsOCBAQCBzdGF0aWMgaW50IGNhcHR1cmVfbGVnYWN5X3NfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGNhcHR1cmVfbGVnYWN5X3F1ZXJ5c3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgY2FwdHVyZV9sZWdhY3lfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgdjRs
Ml9zdGRfaWQgKnN0ZCkKIHsKIAlzdHJ1Y3QgY2FwdHVyZV9wcml2ICpwcml2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTQ4MiwxNCArNDk1LDE4IEBAIHN0YXRpYyBpbnQgY2FwdHVyZV9sZWdh
Y3lfcXVlcnlzdGQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiB2NGwyX3N1
YmRldl9jYWxsKHByaXYtPnNyY19zZCwgdmlkZW8sIHF1ZXJ5c3RkLCBzdGQpOwogfQogCi1zdGF0
aWMgaW50IGNhcHR1cmVfbGVnYWN5X2dfc3RkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwg
djRsMl9zdGRfaWQgKnN0ZCkKK3N0YXRpYyBpbnQgY2FwdHVyZV9sZWdhY3lfZ19zdGQoc3RydWN0
IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkJ
djRsMl9zdGRfaWQgKnN0ZCkKIHsKIAlzdHJ1Y3QgY2FwdHVyZV9wcml2ICpwcml2ID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKIAogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKHByaXYtPnNyY19zZCwg
dmlkZW8sIGdfc3RkLCBzdGQpOwogfQogCi1zdGF0aWMgaW50IGNhcHR1cmVfbGVnYWN5X3Nfc3Rk
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgdjRsMl9zdGRfaWQgc3RkKQorc3RhdGljIGlu
dCBjYXB0dXJlX2xlZ2FjeV9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCQl2NGwyX3N0ZF9pZCBzdGQpCiB7CiAJc3RydWN0
IGNhcHR1cmVfcHJpdiAqcHJpdiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKQEAgLTQ5OSw3ICs1
MTYsOCBAQCBzdGF0aWMgaW50IGNhcHR1cmVfbGVnYWN5X3Nfc3RkKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwgdjRsMl9zdGRfaWQgc3RkKQogCXJldHVybiB2NGwyX3N1YmRldl9jYWxsKHBy
aXYtPnNyY19zZCwgdmlkZW8sIHNfc3RkLCBzdGQpOwogfQogCi1zdGF0aWMgaW50IGNhcHR1cmVf
bGVnYWN5X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNh
cHR1cmVfbGVnYWN5X2dfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7
CiAJc3RydWN0IGNhcHR1cmVfcHJpdiAqcHJpdiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC01
MjIsNyArNTQwLDggQEAgc3RhdGljIGludCBjYXB0dXJlX2xlZ2FjeV9nX3Bhcm0oc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IGNhcHR1cmVf
bGVnYWN5X3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IGNh
cHR1cmVfbGVnYWN5X3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKmEpCiB7
CiAJc3RydWN0IGNhcHR1cmVfcHJpdiAqcHJpdiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvaW14L2lteC1tZWRpYS1jc2Mtc2NhbGVyLmMg
Yi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvaW14L2lteC1tZWRpYS1jc2Mtc2NhbGVyLmMKaW5kZXgg
MTg2OWM1NzkyZWNiNDY2ODI0OTFlY2JmMzM2NzRjNjA0NDkxNTI2MS4uMzhiN2JhZTFhYjIzYzZh
YjFlODk5ZGVkOGZmM2YzMDRhODQ0MjFhMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL21l
ZGlhL2lteC9pbXgtbWVkaWEtY3NjLXNjYWxlci5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRp
YS9pbXgvaW14LW1lZGlhLWNzYy1zY2FsZXIuYwpAQCAtMTUyLDcgKzE1Miw4IEBAIHN0YXRpYyB2
b2lkIGRldmljZV9ydW4odm9pZCAqX2N0eCkKIC8qCiAgKiBWaWRlbyBpb2N0bHMKICAqLwotc3Rh
dGljIGludCBpcHVfY3NjX3NjYWxlcl9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKK3N0YXRpYyBpbnQgaXB1X2NzY19zY2FsZXJfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3Ry
dWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5kcml2ZXIsIElNWF9D
U0NfU0NBTEVSX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMTYzLDcgKzE2NCw4IEBA
IHN0YXRpYyBpbnQgaXB1X2NzY19zY2FsZXJfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXB1X2NzY19zY2FsZXJfZW51
bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcHVfY3NjX3Nj
YWxlcl9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXUz
MiBmb3VyY2M7CkBAIC0xNzksNyArMTgxLDggQEAgc3RhdGljIGludCBpcHVfY3NjX3NjYWxlcl9l
bnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgaXB1X2NzY19zY2FsZXJfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IGlwdV9jc2Nfc2NhbGVyX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgaXB1X2NzY19zY2FsZXJfY3R4ICpjdHggPSBmaWxlX3RvX2N0
eChmaWxlKTsKQEAgLTE5Miw3ICsxOTUsOCBAQCBzdGF0aWMgaW50IGlwdV9jc2Nfc2NhbGVyX2df
Zm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IGlwdV9jc2Nfc2NhbGVyX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitzdGF0aWMgaW50IGlwdV9jc2Nfc2NhbGVyX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaXB1X2NzY19zY2FsZXJfY3R4ICpjdHggPSBmaWxl
X3RvX2N0eChmaWxlKTsKQEAgLTI0MCw3ICsyNDQsOCBAQCBzdGF0aWMgaW50IGlwdV9jc2Nfc2Nh
bGVyX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9
CiAKLXN0YXRpYyBpbnQgaXB1X2NzY19zY2FsZXJfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IGlwdV9jc2Nfc2NhbGVyX3NfZm10KHN0cnVjdCBmaWxlICpm
aWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgaXB1X2NzY19zY2FsZXJfY3R4ICpjdHggPSBmaWxl
X3RvX2N0eChmaWxlKTsKQEAgLTI1Nyw3ICsyNjIsNyBAQCBzdGF0aWMgaW50IGlwdV9jc2Nfc2Nh
bGVyX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCiAJcV9kYXRhID0gZ2V0
X3FfZGF0YShjdHgsIGYtPnR5cGUpOwogCi0JcmV0ID0gaXB1X2NzY19zY2FsZXJfdHJ5X2ZtdChm
aWxlLCBwcml2LCBmKTsKKwlyZXQgPSBpcHVfY3NjX3NjYWxlcl90cnlfZm10KGZpbGUsIHN0YXRl
LCBmKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIApAQCAtMjk2LDcgKzMwMSw4IEBA
IHN0YXRpYyBpbnQgaXB1X2NzY19zY2FsZXJfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXB1X2NzY19zY2FsZXJfZ19zZWxl
Y3Rpb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGlwdV9jc2Nf
c2NhbGVyX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX3NlbGVjdGlv
biAqcykKIHsKIAlzdHJ1Y3QgaXB1X2NzY19zY2FsZXJfY3R4ICpjdHggPSBmaWxlX3RvX2N0eChm
aWxlKTsKQEAgLTMzNCw3ICszNDAsOCBAQCBzdGF0aWMgaW50IGlwdV9jc2Nfc2NhbGVyX2dfc2Vs
ZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1z
dGF0aWMgaW50IGlwdV9jc2Nfc2NhbGVyX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAorc3RhdGljIGludCBpcHVfY3NjX3NjYWxlcl9zX3NlbGVjdGlvbihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpCiB7CiAJc3RydWN0IGlwdV9jc2Nf
c2NhbGVyX2N0eCAqY3R4ID0gZmlsZV90b19jdHgoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L3N0YWdpbmcvbWVkaWEvaXB1My9pcHUzLXY0bDIuYyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9p
cHUzL2lwdTMtdjRsMi5jCmluZGV4IDJmNjA0MWQzNDJmNDI5NjQ0NmRiMjk0YWUwNTRjNjA4NWQz
ZTg1MDAuLmUxMGJmNjgzMzIwYzE5ZThlNmEyYWIzMGFiODg1MzYzNDhjMTE2YmMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9pcHUzL2lwdTMtdjRsMi5jCisrKyBiL2RyaXZlcnMv
c3RhZ2luZy9tZWRpYS9pcHUzL2lwdTMtdjRsMi5jCkBAIC02MjEsNyArNjIxLDggQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBpbWd1X2ZtdCAqZmluZF9mb3JtYXQoc3RydWN0IHY0bDJfZm9ybWF0ICpm
LCB1MzIgdHlwZSkKIAkJCQkgICAgICZmb3JtYXRzW0RFRl9WSURfT1VUUFVUXTsKIH0KIAotc3Rh
dGljIGludCBpbWd1X3ZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IGltZ3VfdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJ
CXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2NhcGFi
aWxpdHkgKmNhcCkKIHsKIAlzdHJ1Y3QgaW1ndV9kZXZpY2UgKmltZ3UgPSB2aWRlb19kcnZkYXRh
KGZpbGUpOwpAQCAtNjU3LDcgKzY1OCw4IEBAIHN0YXRpYyBpbnQgZW51bV9mbXRzKHN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmYsIHUzMiB0eXBlKQogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmKQogewogCWlmIChmLT50eXBlICE9IFY0TDJfQlVGX1RZUEVfVklERU9f
Q0FQVFVSRV9NUExBTkUpCkBAIC02NjYsNyArNjY4LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51
bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gZW51
bV9mbXRzKGYsIFZJRF9DQVBUVVJFKTsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRf
dmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9j
X2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsK
IAlpZiAoZi0+dHlwZSAhPSBWNEwyX0JVRl9UWVBFX1ZJREVPX09VVFBVVF9NUExBTkUpCkBAIC02
NzYsNyArNjc5LDggQEAgc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX291dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIH0KIAogLyogUHJvcGFnYXRlIGZvcndhcmQgYWx3YXlz
IHRoZSBmb3JtYXQgZnJvbSB0aGUgQ0lPMiBzdWJkZXYgKi8KLXN0YXRpYyBpbnQgaW1ndV92aWRp
b2NfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpbWd1X3Zp
ZGlvY19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3QgaW1ndV92aWRlb19kZXZpY2UgKm5vZGUgPSBmaWxlX3RvX2ludGVsX2ltZ3Vfbm9kZShmaWxl
KTsKQEAgLTgxNSw3ICs4MTksOCBAQCBzdGF0aWMgaW50IGltZ3VfdHJ5X2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBpbWd1X3ZpZGlvY190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgaW1ndV92aWRpb2NfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGltZ3VfZGV2aWNlICppbWd1ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTgyNywxNCArODMyLDE2IEBAIHN0YXRpYyBpbnQgaW1ndV92
aWRpb2NfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJZGV2X2RiZyhkZXYs
ICIlcyBbJXV4JXVdIGZvciBub2RlICV1XG4iLCBfX2Z1bmNfXywKIAkJcGl4X21wLT53aWR0aCwg
cGl4X21wLT5oZWlnaHQsIG5vZGUtPmlkKTsKIAotCXIgPSBpbWd1X3RyeV9mbXQoZmlsZSwgZmgs
IGYpOworCXIgPSBpbWd1X3RyeV9mbXQoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyKQogCQlyZXR1
cm4gcjsKIAogCXJldHVybiBpbWd1X2ZtdChpbWd1LCBub2RlLT5waXBlLCBub2RlLT5pZCwgZiwg
dHJ1ZSk7CiB9CiAKLXN0YXRpYyBpbnQgaW1ndV92aWRpb2Nfc19mbXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IGltZ3Vfdmlk
aW9jX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKKwkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBpbWd1X2RldmljZSAqaW1ndSA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJmltZ3UtPnBjaV9kZXYtPmRldjsKQEAgLTg0NSw3ICs4NTIsNyBAQCBzdGF0aWMg
aW50IGltZ3VfdmlkaW9jX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKQogCWRldl9kYmcoZGV2LCAiJXMgWyV1eCV1XSBmb3Igbm9kZSAldVxu
IiwgX19mdW5jX18sCiAJCXBpeF9tcC0+d2lkdGgsIHBpeF9tcC0+aGVpZ2h0LCBub2RlLT5pZCk7
CiAKLQlyID0gaW1ndV90cnlfZm10KGZpbGUsIGZoLCBmKTsKKwlyID0gaW1ndV90cnlfZm10KGZp
bGUsIHN0YXRlLCBmKTsKIAlpZiAocikKIAkJcmV0dXJuIHI7CiAKQEAgLTg2Myw3ICs4NzAsOCBA
QCBzdGF0aWMgY29uc3Qgc3RydWN0IGltZ3VfbWV0YV9mbXQgbWV0YV9mbXRzW10gPSB7CiAJeyBW
NEwyX01FVEFfRk1UX0lQVTNfU1RBVF8zQSwgIklQVTMgM0Egc3RhdGlzdGljcyIgfSwKIH07CiAK
LXN0YXRpYyBpbnQgaW1ndV9tZXRhX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgaW1ndV9tZXRhX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxl
LAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0
bDJfZm10ZGVzYyAqZm10KQogewogCXN0cnVjdCBpbWd1X3ZpZGVvX2RldmljZSAqbm9kZSA9IGZp
bGVfdG9faW50ZWxfaW1ndV9ub2RlKGZpbGUpOwpAQCAtODgyLDcgKzg5MCw4IEBAIHN0YXRpYyBp
bnQgaW1ndV9tZXRhX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAly
ZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBpbWd1X3ZpZGlvY19nX21ldGFfZm10KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaW1ndV92aWRpb2NfZ19tZXRhX2ZtdChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBpbWd1X3ZpZGVvX2Rl
dmljZSAqbm9kZSA9IGZpbGVfdG9faW50ZWxfaW1ndV9ub2RlKGZpbGUpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9zdGFnaW5nL21lZGlhL2lwdTcvaXB1Ny1pc3lzLXZpZGVvLmMgYi9kcml2ZXJzL3N0
YWdpbmcvbWVkaWEvaXB1Ny9pcHU3LWlzeXMtdmlkZW8uYwppbmRleCAxYTdjOGE5MWZmZmIzOGQx
YTliMjBmODk2YTMzMmE4OGQ4MDYwMDk1Li42ZTQ2ZGY3YTA3YjAxNDM4MjZjNDFkMjFkZDM5MjAw
ODhlNzBiM2M2IDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvaXB1Ny9pcHU3LWlz
eXMtdmlkZW8uYworKysgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvaXB1Ny9pcHU3LWlzeXMtdmlk
ZW8uYwpAQCAtMTA3LDcgKzEwNyw4IEBAIGNvbnN0IHN0cnVjdCBpcHU3X2lzeXNfcGl4ZWxmb3Jt
YXQgKmlwdTdfaXN5c19nZXRfaXN5c19mb3JtYXQodTMyIHBpeGVsZm9ybWF0KQogCXJldHVybiAm
aXB1N19pc3lzX3BmbXRzWzBdOwogfQogCi1zdGF0aWMgaW50IGlwdTdfaXN5c192aWRpb2NfcXVl
cnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcHU3X2lzeXNf
dmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7CiAJc3RydWN0IGlwdTdfaXN5c192aWRlbyAqYXYgPSB2aWRlb19kcnZkYXRhKGZpbGUp
OwpAQCAtMTE4LDcgKzExOSw4IEBAIHN0YXRpYyBpbnQgaXB1N19pc3lzX3ZpZGlvY19xdWVyeWNh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgaXB1N19pc3lzX3ZpZGlvY19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgs
CitzdGF0aWMgaW50IGlwdTdfaXN5c192aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJdW5zaWduZWQgaW50IGksIG51bV9mb3VuZDsKQEAg
LTE0NCw3ICsxNDYsOCBAQCBzdGF0aWMgaW50IGlwdTdfaXN5c192aWRpb2NfZW51bV9mbXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMg
aW50IGlwdTdfaXN5c192aWRpb2NfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKK3N0YXRpYyBpbnQgaXB1N19pc3lzX3ZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkJICAgIHN0cnVjdCB2NGwyX2ZybXNpemVlbnVtICpmc2l6ZSkKIHsKIAl1bnNpZ25l
ZCBpbnQgaTsKQEAgLTE3MCw3ICsxNzMsOCBAQCBzdGF0aWMgaW50IGlwdTdfaXN5c192aWRpb2Nf
ZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gLUVJ
TlZBTDsKIH0KIAotc3RhdGljIGludCBpcHU3X2lzeXNfdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcHU3X2lzeXNfdmlkaW9jX2df
Zm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVj
dCBpcHU3X2lzeXNfdmlkZW8gKmF2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTIyNiw3ICsy
MzAsOCBAQCBzdGF0aWMgdm9pZCBfX2lwdV9pc3lzX3ZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3Ry
dWN0IGlwdTdfaXN5c192aWRlbyAqYXYsCiAJZi0+Zm10LnBpeC54ZmVyX2Z1bmMgPSBWNEwyX1hG
RVJfRlVOQ19ERUZBVUxUOwogfQogCi1zdGF0aWMgaW50IGlwdTdfaXN5c192aWRpb2NfdHJ5X2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgaXB1N19p
c3lzX3ZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICAgIHN0cnVjdCB2NGwyX2Zv
cm1hdCAqZikKIHsKIAlzdHJ1Y3QgaXB1N19pc3lzX3ZpZGVvICphdiA9IHZpZGVvX2RydmRhdGEo
ZmlsZSk7CkBAIC0yMzksMTggKzI0NCwyMCBAQCBzdGF0aWMgaW50IGlwdTdfaXN5c192aWRpb2Nf
dHJ5X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBpcHU3X2lzeXNfdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCBpcHU3X2lzeXNfdmlkaW9jX3NfZm10X3Zp
ZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBpcHU3
X2lzeXNfdmlkZW8gKmF2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKIAotCWlwdTdfaXN5c192aWRp
b2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIGZoLCBmKTsKKwlpcHU3X2lzeXNfdmlkaW9jX3RyeV9m
bXRfdmlkX2NhcChmaWxlLCBzdGF0ZSwgZik7CiAJYXYtPnBpeF9mbXQgPSBmLT5mbXQucGl4Owog
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgaXB1N19pc3lzX3ZpZGlvY19yZXFidWZzKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBpcHU3X2lzeXNfdmlkaW9j
X3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAqcCkKIHsK
IAlzdHJ1Y3QgaXB1N19pc3lzX3ZpZGVvICphdiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0y
NjMsMTAgKzI3MCwxMSBAQCBzdGF0aWMgaW50IGlwdTdfaXN5c192aWRpb2NfcmVxYnVmcyhzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCi0J
cmV0dXJuIHZiMl9pb2N0bF9yZXFidWZzKGZpbGUsIHByaXYsIHApOworCXJldHVybiB2YjJfaW9j
dGxfcmVxYnVmcyhmaWxlLCBzdGF0ZSwgcCk7CiB9CiAKLXN0YXRpYyBpbnQgaXB1N19pc3lzX3Zp
ZGlvY19jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBp
bnQgaXB1N19pc3lzX3ZpZGlvY19jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJ
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2NyZWF0
ZV9idWZmZXJzICpwKQogewogCXN0cnVjdCBpcHU3X2lzeXNfdmlkZW8gKmF2ID0gdmlkZW9fZHJ2
ZGF0YShmaWxlKTsKQEAgLTI3OSw3ICsyODcsNyBAQCBzdGF0aWMgaW50IGlwdTdfaXN5c192aWRp
b2NfY3JlYXRlX2J1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKIAotCXJldHVybiB2YjJfaW9jdGxfY3JlYXRlX2J1ZnMoZmlsZSwgcHJp
diwgcCk7CisJcmV0dXJuIHZiMl9pb2N0bF9jcmVhdGVfYnVmcyhmaWxlLCBzdGF0ZSwgcCk7CiB9
CiAKIHN0YXRpYyBpbnQgbGlua192YWxpZGF0ZShzdHJ1Y3QgbWVkaWFfbGluayAqbGluaykKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9tZXNvbi92ZGVjL3ZkZWMuYyBiL2RyaXZl
cnMvc3RhZ2luZy9tZWRpYS9tZXNvbi92ZGVjL3ZkZWMuYwppbmRleCA0OWU0OTdhMzI5NzNiOGRm
MThjNTE0M2UwZGI2OGQwZjdmNDJjMzZjLi44NzZlNmZkYjFmYjMwODc0NmZjNThhN2NmMzE5YmY3
MGQzOWNmZDFjIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvbWVzb24vdmRlYy92
ZGVjLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL21lc29uL3ZkZWMvdmRlYy5jCkBAIC00
NTMsNyArNDUzLDggQEAgc3RhdGljIGNvbnN0IHN0cnVjdCB2YjJfb3BzIHZkZWNfdmIyX29wcyA9
IHsKIH07CiAKIHN0YXRpYyBpbnQKLXZkZWNfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCit2ZGVjX3F1ZXJ5Y2FwKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkgICAgICBz
dHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZlciwgIm1l
c29uLXZkZWMiLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKIAlzdHJzY3B5KGNhcC0+Y2FyZCwgIkFt
bG9naWMgVmlkZW8gRGVjb2RlciIsIHNpemVvZihjYXAtPmNhcmQpKTsKQEAgLTU1Niw3ICs1NTcs
OCBAQCB2ZGVjX3RyeV9mbXRfY29tbW9uKHN0cnVjdCBhbXZkZWNfc2Vzc2lvbiAqc2VzcywgdTMy
IHNpemUsCiAJcmV0dXJuIGZtdF9vdXQ7CiB9CiAKLXN0YXRpYyBpbnQgdmRlY190cnlfZm10KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGlj
IGludCB2ZGVjX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXN0cnVjdCBhbXZk
ZWNfc2Vzc2lvbiAqc2VzcyA9IGZpbGVfdG9fYW12ZGVjX3Nlc3Npb24oZmlsZSk7CiAKQEAgLTU2
NSw3ICs1NjcsOCBAQCBzdGF0aWMgaW50IHZkZWNfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCB2ZGVjX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQorc3RhdGljIGludCB2ZGVjX2dfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQogewogCXN0cnVjdCBhbXZkZWNfc2Vzc2lvbiAqc2VzcyA9IGZpbGVfdG9fYW12ZGVjX3Nl
c3Npb24oZmlsZSk7CiAJc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeG1wID0gJmYt
PmZtdC5waXhfbXA7CkBAIC01OTIsNyArNTk1LDggQEAgc3RhdGljIGludCB2ZGVjX2dfZm10KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogCXJldHVy
biAwOwogfQogCi1zdGF0aWMgaW50IHZkZWNfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCitzdGF0aWMgaW50IHZkZWNfc19mbXQoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGFtdmRlY19zZXNzaW9uICpzZXNzID0g
ZmlsZV90b19hbXZkZWNfc2Vzc2lvbihmaWxlKTsKIAlzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0X21w
bGFuZSAqcGl4bXAgPSAmZi0+Zm10LnBpeF9tcDsKQEAgLTY1Myw3ICs2NTcsOCBAQCBzdGF0aWMg
aW50IHZkZWNfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmRlY19lbnVtX2ZtdChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCitzdGF0aWMg
aW50IHZkZWNfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJc3RydWN0IGFt
dmRlY19zZXNzaW9uICpzZXNzID0gZmlsZV90b19hbXZkZWNfc2Vzc2lvbihmaWxlKTsKIAljb25z
dCBzdHJ1Y3QgdmRlY19wbGF0Zm9ybSAqcGxhdGZvcm0gPSBzZXNzLT5jb3JlLT5wbGF0Zm9ybTsK
QEAgLTY4MSw3ICs2ODYsOCBAQCBzdGF0aWMgaW50IHZkZWNfZW51bV9mbXQoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHZkZWNfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpmaCwKK3N0YXRpYyBpbnQgdmRlY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUs
CisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJf
ZnJtc2l6ZWVudW0gKmZzaXplKQogewogCXN0cnVjdCBhbXZkZWNfc2Vzc2lvbiAqc2VzcyA9IGZp
bGVfdG9fYW12ZGVjX3Nlc3Npb24oZmlsZSk7CkBAIC03MDYsMTQgKzcxMiwxNSBAQCBzdGF0aWMg
aW50IHZkZWNfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIH0K
IAogc3RhdGljIGludAotdmRlY19kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
ZmgsIHN0cnVjdCB2NGwyX2RlY29kZXJfY21kICpjbWQpCit2ZGVjX2RlY29kZXJfY21kKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJIHN0cnVj
dCB2NGwyX2RlY29kZXJfY21kICpjbWQpCiB7CiAJc3RydWN0IGFtdmRlY19zZXNzaW9uICpzZXNz
ID0gZmlsZV90b19hbXZkZWNfc2Vzc2lvbihmaWxlKTsKIAlzdHJ1Y3QgYW12ZGVjX2NvZGVjX29w
cyAqY29kZWNfb3BzID0gc2Vzcy0+Zm10X291dC0+Y29kZWNfb3BzOwogCXN0cnVjdCBkZXZpY2Ug
KmRldiA9IHNlc3MtPmNvcmUtPmRldjsKIAlpbnQgcmV0OwogCi0JcmV0ID0gdjRsMl9tMm1faW9j
dGxfdHJ5X2RlY29kZXJfY21kKGZpbGUsIGZoLCBjbWQpOworCXJldCA9IHY0bDJfbTJtX2lvY3Rs
X3RyeV9kZWNvZGVyX2NtZChmaWxlLCBzdGF0ZSwgY21kKTsKIAlpZiAocmV0KQogCQlyZXR1cm4g
cmV0OwogCkBAIC03NjQsNyArNzcxLDggQEAgc3RhdGljIGludCB2ZGVjX3N1YnNjcmliZV9ldmVu
dChzdHJ1Y3QgdjRsMl9maCAqZmgsCiAJfQogfQogCi1zdGF0aWMgaW50IHZkZWNfZ19waXhlbGFz
cGVjdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGludCB0eXBlLAorc3RhdGljIGludCB2
ZGVjX2dfcGl4ZWxhc3BlY3Qoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgaW50IHR5cGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9m
cmFjdCAqZikKIHsKIAlzdHJ1Y3QgYW12ZGVjX3Nlc3Npb24gKnNlc3MgPSBmaWxlX3RvX2FtdmRl
Y19zZXNzaW9uKGZpbGUpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL3N0YXJm
aXZlL2NhbXNzL3N0Zi12aWRlby5jIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3N0YXJmaXZlL2Nh
bXNzL3N0Zi12aWRlby5jCmluZGV4IGEwNDIwZWI2YTBhYTAzNGZiMGIxNDY4OTUxZDg0YzhmZTdi
YjFiNTYuLmI5NjdhNDQwMzllMDVmYjIyY2NlM2M4NzM2NDk2NTEzN2NlNzQyMmMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9zdGFyZml2ZS9jYW1zcy9zdGYtdmlkZW8uYworKysg
Yi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvc3RhcmZpdmUvY2Ftc3Mvc3RmLXZpZGVvLmMKQEAgLTMz
Miw3ICszMzIsOCBAQCBzdGF0aWMgY29uc3Qgc3RydWN0IHZiMl9vcHMgc3RmX3ZpZGVvX3ZiMl9x
X29wcyA9IHsKICAqIFY0TDIgaW9jdGxzCiAgKi8KIAotc3RhdGljIGludCB2aWRlb19xdWVyeWNh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHZpZGVvX3F1ZXJ5Y2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCSAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnNjcHkoY2FwLT5k
cml2ZXIsICJzdGFyZml2ZS1jYW1zcyIsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMzQxLDcg
KzM0Miw4IEBAIHN0YXRpYyBpbnQgdmlkZW9fcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGVvX2VudW1fZm10KHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3N0YXRpYyBp
bnQgdmlkZW9fZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAorCQkJICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCBz
dGZjYW1zc192aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCWNvbnN0IHN0cnVj
dCBzdGZjYW1zc19mb3JtYXRfaW5mbyAqZmk7CkBAIC0zNjcsNyArMzY5LDggQEAgc3RhdGljIGlu
dCB2aWRlb19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2ZtdGRlc2MgKmYpCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkZW9fZW51bV9mcmFt
ZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdmlkZW9fZW51
bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQogewog
CXN0cnVjdCBzdGZjYW1zc192aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
Mzk1LDcgKzM5OCw4IEBAIHN0YXRpYyBpbnQgdmlkZW9fZW51bV9mcmFtZXNpemVzKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRlb19n
X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
K3N0YXRpYyBpbnQgdmlkZW9fZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CXN0cnVjdCBzdGZjYW1zc192aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBA
IC00MDQsNyArNDA4LDggQEAgc3RhdGljIGludCB2aWRlb19nX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIAlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIGludCB2aWRlb19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZikKK3N0YXRpYyBpbnQgdmlkZW9fc19mbXQoc3RydWN0IGZpbGUgKmZpbGUs
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJf
Zm9ybWF0ICpmKQogewogCXN0cnVjdCBzdGZjYW1zc192aWRlbyAqdmlkZW8gPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwogCWludCByZXQ7CkBAIC00MjEsNyArNDI2LDggQEAgc3RhdGljIGludCB2aWRl
b19zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAq
ZikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRlb190cnlfZm10KHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQorc3RhdGljIGludCB2aWRl
b190cnlfZm10KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKKwkJCSBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IHN0ZmNhbXNzX3Zp
ZGVvICp2aWRlbyA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
c3RhZ2luZy9tZWRpYS9zdW54aS9jZWRydXMvY2VkcnVzX3ZpZGVvLmMgYi9kcml2ZXJzL3N0YWdp
bmcvbWVkaWEvc3VueGkvY2VkcnVzL2NlZHJ1c192aWRlby5jCmluZGV4IGFkNGVjMzQ5MDc3NTQ3
ZWEzNDI4YzczNDFmMTUyZDcyOWQ3NzViYjIuLmE5NjQ3M2E5NjZjYmMxYTJmNjY5YWQ3MDVmY2Y3
MjIyMGE5MmMzN2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9zdW54aS9jZWRy
dXMvY2VkcnVzX3ZpZGVvLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3N1bnhpL2NlZHJ1
cy9jZWRydXNfdmlkZW8uYwpAQCAtMTc1LDcgKzE3NSw4IEBAIHZvaWQgY2VkcnVzX3ByZXBhcmVf
Zm9ybWF0KHN0cnVjdCB2NGwyX3BpeF9mb3JtYXQgKnBpeF9mbXQpCiAJcGl4X2ZtdC0+c2l6ZWlt
YWdlID0gc2l6ZWltYWdlOwogfQogCi1zdGF0aWMgaW50IGNlZHJ1c19xdWVyeWNhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY2VkcnVzX3F1ZXJ5Y2FwKHN0cnVj
dCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCiB7CiAJc3Ryc2NweShjYXAtPmRyaXZl
ciwgQ0VEUlVTX05BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOwpAQCAtMjE4LDE5ICsyMTksMjIg
QEAgc3RhdGljIGludCBjZWRydXNfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
NGwyX2ZtdGRlc2MgKmYsCiAJcmV0dXJuIC1FSU5WQUw7CiB9CiAKLXN0YXRpYyBpbnQgY2VkcnVz
X2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IGNlZHJ1c19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRl
c2MgKmYpCiB7CiAJcmV0dXJuIGNlZHJ1c19lbnVtX2ZtdChmaWxlLCBmLCBDRURSVVNfREVDT0RF
X0RTVCk7CiB9CiAKLXN0YXRpYyBpbnQgY2VkcnVzX2VudW1fZm10X3ZpZF9vdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGNlZHJ1c19lbnVtX2ZtdF92aWRfb3V0
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB7CiAJcmV0dXJuIGNlZHJ1c19l
bnVtX2ZtdChmaWxlLCBmLCBDRURSVVNfREVDT0RFX1NSQyk7CiB9CiAKLXN0YXRpYyBpbnQgY2Vk
cnVzX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IGNlZHJ1c19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsK
IAlzdHJ1Y3QgY2VkcnVzX2N0eCAqY3R4ID0gY2VkcnVzX2ZpbGUyY3R4KGZpbGUpOwpAQCAtMjM5
LDcgKzI0Myw4IEBAIHN0YXRpYyBpbnQgY2VkcnVzX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY2VkcnVzX2df
Zm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IGNl
ZHJ1c19nX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1
Y3QgY2VkcnVzX2N0eCAqY3R4ID0gY2VkcnVzX2ZpbGUyY3R4KGZpbGUpOwpAQCAtMjcwLDcgKzI3
NSw4IEBAIHN0YXRpYyBpbnQgY2VkcnVzX3RyeV9mbXRfdmlkX2NhcF9wKHN0cnVjdCBjZWRydXNf
Y3R4ICpjdHgsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgY2VkcnVzX3RyeV9mbXRfdmlk
X2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgY2VkcnVzX3Ry
eV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewogCXJldHVy
biBjZWRydXNfdHJ5X2ZtdF92aWRfY2FwX3AoY2VkcnVzX2ZpbGUyY3R4KGZpbGUpLCAmZi0+Zm10
LnBpeCk7CkBAIC0yOTIsMTMgKzI5OCwxNSBAQCBzdGF0aWMgaW50IGNlZHJ1c190cnlfZm10X3Zp
ZF9vdXRfcChzdHJ1Y3QgY2VkcnVzX2N0eCAqY3R4LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IGNlZHJ1c190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IGNlZHJ1c190cnlfZm10X3ZpZF9vdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwy
X2Zvcm1hdCAqZikKIHsKIAlyZXR1cm4gY2VkcnVzX3RyeV9mbXRfdmlkX291dF9wKGNlZHJ1c19m
aWxlMmN0eChmaWxlKSwgJmYtPmZtdC5waXgpOwogfQogCi1zdGF0aWMgaW50IGNlZHJ1c19zX2Zt
dF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjZWRy
dXNfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0
IGNlZHJ1c19jdHggKmN0eCA9IGNlZHJ1c19maWxlMmN0eChmaWxlKTsKQEAgLTMwOSw3ICszMTcs
NyBAQCBzdGF0aWMgaW50IGNlZHJ1c19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCWlmICh2YjJfaXNfYnVzeSh2cSkpCiAJCXJldHVybiAtRUJVU1k7CiAKLQly
ZXQgPSBjZWRydXNfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHByaXYsIGYpOworCXJldCA9IGNlZHJ1
c190cnlfZm10X3ZpZF9jYXAoZmlsZSwgc3RhdGUsIGYpOwogCWlmIChyZXQpCiAJCXJldHVybiBy
ZXQ7CiAKQEAgLTM4MSw3ICszODksOCBAQCB2b2lkIGNlZHJ1c19yZXNldF9vdXRfZm9ybWF0KHN0
cnVjdCBjZWRydXNfY3R4ICpjdHgpCiAJY2VkcnVzX3NfZm10X3ZpZF9vdXRfcChjdHgsICZjdHgt
PnNyY19mbXQpOwogfQogCi1zdGF0aWMgaW50IGNlZHJ1c19zX2ZtdF92aWRfb3V0KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBjZWRydXNfc19mbXRfdmlkX291dChz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpCiB7CiAJc3RydWN0IGNlZHJ1c19jdHggKmN0eCA9
IGNlZHJ1c19maWxlMmN0eChmaWxlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tZWRp
YS9zdW54aS9zdW42aS1pc3Avc3VuNmlfaXNwX2NhcHR1cmUuYyBiL2RyaXZlcnMvc3RhZ2luZy9t
ZWRpYS9zdW54aS9zdW42aS1pc3Avc3VuNmlfaXNwX2NhcHR1cmUuYwppbmRleCBlN2I5OWNlZTYz
ZDY4YmNiNmQ2ZTY5Y2RlOWRkNWMyZGUwZDU1M2Y0Li5kNjRkMGY3N2Y2MzJkNjVmZjkyYmMwYTRh
NTg3ZWZhY2YyYTRhNWU5IDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvc3VueGkv
c3VuNmktaXNwL3N1bjZpX2lzcF9jYXB0dXJlLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlh
L3N1bnhpL3N1bjZpLWlzcC9zdW42aV9pc3BfY2FwdHVyZS5jCkBAIC00MTksNyArNDE5LDggQEAg
c3RhdGljIHZvaWQgc3VuNmlfaXNwX2NhcHR1cmVfZm9ybWF0X3ByZXBhcmUoc3RydWN0IHY0bDJf
Zm9ybWF0ICpmb3JtYXQpCiAJcGl4X2Zvcm1hdC0+eGZlcl9mdW5jID0gVjRMMl9YRkVSX0ZVTkNf
REVGQVVMVDsKIH0KIAotc3RhdGljIGludCBzdW42aV9pc3BfY2FwdHVyZV9xdWVyeWNhcChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1cmVf
cXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwYWJp
bGl0eSkKIHsKIAlzdHJ1Y3Qgc3VuNmlfaXNwX2RldmljZSAqaXNwX2RldiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC00MzMsNyArNDM0LDggQEAgc3RhdGljIGludCBzdW42aV9pc3BfY2FwdHVy
ZV9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIGludCBzdW42aV9pc3BfY2FwdHVyZV9lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1cmVfZW51bV9mbXQoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZm10ZGVzYykKIHsKIAl1MzIgaW5k
ZXggPSBmbXRkZXNjLT5pbmRleDsKQEAgLTQ0Niw3ICs0NDgsOCBAQCBzdGF0aWMgaW50IHN1bjZp
X2lzcF9jYXB0dXJlX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN1bjZpX2lzcF9jYXB0dXJlX2dfZm10KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCBzdW42aV9pc3BfY2FwdHVyZV9nX2Zt
dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIHsKIAlzdHJ1Y3Qgc3Vu
NmlfaXNwX2RldmljZSAqaXNwX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC00NTYsNyAr
NDU5LDggQEAgc3RhdGljIGludCBzdW42aV9pc3BfY2FwdHVyZV9nX2ZtdChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBzdW42aV9pc3Bf
Y2FwdHVyZV9zX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQg
c3VuNmlfaXNwX2NhcHR1cmVfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
b3JtYXQpCiB7CiAJc3RydWN0IHN1bjZpX2lzcF9kZXZpY2UgKmlzcF9kZXYgPSB2aWRlb19kcnZk
YXRhKGZpbGUpOwpAQCAtNDcxLDcgKzQ3NSw4IEBAIHN0YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1
cmVfc19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1cmVfdHJ5X2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1cmVfdHJ5X2ZtdChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCSAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmb3JtYXQpCiB7CiAJc3VuNmlfaXNwX2NhcHR1
cmVfZm9ybWF0X3ByZXBhcmUoZm9ybWF0KTsKQEAgLTQ3OSw3ICs0ODQsOCBAQCBzdGF0aWMgaW50
IHN1bjZpX2lzcF9jYXB0dXJlX3RyeV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1cmVfZW51bV9pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlfaXNwX2Nh
cHR1cmVfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCXN0cnVjdCB2NGwyX2lucHV0ICppbnB1dCkKIHsKIAlp
ZiAoaW5wdXQtPmluZGV4ICE9IDApCkBAIC00OTEsNyArNDk3LDggQEAgc3RhdGljIGludCBzdW42
aV9pc3BfY2FwdHVyZV9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAog
CXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN1bjZpX2lzcF9jYXB0dXJlX2dfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHN1bjZpX2lzcF9jYXB0dXJl
X2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHVuc2lnbmVkIGludCAqaW5kZXgpCiB7CiAJKmluZGV4
ID0gMDsKQEAgLTQ5OSw3ICs1MDYsOCBAQCBzdGF0aWMgaW50IHN1bjZpX2lzcF9jYXB0dXJlX2df
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0
YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1cmVfc19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgc3VuNmlfaXNwX2NhcHR1cmVfc19pbnB1dChzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CSAgICAgdW5zaWduZWQgaW50IGluZGV4KQogewogCWlmIChpbmRleCAhPSAwKQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL3N1bnhpL3N1bjZpLWlzcC9zdW42aV9pc3BfcGFyYW1z
LmMgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvc3VueGkvc3VuNmktaXNwL3N1bjZpX2lzcF9wYXJh
bXMuYwppbmRleCA3N2MyZDA2YzA0MzYyMTU3YzljYzNkZTgwMWU4YzU3NjMxM2U3ZGE3Li5lZDY5
N2ZjNTZkZDk0ZmI3Zjc5YzBkMDdiNTVjOGVhMDliMWViOGJjIDEwMDY0NAotLS0gYS9kcml2ZXJz
L3N0YWdpbmcvbWVkaWEvc3VueGkvc3VuNmktaXNwL3N1bjZpX2lzcF9wYXJhbXMuYworKysgYi9k
cml2ZXJzL3N0YWdpbmcvbWVkaWEvc3VueGkvc3VuNmktaXNwL3N1bjZpX2lzcF9wYXJhbXMuYwpA
QCAtMzgzLDcgKzM4Myw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBzdW42aV9pc3Bf
cGFyYW1zX3F1ZXVlX29wcyA9IHsKIAogLyogVmlkZW8gRGV2aWNlICovCiAKLXN0YXRpYyBpbnQg
c3VuNmlfaXNwX3BhcmFtc19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K3N0YXRpYyBpbnQgc3VuNmlfaXNwX3BhcmFtc19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgc3Ry
dWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwYWJpbGl0eSkKIHsKIAlzdHJ1Y3Qgc3VuNmlfaXNwX2Rl
dmljZSAqaXNwX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0zOTcsNyArMzk4LDggQEAg
c3RhdGljIGludCBzdW42aV9pc3BfcGFyYW1zX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN1bjZpX2lzcF9wYXJhbXNf
ZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHN1bjZp
X2lzcF9wYXJhbXNfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICBzdHJ1Y3Qg
dmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2Mg
KmZtdGRlc2MpCiB7CiAJc3RydWN0IHN1bjZpX2lzcF9kZXZpY2UgKmlzcF9kZXYgPSB2aWRlb19k
cnZkYXRhKGZpbGUpOwpAQCAtNDEyLDcgKzQxNCw4IEBAIHN0YXRpYyBpbnQgc3VuNmlfaXNwX3Bh
cmFtc19lbnVtX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIGludCBzdW42aV9pc3BfcGFyYW1zX2dfZm10KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCBzdW42aV9pc3BfcGFyYW1zX2dfZm10KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZvcm1hdCkKIHsKIAlzdHJ1Y3Qgc3VuNmlfaXNwX2Rldmlj
ZSAqaXNwX2RldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0
YWdpbmcvbWVkaWEvdGVncmEtdmlkZW8vdmkuYyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS90ZWdy
YS12aWRlby92aS5jCmluZGV4IGM5Mjc2ZmY3NjE1N2ZhMmQxN2UwNWRmMjcxYzZlYmVhNGI0NDU1
ZWQuLjFmOTEwMGIyOGFjMGM5ZTVjMzFlODM5ZTBkMDM3OGUwMGE1YTg3MmQgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvc3RhZ2luZy9tZWRpYS90ZWdyYS12aWRlby92aS5jCisrKyBiL2RyaXZlcnMvc3Rh
Z2luZy9tZWRpYS90ZWdyYS12aWRlby92aS5jCkBAIC0yOTQsNyArMjk0LDggQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCB2YjJfb3BzIHRlZ3JhX2NoYW5uZWxfcXVldWVfcW9wcyA9IHsKIC8qCiAgKiBW
NEwyIGlvY3RsIG9wZXJhdGlvbnMKICAqLwotc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3F1ZXJ5
Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdGVncmFfY2hhbm5l
bF9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0
cnVjdCB0ZWdyYV92aV9jaGFubmVsICpjaGFuID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTMw
Nyw3ICszMDgsOCBAQCBzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfcXVlcnljYXAoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX2No
YW5uZWxfZ19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdGVn
cmFfY2hhbm5lbF9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqYSkKIHsKIAlz
dHJ1Y3QgdGVncmFfdmlfY2hhbm5lbCAqY2hhbiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0z
MTcsNyArMzE5LDggQEAgc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2dfcGFybShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIHY0bDJfZ19wYXJtX2NhcCgmY2hhbi0+dmlkZW8s
IHN1YmRldiwgYSk7CiB9CiAKLXN0YXRpYyBpbnQgdGVncmFfY2hhbm5lbF9zX3Bhcm0oc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3NfcGFybShz
dHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQlzdHJ1Y3QgdjRsMl9zdHJlYW1wYXJtICphKQogewogCXN0cnVjdCB0ZWdyYV92aV9jaGFu
bmVsICpjaGFuID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTMyNyw3ICszMzAsOCBAQCBzdGF0
aWMgaW50IHRlZ3JhX2NoYW5uZWxfc19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
IAlyZXR1cm4gdjRsMl9zX3Bhcm1fY2FwKCZjaGFuLT52aWRlbywgc3ViZGV2LCBhKTsKIH0KIAot
c3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZW51bV9mcmFtZXNpemVzKHN0
cnVjdCBmaWxlICpmaWxlLAorCQkJCQkgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJCSBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqc2l6ZXMpCiB7CiAJaW50IHJldDsKQEAg
LTM1Nyw3ICszNjEsOCBAQCBzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZW51bV9mcmFtZXNpemVz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB0ZWdyYV9jaGFubmVsX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2VudW1fZnJhbWVpbnRlcnZhbHMoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJCSAgICAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKml2YWxzKQogewogCWludCBy
ZXQ7CkBAIC0zODksNyArMzk0LDggQEAgc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2VudW1fZnJh
bWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZW51bV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAorc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2VudW1fZm9ybWF0KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCB0ZWdyYV92aV9jaGFu
bmVsICpjaGFuID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTQxMCw3ICs0MTYsOCBAQCBzdGF0
aWMgaW50IHRlZ3JhX2NoYW5uZWxfZW51bV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZ2V0X2Zvcm1h
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxf
Z2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm9ybWF0KQogewog
CXN0cnVjdCB0ZWdyYV92aV9jaGFubmVsICpjaGFuID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAg
LTUwNSw3ICs1MTIsOCBAQCBzdGF0aWMgaW50IF9fdGVncmFfY2hhbm5lbF90cnlfZm9ybWF0KHN0
cnVjdCB0ZWdyYV92aV9jaGFubmVsICpjaGFuLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHRlZ3JhX2NoYW5uZWxfdHJ5X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitz
dGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfdHJ5X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZm9ybWF0KQogewogCXN0cnVjdCB0ZWdyYV92aV9jaGFubmVsICpjaGFuID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTUyMSw3ICs1MjksOCBAQCBzdGF0aWMgdm9pZCB0ZWdy
YV9jaGFubmVsX3VwZGF0ZV9nYW5ncG9ydHMoc3RydWN0IHRlZ3JhX3ZpX2NoYW5uZWwgKmNoYW4p
CiAJCWNoYW4tPm51bWdhbmdwb3J0cyA9IGNoYW4tPnRvdGFscG9ydHM7CiB9CiAKLXN0YXRpYyBp
bnQgdGVncmFfY2hhbm5lbF9zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwK
K3N0YXRpYyBpbnQgdGVncmFfY2hhbm5lbF9zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJCSAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmb3JtYXQpCiB7CiAJc3RydWN0IHRlZ3JhX3ZpX2NoYW5uZWwgKmNoYW4g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNjA1LDcgKzYxNCw4IEBAIHRlZ3JhX2NoYW5uZWxf
c3Vic2NyaWJlX2V2ZW50KHN0cnVjdCB2NGwyX2ZoICpmaCwKIAlyZXR1cm4gdjRsMl9jdHJsX3N1
YnNjcmliZV9ldmVudChmaCwgc3ViKTsKIH0KIAotc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2df
c2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB0ZWdy
YV9jaGFubmVsX2dfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rp
b24gKnNlbCkKIHsKIAlzdHJ1Y3QgdGVncmFfdmlfY2hhbm5lbCAqY2hhbiA9IHZpZGVvX2RydmRh
dGEoZmlsZSk7CkBAIC02NDcsNyArNjU3LDggQEAgc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2df
c2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQog
Ci1zdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfc19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAorc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3Nfc2VsZWN0aW9uKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICAgICBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKIHsKIAlzdHJ1Y3QgdGVncmFfdmlf
Y2hhbm5lbCAqY2hhbiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02ODQsNyArNjk1LDggQEAg
c3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2
b2lkICpmaCwKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZ19l
ZGlkKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdGVncmFfY2hhbm5l
bF9nX2VkaWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZWRpZCAqZWRpZCkKIHsKIAlzdHJ1Y3QgdGVncmFf
dmlfY2hhbm5lbCAqY2hhbiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC02OTcsNyArNzA5LDgg
QEAgc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2dfZWRpZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZmgsCiAJcmV0dXJuIHY0bDJfc3ViZGV2X2NhbGwoc3ViZGV2LCBwYWQsIGdldF9lZGlkLCBl
ZGlkKTsKIH0KIAotc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3NfZWRpZChzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfc19lZGlkKHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0
cnVjdCB2NGwyX2VkaWQgKmVkaWQpCiB7CiAJc3RydWN0IHRlZ3JhX3ZpX2NoYW5uZWwgKmNoYW4g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtNzEwLDcgKzcyMyw4IEBAIHN0YXRpYyBpbnQgdGVn
cmFfY2hhbm5lbF9zX2VkaWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCXJldHVybiB2
NGwyX3N1YmRldl9jYWxsKHN1YmRldiwgcGFkLCBzZXRfZWRpZCwgZWRpZCk7CiB9CiAKLXN0YXRp
YyBpbnQgdGVncmFfY2hhbm5lbF9nX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAorc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2dfZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
ICAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCB0ZWdyYV92
aV9jaGFubmVsICpjaGFuID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTcyNCw3ICs3MzgsOCBA
QCBzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZ19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIAkJCQkJICBwYWQsIGdfZHZfdGltaW5ncywgMCwgdGltaW5ncyk7CiB9CiAK
LXN0YXRpYyBpbnQgdGVncmFfY2hhbm5lbF9zX2R2X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLAorc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3NfZHZfdGltaW5ncyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKQogewogCXN0cnVjdCB0
ZWdyYV92aV9jaGFubmVsICpjaGFuID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTczNyw3ICs3
NTIsNyBAQCBzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKIAlpZiAoIXY0bDJfc3ViZGV2X2hhc19vcChzdWJkZXYsIHBhZCwg
c19kdl90aW1pbmdzKSkKIAkJcmV0dXJuIC1FTk9UVFk7CiAKLQlyZXQgPSB0ZWdyYV9jaGFubmVs
X2dfZHZfdGltaW5ncyhmaWxlLCBmaCwgJmN1cnJfdGltaW5ncyk7CisJcmV0ID0gdGVncmFfY2hh
bm5lbF9nX2R2X3RpbWluZ3MoZmlsZSwgc3RhdGUsICZjdXJyX3RpbWluZ3MpOwogCWlmIChyZXQp
CiAJCXJldHVybiByZXQ7CiAKQEAgLTc2Miw3ICs3NzcsOCBAQCBzdGF0aWMgaW50IHRlZ3JhX2No
YW5uZWxfc19kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3F1ZXJ5X2R2X3RpbWluZ3Moc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3F1ZXJ5X2R2
X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZHZfdGltaW5ncyAqdGltaW5ncykKIHsK
IAlzdHJ1Y3QgdGVncmFfdmlfY2hhbm5lbCAqY2hhbiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC03NzYsNyArNzkyLDggQEAgc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX3F1ZXJ5X2R2X3RpbWlu
Z3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAogCQkJCQkgIHBhZCwgcXVlcnlfZHZfdGlt
aW5ncywgMCwgdGltaW5ncyk7CiB9CiAKLXN0YXRpYyBpbnQgdGVncmFfY2hhbm5lbF9lbnVtX2R2
X3RpbWluZ3Moc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB0ZWdyYV9j
aGFubmVsX2VudW1fZHZfdGltaW5ncyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgc3RydWN0IHY0bDJfZW51bV9kdl90aW1p
bmdzICp0aW1pbmdzKQogewogCXN0cnVjdCB0ZWdyYV92aV9jaGFubmVsICpjaGFuID0gdmlkZW9f
ZHJ2ZGF0YShmaWxlKTsKQEAgLTc4OSw3ICs4MDYsOCBAQCBzdGF0aWMgaW50IHRlZ3JhX2NoYW5u
ZWxfZW51bV9kdl90aW1pbmdzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIAlyZXR1cm4g
djRsMl9zdWJkZXZfY2FsbChzdWJkZXYsIHBhZCwgZW51bV9kdl90aW1pbmdzLCB0aW1pbmdzKTsK
IH0KIAotc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2R2X3RpbWluZ3NfY2FwKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpmaCwKK3N0YXRpYyBpbnQgdGVncmFfY2hhbm5lbF9kdl90aW1pbmdzX2Nh
cChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJCXN0cnVjdCB2NGwyX2R2X3RpbWluZ3NfY2FwICpjYXApCiB7CiAJc3RydWN0IHRl
Z3JhX3ZpX2NoYW5uZWwgKmNoYW4gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODAyLDcgKzgy
MCw4IEBAIHN0YXRpYyBpbnQgdGVncmFfY2hhbm5lbF9kdl90aW1pbmdzX2NhcChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsCiAJcmV0dXJuIHY0bDJfc3ViZGV2X2NhbGwoc3ViZGV2LCBwYWQs
IGR2X3RpbWluZ3NfY2FwLCBjYXApOwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfbG9n
X3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgpCitzdGF0aWMgaW50IHRlZ3JhX2No
YW5uZWxfbG9nX3N0YXR1cyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUpCiB7CiAJc3RydWN0IHRlZ3JhX3ZpX2NoYW5uZWwgKmNoYW4g
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwogCkBAIC04MTEsNyArODMwLDggQEAgc3RhdGljIGludCB0
ZWdyYV9jaGFubmVsX2xvZ19zdGF0dXMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoKQogCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZW51bV9pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHRlZ3JhX2NoYW5uZWxfZW51bV9pbnB1
dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2lucHV0ICppbnApCiB7CiAJc3RydWN0IHRlZ3Jh
X3ZpX2NoYW5uZWwgKmNoYW4gPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODI5LDcgKzg0OSw4
IEBAIHN0YXRpYyBpbnQgdGVncmFfY2hhbm5lbF9lbnVtX2lucHV0KHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpmaCwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2df
aW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHRlZ3JhX2No
YW5uZWxfZ19pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHVuc2lnbmVkIGludCAqaSkKIHsKIAkqaSA9IDA7CkBAIC04
MzcsNyArODU4LDggQEAgc3RhdGljIGludCB0ZWdyYV9jaGFubmVsX2dfaW5wdXQoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdGVncmFf
Y2hhbm5lbF9zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGlu
dCB0ZWdyYV9jaGFubmVsX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSB1bnNpZ25lZCBpbnQgaW5wdXQpCiB7CiAJ
aWYgKGlucHV0ID4gMCkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tb3N0L3ZpZGVvL3Zp
ZGVvLmMgYi9kcml2ZXJzL3N0YWdpbmcvbW9zdC92aWRlby92aWRlby5jCmluZGV4IDMyZjcxZDlh
OWNmNzhhZDc0YWE4YjlhNTNmNDBjMWQ1MjEyM2RmNTIuLjViY2U1ZTRjNTY2ODAzYzg2YzhiNjU2
NDI3YTc1ZTkxY2E2MzU0MDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9tb3N0L3ZpZGVv
L3ZpZGVvLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL21vc3QvdmlkZW8vdmlkZW8uYwpAQCAtMjQy
LDEwICsyNDIsMTEgQEAgc3RhdGljIGludCBjb21wX3NldF9mb3JtYXQoc3RydWN0IG1vc3Rfdmlk
ZW9fZGV2ICptZGV2LCB1bnNpZ25lZCBpbnQgY21kLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRp
YyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpj
YXApCiB7Ci0Jc3RydWN0IGNvbXBfZmggKmZoID0gcHJpdjsKKwlzdHJ1Y3QgY29tcF9maCAqZmgg
PSBzdGF0ZTsKIAlzdHJ1Y3QgbW9zdF92aWRlb19kZXYgKm1kZXYgPSBmaC0+bWRldjsKIAogCXN0
cnNjcHkoY2FwLT5kcml2ZXIsICJ2NGwyX2NvbXBvbmVudCIsIHNpemVvZihjYXAtPmRyaXZlcikp
OwpAQCAtMjU1LDcgKzI1Niw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y2FwKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlv
Y19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGlj
IGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9mbXRk
ZXNjICpmKQogewogCWlmIChmLT5pbmRleCkKQEAgLTI2OSw0MSArMjcxLDQ2IEBAIHN0YXRpYyBp
bnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2Fw
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAljb21wX3NldF9mb3JtYXRfc3RydWN0
KGYpOwogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY190cnlfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKLQlzdHJ1Y3QgY29t
cF9maCAqZmggPSBwcml2OworCXN0cnVjdCBjb21wX2ZoICpmaCA9IHN0YXRlOwogCXN0cnVjdCBt
b3N0X3ZpZGVvX2RldiAqbWRldiA9IGZoLT5tZGV2OwogCiAJcmV0dXJuIGNvbXBfc2V0X2Zvcm1h
dChtZGV2LCBWSURJT0NfVFJZX0ZNVCwgZik7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX3NfZm10
X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlv
Y19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKLQlzdHJ1Y3Qg
Y29tcF9maCAqZmggPSBwcml2OworCXN0cnVjdCBjb21wX2ZoICpmaCA9IHN0YXRlOwogCXN0cnVj
dCBtb3N0X3ZpZGVvX2RldiAqbWRldiA9IGZoLT5tZGV2OwogCiAJcmV0dXJuIGNvbXBfc2V0X2Zv
cm1hdChtZGV2LCBWSURJT0NfU19GTVQsIGYpOwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX3N0
ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdjRsMl9zdGRfaWQgKm5vcm0pCitzdGF0
aWMgaW50IHZpZGlvY19nX3N0ZChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCQl2NGwyX3N0ZF9pZCAqbm9ybSkKIHsKIAkqbm9ybSA9IFY0TDJf
U1REX1VOS05PV047CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5w
dXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19lbnVt
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfaW5wdXQgKmlucHV0KQogewotCXN0cnVj
dCBjb21wX2ZoICpmaCA9IHByaXY7CisJc3RydWN0IGNvbXBfZmggKmZoID0gc3RhdGU7CiAJc3Ry
dWN0IG1vc3RfdmlkZW9fZGV2ICptZGV2ID0gZmgtPm1kZXY7CiAKIAlpZiAoaW5wdXQtPmluZGV4
ID49IFY0TDJfQ01QX01BWF9JTlBVVCkKQEAgLTMxOCwxNyArMzI1LDE5IEBAIHN0YXRpYyBpbnQg
dmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKK3N0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1
bnNpZ25lZCBpbnQgKmkpCiB7Ci0Jc3RydWN0IGNvbXBfZmggKmZoID0gcHJpdjsKKwlzdHJ1Y3Qg
Y29tcF9maCAqZmggPSBzdGF0ZTsKIAlzdHJ1Y3QgbW9zdF92aWRlb19kZXYgKm1kZXYgPSBmaC0+
bWRldjsKIAkqaSA9IG1kZXYtPmN0cmxfaW5wdXQ7CiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBp
bnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVk
IGludCBpbmRleCkKK3N0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUs
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkJICB1bnNpZ25lZCBpbnQgaW5k
ZXgpCiB7Ci0Jc3RydWN0IGNvbXBfZmggKmZoID0gcHJpdjsKKwlzdHJ1Y3QgY29tcF9maCAqZmgg
PSBzdGF0ZTsKIAlzdHJ1Y3QgbW9zdF92aWRlb19kZXYgKm1kZXYgPSBmaC0+bWRldjsKIAogCWlm
IChpbmRleCA+PSBWNEwyX0NNUF9NQVhfSU5QVVQpCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdp
bmcvdmMwNF9zZXJ2aWNlcy9iY20yODM1LWNhbWVyYS9iY20yODM1LWNhbWVyYS5jIGIvZHJpdmVy
cy9zdGFnaW5nL3ZjMDRfc2VydmljZXMvYmNtMjgzNS1jYW1lcmEvYmNtMjgzNS1jYW1lcmEuYwpp
bmRleCBmYTdlYTRjYTRjMzZmNGVjN2Y3NmY2ZmZiZWE5ZjQ1MjA1MTE2YmI4Li5hYzBlNWU3MTEy
MDA3MTJkZjE1NDJhZDNjMGYxZGEzZjkwMTM5ZDIwIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdp
bmcvdmMwNF9zZXJ2aWNlcy9iY20yODM1LWNhbWVyYS9iY20yODM1LWNhbWVyYS5jCisrKyBiL2Ry
aXZlcnMvc3RhZ2luZy92YzA0X3NlcnZpY2VzL2JjbTI4MzUtY2FtZXJhL2JjbTI4MzUtY2FtZXJh
LmMKQEAgLTY4OSw3ICs2ODksOCBAQCBzdGF0aWMgaW50IHNldF9vdmVybGF5X3BhcmFtcyhzdHJ1
Y3QgYmNtMjgzNV9tbWFsX2RldiAqZGV2LAogfQogCiAvKiBvdmVybGF5IGlvY3RsICovCi1zdGF0
aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBm
aWxlICpmaWxlLAorCQkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwK
IAkJCQkgICAgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKIHsKIAlzdHJ1Y3QgbW1hbF9mbXQg
KmZtdDsKQEAgLTcwNCw3ICs3MDUsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRf
b3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIGludCB2aWRpb2NfZ19mbXRfdmlkX292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgYmNtMjgzNV9tbWFsX2RldiAq
ZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAgLTcxNCw3ICs3MTYsOCBAQCBzdGF0aWMgaW50
IHZpZGlvY19nX2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3ZlcmxheShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX3RyeV9mbXRf
dmlkX292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICAgICAgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKQogewog
CXN0cnVjdCBiY20yODM1X21tYWxfZGV2ICpkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAt
NzQ1LDEyICs3NDgsMTMgQEAgc3RhdGljIGludCB2aWRpb2NfdHJ5X2ZtdF92aWRfb3ZlcmxheShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGlu
dCB2aWRpb2Nfc19mbXRfdmlkX292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CitzdGF0aWMgaW50IHZpZGlvY19zX2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwK
KwkJCQkgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVj
dCB2NGwyX2Zvcm1hdCAqZikKIHsKIAlzdHJ1Y3QgYmNtMjgzNV9tbWFsX2RldiAqZGV2ID0gdmlk
ZW9fZHJ2ZGF0YShmaWxlKTsKIAotCXZpZGlvY190cnlfZm10X3ZpZF9vdmVybGF5KGZpbGUsIHBy
aXYsIGYpOworCXZpZGlvY190cnlfZm10X3ZpZF9vdmVybGF5KGZpbGUsIHN0YXRlLCBmKTsKIAog
CWRldi0+b3ZlcmxheSA9IGYtPmZtdC53aW47CiAJaWYgKGRldi0+Y29tcG9uZW50W0NPTVBfUFJF
VklFV10tPmVuYWJsZWQpIHsKQEAgLTc2MSw3ICs3NjUsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19z
X2ZtdF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqZiwgdW5zaWduZWQgaW50IG9uKQorc3RhdGljIGludCB2aWRpb2Nfb3ZlcmxheShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgIHVuc2ln
bmVkIGludCBvbikKIHsKIAlpbnQgcmV0OwogCXN0cnVjdCBiY20yODM1X21tYWxfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODE2LDcgKzgyMSw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmYsIHVuc2lnbmVkIGludCBvbikK
IAlyZXR1cm4gdmNoaXFfbW1hbF9wb3J0X2VuYWJsZShkZXYtPmluc3RhbmNlLCBzcmMsIE5VTEwp
OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19nX2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLAorc3RhdGljIGludCB2aWRpb2NfZ19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJIHN0cnVjdCB2NGwyX2ZyYW1lYnVm
ZmVyICphKQogewogCS8qIFRoZSB2aWRlbyBvdmVybGF5IG11c3Qgc3RheSB3aXRoaW4gdGhlIGZy
YW1lYnVmZmVyIGFuZCBjYW4ndCBiZQpAQCAtODQxLDcgKzg0Nyw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX2dfZmJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiB9CiAKIC8qIGlucHV0IGlv
Y3RscyAqLwotc3RhdGljIGludCB2aWRpb2NfZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKK3N0YXRpYyBpbnQgdmlkaW9jX2VudW1faW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBz
dHJ1Y3QgdjRsMl9pbnB1dCAqaW5wKQogewogCS8qIG9ubHkgYSBzaW5nbGUgY2FtZXJhIGlucHV0
ICovCkBAIC04NTMsMTMgKzg2MCwxNSBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2lucHV0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBp
bnQgKmkpCitzdGF0aWMgaW50IHZpZGlvY19nX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50ICppKQogewog
CSppID0gMDsKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCitzdGF0aWMgaW50IHZp
ZGlvY19zX2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJCSAgdW5zaWduZWQgaW50IGkpCiB7CiAJaWYgKGkpCiAJCXJldHVybiAtRUlO
VkFMOwpAQCAtODY4LDcgKzg3Nyw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX3NfaW5wdXQoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCBpKQogfQogCiAvKiBjYXB0dXJl
IGlvY3RscyAqLwotc3RhdGljIGludCB2aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0
IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCBiY20yODM1X21tYWxfZGV2ICpkZXYg
PSB2aWRlb19kcnZkYXRhKGZpbGUpOwpAQCAtODg0LDcgKzg5NCw4IEBAIHN0YXRpYyBpbnQgdmlk
aW9jX3F1ZXJ5Y2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwog
fQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9mbXRfdmlkX2NhcChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0cnVjdCBtbWFsX2ZtdCAqZm10OwpA
QCAtODk5LDcgKzkxMCw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10X3ZpZF9jYXAoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQg
dmlkaW9jX2dfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCXN0cnVj
dCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
IHsKIAlzdHJ1Y3QgYmNtMjgzNV9tbWFsX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsK
QEAgLTkyNCw3ICs5MzYsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19nX2ZtdF92aWRfY2FwKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHZp
ZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0
aWMgaW50IHZpZGlvY190cnlfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJICBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZikKIHsKIAlzdHJ1Y3QgYmNtMjgzNV9tbWFsX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKQEAgLTEyNzYsNyArMTI4OSw4IEBAIHN0YXRpYyBpbnQgbW1hbF9zZXR1cF9jb21wb25l
bnRzKHN0cnVjdCBiY20yODM1X21tYWxfZGV2ICpkZXYsCiAJcmV0dXJuIHJldDsKIH0KIAotc3Rh
dGljIGludCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJp
diwKK3N0YXRpYyBpbnQgdmlkaW9jX3NfZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsCisJ
CQkJc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJc3RydWN0IHY0bDJfZm9y
bWF0ICpmKQogewogCWludCByZXQ7CkBAIC0xMjg0LDcgKzEyOTgsNyBAQCBzdGF0aWMgaW50IHZp
ZGlvY19zX2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXN0cnVj
dCBtbWFsX2ZtdCAqbWZtdDsKIAogCS8qIHRyeSB0aGUgZm9ybWF0IHRvIHNldCB2YWxpZCBwYXJh
bWV0ZXJzICovCi0JcmV0ID0gdmlkaW9jX3RyeV9mbXRfdmlkX2NhcChmaWxlLCBwcml2LCBmKTsK
KwlyZXQgPSB2aWRpb2NfdHJ5X2ZtdF92aWRfY2FwKGZpbGUsIHN0YXRlLCBmKTsKIAlpZiAocmV0
KSB7CiAJCXY0bDJfZXJyKCZkZXYtPnY0bDJfZGV2LAogCQkJICJ2aWRfY2FwIC0gdmlkaW9jX3Ry
eV9mbXRfdmlkX2NhcCBmYWlsZWRcbiIpOwpAQCAtMTMyMCw3ICsxMzM0LDggQEAgc3RhdGljIGlu
dCB2aWRpb2Nfc19mbXRfdmlkX2NhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKIAly
ZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZXNpemVz
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9mcm1zaXplZW51bSAqZnNpemUpCiB7CiAJc3RydWN0IGJj
bTI4MzVfbW1hbF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBAIC0xMzQ1LDcgKzEz
NjAsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLAogfQogCiAvKiB0aW1lcGVyZnJhbWUgaXMgYXJiaXRyYXJ5IGFuZCBjb250
aW51b3VzICovCi1zdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2NfZW51bV9mcmFtZWludGVy
dmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCQkgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mcm1pdmFsZW51bSAqZml2YWwpCiB7
CiAJc3RydWN0IGJjbTI4MzVfbW1hbF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CkBA
IC0xMzc1LDcgKzEzOTEsOCBAQCBzdGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxz
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAogCXJldHVybiAwOwogfQogCi1zdGF0aWMg
aW50IHZpZGlvY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitzdGF0aWMg
aW50IHZpZGlvY19nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSkKIHsK
IAlzdHJ1Y3QgYmNtMjgzNV9tbWFsX2RldiAqZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKQEAg
LTEzODksNyArMTQwNiw4IEBAIHN0YXRpYyBpbnQgdmlkaW9jX2dfcGFybShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCB2aWRpb2Nfc19w
YXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorc3RhdGljIGludCB2aWRpb2Nfc19w
YXJtKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3RydWN0IGJjbTI4
MzVfbW1hbF9kZXYgKmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL3VzYi9nYWRnZXQvZnVuY3Rpb24vdXZjX3Y0bDIuYyBiL2RyaXZlcnMvdXNiL2dhZGdldC9m
dW5jdGlvbi91dmNfdjRsMi5jCmluZGV4IGZkNGI5OThjY2QxNjA1OGViNzk2ZGQzMTc5NzFjMDg2
OWY2YmRlYjguLjc1OWY3NzNlZWQ5MzcyZjJkODNlYzdjYmYxYmE1ZTlkYzFkMjc4ZjYgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvdXNiL2dhZGdldC9mdW5jdGlvbi91dmNfdjRsMi5jCisrKyBiL2RyaXZl
cnMvdXNiL2dhZGdldC9mdW5jdGlvbi91dmNfdjRsMi5jCkBAIC0yMTIsNyArMjEyLDggQEAgdXZj
X3NlbmRfcmVzcG9uc2Uoc3RydWN0IHV2Y19kZXZpY2UgKnV2Yywgc3RydWN0IHV2Y19yZXF1ZXN0
X2RhdGEgKmRhdGEpCiAgKi8KIAogc3RhdGljIGludAotdXZjX3Y0bDJfcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCit1dmNf
djRsMl9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCisJCSAgc3RydWN0IHY0bDJfY2FwYWJpbGl0eSAqY2FwKQogewogCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVjdCB1dmNfZGV2
aWNlICp1dmMgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKQEAgLTIyNiw3ICsyMjcsOCBAQCB1
dmNfdjRsMl9xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2NhcGFiaWxpdHkgKmNhcCkKIH0KIAogc3RhdGljIGludAotdXZjX3Y0bDJfZ2V0X2Zvcm1hdChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQordXZj
X3Y0bDJfZ2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdXZjX2Rl
dmljZSAqdXZjID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CkBAIC0yNDUsNyArMjQ3LDggQEAg
dXZjX3Y0bDJfZ2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZm10KQogfQogCiBzdGF0aWMgaW50Ci11dmNfdjRsMl90cnlfZm9ybWF0KHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0ICpmbXQpCit1dmNf
djRsMl90cnlfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKKwkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQogewogCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVjdCB1dmNfZGV2
aWNlICp1dmMgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKQEAgLTMwMywxNCArMzA2LDE1IEBA
IHV2Y192NGwyX3RyeV9mb3JtYXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmZtdCkKIH0KIAogc3RhdGljIGludAotdXZjX3Y0bDJfc2V0X2Zvcm1hdChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQordXZj
X3Y0bDJfc2V0X2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKIHsKIAlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdXZjX2Rl
dmljZSAqdXZjID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CiAJc3RydWN0IHV2Y192aWRlbyAq
dmlkZW8gPSAmdXZjLT52aWRlbzsKIAlpbnQgcmV0OwogCi0JcmV0ID0gdXZjX3Y0bDJfdHJ5X2Zv
cm1hdChmaWxlLCBmaCwgZm10KTsKKwlyZXQgPSB1dmNfdjRsMl90cnlfZm9ybWF0KGZpbGUsIHN0
YXRlLCBmbXQpOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTMyMyw3ICszMjcsOCBA
QCB1dmNfdjRsMl9zZXRfZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0
IHY0bDJfZm9ybWF0ICpmbXQpCiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIGludCB1dmNfdjRs
Ml9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLAorc3RhdGljIGludCB1dmNfdjRs
Ml9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCSAgIHN0cnVjdCB2NGwyX3N0cmVhbXBhcm0gKnBhcm0pCiB7CiAJc3Ry
dWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CkBAIC0zNTAsNyAr
MzU1LDggQEAgc3RhdGljIGludCB1dmNfdjRsMl9nX3Bhcm0oc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHV2Y192NGwyX3NfcGFybShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCitzdGF0aWMgaW50IHV2Y192NGwyX3NfcGFybShzdHJ1
Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICAgc3RydWN0IHY0bDJfc3RyZWFtcGFybSAqcGFybSkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2
aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTM3NCw3ICszODAsOCBAQCBzdGF0
aWMgaW50IHV2Y192NGwyX3NfcGFybShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiB9CiAK
IHN0YXRpYyBpbnQKLXV2Y192NGwyX2VudW1fZnJhbWVpbnRlcnZhbHMoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKmZoLAordXZjX3Y0bDJfZW51bV9mcmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAq
ZmlsZSwKKwkJCSAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCXN0cnVj
dCB2NGwyX2ZybWl2YWxlbnVtICpmaXZhbCkKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2
ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKQEAgLTQxMyw3ICs0MjAsOCBAQCB1dmNfdjRsMl9lbnVt
X2ZyYW1laW50ZXJ2YWxzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwKIH0KIAogc3RhdGlj
IGludAotdXZjX3Y0bDJfZW51bV9mcmFtZXNpemVzKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpm
aCwKK3V2Y192NGwyX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0g
KmZzaXplKQogewogCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZp
bGUpOwpAQCAtNDQwLDcgKzQ0OCw4IEBAIHV2Y192NGwyX2VudW1fZnJhbWVzaXplcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsCiB9CiAKIHN0YXRpYyBpbnQKLXV2Y192NGwyX2VudW1fZm9y
bWF0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikK
K3V2Y192NGwyX2VudW1fZm9ybWF0KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQogewogCXN0
cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVjdCB1
dmNfZGV2aWNlICp1dmMgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKQEAgLTQ2NCw3ICs0NzMs
OCBAQCB1dmNfdjRsMl9lbnVtX2Zvcm1hdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0
cnVjdCB2NGwyX2ZtdGRlc2MgKmYpCiB9CiAKIHN0YXRpYyBpbnQKLXV2Y192NGwyX3JlcWJ1ZnMo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAq
YikKK3V2Y192NGwyX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAorCQkgc3RydWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKmIpCiB7CiAJ
c3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAJc3RydWN0
IHV2Y19kZXZpY2UgKnV2YyA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOwpAQCAtNDc3LDcgKzQ4
Nyw4IEBAIHV2Y192NGwyX3JlcWJ1ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1
Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAqYikKIH0KIAogc3RhdGljIGludAotdXZjX3Y0bDJfcXVl
cnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmIp
Cit1dmNfdjRsMl9xdWVyeWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCSAgc3RydWN0IHY0bDJfYnVmZmVyICpiKQogewogCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZkZXYgPSB2aWRlb19kZXZkYXRhKGZpbGUpOwogCXN0cnVjdCB1dmNfZGV2
aWNlICp1dmMgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKQEAgLTQ4Nyw3ICs0OTgsOCBAQCB1
dmNfdjRsMl9xdWVyeWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2J1ZmZlciAqYikKIH0KIAogc3RhdGljIGludAotdXZjX3Y0bDJfcWJ1ZihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2J1ZmZlciAqYikKK3V2Y192NGwyX3FidWYoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAorCSAgICAg
IHN0cnVjdCB2NGwyX2J1ZmZlciAqYikKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0g
dmlkZW9fZGV2ZGF0YShmaWxlKTsKIAlzdHJ1Y3QgdXZjX2RldmljZSAqdXZjID0gdmlkZW9fZ2V0
X2RydmRhdGEodmRldik7CkBAIC01MDUsNyArNTE3LDggQEAgdXZjX3Y0bDJfcWJ1ZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2J1ZmZlciAqYikKIH0KIAogc3RhdGlj
IGludAotdXZjX3Y0bDJfZHFidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9idWZmZXIgKmIpCit1dmNfdjRsMl9kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJICAgICAgIHN0cnVjdCB2NGwyX2J1ZmZlciAq
YikKIHsKIAlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsK
IAlzdHJ1Y3QgdXZjX2RldmljZSAqdXZjID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CkBAIC01
MTUsNyArNTI4LDggQEAgdXZjX3Y0bDJfZHFidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZo
LCBzdHJ1Y3QgdjRsMl9idWZmZXIgKmIpCiB9CiAKIHN0YXRpYyBpbnQKLXV2Y192NGwyX3N0cmVh
bW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgZW51bSB2NGwyX2J1Zl90eXBlIHR5cGUp
Cit1dmNfdjRsMl9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCisJCSAgZW51bSB2NGwyX2J1Zl90eXBlIHR5cGUpCiB7CiAJc3RydWN0
IHZpZGVvX2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAJc3RydWN0IHV2Y19k
ZXZpY2UgKnV2YyA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOwpAQCAtNTQxLDcgKzU1NSw4IEBA
IHV2Y192NGwyX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgZW51bSB2NGwy
X2J1Zl90eXBlIHR5cGUpCiB9CiAKIHN0YXRpYyBpbnQKLXV2Y192NGwyX3N0cmVhbW9mZihzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQordXZjX3Y0
bDJfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKKwkJICAgZW51bSB2NGwyX2J1Zl90eXBlIHR5cGUpCiB7CiAJc3RydWN0IHZpZGVv
X2RldmljZSAqdmRldiA9IHZpZGVvX2RldmRhdGEoZmlsZSk7CiAJc3RydWN0IHV2Y19kZXZpY2Ug
KnV2YyA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOwpAQCAtNjIwLDcgKzYzNSw4IEBAIHV2Y192
NGwyX3Vuc3Vic2NyaWJlX2V2ZW50KHN0cnVjdCB2NGwyX2ZoICpmaCwKIH0KIAogc3RhdGljIGxv
bmcKLXV2Y192NGwyX2lvY3RsX2RlZmF1bHQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBi
b29sIHZhbGlkX3ByaW8sCit1dmNfdjRsMl9pb2N0bF9kZWZhdWx0KHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJICAgICAgIGJvb2wgdmFsaWRf
cHJpbywKIAkJICAgICAgIHVuc2lnbmVkIGludCBjbWQsIHZvaWQgKmFyZykKIHsKIAlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdmlkZW9fZGV2ZGF0YShmaWxlKTsKZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvbWVkaWEvdjRsMi1jdHJscy5oIGIvaW5jbHVkZS9tZWRpYS92NGwyLWN0cmxzLmgKaW5k
ZXggMzFmYzFiZWUzNzk3YmZlNTMyOTMxODg5MTg4YzhmN2E5ZGVkYWQzOS4uYTVhNzgxZDA0ZGI5
YWE1N2ZhYmJjY2Y5MzhmZThkMzhlYjU1MGE4MCAxMDA2NDQKLS0tIGEvaW5jbHVkZS9tZWRpYS92
NGwyLWN0cmxzLmgKKysrIGIvaW5jbHVkZS9tZWRpYS92NGwyLWN0cmxzLmgKQEAgLTEyLDYgKzEy
LDcgQEAKICNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgogI2luY2x1ZGUgPGxpbnV4L3ZpZGVvZGV2
Mi5oPgogI2luY2x1ZGUgPG1lZGlhL21lZGlhLXJlcXVlc3QuaD4KKyNpbmNsdWRlIDxtZWRpYS92
NGwyLWRldi5oPgogCiAvKiBmb3J3YXJkIHJlZmVyZW5jZXMgKi8KIHN0cnVjdCBmaWxlOwpAQCAt
MTMxMywxMyArMTMxNCwxMyBAQCB2b2lkIHY0bDJfY3RybF9tZXJnZShjb25zdCBzdHJ1Y3QgdjRs
Ml9ldmVudCAqb2xkLCBzdHJ1Y3QgdjRsMl9ldmVudCAqbmV3KTsKICAqIHY0bDJfY3RybF9sb2df
c3RhdHVzIC0gaGVscGVyIGZ1bmN0aW9uIHRvIGltcGxlbWVudCAlVklESU9DX0xPR19TVEFUVVMg
aW9jdGwKICAqCiAgKiBAZmlsZTogcG9pbnRlciB0byBzdHJ1Y3QgZmlsZQotICogQHByaXY6IHVu
dXNlZC4gS2VwdCBqdXN0IHRvIGJlIGNvbXBhdGlibGUgdG8gdGhlIGFyZ3VtZW50cyBleHBlY3Rl
ZCBieQorICogQHN0YXRlOiB1bnVzZWQuIEtlcHQganVzdCB0byBiZSBjb21wYXRpYmxlIHRvIHRo
ZSBhcmd1bWVudHMgZXhwZWN0ZWQgYnkKICAqCSZzdHJ1Y3QgdjRsMl9pb2N0bF9vcHMudmlkaW9j
X2xvZ19zdGF0dXMuCiAgKgogICogQ2FuIGJlIHVzZWQgYXMgYSB2aWRpb2NfbG9nX3N0YXR1cyBm
dW5jdGlvbiB0aGF0IGp1c3QgZHVtcHMgYWxsIGNvbnRyb2xzCiAgKiBhc3NvY2lhdGVkIHdpdGgg
dGhlIGZpbGVoYW5kbGUuCiAgKi8KLWludCB2NGwyX2N0cmxfbG9nX3N0YXR1cyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdik7CitpbnQgdjRsMl9jdHJsX2xvZ19zdGF0dXMoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlKTsKIAogLyoqCiAgKiB2
NGwyX2N0cmxfc3Vic2NyaWJlX2V2ZW50IC0gU3Vic2NyaWJlcyB0byBhbiBldmVudApkaWZmIC0t
Z2l0IGEvaW5jbHVkZS9tZWRpYS92NGwyLWRldi5oIGIvaW5jbHVkZS9tZWRpYS92NGwyLWRldi5o
CmluZGV4IGI1MzEyODIzZmJmZjljMjM2ZDQzOTRkNDhmYTlhMTQ0MTJiMTdjNjguLmU4Njk2ZDFh
NTkzMWM1NGVlMDdlZjllMjY4Y2Y2MzVjZjg3ZTM0ZjIgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbWVk
aWEvdjRsMi1kZXYuaAorKysgYi9pbmNsdWRlL21lZGlhL3Y0bDItZGV2LmgKQEAgLTYyNyw3ICs2
MjcsNyBAQCB2aWRlb19kZXZpY2Vfc3RhdGVfZ2V0X2ZtdChzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSk7CiAgKiBAc3RhdGU6IHBvaW50ZXIgdG8gc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZQogICogQGZvcm1hdDogcG9pbnRlciB0byBzdHJ1Y3QgdjRsMl9mb3JtYXQKICAqLwotaW50
IHZpZGVvX2RldmljZV9nX2ZtdChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2
aWRlb19kZXZpY2VfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkgICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmb3JtYXQpOwogCiAv
KioKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbWVkaWEvdjRsMi1pb2N0bC5oIGIvaW5jbHVkZS9tZWRp
YS92NGwyLWlvY3RsLmgKaW5kZXggNmY3YTU4MzUwNDQxYmVkZjQwNzJkM2YxM2NlMDU5MzJjNGFl
ODcyOS4uOWUwYWNkNTc5MThjNmQ5MWYyNGYyMTg0MTA4ZTc1ZTc3ZDUwNTU5MiAxMDA2NDQKLS0t
IGEvaW5jbHVkZS9tZWRpYS92NGwyLWlvY3RsLmgKKysrIGIvaW5jbHVkZS9tZWRpYS92NGwyLWlv
Y3RsLmgKQEAgLTE2LDYgKzE2LDcgQEAKICNpbmNsdWRlIDxsaW51eC9zY2hlZC9zaWduYWwuaD4K
ICNpbmNsdWRlIDxsaW51eC9jb21waWxlci5oPiAvKiBuZWVkIF9fdXNlciAqLwogI2luY2x1ZGUg
PGxpbnV4L3ZpZGVvZGV2Mi5oPgorI2luY2x1ZGUgPG1lZGlhL3Y0bDItZGV2Lmg+CiAKIHN0cnVj
dCB2NGwyX2ZoOwogCkBAIC0yOTMsMTQ0ICsyOTQsMTQ0IEBAIHN0cnVjdCB2NGwyX2lvY3RsX29w
cyB7CiAJLyogaW9jdGwgY2FsbGJhY2tzICovCiAKIAkvKiBWSURJT0NfUVVFUllDQVAgaGFuZGxl
ciAqLwotCWludCAoKnZpZGlvY19xdWVyeWNhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCisJaW50ICgqdmlkaW9jX3F1ZXJ5Y2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfY2FwYWJpbGl0
eSAqY2FwKTsKIAogCS8qIFZJRElPQ19FTlVNX0ZNVCBoYW5kbGVycyAqLwotCWludCAoKnZpZGlv
Y19lbnVtX2ZtdF92aWRfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQg
KCp2aWRpb2NfZW51bV9mbXRfdmlkX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpm
KTsKLQlpbnQgKCp2aWRpb2NfZW51bV9mbXRfdmlkX292ZXJsYXkpKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19lbnVtX2ZtdF92aWRfb3ZlcmxheSkoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgICBz
dHJ1Y3QgdjRsMl9mbXRkZXNjICpmKTsKLQlpbnQgKCp2aWRpb2NfZW51bV9mbXRfdmlkX291dCko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2VudW1fZm10X3Zp
ZF9vdXQpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkgICAgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZik7Ci0JaW50ICgqdmlkaW9jX2Vu
dW1fZm10X3Nkcl9jYXApKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZp
ZGlvY19lbnVtX2ZtdF9zZHJfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgIHN0cnVjdCB2NGwyX2ZtdGRlc2MgKmYpOwot
CWludCAoKnZpZGlvY19lbnVtX2ZtdF9zZHJfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKKwlpbnQgKCp2aWRpb2NfZW51bV9mbXRfc2RyX291dCkoc3RydWN0IGZpbGUgKmZpbGUs
IHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9mbXRkZXNjICpmKTsKLQlpbnQgKCp2aWRpb2NfZW51bV9mbXRfbWV0YV9jYXApKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19lbnVtX2ZtdF9tZXRhX2NhcCko
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKTsKLQlpbnQgKCp2aWRpb2NfZW51bV9mbXRfbWV0YV9v
dXQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19lbnVtX2Zt
dF9tZXRhX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJCQlzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKTsKIAogCS8qIFZJRElPQ19HX0ZN
VCBoYW5kbGVycyAqLwotCWludCAoKnZpZGlvY19nX2ZtdF92aWRfY2FwKShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfZ19mbXRfdmlkX2NhcCkoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1
Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY19nX2ZtdF92aWRfb3ZlcmxheSkoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2dfZm10X3ZpZF9vdmVy
bGF5KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgqdmlkaW9jX2dfZm10X3ZpZF9v
dXQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX2ZtdF92
aWRfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgqdmlkaW9jX2dfZm10
X3ZpZF9vdXRfb3ZlcmxheSkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgq
dmlkaW9jX2dfZm10X3ZpZF9vdXRfb3ZlcmxheSkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCQkgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KTsKLQlpbnQgKCp2aWRpb2NfZ19mbXRfdmJpX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCisJaW50ICgqdmlkaW9jX2dfZm10X3ZiaV9jYXApKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKTsKLQlpbnQgKCp2aWRpb2NfZ19mbXRfdmJpX291dCkoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2dfZm10X3ZiaV9vdXQpKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0
bDJfZm9ybWF0ICpmKTsKLQlpbnQgKCp2aWRpb2NfZ19mbXRfc2xpY2VkX3ZiaV9jYXApKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX2ZtdF9zbGljZWRfdmJp
X2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LAogCQkJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY19nX2ZtdF9z
bGljZWRfdmJpX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlk
aW9jX2dfZm10X3NsaWNlZF92Ymlfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0J
aW50ICgqdmlkaW9jX2dfZm10X3ZpZF9jYXBfbXBsYW5lKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfZ19mbXRfdmlkX2NhcF9tcGxhbmUpKHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKLQlpbnQgKCp2aWRpb2NfZ19mbXRfdmlkX291dF9tcGxhbmUpKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX2ZtdF92aWRfb3V0
X21wbGFuZSkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY19nX2Zt
dF9zZHJfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nf
Z19mbXRfc2RyX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlv
Y19nX2ZtdF9zZHJfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2
aWRpb2NfZ19mbXRfc2RyX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZp
Y2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAo
KnZpZGlvY19nX2ZtdF9tZXRhX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJ
aW50ICgqdmlkaW9jX2dfZm10X21ldGFfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZp
ZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYp
OwotCWludCAoKnZpZGlvY19nX2ZtdF9tZXRhX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCisJaW50ICgqdmlkaW9jX2dfZm10X21ldGFfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpOwogCiAJLyogVklESU9DX1NfRk1UIGhhbmRsZXJzICovCi0JaW50ICgqdmlkaW9j
X3NfZm10X3ZpZF9jYXApKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZp
ZGlvY19zX2ZtdF92aWRfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgq
dmlkaW9jX3NfZm10X3ZpZF9vdmVybGF5KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
KwlpbnQgKCp2aWRpb2Nfc19mbXRfdmlkX292ZXJsYXkpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
KTsKLQlpbnQgKCp2aWRpb2Nfc19mbXRfdmlkX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCisJaW50ICgqdmlkaW9jX3NfZm10X3ZpZF9vdXQpKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgc3RydWN0IHY0bDJfZm9y
bWF0ICpmKTsKLQlpbnQgKCp2aWRpb2Nfc19mbXRfdmlkX291dF9vdmVybGF5KShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc19mbXRfdmlkX291dF9vdmVybGF5
KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY19zX2ZtdF92Ymlf
Y2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc19mbXRf
dmJpX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY19zX2Zt
dF92Ymlfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nf
c19mbXRfdmJpX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlv
Y19zX2ZtdF9zbGljZWRfdmJpX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJ
aW50ICgqdmlkaW9jX3NfZm10X3NsaWNlZF92YmlfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3Ry
dWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgIHN0cnVjdCB2NGwyX2Zvcm1h
dCAqZik7Ci0JaW50ICgqdmlkaW9jX3NfZm10X3NsaWNlZF92Ymlfb3V0KShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc19mbXRfc2xpY2VkX3ZiaV9vdXQpKHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJ
ICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLQlpbnQgKCp2aWRpb2Nfc19mbXRfdmlkX2NhcF9t
cGxhbmUpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19zX2Zt
dF92aWRfY2FwX21wbGFuZSkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCQkgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZp
ZGlvY19zX2ZtdF92aWRfb3V0X21wbGFuZSkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CisJaW50ICgqdmlkaW9jX3NfZm10X3ZpZF9vdXRfbXBsYW5lKShzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgIHN0cnVjdCB2NGwyX2Zv
cm1hdCAqZik7Ci0JaW50ICgqdmlkaW9jX3NfZm10X3Nkcl9jYXApKHN0cnVjdCBmaWxlICpmaWxl
LCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19zX2ZtdF9zZHJfY2FwKShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0cnVjdCB2
NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgqdmlkaW9jX3NfZm10X3Nkcl9vdXQpKHN0cnVjdCBmaWxl
ICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19zX2ZtdF9zZHJfb3V0KShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgIHN0
cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgqdmlkaW9jX3NfZm10X21ldGFfY2FwKShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc19mbXRfbWV0YV9jYXAp
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJ
CQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgqdmlkaW9jX3NfZm10X21ldGFf
b3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc19mbXRf
bWV0YV9vdXQpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpz
dGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7CiAKIAkvKiBWSURJT0NfVFJZ
X0ZNVCBoYW5kbGVycyAqLwotCWludCAoKnZpZGlvY190cnlfZm10X3ZpZF9jYXApKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY190cnlfZm10X3ZpZF9jYXApKHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkg
ICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY190cnlfZm10X3ZpZF9v
dmVybGF5KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfdHJ5
X2ZtdF92aWRfb3ZlcmxheSkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCQkgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgqdmlk
aW9jX3RyeV9mbXRfdmlkX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50
ICgqdmlkaW9jX3RyeV9mbXRfdmlkX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7
Ci0JaW50ICgqdmlkaW9jX3RyeV9mbXRfdmlkX291dF9vdmVybGF5KShzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0X292ZXJsYXkpKHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJ
ICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLQlpbnQgKCp2aWRpb2NfdHJ5X2ZtdF92Ymlf
Y2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfdHJ5X2Zt
dF92YmlfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLQlpbnQgKCp2aWRpb2Nf
dHJ5X2ZtdF92Ymlfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2
aWRpb2NfdHJ5X2ZtdF92Ymlfb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICAgc3RydWN0IHY0bDJfZm9ybWF0ICpmKTsKLQlp
bnQgKCp2aWRpb2NfdHJ5X2ZtdF9zbGljZWRfdmJpX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsCisJaW50ICgqdmlkaW9jX3RyeV9mbXRfc2xpY2VkX3ZiaV9jYXApKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICAgICBz
dHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY190cnlfZm10X3NsaWNlZF92Ymlf
b3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfdHJ5X2Zt
dF9zbGljZWRfdmJpX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCQkgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZik7Ci0JaW50ICgq
dmlkaW9jX3RyeV9mbXRfdmlkX2NhcF9tcGxhbmUpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorCWludCAoKnZpZGlvY190cnlfZm10X3ZpZF9jYXBfbXBsYW5lKShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJCSAgICAgc3RydWN0
IHY0bDJfZm9ybWF0ICpmKTsKLQlpbnQgKCp2aWRpb2NfdHJ5X2ZtdF92aWRfb3V0X21wbGFuZSko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX3RyeV9mbXRfdmlk
X291dF9tcGxhbmUpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkJICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlv
Y190cnlfZm10X3Nkcl9jYXApKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAo
KnZpZGlvY190cnlfZm10X3Nkcl9jYXApKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwot
CWludCAoKnZpZGlvY190cnlfZm10X3Nkcl9vdXQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorCWludCAoKnZpZGlvY190cnlfZm10X3Nkcl9vdXQpKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9m
b3JtYXQgKmYpOwotCWludCAoKnZpZGlvY190cnlfZm10X21ldGFfY2FwKShzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfdHJ5X2ZtdF9tZXRhX2NhcCkoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAg
ICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwotCWludCAoKnZpZGlvY190cnlfZm10X21ldGFfb3V0
KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfdHJ5X2ZtdF9t
ZXRhX291dCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9mb3JtYXQgKmYpOwogCiAJLyogQnVmZmVyIGhh
bmRsZXJzICovCi0JaW50ICgqdmlkaW9jX3JlcWJ1ZnMpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorCWludCAoKnZpZGlvY19yZXFidWZzKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICBzdHJ1Y3QgdjRsMl9yZXF1ZXN0
YnVmZmVycyAqYik7Ci0JaW50ICgqdmlkaW9jX3F1ZXJ5YnVmKShzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfcXVlcnlidWYpKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9i
dWZmZXIgKmIpOwotCWludCAoKnZpZGlvY19xYnVmKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwKKwlpbnQgKCp2aWRpb2NfcWJ1Zikoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfYnVmZmVyICpiKTsKLQlp
bnQgKCp2aWRpb2NfZXhwYnVmKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQg
KCp2aWRpb2NfZXhwYnVmKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCiAJCQkgICAgIHN0cnVjdCB2NGwyX2V4cG9ydGJ1ZmZlciAqZSk7Ci0JaW50
ICgqdmlkaW9jX2RxYnVmKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2
aWRpb2NfZHFidWYpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCSAgICBzdHJ1Y3QgdjRsMl9idWZmZXIgKmIpOwogCi0JaW50ICgqdmlkaW9j
X2NyZWF0ZV9idWZzKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRp
b2NfY3JlYXRlX2J1ZnMpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2NyZWF0ZV9idWZmZXJzICpiKTsKLQlpbnQg
KCp2aWRpb2NfcHJlcGFyZV9idWYpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWlu
dCAoKnZpZGlvY19wcmVwYXJlX2J1Zikoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfYnVmZmVyICpiKTsKLQlpbnQg
KCp2aWRpb2NfcmVtb3ZlX2J1ZnMpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWlu
dCAoKnZpZGlvY19yZW1vdmVfYnVmcykoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfcmVtb3ZlX2J1ZmZlcnMgKmQp
OwogCi0JaW50ICgqdmlkaW9jX292ZXJsYXkpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LCB1bnNpZ25lZCBpbnQgaSk7Ci0JaW50ICgqdmlkaW9jX2dfZmJ1Zikoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX292ZXJsYXkpKHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5zaWduZWQgaW50IGkpOworCWlu
dCAoKnZpZGlvY19nX2ZidWYpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfZnJhbWVidWZmZXIgKmEpOwotCWlu
dCAoKnZpZGlvY19zX2ZidWYpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAo
KnZpZGlvY19zX2ZidWYpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0
YXRlICpzdGF0ZSwKIAkJCSAgICAgY29uc3Qgc3RydWN0IHY0bDJfZnJhbWVidWZmZXIgKmEpOwog
CiAJCS8qIFN0cmVhbSBvbi9vZmYgKi8KLQlpbnQgKCp2aWRpb2Nfc3RyZWFtb24pKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19zdHJlYW1vbikoc3RydWN0IGZp
bGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIGVu
dW0gdjRsMl9idWZfdHlwZSBpKTsKLQlpbnQgKCp2aWRpb2Nfc3RyZWFtb2ZmKShzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc3RyZWFtb2ZmKShzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJZW51bSB2NGwy
X2J1Zl90eXBlIGkpOwogCiAJCS8qCkBAIC00MzgsMTM1ICs0MzksMTM2IEBAIHN0cnVjdCB2NGwy
X2lvY3RsX29wcyB7CiAJCSAqCiAJCSAqIE5vdGU6IEVOVU1TVEQgaXMgaGFuZGxlZCBieSB2aWRl
b2Rldi5jCiAJCSAqLwotCWludCAoKnZpZGlvY19nX3N0ZCkoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHY0bDJfc3RkX2lkICpub3JtKTsKLQlpbnQgKCp2aWRpb2Nfc19zdGQpKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCBub3JtKTsKLQlpbnQgKCp2aWRp
b2NfcXVlcnlzdGQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB2NGwyX3N0ZF9pZCAq
YSk7CisJaW50ICgqdmlkaW9jX2dfc3RkKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVv
X2RldmljZV9zdGF0ZSAqc3RhdGUsIHY0bDJfc3RkX2lkICpub3JtKTsKKwlpbnQgKCp2aWRpb2Nf
c19zdGQpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwgdjRsMl9zdGRfaWQgbm9ybSk7CisJaW50ICgqdmlkaW9jX3F1ZXJ5c3RkKShzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsIHY0bDJfc3RkX2lkICph
KTsKIAogCQkvKiBJbnB1dCBoYW5kbGluZyAqLwotCWludCAoKnZpZGlvY19lbnVtX2lucHV0KShz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfZW51bV9pbnB1dCko
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
CSBzdHJ1Y3QgdjRsMl9pbnB1dCAqaW5wKTsKLQlpbnQgKCp2aWRpb2NfZ19pbnB1dCkoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSk7Ci0JaW50ICgqdmlkaW9j
X3NfaW5wdXQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCB1bnNpZ25lZCBpbnQgaSk7
CisJaW50ICgqdmlkaW9jX2dfaW5wdXQpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9f
ZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5zaWduZWQgaW50ICppKTsKKwlpbnQgKCp2aWRpb2Nfc19p
bnB1dCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRl
LCB1bnNpZ25lZCBpbnQgaSk7CiAKIAkJLyogT3V0cHV0IGhhbmRsaW5nICovCi0JaW50ICgqdmlk
aW9jX2VudW1fb3V0cHV0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2
aWRpb2NfZW51bV9vdXRwdXQpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX291dHB1dCAqYSk7Ci0JaW50ICgqdmlk
aW9jX2dfb3V0cHV0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50
ICppKTsKLQlpbnQgKCp2aWRpb2Nfc19vdXRwdXQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCB1bnNpZ25lZCBpbnQgaSk7CisJaW50ICgqdmlkaW9jX2dfb3V0cHV0KShzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCQkgICAgICAgdW5z
aWduZWQgaW50ICppKTsKKwlpbnQgKCp2aWRpb2Nfc19vdXRwdXQpKHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwgdW5zaWduZWQgaW50IGkpOwogCiAJ
CS8qIENvbnRyb2wgaGFuZGxpbmcgKi8KLQlpbnQgKCp2aWRpb2NfcXVlcnlfZXh0X2N0cmwpKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19xdWVyeV9leHRfY3Ry
bCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJCSAgICAgc3RydWN0IHY0bDJfcXVlcnlfZXh0X2N0cmwgKmEpOwotCWludCAoKnZpZGlvY19n
X2V4dF9jdHJscykoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9j
X2dfZXh0X2N0cmxzKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9leHRfY29udHJvbHMgKmEpOwotCWludCAoKnZp
ZGlvY19zX2V4dF9jdHJscykoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgq
dmlkaW9jX3NfZXh0X2N0cmxzKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9leHRfY29udHJvbHMgKmEpOwotCWlu
dCAoKnZpZGlvY190cnlfZXh0X2N0cmxzKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
KwlpbnQgKCp2aWRpb2NfdHJ5X2V4dF9jdHJscykoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICBzdHJ1Y3QgdjRsMl9leHRfY29udHJv
bHMgKmEpOwotCWludCAoKnZpZGlvY19xdWVyeW1lbnUpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorCWludCAoKnZpZGlvY19xdWVyeW1lbnUpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQlzdHJ1Y3QgdjRsMl9xdWVyeW1lbnUg
KmEpOwogCiAJLyogQXVkaW8gaW9jdGxzICovCi0JaW50ICgqdmlkaW9jX2VudW1hdWRpbykoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2VudW1hdWRpbykoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCXN0
cnVjdCB2NGwyX2F1ZGlvICphKTsKLQlpbnQgKCp2aWRpb2NfZ19hdWRpbykoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2dfYXVkaW8pKHN0cnVjdCBmaWxlICpm
aWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIHN0cnVjdCB2
NGwyX2F1ZGlvICphKTsKLQlpbnQgKCp2aWRpb2Nfc19hdWRpbykoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX3NfYXVkaW8pKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgIGNvbnN0IHN0cnVjdCB2
NGwyX2F1ZGlvICphKTsKIAogCS8qIEF1ZGlvIG91dCBpb2N0bHMgKi8KLQlpbnQgKCp2aWRpb2Nf
ZW51bWF1ZG91dCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9j
X2VudW1hdWRvdXQpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0bDJfYXVkaW9vdXQgKmEpOwotCWludCAoKnZpZGlvY19n
X2F1ZG91dCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2df
YXVkb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfYXVkaW9vdXQgKmEpOwotCWludCAoKnZpZGlvY19z
X2F1ZG91dCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX3Nf
YXVkb3V0KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3Rh
dGUsCiAJCQkgICAgICAgY29uc3Qgc3RydWN0IHY0bDJfYXVkaW9vdXQgKmEpOwotCWludCAoKnZp
ZGlvY19nX21vZHVsYXRvcikoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgq
dmlkaW9jX2dfbW9kdWxhdG9yKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rldmlj
ZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9tb2R1bGF0b3IgKmEpOwotCWludCAo
KnZpZGlvY19zX21vZHVsYXRvcikoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50
ICgqdmlkaW9jX3NfbW9kdWxhdG9yKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2Rl
dmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICBjb25zdCBzdHJ1Y3QgdjRsMl9tb2R1bGF0b3IgKmEp
OwogCS8qIENyb3AgaW9jdGxzICovCi0JaW50ICgqdmlkaW9jX2dfcGl4ZWxhc3BlY3QpKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX3BpeGVsYXNwZWN0KShz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
ICAgIGludCBidWZfdHlwZSwgc3RydWN0IHY0bDJfZnJhY3QgKmFzcGVjdCk7Ci0JaW50ICgqdmlk
aW9jX2dfc2VsZWN0aW9uKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2
aWRpb2NfZ19zZWxlY3Rpb24pKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcyk7Ci0JaW50ICgq
dmlkaW9jX3Nfc2VsZWN0aW9uKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQg
KCp2aWRpb2Nfc19zZWxlY3Rpb24pKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX3NlbGVjdGlvbiAqcyk7CiAJLyog
Q29tcHJlc3Npb24gaW9jdGxzICovCi0JaW50ICgqdmlkaW9jX2dfanBlZ2NvbXApKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX2pwZWdjb21wKShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJIHN0cnVj
dCB2NGwyX2pwZWdjb21wcmVzc2lvbiAqYSk7Ci0JaW50ICgqdmlkaW9jX3NfanBlZ2NvbXApKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19zX2pwZWdjb21wKShz
dHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJ
IGNvbnN0IHN0cnVjdCB2NGwyX2pwZWdjb21wcmVzc2lvbiAqYSk7Ci0JaW50ICgqdmlkaW9jX2df
ZW5jX2luZGV4KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nf
Z19lbmNfaW5kZXgpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRl
ICpzdGF0ZSwKIAkJCQkgIHN0cnVjdCB2NGwyX2VuY19pZHggKmEpOwotCWludCAoKnZpZGlvY19l
bmNvZGVyX2NtZCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9j
X2VuY29kZXJfY21kKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkJICBzdHJ1Y3QgdjRsMl9lbmNvZGVyX2NtZCAqYSk7Ci0JaW50ICgqdmlk
aW9jX3RyeV9lbmNvZGVyX2NtZCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50
ICgqdmlkaW9jX3RyeV9lbmNvZGVyX2NtZCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRl
b19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAgIHN0cnVjdCB2NGwyX2VuY29kZXJfY21k
ICphKTsKLQlpbnQgKCp2aWRpb2NfZGVjb2Rlcl9jbWQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LAorCWludCAoKnZpZGlvY19kZWNvZGVyX2NtZCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZGVjb2Rl
cl9jbWQgKmEpOwotCWludCAoKnZpZGlvY190cnlfZGVjb2Rlcl9jbWQpKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY190cnlfZGVjb2Rlcl9jbWQpKHN0cnVjdCBm
aWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBz
dHJ1Y3QgdjRsMl9kZWNvZGVyX2NtZCAqYSk7CiAKIAkvKiBTdHJlYW0gdHlwZS1kZXBlbmRlbnQg
cGFyYW1ldGVyIGlvY3RscyAqLwotCWludCAoKnZpZGlvY19nX3Bhcm0pKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX3Bhcm0pKHN0cnVjdCBmaWxlICpmaWxl
LCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJf
c3RyZWFtcGFybSAqYSk7Ci0JaW50ICgqdmlkaW9jX3NfcGFybSkoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX3NfcGFybSkoc3RydWN0IGZpbGUgKmZpbGUsIHN0
cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9zdHJl
YW1wYXJtICphKTsKIAogCS8qIFR1bmVyIGlvY3RscyAqLwotCWludCAoKnZpZGlvY19nX3R1bmVy
KShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfZ190dW5lciko
c3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJ
ICAgICAgc3RydWN0IHY0bDJfdHVuZXIgKmEpOwotCWludCAoKnZpZGlvY19zX3R1bmVyKShzdHJ1
Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc190dW5lcikoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAg
Y29uc3Qgc3RydWN0IHY0bDJfdHVuZXIgKmEpOwotCWludCAoKnZpZGlvY19nX2ZyZXF1ZW5jeSko
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2dfZnJlcXVlbmN5
KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJ
CQkJICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmEpOwotCWludCAoKnZpZGlvY19zX2ZyZXF1ZW5j
eSkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX3NfZnJlcXVl
bmN5KShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUs
CiAJCQkJICBjb25zdCBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3kgKmEpOwotCWludCAoKnZpZGlvY19l
bnVtX2ZyZXFfYmFuZHMpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZp
ZGlvY19lbnVtX2ZyZXFfYmFuZHMpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9mcmVxdWVuY3lfYmFuZCAq
YmFuZCk7CiAKIAkvKiBTbGljZWQgVkJJIGNhcCAqLwotCWludCAoKnZpZGlvY19nX3NsaWNlZF92
YmlfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2NfZ19z
bGljZWRfdmJpX2NhcCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJCSAgICAgICBzdHJ1Y3QgdjRsMl9zbGljZWRfdmJpX2NhcCAqYSk7CiAK
IAkvKiBMb2cgc3RhdHVzIGlvY3RsICovCi0JaW50ICgqdmlkaW9jX2xvZ19zdGF0dXMpKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2KTsKKwlpbnQgKCp2aWRpb2NfbG9nX3N0YXR1cykoc3Ry
dWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlKTsKIAotCWlu
dCAoKnZpZGlvY19zX2h3X2ZyZXFfc2Vlaykoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYs
CisJaW50ICgqdmlkaW9jX3NfaHdfZnJlcV9zZWVrKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkJICAgICBjb25zdCBzdHJ1Y3QgdjRsMl9o
d19mcmVxX3NlZWsgKmEpOwogCiAJLyogRGVidWdnaW5nIGlvY3RscyAqLwogI2lmZGVmIENPTkZJ
R19WSURFT19BRFZfREVCVUcKLQlpbnQgKCp2aWRpb2NfZ19yZWdpc3Rlcikoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2dfcmVnaXN0ZXIpKHN0cnVjdCBmaWxl
ICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgc3RydWN0IHY0
bDJfZGJnX3JlZ2lzdGVyICpyZWcpOwotCWludCAoKnZpZGlvY19zX3JlZ2lzdGVyKShzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRpb2Nfc19yZWdpc3Rlcikoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSBjb25z
dCBzdHJ1Y3QgdjRsMl9kYmdfcmVnaXN0ZXIgKnJlZyk7CiAKLQlpbnQgKCp2aWRpb2NfZ19jaGlw
X2luZm8pKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX2No
aXBfaW5mbykoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0
YXRlLAogCQkJCSAgc3RydWN0IHY0bDJfZGJnX2NoaXBfaW5mbyAqY2hpcCk7CiAjZW5kaWYKIAot
CWludCAoKnZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAorCWludCAoKnZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMpKHN0cnVjdCBmaWxlICpmaWxlLCBz
dHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICBzdHJ1Y3QgdjRsMl9m
cm1zaXplZW51bSAqZnNpemUpOwogCi0JaW50ICgqdmlkaW9jX2VudW1fZnJhbWVpbnRlcnZhbHMp
KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19lbnVtX2ZyYW1l
aW50ZXJ2YWxzKShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAq
c3RhdGUsCiAJCQkJCSAgc3RydWN0IHY0bDJfZnJtaXZhbGVudW0gKmZpdmFsKTsKIAogCS8qIERW
IFRpbWluZ3MgSU9DVExzICovCi0JaW50ICgqdmlkaW9jX3NfZHZfdGltaW5ncykoc3RydWN0IGZp
bGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX3NfZHZfdGltaW5ncykoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0
cnVjdCB2NGwyX2R2X3RpbWluZ3MgKnRpbWluZ3MpOwotCWludCAoKnZpZGlvY19nX2R2X3RpbWlu
Z3MpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCWludCAoKnZpZGlvY19nX2R2X3Rp
bWluZ3MpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKIAkJCQkgICBzdHJ1Y3QgdjRsMl9kdl90aW1pbmdzICp0aW1pbmdzKTsKLQlpbnQgKCp2aWRp
b2NfcXVlcnlfZHZfdGltaW5ncykoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50
ICgqdmlkaW9jX3F1ZXJ5X2R2X3RpbWluZ3MpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgICAgc3RydWN0IHY0bDJfZHZfdGltaW5n
cyAqdGltaW5ncyk7Ci0JaW50ICgqdmlkaW9jX2VudW1fZHZfdGltaW5ncykoc3RydWN0IGZpbGUg
KmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgqdmlkaW9jX2VudW1fZHZfdGltaW5ncykoc3RydWN0
IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJCSAgICAg
IHN0cnVjdCB2NGwyX2VudW1fZHZfdGltaW5ncyAqdGltaW5ncyk7Ci0JaW50ICgqdmlkaW9jX2R2
X3RpbWluZ3NfY2FwKShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwlpbnQgKCp2aWRp
b2NfZHZfdGltaW5nc19jYXApKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCQkgICAgIHN0cnVjdCB2NGwyX2R2X3RpbWluZ3NfY2FwICpjYXAp
OwotCWludCAoKnZpZGlvY19nX2VkaWQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
CWludCAoKnZpZGlvY19nX2VkaWQpKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2
aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgc3RydWN0IHY0bDJfZWRpZCAqZWRpZCk7Ci0JaW50
ICgqdmlkaW9jX3NfZWRpZCkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJaW50ICgq
dmlkaW9jX3NfZWRpZCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3Rh
dGUgKnN0YXRlLAogCQkJICAgICBzdHJ1Y3QgdjRsMl9lZGlkICplZGlkKTsKIAogCWludCAoKnZp
ZGlvY19zdWJzY3JpYmVfZXZlbnQpKHN0cnVjdCB2NGwyX2ZoICpmaCwKQEAgLTU3NSw3ICs1Nzcs
NyBAQCBzdHJ1Y3QgdjRsMl9pb2N0bF9vcHMgewogCQkJCQljb25zdCBzdHJ1Y3QgdjRsMl9ldmVu
dF9zdWJzY3JpcHRpb24gKnN1Yik7CiAKIAkvKiBGb3Igb3RoZXIgcHJpdmF0ZSBpb2N0bHMgKi8K
LQlsb25nICgqdmlkaW9jX2RlZmF1bHQpKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAor
CWxvbmcgKCp2aWRpb2NfZGVmYXVsdCkoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgICAgIGJvb2wgdmFsaWRfcHJpbywgdW5zaWduZWQg
aW50IGNtZCwgdm9pZCAqYXJnKTsKIH07CiAKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbWVkaWEvdjRs
Mi1tZW0ybWVtLmggYi9pbmNsdWRlL21lZGlhL3Y0bDItbWVtMm1lbS5oCmluZGV4IDA5YzYxNjQ1
NzdjY2Y0ZWY0OWRlZTI0ZTllZTZiZTM4ZmJjNTIxY2UuLmFjY2QwNWZiYTBkZmYzYzdlYmQ1OTZh
ZTcyNmJhOTY1NzJiOTBhOGMgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbWVkaWEvdjRsMi1tZW0ybWVt
LmgKKysrIGIvaW5jbHVkZS9tZWRpYS92NGwyLW1lbTJtZW0uaApAQCAtODYzLDM3ICs4NjMsNTMg
QEAgdm9pZCB2NGwyX20ybV9yZXF1ZXN0X3F1ZXVlKHN0cnVjdCBtZWRpYV9yZXF1ZXN0ICpyZXEp
OwogCiAvKiB2NGwyIGlvY3RsIGhlbHBlcnMgKi8KIAotaW50IHY0bDJfbTJtX2lvY3RsX3JlcWJ1
ZnMoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdjRsMl9tMm1faW9jdGxfcmVx
YnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJICAgc3RydWN0IHY0bDJfcmVxdWVzdGJ1ZmZlcnMgKnJiKTsKLWludCB2NGwy
X20ybV9pb2N0bF9jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2lu
dCB2NGwyX20ybV9pb2N0bF9jcmVhdGVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAg
ICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRs
Ml9jcmVhdGVfYnVmZmVycyAqY3JlYXRlKTsKLWludCB2NGwyX20ybV9pb2N0bF9yZW1vdmVfYnVm
cyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2NGwyX20ybV9pb2N0bF9yZW1v
dmVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNl
X3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgICBzdHJ1Y3QgdjRsMl9yZW1vdmVfYnVmZmVycyAqZCk7
Ci1pbnQgdjRsMl9tMm1faW9jdGxfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCitpbnQgdjRsMl9tMm1faW9jdGxfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgc3RydWN0IHY0bDJf
YnVmZmVyICpidWYpOwotaW50IHY0bDJfbTJtX2lvY3RsX2V4cGJ1ZihzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqcHJpdiwKK2ludCB2NGwyX20ybV9pb2N0bF9leHBidWYoc3RydWN0IGZpbGUgKmZp
bGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICBzdHJ1Y3Qg
djRsMl9leHBvcnRidWZmZXIgKmViKTsKLWludCB2NGwyX20ybV9pb2N0bF9xYnVmKHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHY0bDJfbTJtX2lvY3RsX3FidWYoc3RydWN0IGZp
bGUgKmZpbGUsCisJCQlzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCXN0cnVj
dCB2NGwyX2J1ZmZlciAqYnVmKTsKLWludCB2NGwyX20ybV9pb2N0bF9kcWJ1ZihzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2NGwyX20ybV9pb2N0bF9kcWJ1ZihzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSBzdHJ1
Y3QgdjRsMl9idWZmZXIgKmJ1Zik7Ci1pbnQgdjRsMl9tMm1faW9jdGxfcHJlcGFyZV9idWYoc3Ry
dWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdjRsMl9tMm1faW9jdGxfcHJlcGFyZV9i
dWYoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAgICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0bDJfYnVmZmVyICpidWYpOwotaW50IHY0bDJf
bTJtX2lvY3RsX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHY0
bDJfbTJtX2lvY3RsX3N0cmVhbW9uKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgIHN0cnVjdCB2
aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAogCQkJICAgIGVudW0gdjRsMl9idWZfdHlwZSB0eXBl
KTsKLWludCB2NGwyX20ybV9pb2N0bF9zdHJlYW1vZmYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KnByaXYsCitpbnQgdjRsMl9tMm1faW9jdGxfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLAor
CQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCSAgICAgZW51bSB2
NGwyX2J1Zl90eXBlIHR5cGUpOwotaW50IHY0bDJfbTJtX2lvY3RsX2VuY29kZXJfY21kKHN0cnVj
dCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHY0bDJfbTJtX2lvY3RsX2VuY29kZXJfY21k
KHN0cnVjdCBmaWxlICpmaWxlLAorCQkJICAgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUg
KnN0YXRlLAogCQkJICAgICAgIHN0cnVjdCB2NGwyX2VuY29kZXJfY21kICplYyk7Ci1pbnQgdjRs
Ml9tMm1faW9jdGxfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitp
bnQgdjRsMl9tMm1faW9jdGxfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkgICAg
ICAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgICAgICAgc3RydWN0IHY0
bDJfZGVjb2Rlcl9jbWQgKmRjKTsKLWludCB2NGwyX20ybV9pb2N0bF90cnlfZW5jb2Rlcl9jbWQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdjRsMl9tMm1faW9jdGxfdHJ5X2Vu
Y29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLAorCQkJCSAgIHN0cnVjdCB2aWRlb19kZXZpY2Vf
c3RhdGUgKnN0YXRlLAogCQkJCSAgIHN0cnVjdCB2NGwyX2VuY29kZXJfY21kICplYyk7Ci1pbnQg
djRsMl9tMm1faW9jdGxfdHJ5X2RlY29kZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LAoraW50IHY0bDJfbTJtX2lvY3RsX3RyeV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmls
ZSwKKwkJCQkgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkgICBzdHJ1
Y3QgdjRsMl9kZWNvZGVyX2NtZCAqZGMpOwotaW50IHY0bDJfbTJtX2lvY3RsX3N0YXRlbGVzc190
cnlfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCitpbnQgdjRsMl9t
Mm1faW9jdGxfc3RhdGVsZXNzX3RyeV9kZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJ
CQkJICAgICBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJICAgICBzdHJ1
Y3QgdjRsMl9kZWNvZGVyX2NtZCAqZGMpOwotaW50IHY0bDJfbTJtX2lvY3RsX3N0YXRlbGVzc19k
ZWNvZGVyX2NtZChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2NGwyX20ybV9p
b2N0bF9zdGF0ZWxlc3NfZGVjb2Rlcl9jbWQoc3RydWN0IGZpbGUgKmZpbGUsCisJCQkJCSBzdHJ1
Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKIAkJCQkJIHN0cnVjdCB2NGwyX2RlY29kZXJf
Y21kICpkYyk7CiBpbnQgdjRsMl9tMm1fZm9wX21tYXAoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVj
dCB2bV9hcmVhX3N0cnVjdCAqdm1hKTsKIF9fcG9sbF90IHY0bDJfbTJtX2ZvcF9wb2xsKHN0cnVj
dCBmaWxlICpmaWxlLCBwb2xsX3RhYmxlICp3YWl0KTsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbWVk
aWEvdmlkZW9idWYyLXY0bDIuaCBiL2luY2x1ZGUvbWVkaWEvdmlkZW9idWYyLXY0bDIuaAppbmRl
eCA3N2NlODIzOGFiMzAzYTZmOTBkZmI4OTg1MmU3ZTQ4NTU1ZjU1YTkyLi4wMTY0ZjBmM2U0MDRh
NDI1NTMzZDc2NTc5NDRjMjZjMmY2ZWFlMWRhIDEwMDY0NAotLS0gYS9pbmNsdWRlL21lZGlhL3Zp
ZGVvYnVmMi12NGwyLmgKKysrIGIvaW5jbHVkZS9tZWRpYS92aWRlb2J1ZjItdjRsMi5oCkBAIC0x
NCw2ICsxNCw3IEBACiAKICNpbmNsdWRlIDxsaW51eC92aWRlb2RldjIuaD4KICNpbmNsdWRlIDxt
ZWRpYS92aWRlb2J1ZjItY29yZS5oPgorI2luY2x1ZGUgPG1lZGlhL3Y0bDItZGV2Lmg+CiAKICNp
ZiBWQjJfTUFYX0ZSQU1FICE9IFZJREVPX01BWF9GUkFNRQogI2Vycm9yIFZCMl9NQVhfRlJBTUUg
IT0gVklERU9fTUFYX0ZSQU1FCkBAIC0zMjEsMjAgKzMyMiwyOCBAQCBzdGF0aWMgaW5saW5lIGJv
b2wgdmIyX3F1ZXVlX2lzX2J1c3koc3RydWN0IHZiMl9xdWV1ZSAqcSwgc3RydWN0IGZpbGUgKmZp
bGUpCiAKIC8qIHN0cnVjdCB2NGwyX2lvY3RsX29wcyBoZWxwZXJzICovCiAKLWludCB2YjJfaW9j
dGxfcmVxYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQkJCSAgc3RydWN0IHY0
bDJfcmVxdWVzdGJ1ZmZlcnMgKnApOwotaW50IHZiMl9pb2N0bF9jcmVhdGVfYnVmcyhzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKK2ludCB2YjJfaW9jdGxfcmVxYnVmcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCisJCSAgICAgIHN0cnVj
dCB2NGwyX3JlcXVlc3RidWZmZXJzICpwKTsKK2ludCB2YjJfaW9jdGxfY3JlYXRlX2J1ZnMoc3Ry
dWN0IGZpbGUgKmZpbGUsCisJCQkgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLAog
CQkJICBzdHJ1Y3QgdjRsMl9jcmVhdGVfYnVmZmVycyAqcCk7Ci1pbnQgdmIyX2lvY3RsX3ByZXBh
cmVfYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAoraW50IHZiMl9pb2N0bF9wcmVw
YXJlX2J1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0
ZSAqc3RhdGUsCiAJCQkgIHN0cnVjdCB2NGwyX2J1ZmZlciAqcCk7Ci1pbnQgdmIyX2lvY3RsX3F1
ZXJ5YnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBzdHJ1Y3QgdjRsMl9idWZmZXIg
KnApOwotaW50IHZiMl9pb2N0bF9xYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LCBz
dHJ1Y3QgdjRsMl9idWZmZXIgKnApOwotaW50IHZiMl9pb2N0bF9kcWJ1ZihzdHJ1Y3QgZmlsZSAq
ZmlsZSwgdm9pZCAqcHJpdiwgc3RydWN0IHY0bDJfYnVmZmVyICpwKTsKLWludCB2YjJfaW9jdGxf
c3RyZWFtb24oc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIGVudW0gdjRsMl9idWZfdHlw
ZSBpKTsKLWludCB2YjJfaW9jdGxfc3RyZWFtb2ZmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpw
cml2LCBlbnVtIHY0bDJfYnVmX3R5cGUgaSk7Ci1pbnQgdmIyX2lvY3RsX2V4cGJ1ZihzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKLQlzdHJ1Y3QgdjRsMl9leHBvcnRidWZmZXIgKnApOwot
aW50IHZiMl9pb2N0bF9yZW1vdmVfYnVmcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwK
K2ludCB2YjJfaW9jdGxfcXVlcnlidWYoc3RydWN0IGZpbGUgKmZpbGUsIHN0cnVjdCB2aWRlb19k
ZXZpY2Vfc3RhdGUgKnN0YXRlLAorCQkgICAgICAgc3RydWN0IHY0bDJfYnVmZmVyICpwKTsKK2lu
dCB2YjJfaW9jdGxfcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHZpZGVvX2RldmljZV9z
dGF0ZSAqc3RhdGUsCisJCSAgIHN0cnVjdCB2NGwyX2J1ZmZlciAqcCk7CitpbnQgdmIyX2lvY3Rs
X2RxYnVmKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0
ZSwKKwkJICAgIHN0cnVjdCB2NGwyX2J1ZmZlciAqcCk7CitpbnQgdmIyX2lvY3RsX3N0cmVhbW9u
KHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJ
ICAgICAgIGVudW0gdjRsMl9idWZfdHlwZSBpKTsKK2ludCB2YjJfaW9jdGxfc3RyZWFtb2ZmKHN0
cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgdmlkZW9fZGV2aWNlX3N0YXRlICpzdGF0ZSwKKwkJCWVu
dW0gdjRsMl9idWZfdHlwZSBpKTsKK2ludCB2YjJfaW9jdGxfZXhwYnVmKHN0cnVjdCBmaWxlICpm
aWxlLAorCQkgICAgIHN0cnVjdCB2aWRlb19kZXZpY2Vfc3RhdGUgKnN0YXRlLCBzdHJ1Y3QgdjRs
Ml9leHBvcnRidWZmZXIgKnApOworaW50IHZiMl9pb2N0bF9yZW1vdmVfYnVmcyhzdHJ1Y3QgZmls
ZSAqZmlsZSwKKwkJCSAgc3RydWN0IHZpZGVvX2RldmljZV9zdGF0ZSAqc3RhdGUsCiAJCQkgIHN0
cnVjdCB2NGwyX3JlbW92ZV9idWZmZXJzICpwKTsKIAogLyogc3RydWN0IHY0bDJfZmlsZV9vcGVy
YXRpb25zIGhlbHBlcnMgKi8KCi0tIAoyLjUxLjAKCgoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KTWpwZWctdXNlcnMgbWFpbGluZyBsaXN0Ck1qcGVnLXVz
ZXJzQGxpc3RzLnNvdXJjZWZvcmdlLm5ldApodHRwczovL2xpc3RzLnNvdXJjZWZvcmdlLm5ldC9s
aXN0cy9saXN0aW5mby9tanBlZy11c2Vycwo=
